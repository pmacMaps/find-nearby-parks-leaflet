!function(){let i,r;var n="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{};function o(i,r,n,o){Object.defineProperty(i,r,{get:n,set:o,enumerable:!0,configurable:!0})}var a={},s={},l=n.parcelRequirebeb2;null==l&&((l=function(i){if(i in a)return a[i].exports;if(i in s){var r=s[i];delete s[i];var n={id:i,exports:{}};return a[i]=n,r.call(n.exports,n,n.exports),n.exports}var o=Error("Cannot find module '"+i+"'");throw o.code="MODULE_NOT_FOUND",o}).register=function(i,r){s[i]=r},n.parcelRequirebeb2=l),l.register("9qak9",function(i,r){var n,o;n="undefined"!=typeof window?window:i.exports,o=function(i,r){"use strict";var n,o=[],a=Object.getPrototypeOf,s=o.slice,l=o.flat?function(i){return o.flat.call(i)}:function(i){return o.concat.apply([],i)},u=o.push,h=o.indexOf,c={},d=c.toString,p=c.hasOwnProperty,f=p.toString,m=f.call(Object),g={},_=function(i){return"function"==typeof i&&"number"!=typeof i.nodeType&&"function"!=typeof i.item},y=function(i){return null!=i&&i===i.window},v=i.document,x={type:!0,src:!0,nonce:!0,noModule:!0};function b(i,r,n){var o,a,s=(n=n||v).createElement("script");if(s.text=i,r)for(o in x)(a=r[o]||r.getAttribute&&r.getAttribute(o))&&s.setAttribute(o,a);n.head.appendChild(s).parentNode.removeChild(s)}function w(i){return null==i?i+"":"object"==typeof i||"function"==typeof i?c[d.call(i)]||"object":typeof i}var T="3.7.0",E=/HTML$/i,S=function(i,r){return new S.fn.init(i,r)};function C(i){var r=!!i&&"length"in i&&i.length,n=w(i);return!(_(i)||y(i))&&("array"===n||0===r||"number"==typeof r&&r>0&&r-1 in i)}function I(i,r){return i.nodeName&&i.nodeName.toLowerCase()===r.toLowerCase()}S.fn=S.prototype={jquery:T,constructor:S,length:0,toArray:function(){return s.call(this)},get:function(i){return null==i?s.call(this):i<0?this[i+this.length]:this[i]},pushStack:function(i){var r=S.merge(this.constructor(),i);return r.prevObject=this,r},each:function(i){return S.each(this,i)},map:function(i){return this.pushStack(S.map(this,function(r,n){return i.call(r,n,r)}))},slice:function(){return this.pushStack(s.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},even:function(){return this.pushStack(S.grep(this,function(i,r){return(r+1)%2}))},odd:function(){return this.pushStack(S.grep(this,function(i,r){return r%2}))},eq:function(i){var r=this.length,n=+i+(i<0?r:0);return this.pushStack(n>=0&&n<r?[this[n]]:[])},end:function(){return this.prevObject||this.constructor()},push:u,sort:o.sort,splice:o.splice},S.extend=S.fn.extend=function(){var i,r,n,o,a,s,l=arguments[0]||{},u=1,h=arguments.length,c=!1;for("boolean"==typeof l&&(c=l,l=arguments[u]||{},u++),"object"==typeof l||_(l)||(l={}),u===h&&(l=this,u--);u<h;u++)if(null!=(i=arguments[u]))for(r in i)o=i[r],"__proto__"!==r&&l!==o&&(c&&o&&(S.isPlainObject(o)||(a=Array.isArray(o)))?(n=l[r],s=a&&!Array.isArray(n)?[]:a||S.isPlainObject(n)?n:{},a=!1,l[r]=S.extend(c,s,o)):void 0!==o&&(l[r]=o));return l},S.extend({expando:"jQuery"+(T+Math.random()).replace(/\D/g,""),isReady:!0,error:function(i){throw Error(i)},noop:function(){},isPlainObject:function(i){var r,n;return!!i&&"[object Object]"===d.call(i)&&(!(r=a(i))||"function"==typeof(n=p.call(r,"constructor")&&r.constructor)&&f.call(n)===m)},isEmptyObject:function(i){var r;for(r in i)return!1;return!0},globalEval:function(i,r,n){b(i,{nonce:r&&r.nonce},n)},each:function(i,r){var n,o=0;if(C(i))for(n=i.length;o<n&&!1!==r.call(i[o],o,i[o]);o++);else for(o in i)if(!1===r.call(i[o],o,i[o]))break;return i},text:function(i){var r,n="",o=0,a=i.nodeType;if(a){if(1===a||9===a||11===a)return i.textContent;if(3===a||4===a)return i.nodeValue}else for(;r=i[o++];)n+=S.text(r);return n},makeArray:function(i,r){var n=r||[];return null!=i&&(C(Object(i))?S.merge(n,"string"==typeof i?[i]:i):u.call(n,i)),n},inArray:function(i,r,n){return null==r?-1:h.call(r,i,n)},isXMLDoc:function(i){var r=i&&i.namespaceURI,n=i&&(i.ownerDocument||i).documentElement;return!E.test(r||n&&n.nodeName||"HTML")},merge:function(i,r){for(var n=+r.length,o=0,a=i.length;o<n;o++)i[a++]=r[o];return i.length=a,i},grep:function(i,r,n){for(var o=[],a=0,s=i.length,l=!n;a<s;a++)!r(i[a],a)!==l&&o.push(i[a]);return o},map:function(i,r,n){var o,a,s=0,u=[];if(C(i))for(o=i.length;s<o;s++)null!=(a=r(i[s],s,n))&&u.push(a);else for(s in i)null!=(a=r(i[s],s,n))&&u.push(a);return l(u)},guid:1,support:g}),"function"==typeof Symbol&&(S.fn[Symbol.iterator]=o[Symbol.iterator]),S.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),function(i,r){c["[object "+r+"]"]=r.toLowerCase()});var A=o.pop,P=o.sort,k=o.splice,M="[\\x20\\t\\r\\n\\f]",z=RegExp("^"+M+"+|((?:^|[^\\\\])(?:\\\\.)*)"+M+"+$","g");S.contains=function(i,r){var n=r&&r.parentNode;return i===n||!!(n&&1===n.nodeType&&(i.contains?i.contains(n):i.compareDocumentPosition&&16&i.compareDocumentPosition(n)))};var D=/([\0-\x1f\x7f]|^-?\d)|^-$|[^\x80-\uFFFF\w-]/g;function R(i,r){return r?"\x00"===i?"ï¿½":i.slice(0,-1)+"\\"+i.charCodeAt(i.length-1).toString(16)+" ":"\\"+i}S.escapeSelector=function(i){return(i+"").replace(D,R)},function(){var r,n,a,l,c,d,f,m,_,y,x=u,b=S.expando,w=0,T=0,E=tn(),C=tn(),D=tn(),R=tn(),B=function(i,r){return i===r&&(c=!0),0},O="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",F="(?:\\\\[\\da-fA-F]{1,6}"+M+"?|\\\\[^\\r\\n\\f]|[\\w-]|[^\x00-\\x7f])+",N="\\["+M+"*("+F+")(?:"+M+"*([*^$|!~]?=)"+M+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+F+"))|)"+M+"*\\]",U=":("+F+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+N+")*)|.*)\\)|)",j=RegExp(M+"+","g"),Z=RegExp("^"+M+"*,"+M+"*"),V=RegExp("^"+M+"*([>+~]|"+M+")"+M+"*"),q=RegExp(M+"|>"),G=new RegExp(U),W=RegExp("^"+F+"$"),H={ID:RegExp("^#("+F+")"),CLASS:RegExp("^\\.("+F+")"),TAG:RegExp("^("+F+"|[*])"),ATTR:RegExp("^"+N),PSEUDO:RegExp("^"+U),CHILD:RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+M+"*(even|odd|(([+-]|)(\\d*)n|)"+M+"*(?:([+-]|)"+M+"*(\\d+)|))"+M+"*\\)|)","i"),bool:RegExp("^(?:"+O+")$","i"),needsContext:RegExp("^"+M+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+M+"*((?:-\\d)?\\d*)"+M+"*\\)|)(?=[^-]|$)","i")},X=/^(?:input|select|textarea|button)$/i,K=/^h\d$/i,J=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,Y=/[+~]/,Q=RegExp("\\\\[\\da-fA-F]{1,6}"+M+"?|\\\\([^\\r\\n\\f])","g"),tt=function(i,r){var n="0x"+i.slice(1)-65536;return r||(n<0?String.fromCharCode(n+65536):String.fromCharCode(n>>10|55296,1023&n|56320))},te=function(){th()},ti=tf(function(i){return!0===i.disabled&&I(i,"fieldset")},{dir:"parentNode",next:"legend"});try{x.apply(o=s.call(v.childNodes),v.childNodes),o[v.childNodes.length].nodeType}catch(i){x={apply:function(i,r){u.apply(i,s.call(r))},call:function(i){u.apply(i,s.call(arguments,1))}}}function tr(i,r,n,o){var a,s,l,u,h,c,p,f=r&&r.ownerDocument,y=r?r.nodeType:9;if(n=n||[],"string"!=typeof i||!i||1!==y&&9!==y&&11!==y)return n;if(!o&&(th(r),r=r||d,m)){if(11!==y&&(h=J.exec(i))){if(a=h[1]){if(9===y){if(!(l=r.getElementById(a)))return n;if(l.id===a)return x.call(n,l),n}else if(f&&(l=f.getElementById(a))&&tr.contains(r,l)&&l.id===a)return x.call(n,l),n}else if(h[2])return x.apply(n,r.getElementsByTagName(i)),n;else if((a=h[3])&&r.getElementsByClassName)return x.apply(n,r.getElementsByClassName(a)),n}if(!R[i+" "]&&(!_||!_.test(i))){if(p=i,f=r,1===y&&(q.test(i)||V.test(i))){for((f=Y.test(i)&&tu(r.parentNode)||r)==r&&g.scope||((u=r.getAttribute("id"))?u=S.escapeSelector(u):r.setAttribute("id",u=b)),s=(c=td(i)).length;s--;)c[s]=(u?"#"+u:":scope")+" "+tp(c[s]);p=c.join(",")}try{return x.apply(n,f.querySelectorAll(p)),n}catch(r){R(i,!0)}finally{u===b&&r.removeAttribute("id")}}}return ty(i.replace(z,"$1"),r,n,o)}function tn(){var i=[];function r(o,a){return i.push(o+" ")>n.cacheLength&&delete r[i.shift()],r[o+" "]=a}return r}function to(i){return i[b]=!0,i}function ta(i){var r=d.createElement("fieldset");try{return!!i(r)}catch(i){return!1}finally{r.parentNode&&r.parentNode.removeChild(r),r=null}}function ts(i){return function(r){if("form"in r)return r.parentNode&&!1===r.disabled?"label"in r?"label"in r.parentNode?r.parentNode.disabled===i:r.disabled===i:r.isDisabled===i||!i!==r.isDisabled&&ti(r)===i:r.disabled===i;return"label"in r&&r.disabled===i}}function tl(i){return to(function(r){return r=+r,to(function(n,o){for(var a,s=i([],n.length,r),l=s.length;l--;)n[a=s[l]]&&(n[a]=!(o[a]=n[a]))})})}function tu(i){return i&&void 0!==i.getElementsByTagName&&i}function th(i){var r,o=i?i.ownerDocument||i:v;return o!=d&&9===o.nodeType&&o.documentElement&&(f=(d=o).documentElement,m=!S.isXMLDoc(d),y=f.matches||f.webkitMatchesSelector||f.msMatchesSelector,v!=d&&(r=d.defaultView)&&r.top!==r&&r.addEventListener("unload",te),g.getById=ta(function(i){return f.appendChild(i).id=S.expando,!d.getElementsByName||!d.getElementsByName(S.expando).length}),g.disconnectedMatch=ta(function(i){return y.call(i,"*")}),g.scope=ta(function(){return d.querySelectorAll(":scope")}),g.cssHas=ta(function(){try{return d.querySelector(":has(*,:jqfake)"),!1}catch(i){return!0}}),g.getById?(n.filter.ID=function(i){var r=i.replace(Q,tt);return function(i){return i.getAttribute("id")===r}},n.find.ID=function(i,r){if(void 0!==r.getElementById&&m){var n=r.getElementById(i);return n?[n]:[]}}):(n.filter.ID=function(i){var r=i.replace(Q,tt);return function(i){var n=void 0!==i.getAttributeNode&&i.getAttributeNode("id");return n&&n.value===r}},n.find.ID=function(i,r){if(void 0!==r.getElementById&&m){var n,o,a,s=r.getElementById(i);if(s){if((n=s.getAttributeNode("id"))&&n.value===i)return[s];for(a=r.getElementsByName(i),o=0;s=a[o++];)if((n=s.getAttributeNode("id"))&&n.value===i)return[s]}return[]}}),n.find.TAG=function(i,r){return void 0!==r.getElementsByTagName?r.getElementsByTagName(i):r.querySelectorAll(i)},n.find.CLASS=function(i,r){if(void 0!==r.getElementsByClassName&&m)return r.getElementsByClassName(i)},_=[],ta(function(i){var r;f.appendChild(i).innerHTML="<a id='"+b+"' href='' disabled='disabled'></a><select id='"+b+"-\r\\' disabled='disabled'><option selected=''></option></select>",i.querySelectorAll("[selected]").length||_.push("\\["+M+"*(?:value|"+O+")"),i.querySelectorAll("[id~="+b+"-]").length||_.push("~="),i.querySelectorAll("a#"+b+"+*").length||_.push(".#.+[+~]"),i.querySelectorAll(":checked").length||_.push(":checked"),(r=d.createElement("input")).setAttribute("type","hidden"),i.appendChild(r).setAttribute("name","D"),f.appendChild(i).disabled=!0,2!==i.querySelectorAll(":disabled").length&&_.push(":enabled",":disabled"),(r=d.createElement("input")).setAttribute("name",""),i.appendChild(r),i.querySelectorAll("[name='']").length||_.push("\\["+M+"*name"+M+"*="+M+"*(?:''|\"\")")}),g.cssHas||_.push(":has"),_=_.length&&new RegExp(_.join("|")),B=function(i,r){if(i===r)return c=!0,0;var n=!i.compareDocumentPosition-!r.compareDocumentPosition;return n||(1&(n=(i.ownerDocument||i)==(r.ownerDocument||r)?i.compareDocumentPosition(r):1)||!g.sortDetached&&r.compareDocumentPosition(i)===n?i===d||i.ownerDocument==v&&tr.contains(v,i)?-1:r===d||r.ownerDocument==v&&tr.contains(v,r)?1:l?h.call(l,i)-h.call(l,r):0:4&n?-1:1)}),d}for(r in tr.matches=function(i,r){return tr(i,null,null,r)},tr.matchesSelector=function(i,r){if(th(i),m&&!R[r+" "]&&(!_||!_.test(r)))try{var n=y.call(i,r);if(n||g.disconnectedMatch||i.document&&11!==i.document.nodeType)return n}catch(i){R(r,!0)}return tr(r,d,null,[i]).length>0},tr.contains=function(i,r){return(i.ownerDocument||i)!=d&&th(i),S.contains(i,r)},tr.attr=function(i,r){(i.ownerDocument||i)!=d&&th(i);var o=n.attrHandle[r.toLowerCase()],a=o&&p.call(n.attrHandle,r.toLowerCase())?o(i,r,!m):void 0;return void 0!==a?a:i.getAttribute(r)},tr.error=function(i){throw Error("Syntax error, unrecognized expression: "+i)},S.uniqueSort=function(i){var r,n=[],o=0,a=0;if(c=!g.sortStable,l=!g.sortStable&&s.call(i,0),P.call(i,B),c){for(;r=i[a++];)r===i[a]&&(o=n.push(a));for(;o--;)k.call(i,n[o],1)}return l=null,i},S.fn.uniqueSort=function(){return this.pushStack(S.uniqueSort(s.apply(this)))},(n=S.expr={cacheLength:50,createPseudo:to,match:H,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(i){return i[1]=i[1].replace(Q,tt),i[3]=(i[3]||i[4]||i[5]||"").replace(Q,tt),"~="===i[2]&&(i[3]=" "+i[3]+" "),i.slice(0,4)},CHILD:function(i){return i[1]=i[1].toLowerCase(),"nth"===i[1].slice(0,3)?(i[3]||tr.error(i[0]),i[4]=+(i[4]?i[5]+(i[6]||1):2*("even"===i[3]||"odd"===i[3])),i[5]=+(i[7]+i[8]||"odd"===i[3])):i[3]&&tr.error(i[0]),i},PSEUDO:function(i){var r,n=!i[6]&&i[2];return H.CHILD.test(i[0])?null:(i[3]?i[2]=i[4]||i[5]||"":n&&G.test(n)&&(r=td(n,!0))&&(r=n.indexOf(")",n.length-r)-n.length)&&(i[0]=i[0].slice(0,r),i[2]=n.slice(0,r)),i.slice(0,3))}},filter:{TAG:function(i){var r=i.replace(Q,tt).toLowerCase();return"*"===i?function(){return!0}:function(i){return I(i,r)}},CLASS:function(i){var r=E[i+" "];return r||(r=RegExp("(^|"+M+")"+i+"("+M+"|$)"),E(i,function(i){return r.test("string"==typeof i.className&&i.className||void 0!==i.getAttribute&&i.getAttribute("class")||"")}))},ATTR:function(i,r,n){return function(o){var a=tr.attr(o,i);return null==a?"!="===r:!r||((a+="","="===r)?a===n:"!="===r?a!==n:"^="===r?n&&0===a.indexOf(n):"*="===r?n&&a.indexOf(n)>-1:"$="===r?n&&a.slice(-n.length)===n:"~="===r?(" "+a.replace(j," ")+" ").indexOf(n)>-1:"|="===r&&(a===n||a.slice(0,n.length+1)===n+"-"))}},CHILD:function(i,r,n,o,a){var s="nth"!==i.slice(0,3),l="last"!==i.slice(-4),u="of-type"===r;return 1===o&&0===a?function(i){return!!i.parentNode}:function(r,n,h){var c,d,p,f,m,g=s!==l?"nextSibling":"previousSibling",_=r.parentNode,y=u&&r.nodeName.toLowerCase(),v=!h&&!u,x=!1;if(_){if(s){for(;g;){for(p=r;p=p[g];)if(u?I(p,y):1===p.nodeType)return!1;m=g="only"===i&&!m&&"nextSibling"}return!0}if(m=[l?_.firstChild:_.lastChild],l&&v){for(x=(f=(c=(d=_[b]||(_[b]={}))[i]||[])[0]===w&&c[1])&&c[2],p=f&&_.childNodes[f];p=++f&&p&&p[g]||(x=f=0)||m.pop();)if(1===p.nodeType&&++x&&p===r){d[i]=[w,f,x];break}}else if(v&&(x=f=(c=(d=r[b]||(r[b]={}))[i]||[])[0]===w&&c[1]),!1===x)for(;(p=++f&&p&&p[g]||(x=f=0)||m.pop())&&(!((u?I(p,y):1===p.nodeType)&&++x)||(v&&((d=p[b]||(p[b]={}))[i]=[w,x]),p!==r)););return(x-=a)===o||x%o==0&&x/o>=0}}},PSEUDO:function(i,r){var o,a=n.pseudos[i]||n.setFilters[i.toLowerCase()]||tr.error("unsupported pseudo: "+i);return a[b]?a(r):a.length>1?(o=[i,i,"",r],n.setFilters.hasOwnProperty(i.toLowerCase())?to(function(i,n){for(var o,s=a(i,r),l=s.length;l--;)o=h.call(i,s[l]),i[o]=!(n[o]=s[l])}):function(i){return a(i,0,o)}):a}},pseudos:{not:to(function(i){var r=[],n=[],o=t_(i.replace(z,"$1"));return o[b]?to(function(i,r,n,a){for(var s,l=o(i,null,a,[]),u=i.length;u--;)(s=l[u])&&(i[u]=!(r[u]=s))}):function(i,a,s){return r[0]=i,o(r,null,s,n),r[0]=null,!n.pop()}}),has:to(function(i){return function(r){return tr(i,r).length>0}}),contains:to(function(i){return i=i.replace(Q,tt),function(r){return(r.textContent||S.text(r)).indexOf(i)>-1}}),lang:to(function(i){return W.test(i||"")||tr.error("unsupported lang: "+i),i=i.replace(Q,tt).toLowerCase(),function(r){var n;do if(n=m?r.lang:r.getAttribute("xml:lang")||r.getAttribute("lang"))return(n=n.toLowerCase())===i||0===n.indexOf(i+"-");while((r=r.parentNode)&&1===r.nodeType)return!1}}),target:function(r){var n=i.location&&i.location.hash;return n&&n.slice(1)===r.id},root:function(i){return i===f},focus:function(i){return i===function(){try{return d.activeElement}catch(i){}}()&&d.hasFocus()&&!!(i.type||i.href||~i.tabIndex)},enabled:ts(!1),disabled:ts(!0),checked:function(i){return I(i,"input")&&!!i.checked||I(i,"option")&&!!i.selected},selected:function(i){return i.parentNode&&i.parentNode.selectedIndex,!0===i.selected},empty:function(i){for(i=i.firstChild;i;i=i.nextSibling)if(i.nodeType<6)return!1;return!0},parent:function(i){return!n.pseudos.empty(i)},header:function(i){return K.test(i.nodeName)},input:function(i){return X.test(i.nodeName)},button:function(i){return I(i,"input")&&"button"===i.type||I(i,"button")},text:function(i){var r;return I(i,"input")&&"text"===i.type&&(null==(r=i.getAttribute("type"))||"text"===r.toLowerCase())},first:tl(function(){return[0]}),last:tl(function(i,r){return[r-1]}),eq:tl(function(i,r,n){return[n<0?n+r:n]}),even:tl(function(i,r){for(var n=0;n<r;n+=2)i.push(n);return i}),odd:tl(function(i,r){for(var n=1;n<r;n+=2)i.push(n);return i}),lt:tl(function(i,r,n){var o;for(o=n<0?n+r:n>r?r:n;--o>=0;)i.push(o);return i}),gt:tl(function(i,r,n){for(var o=n<0?n+r:n;++o<r;)i.push(o);return i})}}).pseudos.nth=n.pseudos.eq,{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})n.pseudos[r]=function(i){return function(r){return I(r,"input")&&r.type===i}}(r);for(r in{submit:!0,reset:!0})n.pseudos[r]=function(i){return function(r){return(I(r,"input")||I(r,"button"))&&r.type===i}}(r);function tc(){}function td(i,r){var o,a,s,l,u,h,c,d=C[i+" "];if(d)return r?0:d.slice(0);for(u=i,h=[],c=n.preFilter;u;){for(l in(!o||(a=Z.exec(u)))&&(a&&(u=u.slice(a[0].length)||u),h.push(s=[])),o=!1,(a=V.exec(u))&&(o=a.shift(),s.push({value:o,type:a[0].replace(z," ")}),u=u.slice(o.length)),n.filter)(a=H[l].exec(u))&&(!c[l]||(a=c[l](a)))&&(o=a.shift(),s.push({value:o,type:l,matches:a}),u=u.slice(o.length));if(!o)break}return r?u.length:u?tr.error(i):C(i,h).slice(0)}function tp(i){for(var r=0,n=i.length,o="";r<n;r++)o+=i[r].value;return o}function tf(i,r,n){var o=r.dir,a=r.next,s=a||o,l=n&&"parentNode"===s,u=T++;return r.first?function(r,n,a){for(;r=r[o];)if(1===r.nodeType||l)return i(r,n,a);return!1}:function(r,n,h){var c,d,p=[w,u];if(h){for(;r=r[o];)if((1===r.nodeType||l)&&i(r,n,h))return!0}else for(;r=r[o];)if(1===r.nodeType||l){if(d=r[b]||(r[b]={}),a&&I(r,a))r=r[o]||r;else{if((c=d[s])&&c[0]===w&&c[1]===u)return p[2]=c[2];if(d[s]=p,p[2]=i(r,n,h))return!0}}return!1}}function tm(i){return i.length>1?function(r,n,o){for(var a=i.length;a--;)if(!i[a](r,n,o))return!1;return!0}:i[0]}function tg(i,r,n,o,a){for(var s,l=[],u=0,h=i.length,c=null!=r;u<h;u++)(s=i[u])&&(!n||n(s,o,a))&&(l.push(s),c&&r.push(u));return l}function t_(i,r){var o,s,l,u,c=[],p=[],f=D[i+" "];if(!f){for(r||(r=td(i)),u=r.length;u--;)(f=function i(r){for(var o,s,l,u=r.length,c=n.relative[r[0].type],d=c||n.relative[" "],p=c?1:0,f=tf(function(i){return i===o},d,!0),m=tf(function(i){return h.call(o,i)>-1},d,!0),g=[function(i,r,n){var s=!c&&(n||r!=a)||((o=r).nodeType?f(i,r,n):m(i,r,n));return o=null,s}];p<u;p++)if(s=n.relative[r[p].type])g=[tf(tm(g),s)];else{if((s=n.filter[r[p].type].apply(null,r[p].matches))[b]){for(l=++p;l<u&&!n.relative[r[l].type];l++);return function i(r,n,o,a,s,l){return a&&!a[b]&&(a=i(a)),s&&!s[b]&&(s=i(s,l)),to(function(i,l,u,c){var d,p,f,m,g=[],_=[],y=l.length,v=i||function(i,r,n){for(var o=0,a=r.length;o<a;o++)tr(i,r[o],n);return n}(n||"*",u.nodeType?[u]:u,[]),b=r&&(i||!n)?tg(v,g,r,u,c):v;if(o?o(b,m=s||(i?r:y||a)?[]:l,u,c):m=b,a)for(d=tg(m,_),a(d,[],u,c),p=d.length;p--;)(f=d[p])&&(m[_[p]]=!(b[_[p]]=f));if(i){if(s||r){if(s){for(d=[],p=m.length;p--;)(f=m[p])&&d.push(b[p]=f);s(null,m=[],d,c)}for(p=m.length;p--;)(f=m[p])&&(d=s?h.call(i,f):g[p])>-1&&(i[d]=!(l[d]=f))}}else m=tg(m===l?m.splice(y,m.length):m),s?s(null,l,m,c):x.apply(l,m)})}(p>1&&tm(g),p>1&&tp(r.slice(0,p-1).concat({value:" "===r[p-2].type?"*":""})).replace(z,"$1"),s,p<l&&i(r.slice(p,l)),l<u&&i(r=r.slice(l)),l<u&&tp(r))}g.push(s)}return tm(g)}(r[u]))[b]?c.push(f):p.push(f);(f=D(i,(o=c.length>0,s=p.length>0,l=function(i,r,l,u,h){var f,g,_,y=0,v="0",b=i&&[],T=[],E=a,C=i||s&&n.find.TAG("*",h),I=w+=null==E?1:Math.random()||.1,P=C.length;for(h&&(a=r==d||r||h);v!==P&&null!=(f=C[v]);v++){if(s&&f){for(g=0,r||f.ownerDocument==d||(th(f),l=!m);_=p[g++];)if(_(f,r||d,l)){x.call(u,f);break}h&&(w=I)}o&&((f=!_&&f)&&y--,i&&b.push(f))}if(y+=v,o&&v!==y){for(g=0;_=c[g++];)_(b,T,r,l);if(i){if(y>0)for(;v--;)b[v]||T[v]||(T[v]=A.call(u));T=tg(T)}x.apply(u,T),h&&!i&&T.length>0&&y+c.length>1&&S.uniqueSort(u)}return h&&(w=I,a=E),b},o?to(l):l))).selector=i}return f}function ty(i,r,o,a){var s,l,u,h,c,d="function"==typeof i&&i,p=!a&&td(i=d.selector||i);if(o=o||[],1===p.length){if((l=p[0]=p[0].slice(0)).length>2&&"ID"===(u=l[0]).type&&9===r.nodeType&&m&&n.relative[l[1].type]){if(!(r=(n.find.ID(u.matches[0].replace(Q,tt),r)||[])[0]))return o;d&&(r=r.parentNode),i=i.slice(l.shift().value.length)}for(s=H.needsContext.test(i)?0:l.length;s--&&(u=l[s],!n.relative[h=u.type]);)if((c=n.find[h])&&(a=c(u.matches[0].replace(Q,tt),Y.test(l[0].type)&&tu(r.parentNode)||r))){if(l.splice(s,1),!(i=a.length&&tp(l)))return x.apply(o,a),o;break}}return(d||t_(i,p))(a,r,!m,o,!r||Y.test(i)&&tu(r.parentNode)||r),o}tc.prototype=n.filters=n.pseudos,n.setFilters=new tc,g.sortStable=b.split("").sort(B).join("")===b,th(),g.sortDetached=ta(function(i){return 1&i.compareDocumentPosition(d.createElement("fieldset"))}),S.find=tr,S.expr[":"]=S.expr.pseudos,S.unique=S.uniqueSort,tr.compile=t_,tr.select=ty,tr.setDocument=th,tr.escape=S.escapeSelector,tr.getText=S.text,tr.isXML=S.isXMLDoc,tr.selectors=S.expr,tr.support=S.support,tr.uniqueSort=S.uniqueSort}();var B=function(i,r,n){for(var o=[],a=void 0!==n;(i=i[r])&&9!==i.nodeType;)if(1===i.nodeType){if(a&&S(i).is(n))break;o.push(i)}return o},O=function(i,r){for(var n=[];i;i=i.nextSibling)1===i.nodeType&&i!==r&&n.push(i);return n},F=S.expr.match.needsContext,N=/^<([a-z][^\/\0>:\x20\t\r\n\f]*)[\x20\t\r\n\f]*\/?>(?:<\/\1>|)$/i;function U(i,r,n){return _(r)?S.grep(i,function(i,o){return!!r.call(i,o,i)!==n}):r.nodeType?S.grep(i,function(i){return i===r!==n}):"string"!=typeof r?S.grep(i,function(i){return h.call(r,i)>-1!==n}):S.filter(r,i,n)}S.filter=function(i,r,n){var o=r[0];return(n&&(i=":not("+i+")"),1===r.length&&1===o.nodeType)?S.find.matchesSelector(o,i)?[o]:[]:S.find.matches(i,S.grep(r,function(i){return 1===i.nodeType}))},S.fn.extend({find:function(i){var r,n,o=this.length,a=this;if("string"!=typeof i)return this.pushStack(S(i).filter(function(){for(r=0;r<o;r++)if(S.contains(a[r],this))return!0}));for(r=0,n=this.pushStack([]);r<o;r++)S.find(i,a[r],n);return o>1?S.uniqueSort(n):n},filter:function(i){return this.pushStack(U(this,i||[],!1))},not:function(i){return this.pushStack(U(this,i||[],!0))},is:function(i){return!!U(this,"string"==typeof i&&F.test(i)?S(i):i||[],!1).length}});var j,Z=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]+))$/;(S.fn.init=function(i,r,n){var o,a;if(!i)return this;if(n=n||j,"string"==typeof i){if((o="<"===i[0]&&">"===i[i.length-1]&&i.length>=3?[null,i,null]:Z.exec(i))&&(o[1]||!r)){if(!o[1])return(a=v.getElementById(o[2]))&&(this[0]=a,this.length=1),this;if(r=r instanceof S?r[0]:r,S.merge(this,S.parseHTML(o[1],r&&r.nodeType?r.ownerDocument||r:v,!0)),N.test(o[1])&&S.isPlainObject(r))for(o in r)_(this[o])?this[o](r[o]):this.attr(o,r[o]);return this}return!r||r.jquery?(r||n).find(i):this.constructor(r).find(i)}return i.nodeType?(this[0]=i,this.length=1,this):_(i)?void 0!==n.ready?n.ready(i):i(S):S.makeArray(i,this)}).prototype=S.fn,j=S(v);var V=/^(?:parents|prev(?:Until|All))/,q={children:!0,contents:!0,next:!0,prev:!0};function G(i,r){for(;(i=i[r])&&1!==i.nodeType;);return i}S.fn.extend({has:function(i){var r=S(i,this),n=r.length;return this.filter(function(){for(var i=0;i<n;i++)if(S.contains(this,r[i]))return!0})},closest:function(i,r){var n,o=0,a=this.length,s=[],l="string"!=typeof i&&S(i);if(!F.test(i)){for(;o<a;o++)for(n=this[o];n&&n!==r;n=n.parentNode)if(n.nodeType<11&&(l?l.index(n)>-1:1===n.nodeType&&S.find.matchesSelector(n,i))){s.push(n);break}}return this.pushStack(s.length>1?S.uniqueSort(s):s)},index:function(i){return i?"string"==typeof i?h.call(S(i),this[0]):h.call(this,i.jquery?i[0]:i):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(i,r){return this.pushStack(S.uniqueSort(S.merge(this.get(),S(i,r))))},addBack:function(i){return this.add(null==i?this.prevObject:this.prevObject.filter(i))}}),S.each({parent:function(i){var r=i.parentNode;return r&&11!==r.nodeType?r:null},parents:function(i){return B(i,"parentNode")},parentsUntil:function(i,r,n){return B(i,"parentNode",n)},next:function(i){return G(i,"nextSibling")},prev:function(i){return G(i,"previousSibling")},nextAll:function(i){return B(i,"nextSibling")},prevAll:function(i){return B(i,"previousSibling")},nextUntil:function(i,r,n){return B(i,"nextSibling",n)},prevUntil:function(i,r,n){return B(i,"previousSibling",n)},siblings:function(i){return O((i.parentNode||{}).firstChild,i)},children:function(i){return O(i.firstChild)},contents:function(i){return null!=i.contentDocument&&a(i.contentDocument)?i.contentDocument:(I(i,"template")&&(i=i.content||i),S.merge([],i.childNodes))}},function(i,r){S.fn[i]=function(n,o){var a=S.map(this,r,n);return"Until"!==i.slice(-5)&&(o=n),o&&"string"==typeof o&&(a=S.filter(o,a)),this.length>1&&(q[i]||S.uniqueSort(a),V.test(i)&&a.reverse()),this.pushStack(a)}});var W=/[^\x20\t\r\n\f]+/g;function H(i){return i}function X(i){throw i}function K(i,r,n,o){var a;try{i&&_(a=i.promise)?a.call(i).done(r).fail(n):i&&_(a=i.then)?a.call(i,r,n):r.apply(void 0,[i].slice(o))}catch(i){n.apply(void 0,[i])}}S.Callbacks=function(i){i="string"==typeof i?(r=i,n={},S.each(r.match(W)||[],function(i,r){n[r]=!0}),n):S.extend({},i);var r,n,o,a,s,l,u=[],h=[],c=-1,d=function(){for(l=l||i.once,s=o=!0;h.length;c=-1)for(a=h.shift();++c<u.length;)!1===u[c].apply(a[0],a[1])&&i.stopOnFalse&&(c=u.length,a=!1);i.memory||(a=!1),o=!1,l&&(u=a?[]:"")},p={add:function(){return u&&(a&&!o&&(c=u.length-1,h.push(a)),function r(n){S.each(n,function(n,o){_(o)?i.unique&&p.has(o)||u.push(o):o&&o.length&&"string"!==w(o)&&r(o)})}(arguments),a&&!o&&d()),this},remove:function(){return S.each(arguments,function(i,r){for(var n;(n=S.inArray(r,u,n))>-1;)u.splice(n,1),n<=c&&c--}),this},has:function(i){return i?S.inArray(i,u)>-1:u.length>0},empty:function(){return u&&(u=[]),this},disable:function(){return l=h=[],u=a="",this},disabled:function(){return!u},lock:function(){return l=h=[],a||o||(u=a=""),this},locked:function(){return!!l},fireWith:function(i,r){return l||(r=r||[],r=[i,r.slice?r.slice():r],h.push(r),o||d()),this},fire:function(){return p.fireWith(this,arguments),this},fired:function(){return!!s}};return p},S.extend({Deferred:function(r){var n=[["notify","progress",S.Callbacks("memory"),S.Callbacks("memory"),2],["resolve","done",S.Callbacks("once memory"),S.Callbacks("once memory"),0,"resolved"],["reject","fail",S.Callbacks("once memory"),S.Callbacks("once memory"),1,"rejected"]],o="pending",a={state:function(){return o},always:function(){return s.done(arguments).fail(arguments),this},catch:function(i){return a.then(null,i)},pipe:function(){var i=arguments;return S.Deferred(function(r){S.each(n,function(n,o){var a=_(i[o[4]])&&i[o[4]];s[o[1]](function(){var i=a&&a.apply(this,arguments);i&&_(i.promise)?i.promise().progress(r.notify).done(r.resolve).fail(r.reject):r[o[0]+"With"](this,a?[i]:arguments)})}),i=null}).promise()},then:function(r,o,a){var s=0;function l(r,n,o,a){return function(){var u=this,h=arguments,c=function(){var i,c;if(!(r<s)){if((i=o.apply(u,h))===n.promise())throw TypeError("Thenable self-resolution");_(c=i&&("object"==typeof i||"function"==typeof i)&&i.then)?a?c.call(i,l(s,n,H,a),l(s,n,X,a)):(s++,c.call(i,l(s,n,H,a),l(s,n,X,a),l(s,n,H,n.notifyWith))):(o!==H&&(u=void 0,h=[i]),(a||n.resolveWith)(u,h))}},d=a?c:function(){try{c()}catch(i){S.Deferred.exceptionHook&&S.Deferred.exceptionHook(i,d.error),r+1>=s&&(o!==X&&(u=void 0,h=[i]),n.rejectWith(u,h))}};r?d():(S.Deferred.getErrorHook?d.error=S.Deferred.getErrorHook():S.Deferred.getStackHook&&(d.error=S.Deferred.getStackHook()),i.setTimeout(d))}}return S.Deferred(function(i){n[0][3].add(l(0,i,_(a)?a:H,i.notifyWith)),n[1][3].add(l(0,i,_(r)?r:H)),n[2][3].add(l(0,i,_(o)?o:X))}).promise()},promise:function(i){return null!=i?S.extend(i,a):a}},s={};return S.each(n,function(i,r){var l=r[2],u=r[5];a[r[1]]=l.add,u&&l.add(function(){o=u},n[3-i][2].disable,n[3-i][3].disable,n[0][2].lock,n[0][3].lock),l.add(r[3].fire),s[r[0]]=function(){return s[r[0]+"With"](this===s?void 0:this,arguments),this},s[r[0]+"With"]=l.fireWith}),a.promise(s),r&&r.call(s,s),s},when:function(i){var r=arguments.length,n=r,o=Array(n),a=s.call(arguments),l=S.Deferred(),u=function(i){return function(n){o[i]=this,a[i]=arguments.length>1?s.call(arguments):n,--r||l.resolveWith(o,a)}};if(r<=1&&(K(i,l.done(u(n)).resolve,l.reject,!r),"pending"===l.state()||_(a[n]&&a[n].then)))return l.then();for(;n--;)K(a[n],u(n),l.reject);return l.promise()}});var J=/^(Eval|Internal|Range|Reference|Syntax|Type|URI)Error$/;S.Deferred.exceptionHook=function(r,n){i.console&&i.console.warn&&r&&J.test(r.name)&&i.console.warn("jQuery.Deferred exception: "+r.message,r.stack,n)},S.readyException=function(r){i.setTimeout(function(){throw r})};var Y=S.Deferred();function Q(){v.removeEventListener("DOMContentLoaded",Q),i.removeEventListener("load",Q),S.ready()}S.fn.ready=function(i){return Y.then(i).catch(function(i){S.readyException(i)}),this},S.extend({isReady:!1,readyWait:1,ready:function(i){!(!0===i?--S.readyWait:S.isReady)&&(S.isReady=!0,!0!==i&&--S.readyWait>0||Y.resolveWith(v,[S]))}}),S.ready.then=Y.then,"complete"!==v.readyState&&("loading"===v.readyState||v.documentElement.doScroll)?(v.addEventListener("DOMContentLoaded",Q),i.addEventListener("load",Q)):i.setTimeout(S.ready);var tt=function(i,r,n,o,a,s,l){var u=0,h=i.length,c=null==n;if("object"===w(n))for(u in a=!0,n)tt(i,r,u,n[u],!0,s,l);else if(void 0!==o&&(a=!0,_(o)||(l=!0),c&&(l?(r.call(i,o),r=null):(c=r,r=function(i,r,n){return c.call(S(i),n)})),r))for(;u<h;u++)r(i[u],n,l?o:o.call(i[u],u,r(i[u],n)));return a?i:c?r.call(i):h?r(i[0],n):s},te=/^-ms-/,ti=/-([a-z])/g;function tr(i,r){return r.toUpperCase()}function tn(i){return i.replace(te,"ms-").replace(ti,tr)}var to=function(i){return 1===i.nodeType||9===i.nodeType||!+i.nodeType};function ta(){this.expando=S.expando+ta.uid++}ta.uid=1,ta.prototype={cache:function(i){var r=i[this.expando];return!r&&(r={},to(i)&&(i.nodeType?i[this.expando]=r:Object.defineProperty(i,this.expando,{value:r,configurable:!0}))),r},set:function(i,r,n){var o,a=this.cache(i);if("string"==typeof r)a[tn(r)]=n;else for(o in r)a[tn(o)]=r[o];return a},get:function(i,r){return void 0===r?this.cache(i):i[this.expando]&&i[this.expando][tn(r)]},access:function(i,r,n){return void 0===r||r&&"string"==typeof r&&void 0===n?this.get(i,r):(this.set(i,r,n),void 0!==n?n:r)},remove:function(i,r){var n,o=i[this.expando];if(void 0!==o){if(void 0!==r)for(n=(r=Array.isArray(r)?r.map(tn):((r=tn(r))in o)?[r]:r.match(W)||[]).length;n--;)delete o[r[n]];(void 0===r||S.isEmptyObject(o))&&(i.nodeType?i[this.expando]=void 0:delete i[this.expando])}},hasData:function(i){var r=i[this.expando];return void 0!==r&&!S.isEmptyObject(r)}};var ts=new ta,tl=new ta,tu=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,th=/[A-Z]/g;function tc(i,r,n){var o,a;if(void 0===n&&1===i.nodeType){if(o="data-"+r.replace(th,"-$&").toLowerCase(),"string"==typeof(n=i.getAttribute(o))){try{a=n,n="true"===a||"false"!==a&&("null"===a?null:a===+a+""?+a:tu.test(a)?JSON.parse(a):a)}catch(i){}tl.set(i,r,n)}else n=void 0}return n}S.extend({hasData:function(i){return tl.hasData(i)||ts.hasData(i)},data:function(i,r,n){return tl.access(i,r,n)},removeData:function(i,r){tl.remove(i,r)},_data:function(i,r,n){return ts.access(i,r,n)},_removeData:function(i,r){ts.remove(i,r)}}),S.fn.extend({data:function(i,r){var n,o,a,s=this[0],l=s&&s.attributes;if(void 0===i){if(this.length&&(a=tl.get(s),1===s.nodeType&&!ts.get(s,"hasDataAttrs"))){for(n=l.length;n--;)l[n]&&0===(o=l[n].name).indexOf("data-")&&tc(s,o=tn(o.slice(5)),a[o]);ts.set(s,"hasDataAttrs",!0)}return a}return"object"==typeof i?this.each(function(){tl.set(this,i)}):tt(this,function(r){var n;if(s&&void 0===r)return void 0!==(n=tl.get(s,i))||void 0!==(n=tc(s,i))?n:void 0;this.each(function(){tl.set(this,i,r)})},null,r,arguments.length>1,null,!0)},removeData:function(i){return this.each(function(){tl.remove(this,i)})}}),S.extend({queue:function(i,r,n){var o;if(i)return r=(r||"fx")+"queue",o=ts.get(i,r),n&&(!o||Array.isArray(n)?o=ts.access(i,r,S.makeArray(n)):o.push(n)),o||[]},dequeue:function(i,r){r=r||"fx";var n=S.queue(i,r),o=n.length,a=n.shift(),s=S._queueHooks(i,r);"inprogress"===a&&(a=n.shift(),o--),a&&("fx"===r&&n.unshift("inprogress"),delete s.stop,a.call(i,function(){S.dequeue(i,r)},s)),!o&&s&&s.empty.fire()},_queueHooks:function(i,r){var n=r+"queueHooks";return ts.get(i,n)||ts.access(i,n,{empty:S.Callbacks("once memory").add(function(){ts.remove(i,[r+"queue",n])})})}}),S.fn.extend({queue:function(i,r){var n=2;return("string"!=typeof i&&(r=i,i="fx",n--),arguments.length<n)?S.queue(this[0],i):void 0===r?this:this.each(function(){var n=S.queue(this,i,r);S._queueHooks(this,i),"fx"===i&&"inprogress"!==n[0]&&S.dequeue(this,i)})},dequeue:function(i){return this.each(function(){S.dequeue(this,i)})},clearQueue:function(i){return this.queue(i||"fx",[])},promise:function(i,r){var n,o=1,a=S.Deferred(),s=this,l=this.length,u=function(){--o||a.resolveWith(s,[s])};for("string"!=typeof i&&(r=i,i=void 0),i=i||"fx";l--;)(n=ts.get(s[l],i+"queueHooks"))&&n.empty&&(o++,n.empty.add(u));return u(),a.promise(r)}});var td=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,tp=RegExp("^(?:([+-])=|)("+td+")([a-z%]*)$","i"),tf=["Top","Right","Bottom","Left"],tm=v.documentElement,tg=function(i){return S.contains(i.ownerDocument,i)},t_={composed:!0};tm.getRootNode&&(tg=function(i){return S.contains(i.ownerDocument,i)||i.getRootNode(t_)===i.ownerDocument});var ty=function(i,r){return"none"===(i=r||i).style.display||""===i.style.display&&tg(i)&&"none"===S.css(i,"display")};function tv(i,r,n,o){var a,s,l=20,u=o?function(){return o.cur()}:function(){return S.css(i,r,"")},h=u(),c=n&&n[3]||(S.cssNumber[r]?"":"px"),d=i.nodeType&&(S.cssNumber[r]||"px"!==c&&+h)&&tp.exec(S.css(i,r));if(d&&d[3]!==c){for(h/=2,c=c||d[3],d=+h||1;l--;)S.style(i,r,d+c),(1-s)*(1-(s=u()/h||.5))<=0&&(l=0),d/=s;d*=2,S.style(i,r,d+c),n=n||[]}return n&&(d=+d||+h||0,a=n[1]?d+(n[1]+1)*n[2]:+n[2],o&&(o.unit=c,o.start=d,o.end=a)),a}var tx={};function tb(i,r){for(var n,o,a=[],s=0,l=i.length;s<l;s++)(o=i[s]).style&&(n=o.style.display,r?("none"!==n||(a[s]=ts.get(o,"display")||null,a[s]||(o.style.display="")),""===o.style.display&&ty(o)&&(a[s]=function(i){var r,n=i.ownerDocument,o=i.nodeName,a=tx[o];return a||(r=n.body.appendChild(n.createElement(o)),a=S.css(r,"display"),r.parentNode.removeChild(r),"none"===a&&(a="block"),tx[o]=a),a}(o))):"none"!==n&&(a[s]="none",ts.set(o,"display",n)));for(s=0;s<l;s++)null!=a[s]&&(i[s].style.display=a[s]);return i}S.fn.extend({show:function(){return tb(this,!0)},hide:function(){return tb(this)},toggle:function(i){return"boolean"==typeof i?i?this.show():this.hide():this.each(function(){ty(this)?S(this).show():S(this).hide()})}});var tw=/^(?:checkbox|radio)$/i,tT=/<([a-z][^\/\0>\x20\t\r\n\f]*)/i,tE=/^$|^module$|\/(?:java|ecma)script/i;t9=v.createDocumentFragment().appendChild(v.createElement("div")),(t7=v.createElement("input")).setAttribute("type","radio"),t7.setAttribute("checked","checked"),t7.setAttribute("name","t"),t9.appendChild(t7),g.checkClone=t9.cloneNode(!0).cloneNode(!0).lastChild.checked,t9.innerHTML="<textarea>x</textarea>",g.noCloneChecked=!!t9.cloneNode(!0).lastChild.defaultValue,t9.innerHTML="<option></option>",g.option=!!t9.lastChild;var tS={thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};function tC(i,r){var n;return(n=void 0!==i.getElementsByTagName?i.getElementsByTagName(r||"*"):void 0!==i.querySelectorAll?i.querySelectorAll(r||"*"):[],void 0===r||r&&I(i,r))?S.merge([i],n):n}function tI(i,r){for(var n=0,o=i.length;n<o;n++)ts.set(i[n],"globalEval",!r||ts.get(r[n],"globalEval"))}tS.tbody=tS.tfoot=tS.colgroup=tS.caption=tS.thead,tS.th=tS.td,g.option||(tS.optgroup=tS.option=[1,"<select multiple='multiple'>","</select>"]);var tA=/<|&#?\w+;/;function tP(i,r,n,o,a){for(var s,l,u,h,c,d=r.createDocumentFragment(),p=[],f=0,m=i.length;f<m;f++)if((s=i[f])||0===s){if("object"===w(s))S.merge(p,s.nodeType?[s]:s);else if(tA.test(s)){for(l=l||d.appendChild(r.createElement("div")),u=tS[(tT.exec(s)||["",""])[1].toLowerCase()]||tS._default,l.innerHTML=u[1]+S.htmlPrefilter(s)+u[2],c=u[0];c--;)l=l.lastChild;S.merge(p,l.childNodes),(l=d.firstChild).textContent=""}else p.push(r.createTextNode(s))}for(d.textContent="",f=0;s=p[f++];){if(o&&S.inArray(s,o)>-1){a&&a.push(s);continue}if(h=tg(s),l=tC(d.appendChild(s),"script"),h&&tI(l),n)for(c=0;s=l[c++];)tE.test(s.type||"")&&n.push(s)}return d}var tk=/^([^.]*)(?:\.(.+)|)/;function tL(){return!0}function tM(){return!1}function tz(i,r,n,o,a,s){var l,u;if("object"==typeof r){for(u in"string"!=typeof n&&(o=o||n,n=void 0),r)tz(i,u,n,o,r[u],s);return i}if(null==o&&null==a?(a=n,o=n=void 0):null==a&&("string"==typeof n?(a=o,o=void 0):(a=o,o=n,n=void 0)),!1===a)a=tM;else if(!a)return i;return 1===s&&(l=a,(a=function(i){return S().off(i),l.apply(this,arguments)}).guid=l.guid||(l.guid=S.guid++)),i.each(function(){S.event.add(this,r,a,o,n)})}function tD(i,r,n){if(!n){void 0===ts.get(i,r)&&S.event.add(i,r,tL);return}ts.set(i,r,!1),S.event.add(i,r,{namespace:!1,handler:function(i){var n,o=ts.get(this,r);if(1&i.isTrigger&&this[r]){if(o)(S.event.special[r]||{}).delegateType&&i.stopPropagation();else if(o=s.call(arguments),ts.set(this,r,o),this[r](),n=ts.get(this,r),ts.set(this,r,!1),o!==n)return i.stopImmediatePropagation(),i.preventDefault(),n}else o&&(ts.set(this,r,S.event.trigger(o[0],o.slice(1),this)),i.stopPropagation(),i.isImmediatePropagationStopped=tL)}})}S.event={global:{},add:function(i,r,n,o,a){var s,l,u,h,c,d,p,f,m,g,_,y=ts.get(i);if(to(i))for(n.handler&&(n=(s=n).handler,a=s.selector),a&&S.find.matchesSelector(tm,a),n.guid||(n.guid=S.guid++),(h=y.events)||(h=y.events=Object.create(null)),(l=y.handle)||(l=y.handle=function(r){return S.event.triggered!==r.type?S.event.dispatch.apply(i,arguments):void 0}),c=(r=(r||"").match(W)||[""]).length;c--;)m=_=(u=tk.exec(r[c])||[])[1],g=(u[2]||"").split(".").sort(),m&&(p=S.event.special[m]||{},m=(a?p.delegateType:p.bindType)||m,p=S.event.special[m]||{},d=S.extend({type:m,origType:_,data:o,handler:n,guid:n.guid,selector:a,needsContext:a&&S.expr.match.needsContext.test(a),namespace:g.join(".")},s),(f=h[m])||((f=h[m]=[]).delegateCount=0,(!p.setup||!1===p.setup.call(i,o,g,l))&&i.addEventListener&&i.addEventListener(m,l)),p.add&&(p.add.call(i,d),d.handler.guid||(d.handler.guid=n.guid)),a?f.splice(f.delegateCount++,0,d):f.push(d),S.event.global[m]=!0)},remove:function(i,r,n,o,a){var s,l,u,h,c,d,p,f,m,g,_,y=ts.hasData(i)&&ts.get(i);if(y&&(h=y.events)){for(c=(r=(r||"").match(W)||[""]).length;c--;){if(m=_=(u=tk.exec(r[c])||[])[1],g=(u[2]||"").split(".").sort(),!m){for(m in h)S.event.remove(i,m+r[c],n,o,!0);continue}for(p=S.event.special[m]||{},f=h[m=(o?p.delegateType:p.bindType)||m]||[],u=u[2]&&RegExp("(^|\\.)"+g.join("\\.(?:.*\\.|)")+"(\\.|$)"),l=s=f.length;s--;)d=f[s],(a||_===d.origType)&&(!n||n.guid===d.guid)&&(!u||u.test(d.namespace))&&(!o||o===d.selector||"**"===o&&d.selector)&&(f.splice(s,1),d.selector&&f.delegateCount--,p.remove&&p.remove.call(i,d));l&&!f.length&&(p.teardown&&!1!==p.teardown.call(i,g,y.handle)||S.removeEvent(i,m,y.handle),delete h[m])}S.isEmptyObject(h)&&ts.remove(i,"handle events")}},dispatch:function(i){var r,n,o,a,s,l,u=Array(arguments.length),h=S.event.fix(i),c=(ts.get(this,"events")||Object.create(null))[h.type]||[],d=S.event.special[h.type]||{};for(r=1,u[0]=h;r<arguments.length;r++)u[r]=arguments[r];if(h.delegateTarget=this,!d.preDispatch||!1!==d.preDispatch.call(this,h)){for(l=S.event.handlers.call(this,h,c),r=0;(a=l[r++])&&!h.isPropagationStopped();)for(h.currentTarget=a.elem,n=0;(s=a.handlers[n++])&&!h.isImmediatePropagationStopped();)(!h.rnamespace||!1===s.namespace||h.rnamespace.test(s.namespace))&&(h.handleObj=s,h.data=s.data,void 0!==(o=((S.event.special[s.origType]||{}).handle||s.handler).apply(a.elem,u))&&!1===(h.result=o)&&(h.preventDefault(),h.stopPropagation()));return d.postDispatch&&d.postDispatch.call(this,h),h.result}},handlers:function(i,r){var n,o,a,s,l,u=[],h=r.delegateCount,c=i.target;if(h&&c.nodeType&&!("click"===i.type&&i.button>=1)){for(;c!==this;c=c.parentNode||this)if(1===c.nodeType&&!("click"===i.type&&!0===c.disabled)){for(n=0,s=[],l={};n<h;n++)void 0===l[a=(o=r[n]).selector+" "]&&(l[a]=o.needsContext?S(a,this).index(c)>-1:S.find(a,this,null,[c]).length),l[a]&&s.push(o);s.length&&u.push({elem:c,handlers:s})}}return c=this,h<r.length&&u.push({elem:c,handlers:r.slice(h)}),u},addProp:function(i,r){Object.defineProperty(S.Event.prototype,i,{enumerable:!0,configurable:!0,get:_(r)?function(){if(this.originalEvent)return r(this.originalEvent)}:function(){if(this.originalEvent)return this.originalEvent[i]},set:function(r){Object.defineProperty(this,i,{enumerable:!0,configurable:!0,writable:!0,value:r})}})},fix:function(i){return i[S.expando]?i:new S.Event(i)},special:{load:{noBubble:!0},click:{setup:function(i){var r=this||i;return tw.test(r.type)&&r.click&&I(r,"input")&&tD(r,"click",!0),!1},trigger:function(i){var r=this||i;return tw.test(r.type)&&r.click&&I(r,"input")&&tD(r,"click"),!0},_default:function(i){var r=i.target;return tw.test(r.type)&&r.click&&I(r,"input")&&ts.get(r,"click")||I(r,"a")}},beforeunload:{postDispatch:function(i){void 0!==i.result&&i.originalEvent&&(i.originalEvent.returnValue=i.result)}}}},S.removeEvent=function(i,r,n){i.removeEventListener&&i.removeEventListener(r,n)},S.Event=function(i,r){if(!(this instanceof S.Event))return new S.Event(i,r);i&&i.type?(this.originalEvent=i,this.type=i.type,this.isDefaultPrevented=i.defaultPrevented||void 0===i.defaultPrevented&&!1===i.returnValue?tL:tM,this.target=i.target&&3===i.target.nodeType?i.target.parentNode:i.target,this.currentTarget=i.currentTarget,this.relatedTarget=i.relatedTarget):this.type=i,r&&S.extend(this,r),this.timeStamp=i&&i.timeStamp||Date.now(),this[S.expando]=!0},S.Event.prototype={constructor:S.Event,isDefaultPrevented:tM,isPropagationStopped:tM,isImmediatePropagationStopped:tM,isSimulated:!1,preventDefault:function(){var i=this.originalEvent;this.isDefaultPrevented=tL,i&&!this.isSimulated&&i.preventDefault()},stopPropagation:function(){var i=this.originalEvent;this.isPropagationStopped=tL,i&&!this.isSimulated&&i.stopPropagation()},stopImmediatePropagation:function(){var i=this.originalEvent;this.isImmediatePropagationStopped=tL,i&&!this.isSimulated&&i.stopImmediatePropagation(),this.stopPropagation()}},S.each({altKey:!0,bubbles:!0,cancelable:!0,changedTouches:!0,ctrlKey:!0,detail:!0,eventPhase:!0,metaKey:!0,pageX:!0,pageY:!0,shiftKey:!0,view:!0,char:!0,code:!0,charCode:!0,key:!0,keyCode:!0,button:!0,buttons:!0,clientX:!0,clientY:!0,offsetX:!0,offsetY:!0,pointerId:!0,pointerType:!0,screenX:!0,screenY:!0,targetTouches:!0,toElement:!0,touches:!0,which:!0},S.event.addProp),S.each({focus:"focusin",blur:"focusout"},function(i,r){function n(i){if(v.documentMode){var n=ts.get(this,"handle"),o=S.event.fix(i);o.type="focusin"===i.type?"focus":"blur",o.isSimulated=!0,n(i),o.target===o.currentTarget&&n(o)}else S.event.simulate(r,i.target,S.event.fix(i))}S.event.special[i]={setup:function(){var o;if(tD(this,i,!0),!v.documentMode)return!1;(o=ts.get(this,r))||this.addEventListener(r,n),ts.set(this,r,(o||0)+1)},trigger:function(){return tD(this,i),!0},teardown:function(){var i;if(!v.documentMode)return!1;(i=ts.get(this,r)-1)?ts.set(this,r,i):(this.removeEventListener(r,n),ts.remove(this,r))},_default:function(r){return ts.get(r.target,i)},delegateType:r},S.event.special[r]={setup:function(){var o=this.ownerDocument||this.document||this,a=v.documentMode?this:o,s=ts.get(a,r);s||(v.documentMode?this.addEventListener(r,n):o.addEventListener(i,n,!0)),ts.set(a,r,(s||0)+1)},teardown:function(){var o=this.ownerDocument||this.document||this,a=v.documentMode?this:o,s=ts.get(a,r)-1;s?ts.set(a,r,s):(v.documentMode?this.removeEventListener(r,n):o.removeEventListener(i,n,!0),ts.remove(a,r))}}}),S.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(i,r){S.event.special[i]={delegateType:r,bindType:r,handle:function(i){var n,o=i.relatedTarget,a=i.handleObj;return o&&(o===this||S.contains(this,o))||(i.type=a.origType,n=a.handler.apply(this,arguments),i.type=r),n}}}),S.fn.extend({on:function(i,r,n,o){return tz(this,i,r,n,o)},one:function(i,r,n,o){return tz(this,i,r,n,o,1)},off:function(i,r,n){var o,a;if(i&&i.preventDefault&&i.handleObj)return o=i.handleObj,S(i.delegateTarget).off(o.namespace?o.origType+"."+o.namespace:o.origType,o.selector,o.handler),this;if("object"==typeof i){for(a in i)this.off(a,r,i[a]);return this}return(!1===r||"function"==typeof r)&&(n=r,r=void 0),!1===n&&(n=tM),this.each(function(){S.event.remove(this,i,n,r)})}});var tR=/<script|<style|<link/i,tB=/checked\s*(?:[^=]|=\s*.checked.)/i,tO=/^\s*<!\[CDATA\[|\]\]>\s*$/g;function tF(i,r){return I(i,"table")&&I(11!==r.nodeType?r:r.firstChild,"tr")&&S(i).children("tbody")[0]||i}function tN(i){return i.type=(null!==i.getAttribute("type"))+"/"+i.type,i}function tU(i){return"true/"===(i.type||"").slice(0,5)?i.type=i.type.slice(5):i.removeAttribute("type"),i}function tj(i,r){var n,o,a,s,l,u;if(1===r.nodeType){if(ts.hasData(i)&&(u=ts.get(i).events))for(a in ts.remove(r,"handle events"),u)for(n=0,o=u[a].length;n<o;n++)S.event.add(r,a,u[a][n]);tl.hasData(i)&&(s=tl.access(i),l=S.extend({},s),tl.set(r,l))}}function tZ(i,r,n,o){r=l(r);var a,s,u,h,c,d,p=0,f=i.length,m=f-1,y=r[0],v=_(y);if(v||f>1&&"string"==typeof y&&!g.checkClone&&tB.test(y))return i.each(function(a){var s=i.eq(a);v&&(r[0]=y.call(this,a,s.html())),tZ(s,r,n,o)});if(f&&(s=(a=tP(r,i[0].ownerDocument,!1,i,o)).firstChild,1===a.childNodes.length&&(a=s),s||o)){for(h=(u=S.map(tC(a,"script"),tN)).length;p<f;p++)c=a,p!==m&&(c=S.clone(c,!0,!0),h&&S.merge(u,tC(c,"script"))),n.call(i[p],c,p);if(h)for(d=u[u.length-1].ownerDocument,S.map(u,tU),p=0;p<h;p++)c=u[p],tE.test(c.type||"")&&!ts.access(c,"globalEval")&&S.contains(d,c)&&(c.src&&"module"!==(c.type||"").toLowerCase()?S._evalUrl&&!c.noModule&&S._evalUrl(c.src,{nonce:c.nonce||c.getAttribute("nonce")},d):b(c.textContent.replace(tO,""),c,d))}return i}function tV(i,r,n){for(var o,a=r?S.filter(r,i):i,s=0;null!=(o=a[s]);s++)n||1!==o.nodeType||S.cleanData(tC(o)),o.parentNode&&(n&&tg(o)&&tI(tC(o,"script")),o.parentNode.removeChild(o));return i}S.extend({htmlPrefilter:function(i){return i},clone:function(i,r,n){var o,a,s,l,u=i.cloneNode(!0),h=tg(i);if(!g.noCloneChecked&&(1===i.nodeType||11===i.nodeType)&&!S.isXMLDoc(i))for(o=0,l=tC(u),a=(s=tC(i)).length;o<a;o++)!function(i,r){var n=r.nodeName.toLowerCase();"input"===n&&tw.test(i.type)?r.checked=i.checked:("input"===n||"textarea"===n)&&(r.defaultValue=i.defaultValue)}(s[o],l[o]);if(r){if(n)for(o=0,s=s||tC(i),l=l||tC(u),a=s.length;o<a;o++)tj(s[o],l[o]);else tj(i,u)}return(l=tC(u,"script")).length>0&&tI(l,!h&&tC(i,"script")),u},cleanData:function(i){for(var r,n,o,a=S.event.special,s=0;void 0!==(n=i[s]);s++)if(to(n)){if(r=n[ts.expando]){if(r.events)for(o in r.events)a[o]?S.event.remove(n,o):S.removeEvent(n,o,r.handle);n[ts.expando]=void 0}n[tl.expando]&&(n[tl.expando]=void 0)}}}),S.fn.extend({detach:function(i){return tV(this,i,!0)},remove:function(i){return tV(this,i)},text:function(i){return tt(this,function(i){return void 0===i?S.text(this):this.empty().each(function(){(1===this.nodeType||11===this.nodeType||9===this.nodeType)&&(this.textContent=i)})},null,i,arguments.length)},append:function(){return tZ(this,arguments,function(i){(1===this.nodeType||11===this.nodeType||9===this.nodeType)&&tF(this,i).appendChild(i)})},prepend:function(){return tZ(this,arguments,function(i){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var r=tF(this,i);r.insertBefore(i,r.firstChild)}})},before:function(){return tZ(this,arguments,function(i){this.parentNode&&this.parentNode.insertBefore(i,this)})},after:function(){return tZ(this,arguments,function(i){this.parentNode&&this.parentNode.insertBefore(i,this.nextSibling)})},empty:function(){for(var i,r=0;null!=(i=this[r]);r++)1===i.nodeType&&(S.cleanData(tC(i,!1)),i.textContent="");return this},clone:function(i,r){return i=null!=i&&i,r=null==r?i:r,this.map(function(){return S.clone(this,i,r)})},html:function(i){return tt(this,function(i){var r=this[0]||{},n=0,o=this.length;if(void 0===i&&1===r.nodeType)return r.innerHTML;if("string"==typeof i&&!tR.test(i)&&!tS[(tT.exec(i)||["",""])[1].toLowerCase()]){i=S.htmlPrefilter(i);try{for(;n<o;n++)r=this[n]||{},1===r.nodeType&&(S.cleanData(tC(r,!1)),r.innerHTML=i);r=0}catch(i){}}r&&this.empty().append(i)},null,i,arguments.length)},replaceWith:function(){var i=[];return tZ(this,arguments,function(r){var n=this.parentNode;0>S.inArray(this,i)&&(S.cleanData(tC(this)),n&&n.replaceChild(r,this))},i)}}),S.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(i,r){S.fn[i]=function(i){for(var n,o=[],a=S(i),s=a.length-1,l=0;l<=s;l++)n=l===s?this:this.clone(!0),S(a[l])[r](n),u.apply(o,n.get());return this.pushStack(o)}});var tq=RegExp("^("+td+")(?!px)[a-z%]+$","i"),tG=/^--/,t$=function(r){var n=r.ownerDocument.defaultView;return n&&n.opener||(n=i),n.getComputedStyle(r)},tW=function(i,r,n){var o,a,s={};for(a in r)s[a]=i.style[a],i.style[a]=r[a];for(a in o=n.call(i),r)i.style[a]=s[a];return o},tH=RegExp(tf.join("|"),"i");function tX(i,r,n){var o,a,s,l,u=tG.test(r),h=i.style;return(n=n||t$(i))&&(l=n.getPropertyValue(r)||n[r],u&&l&&(l=l.replace(z,"$1")||void 0),""!==l||tg(i)||(l=S.style(i,r)),!g.pixelBoxStyles()&&tq.test(l)&&tH.test(r)&&(o=h.width,a=h.minWidth,s=h.maxWidth,h.minWidth=h.maxWidth=h.width=l,l=n.width,h.width=o,h.minWidth=a,h.maxWidth=s)),void 0!==l?l+"":l}function tK(i,r){return{get:function(){if(i()){delete this.get;return}return(this.get=r).apply(this,arguments)}}}!function(){function r(){if(d){c.style.cssText="position:absolute;left:-11111px;width:60px;margin-top:1px;padding:0;border:0",d.style.cssText="position:relative;display:block;box-sizing:border-box;overflow:scroll;margin:auto;border:1px;padding:1px;width:60%;top:1%",tm.appendChild(c).appendChild(d);var r=i.getComputedStyle(d);o="1%"!==r.top,h=12===n(r.marginLeft),d.style.right="60%",l=36===n(r.right),a=36===n(r.width),d.style.position="absolute",s=12===n(d.offsetWidth/3),tm.removeChild(c),d=null}}function n(i){return Math.round(parseFloat(i))}var o,a,s,l,u,h,c=v.createElement("div"),d=v.createElement("div");d.style&&(d.style.backgroundClip="content-box",d.cloneNode(!0).style.backgroundClip="",g.clearCloneStyle="content-box"===d.style.backgroundClip,S.extend(g,{boxSizingReliable:function(){return r(),a},pixelBoxStyles:function(){return r(),l},pixelPosition:function(){return r(),o},reliableMarginLeft:function(){return r(),h},scrollboxSize:function(){return r(),s},reliableTrDimensions:function(){var r,n,o,a;return null==u&&(r=v.createElement("table"),n=v.createElement("tr"),o=v.createElement("div"),r.style.cssText="position:absolute;left:-11111px;border-collapse:separate",n.style.cssText="border:1px solid",n.style.height="1px",o.style.height="9px",o.style.display="block",tm.appendChild(r).appendChild(n).appendChild(o),u=parseInt((a=i.getComputedStyle(n)).height,10)+parseInt(a.borderTopWidth,10)+parseInt(a.borderBottomWidth,10)===n.offsetHeight,tm.removeChild(r)),u}}))}();var tJ=["Webkit","Moz","ms"],tY=v.createElement("div").style,tQ={};function t0(i){return S.cssProps[i]||tQ[i]||(i in tY?i:tQ[i]=function(i){for(var r=i[0].toUpperCase()+i.slice(1),n=tJ.length;n--;)if((i=tJ[n]+r)in tY)return i}(i)||i)}var t1=/^(none|table(?!-c[ea]).+)/,t2={position:"absolute",visibility:"hidden",display:"block"},t3={letterSpacing:"0",fontWeight:"400"};function t5(i,r,n){var o=tp.exec(r);return o?Math.max(0,o[2]-(n||0))+(o[3]||"px"):r}function t4(i,r,n,o,a,s){var l="width"===r?1:0,u=0,h=0,c=0;if(n===(o?"border":"content"))return 0;for(;l<4;l+=2)"margin"===n&&(c+=S.css(i,n+tf[l],!0,a)),o?("content"===n&&(h-=S.css(i,"padding"+tf[l],!0,a)),"margin"!==n&&(h-=S.css(i,"border"+tf[l]+"Width",!0,a))):(h+=S.css(i,"padding"+tf[l],!0,a),"padding"!==n?h+=S.css(i,"border"+tf[l]+"Width",!0,a):u+=S.css(i,"border"+tf[l]+"Width",!0,a));return!o&&s>=0&&(h+=Math.max(0,Math.ceil(i["offset"+r[0].toUpperCase()+r.slice(1)]-s-h-u-.5))||0),h+c}function t6(i,r,n){var o=t$(i),a=(!g.boxSizingReliable()||n)&&"border-box"===S.css(i,"boxSizing",!1,o),s=a,l=tX(i,r,o),u="offset"+r[0].toUpperCase()+r.slice(1);if(tq.test(l)){if(!n)return l;l="auto"}return(!g.boxSizingReliable()&&a||!g.reliableTrDimensions()&&I(i,"tr")||"auto"===l||!parseFloat(l)&&"inline"===S.css(i,"display",!1,o))&&i.getClientRects().length&&(a="border-box"===S.css(i,"boxSizing",!1,o),(s=u in i)&&(l=i[u])),(l=parseFloat(l)||0)+t4(i,r,n||(a?"border":"content"),s,o,l)+"px"}function t8(i,r,n,o,a){return new t8.prototype.init(i,r,n,o,a)}S.extend({cssHooks:{opacity:{get:function(i,r){if(r){var n=tX(i,"opacity");return""===n?"1":n}}}},cssNumber:{animationIterationCount:!0,aspectRatio:!0,borderImageSlice:!0,columnCount:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,gridArea:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnStart:!0,gridRow:!0,gridRowEnd:!0,gridRowStart:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,scale:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeMiterlimit:!0,strokeOpacity:!0},cssProps:{},style:function(i,r,n,o){if(i&&3!==i.nodeType&&8!==i.nodeType&&i.style){var a,s,l,u=tn(r),h=tG.test(r),c=i.style;if(h||(r=t0(u)),l=S.cssHooks[r]||S.cssHooks[u],void 0===n)return l&&"get"in l&&void 0!==(a=l.get(i,!1,o))?a:c[r];"string"==(s=typeof n)&&(a=tp.exec(n))&&a[1]&&(n=tv(i,r,a),s="number"),null!=n&&n==n&&("number"!==s||h||(n+=a&&a[3]||(S.cssNumber[u]?"":"px")),g.clearCloneStyle||""!==n||0!==r.indexOf("background")||(c[r]="inherit"),l&&"set"in l&&void 0===(n=l.set(i,n,o))||(h?c.setProperty(r,n):c[r]=n))}},css:function(i,r,n,o){var a,s,l,u=tn(r);return(tG.test(r)||(r=t0(u)),(l=S.cssHooks[r]||S.cssHooks[u])&&"get"in l&&(a=l.get(i,!0,n)),void 0===a&&(a=tX(i,r,o)),"normal"===a&&r in t3&&(a=t3[r]),""===n||n)?(s=parseFloat(a),!0===n||isFinite(s)?s||0:a):a}}),S.each(["height","width"],function(i,r){S.cssHooks[r]={get:function(i,n,o){if(n)return!t1.test(S.css(i,"display"))||i.getClientRects().length&&i.getBoundingClientRect().width?t6(i,r,o):tW(i,t2,function(){return t6(i,r,o)})},set:function(i,n,o){var a,s=t$(i),l=!g.scrollboxSize()&&"absolute"===s.position,u=(l||o)&&"border-box"===S.css(i,"boxSizing",!1,s),h=o?t4(i,r,o,u,s):0;return u&&l&&(h-=Math.ceil(i["offset"+r[0].toUpperCase()+r.slice(1)]-parseFloat(s[r])-t4(i,r,"border",!1,s)-.5)),h&&(a=tp.exec(n))&&"px"!==(a[3]||"px")&&(i.style[r]=n,n=S.css(i,r)),t5(i,n,h)}}}),S.cssHooks.marginLeft=tK(g.reliableMarginLeft,function(i,r){if(r)return(parseFloat(tX(i,"marginLeft"))||i.getBoundingClientRect().left-tW(i,{marginLeft:0},function(){return i.getBoundingClientRect().left}))+"px"}),S.each({margin:"",padding:"",border:"Width"},function(i,r){S.cssHooks[i+r]={expand:function(n){for(var o=0,a={},s="string"==typeof n?n.split(" "):[n];o<4;o++)a[i+tf[o]+r]=s[o]||s[o-2]||s[0];return a}},"margin"!==i&&(S.cssHooks[i+r].set=t5)}),S.fn.extend({css:function(i,r){return tt(this,function(i,r,n){var o,a,s={},l=0;if(Array.isArray(r)){for(o=t$(i),a=r.length;l<a;l++)s[r[l]]=S.css(i,r[l],!1,o);return s}return void 0!==n?S.style(i,r,n):S.css(i,r)},i,r,arguments.length>1)}}),S.Tween=t8,t8.prototype={constructor:t8,init:function(i,r,n,o,a,s){this.elem=i,this.prop=n,this.easing=a||S.easing._default,this.options=r,this.start=this.now=this.cur(),this.end=o,this.unit=s||(S.cssNumber[n]?"":"px")},cur:function(){var i=t8.propHooks[this.prop];return i&&i.get?i.get(this):t8.propHooks._default.get(this)},run:function(i){var r,n=t8.propHooks[this.prop];return this.options.duration?this.pos=r=S.easing[this.easing](i,this.options.duration*i,0,1,this.options.duration):this.pos=r=i,this.now=(this.end-this.start)*r+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),n&&n.set?n.set(this):t8.propHooks._default.set(this),this}},t8.prototype.init.prototype=t8.prototype,t8.propHooks={_default:{get:function(i){var r;return 1!==i.elem.nodeType||null!=i.elem[i.prop]&&null==i.elem.style[i.prop]?i.elem[i.prop]:(r=S.css(i.elem,i.prop,""))&&"auto"!==r?r:0},set:function(i){S.fx.step[i.prop]?S.fx.step[i.prop](i):1===i.elem.nodeType&&(S.cssHooks[i.prop]||null!=i.elem.style[t0(i.prop)])?S.style(i.elem,i.prop,i.now+i.unit):i.elem[i.prop]=i.now}}},t8.propHooks.scrollTop=t8.propHooks.scrollLeft={set:function(i){i.elem.nodeType&&i.elem.parentNode&&(i.elem[i.prop]=i.now)}},S.easing={linear:function(i){return i},swing:function(i){return .5-Math.cos(i*Math.PI)/2},_default:"swing"},S.fx=t8.prototype.init,S.fx.step={};var t9,t7,et,ee,ei=/^(?:toggle|show|hide)$/,er=/queueHooks$/;function en(){return i.setTimeout(function(){et=void 0}),et=Date.now()}function eo(i,r){var n,o=0,a={height:i};for(r=r?1:0;o<4;o+=2-r)a["margin"+(n=tf[o])]=a["padding"+n]=i;return r&&(a.opacity=a.width=i),a}function ea(i,r,n){for(var o,a=(es.tweeners[r]||[]).concat(es.tweeners["*"]),s=0,l=a.length;s<l;s++)if(o=a[s].call(n,r,i))return o}function es(i,r,n){var o,a,s=0,l=es.prefilters.length,u=S.Deferred().always(function(){delete h.elem}),h=function(){if(a)return!1;for(var r=et||en(),n=Math.max(0,c.startTime+c.duration-r),o=1-(n/c.duration||0),s=0,l=c.tweens.length;s<l;s++)c.tweens[s].run(o);return(u.notifyWith(i,[c,o,n]),o<1&&l)?n:(l||u.notifyWith(i,[c,1,0]),u.resolveWith(i,[c]),!1)},c=u.promise({elem:i,props:S.extend({},r),opts:S.extend(!0,{specialEasing:{},easing:S.easing._default},n),originalProperties:r,originalOptions:n,startTime:et||en(),duration:n.duration,tweens:[],createTween:function(r,n){var o=S.Tween(i,c.opts,r,n,c.opts.specialEasing[r]||c.opts.easing);return c.tweens.push(o),o},stop:function(r){var n=0,o=r?c.tweens.length:0;if(a)return this;for(a=!0;n<o;n++)c.tweens[n].run(1);return r?(u.notifyWith(i,[c,1,0]),u.resolveWith(i,[c,r])):u.rejectWith(i,[c,r]),this}}),d=c.props;for(function(i,r){var n,o,a,s,l;for(n in i)if(a=r[o=tn(n)],Array.isArray(s=i[n])&&(a=s[1],s=i[n]=s[0]),n!==o&&(i[o]=s,delete i[n]),(l=S.cssHooks[o])&&("expand"in l))for(n in s=l.expand(s),delete i[o],s)(n in i)||(i[n]=s[n],r[n]=a);else r[o]=a}(d,c.opts.specialEasing);s<l;s++)if(o=es.prefilters[s].call(c,i,d,c.opts))return _(o.stop)&&(S._queueHooks(c.elem,c.opts.queue).stop=o.stop.bind(o)),o;return S.map(d,ea,c),_(c.opts.start)&&c.opts.start.call(i,c),c.progress(c.opts.progress).done(c.opts.done,c.opts.complete).fail(c.opts.fail).always(c.opts.always),S.fx.timer(S.extend(h,{elem:i,anim:c,queue:c.opts.queue})),c}S.Animation=S.extend(es,{tweeners:{"*":[function(i,r){var n=this.createTween(i,r);return tv(n.elem,i,tp.exec(r),n),n}]},tweener:function(i,r){_(i)?(r=i,i=["*"]):i=i.match(W);for(var n,o=0,a=i.length;o<a;o++)n=i[o],es.tweeners[n]=es.tweeners[n]||[],es.tweeners[n].unshift(r)},prefilters:[function(i,r,n){var o,a,s,l,u,h,c,d,p="width"in r||"height"in r,f=this,m={},g=i.style,_=i.nodeType&&ty(i),y=ts.get(i,"fxshow");for(o in n.queue||(null==(l=S._queueHooks(i,"fx")).unqueued&&(l.unqueued=0,u=l.empty.fire,l.empty.fire=function(){l.unqueued||u()}),l.unqueued++,f.always(function(){f.always(function(){l.unqueued--,S.queue(i,"fx").length||l.empty.fire()})})),r)if(a=r[o],ei.test(a)){if(delete r[o],s=s||"toggle"===a,a===(_?"hide":"show")){if("show"!==a||!y||void 0===y[o])continue;_=!0}m[o]=y&&y[o]||S.style(i,o)}if(!(!(h=!S.isEmptyObject(r))&&S.isEmptyObject(m)))for(o in p&&1===i.nodeType&&(n.overflow=[g.overflow,g.overflowX,g.overflowY],null==(c=y&&y.display)&&(c=ts.get(i,"display")),"none"===(d=S.css(i,"display"))&&(c?d=c:(tb([i],!0),c=i.style.display||c,d=S.css(i,"display"),tb([i]))),("inline"===d||"inline-block"===d&&null!=c)&&"none"===S.css(i,"float")&&(h||(f.done(function(){g.display=c}),null!=c||(c="none"===(d=g.display)?"":d)),g.display="inline-block")),n.overflow&&(g.overflow="hidden",f.always(function(){g.overflow=n.overflow[0],g.overflowX=n.overflow[1],g.overflowY=n.overflow[2]})),h=!1,m)h||(y?"hidden"in y&&(_=y.hidden):y=ts.access(i,"fxshow",{display:c}),s&&(y.hidden=!_),_&&tb([i],!0),f.done(function(){for(o in _||tb([i]),ts.remove(i,"fxshow"),m)S.style(i,o,m[o])})),h=ea(_?y[o]:0,o,f),o in y||(y[o]=h.start,_&&(h.end=h.start,h.start=0))}],prefilter:function(i,r){r?es.prefilters.unshift(i):es.prefilters.push(i)}}),S.speed=function(i,r,n){var o=i&&"object"==typeof i?S.extend({},i):{complete:n||!n&&r||_(i)&&i,duration:i,easing:n&&r||r&&!_(r)&&r};return S.fx.off?o.duration=0:"number"!=typeof o.duration&&(o.duration in S.fx.speeds?o.duration=S.fx.speeds[o.duration]:o.duration=S.fx.speeds._default),(null==o.queue||!0===o.queue)&&(o.queue="fx"),o.old=o.complete,o.complete=function(){_(o.old)&&o.old.call(this),o.queue&&S.dequeue(this,o.queue)},o},S.fn.extend({fadeTo:function(i,r,n,o){return this.filter(ty).css("opacity",0).show().end().animate({opacity:r},i,n,o)},animate:function(i,r,n,o){var a=S.isEmptyObject(i),s=S.speed(r,n,o),l=function(){var r=es(this,S.extend({},i),s);(a||ts.get(this,"finish"))&&r.stop(!0)};return l.finish=l,a||!1===s.queue?this.each(l):this.queue(s.queue,l)},stop:function(i,r,n){var o=function(i){var r=i.stop;delete i.stop,r(n)};return"string"!=typeof i&&(n=r,r=i,i=void 0),r&&this.queue(i||"fx",[]),this.each(function(){var r=!0,a=null!=i&&i+"queueHooks",s=S.timers,l=ts.get(this);if(a)l[a]&&l[a].stop&&o(l[a]);else for(a in l)l[a]&&l[a].stop&&er.test(a)&&o(l[a]);for(a=s.length;a--;)s[a].elem===this&&(null==i||s[a].queue===i)&&(s[a].anim.stop(n),r=!1,s.splice(a,1));(r||!n)&&S.dequeue(this,i)})},finish:function(i){return!1!==i&&(i=i||"fx"),this.each(function(){var r,n=ts.get(this),o=n[i+"queue"],a=n[i+"queueHooks"],s=S.timers,l=o?o.length:0;for(n.finish=!0,S.queue(this,i,[]),a&&a.stop&&a.stop.call(this,!0),r=s.length;r--;)s[r].elem===this&&s[r].queue===i&&(s[r].anim.stop(!0),s.splice(r,1));for(r=0;r<l;r++)o[r]&&o[r].finish&&o[r].finish.call(this);delete n.finish})}}),S.each(["toggle","show","hide"],function(i,r){var n=S.fn[r];S.fn[r]=function(i,o,a){return null==i||"boolean"==typeof i?n.apply(this,arguments):this.animate(eo(r,!0),i,o,a)}}),S.each({slideDown:eo("show"),slideUp:eo("hide"),slideToggle:eo("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(i,r){S.fn[i]=function(i,n,o){return this.animate(r,i,n,o)}}),S.timers=[],S.fx.tick=function(){var i,r=0,n=S.timers;for(et=Date.now();r<n.length;r++)(i=n[r])()||n[r]!==i||n.splice(r--,1);n.length||S.fx.stop(),et=void 0},S.fx.timer=function(i){S.timers.push(i),S.fx.start()},S.fx.interval=13,S.fx.start=function(){ee||(ee=!0,function r(){ee&&(!1===v.hidden&&i.requestAnimationFrame?i.requestAnimationFrame(r):i.setTimeout(r,S.fx.interval),S.fx.tick())}())},S.fx.stop=function(){ee=null},S.fx.speeds={slow:600,fast:200,_default:400},S.fn.delay=function(r,n){return r=S.fx&&S.fx.speeds[r]||r,n=n||"fx",this.queue(n,function(n,o){var a=i.setTimeout(n,r);o.stop=function(){i.clearTimeout(a)}})},el=v.createElement("input"),eu=v.createElement("select").appendChild(v.createElement("option")),el.type="checkbox",g.checkOn=""!==el.value,g.optSelected=eu.selected,(el=v.createElement("input")).value="t",el.type="radio",g.radioValue="t"===el.value;var el,eu,eh,ec=S.expr.attrHandle;S.fn.extend({attr:function(i,r){return tt(this,S.attr,i,r,arguments.length>1)},removeAttr:function(i){return this.each(function(){S.removeAttr(this,i)})}}),S.extend({attr:function(i,r,n){var o,a,s=i.nodeType;if(3!==s&&8!==s&&2!==s){if(void 0===i.getAttribute)return S.prop(i,r,n);if(1===s&&S.isXMLDoc(i)||(a=S.attrHooks[r.toLowerCase()]||(S.expr.match.bool.test(r)?eh:void 0)),void 0!==n){if(null===n){S.removeAttr(i,r);return}return a&&"set"in a&&void 0!==(o=a.set(i,n,r))?o:(i.setAttribute(r,n+""),n)}return a&&"get"in a&&null!==(o=a.get(i,r))?o:null==(o=S.find.attr(i,r))?void 0:o}},attrHooks:{type:{set:function(i,r){if(!g.radioValue&&"radio"===r&&I(i,"input")){var n=i.value;return i.setAttribute("type",r),n&&(i.value=n),r}}}},removeAttr:function(i,r){var n,o=0,a=r&&r.match(W);if(a&&1===i.nodeType)for(;n=a[o++];)i.removeAttribute(n)}}),eh={set:function(i,r,n){return!1===r?S.removeAttr(i,n):i.setAttribute(n,n),n}},S.each(S.expr.match.bool.source.match(/\w+/g),function(i,r){var n=ec[r]||S.find.attr;ec[r]=function(i,r,o){var a,s,l=r.toLowerCase();return o||(s=ec[l],ec[l]=a,a=null!=n(i,r,o)?l:null,ec[l]=s),a}});var ed=/^(?:input|select|textarea|button)$/i,ep=/^(?:a|area)$/i;function ef(i){return(i.match(W)||[]).join(" ")}function em(i){return i.getAttribute&&i.getAttribute("class")||""}function eg(i){return Array.isArray(i)?i:"string"==typeof i&&i.match(W)||[]}S.fn.extend({prop:function(i,r){return tt(this,S.prop,i,r,arguments.length>1)},removeProp:function(i){return this.each(function(){delete this[S.propFix[i]||i]})}}),S.extend({prop:function(i,r,n){var o,a,s=i.nodeType;if(3!==s&&8!==s&&2!==s)return(1===s&&S.isXMLDoc(i)||(r=S.propFix[r]||r,a=S.propHooks[r]),void 0!==n)?a&&"set"in a&&void 0!==(o=a.set(i,n,r))?o:i[r]=n:a&&"get"in a&&null!==(o=a.get(i,r))?o:i[r]},propHooks:{tabIndex:{get:function(i){var r=S.find.attr(i,"tabindex");return r?parseInt(r,10):ed.test(i.nodeName)||ep.test(i.nodeName)&&i.href?0:-1}}},propFix:{for:"htmlFor",class:"className"}}),g.optSelected||(S.propHooks.selected={get:function(i){var r=i.parentNode;return r&&r.parentNode&&r.parentNode.selectedIndex,null},set:function(i){var r=i.parentNode;r&&(r.selectedIndex,r.parentNode&&r.parentNode.selectedIndex)}}),S.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){S.propFix[this.toLowerCase()]=this}),S.fn.extend({addClass:function(i){var r,n,o,a,s,l;return _(i)?this.each(function(r){S(this).addClass(i.call(this,r,em(this)))}):(r=eg(i)).length?this.each(function(){if(o=em(this),n=1===this.nodeType&&" "+ef(o)+" "){for(s=0;s<r.length;s++)a=r[s],0>n.indexOf(" "+a+" ")&&(n+=a+" ");l=ef(n),o!==l&&this.setAttribute("class",l)}}):this},removeClass:function(i){var r,n,o,a,s,l;return _(i)?this.each(function(r){S(this).removeClass(i.call(this,r,em(this)))}):arguments.length?(r=eg(i)).length?this.each(function(){if(o=em(this),n=1===this.nodeType&&" "+ef(o)+" "){for(s=0;s<r.length;s++)for(a=r[s];n.indexOf(" "+a+" ")>-1;)n=n.replace(" "+a+" "," ");l=ef(n),o!==l&&this.setAttribute("class",l)}}):this:this.attr("class","")},toggleClass:function(i,r){var n,o,a,s,l=typeof i,u="string"===l||Array.isArray(i);return _(i)?this.each(function(n){S(this).toggleClass(i.call(this,n,em(this),r),r)}):"boolean"==typeof r&&u?r?this.addClass(i):this.removeClass(i):(n=eg(i),this.each(function(){if(u)for(a=0,s=S(this);a<n.length;a++)o=n[a],s.hasClass(o)?s.removeClass(o):s.addClass(o);else(void 0===i||"boolean"===l)&&((o=em(this))&&ts.set(this,"__className__",o),this.setAttribute&&this.setAttribute("class",o||!1===i?"":ts.get(this,"__className__")||""))}))},hasClass:function(i){var r,n,o=0;for(r=" "+i+" ";n=this[o++];)if(1===n.nodeType&&(" "+ef(em(n))+" ").indexOf(r)>-1)return!0;return!1}});var e_=/\r/g;S.fn.extend({val:function(i){var r,n,o,a=this[0];return arguments.length?(o=_(i),this.each(function(n){var a;1!==this.nodeType||(null==(a=o?i.call(this,n,S(this).val()):i)?a="":"number"==typeof a?a+="":Array.isArray(a)&&(a=S.map(a,function(i){return null==i?"":i+""})),(r=S.valHooks[this.type]||S.valHooks[this.nodeName.toLowerCase()])&&"set"in r&&void 0!==r.set(this,a,"value")||(this.value=a))})):a?(r=S.valHooks[a.type]||S.valHooks[a.nodeName.toLowerCase()])&&"get"in r&&void 0!==(n=r.get(a,"value"))?n:"string"==typeof(n=a.value)?n.replace(e_,""):null==n?"":n:void 0}}),S.extend({valHooks:{option:{get:function(i){var r=S.find.attr(i,"value");return null!=r?r:ef(S.text(i))}},select:{get:function(i){var r,n,o,a=i.options,s=i.selectedIndex,l="select-one"===i.type,u=l?null:[],h=l?s+1:a.length;for(o=s<0?h:l?s:0;o<h;o++)if(((n=a[o]).selected||o===s)&&!n.disabled&&(!n.parentNode.disabled||!I(n.parentNode,"optgroup"))){if(r=S(n).val(),l)return r;u.push(r)}return u},set:function(i,r){for(var n,o,a=i.options,s=S.makeArray(r),l=a.length;l--;)((o=a[l]).selected=S.inArray(S.valHooks.option.get(o),s)>-1)&&(n=!0);return n||(i.selectedIndex=-1),s}}}}),S.each(["radio","checkbox"],function(){S.valHooks[this]={set:function(i,r){if(Array.isArray(r))return i.checked=S.inArray(S(i).val(),r)>-1}},g.checkOn||(S.valHooks[this].get=function(i){return null===i.getAttribute("value")?"on":i.value})});var ey=i.location,ev={guid:Date.now()},ex=/\?/;S.parseXML=function(r){var n,o;if(!r||"string"!=typeof r)return null;try{n=new i.DOMParser().parseFromString(r,"text/xml")}catch(i){}return o=n&&n.getElementsByTagName("parsererror")[0],(!n||o)&&S.error("Invalid XML: "+(o?S.map(o.childNodes,function(i){return i.textContent}).join("\n"):r)),n};var eb=/^(?:focusinfocus|focusoutblur)$/,ew=function(i){i.stopPropagation()};S.extend(S.event,{trigger:function(r,n,o,a){var s,l,u,h,c,d,f,m,g=[o||v],x=p.call(r,"type")?r.type:r,b=p.call(r,"namespace")?r.namespace.split("."):[];if(l=m=u=o=o||v,!(3===o.nodeType||8===o.nodeType||eb.test(x+S.event.triggered))&&(x.indexOf(".")>-1&&(x=(b=x.split(".")).shift(),b.sort()),c=0>x.indexOf(":")&&"on"+x,(r=r[S.expando]?r:new S.Event(x,"object"==typeof r&&r)).isTrigger=a?2:3,r.namespace=b.join("."),r.rnamespace=r.namespace?RegExp("(^|\\.)"+b.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,r.result=void 0,r.target||(r.target=o),n=null==n?[r]:S.makeArray(n,[r]),f=S.event.special[x]||{},a||!f.trigger||!1!==f.trigger.apply(o,n))){if(!a&&!f.noBubble&&!y(o)){for(h=f.delegateType||x,eb.test(h+x)||(l=l.parentNode);l;l=l.parentNode)g.push(l),u=l;u===(o.ownerDocument||v)&&g.push(u.defaultView||u.parentWindow||i)}for(s=0;(l=g[s++])&&!r.isPropagationStopped();)m=l,r.type=s>1?h:f.bindType||x,(d=(ts.get(l,"events")||Object.create(null))[r.type]&&ts.get(l,"handle"))&&d.apply(l,n),(d=c&&l[c])&&d.apply&&to(l)&&(r.result=d.apply(l,n),!1===r.result&&r.preventDefault());return r.type=x,!a&&!r.isDefaultPrevented()&&(!f._default||!1===f._default.apply(g.pop(),n))&&to(o)&&c&&_(o[x])&&!y(o)&&((u=o[c])&&(o[c]=null),S.event.triggered=x,r.isPropagationStopped()&&m.addEventListener(x,ew),o[x](),r.isPropagationStopped()&&m.removeEventListener(x,ew),S.event.triggered=void 0,u&&(o[c]=u)),r.result}},simulate:function(i,r,n){var o=S.extend(new S.Event,n,{type:i,isSimulated:!0});S.event.trigger(o,null,r)}}),S.fn.extend({trigger:function(i,r){return this.each(function(){S.event.trigger(i,r,this)})},triggerHandler:function(i,r){var n=this[0];if(n)return S.event.trigger(i,r,n,!0)}});var eT=/\[\]$/,eE=/\r?\n/g,eS=/^(?:submit|button|image|reset|file)$/i,eC=/^(?:input|select|textarea|keygen)/i;S.param=function(i,r){var n,o=[],a=function(i,r){var n=_(r)?r():r;o[o.length]=encodeURIComponent(i)+"="+encodeURIComponent(null==n?"":n)};if(null==i)return"";if(Array.isArray(i)||i.jquery&&!S.isPlainObject(i))S.each(i,function(){a(this.name,this.value)});else for(n in i)!function i(r,n,o,a){var s;if(Array.isArray(n))S.each(n,function(n,s){o||eT.test(r)?a(r,s):i(r+"["+("object"==typeof s&&null!=s?n:"")+"]",s,o,a)});else if(o||"object"!==w(n))a(r,n);else for(s in n)i(r+"["+s+"]",n[s],o,a)}(n,i[n],r,a);return o.join("&")},S.fn.extend({serialize:function(){return S.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var i=S.prop(this,"elements");return i?S.makeArray(i):this}).filter(function(){var i=this.type;return this.name&&!S(this).is(":disabled")&&eC.test(this.nodeName)&&!eS.test(i)&&(this.checked||!tw.test(i))}).map(function(i,r){var n=S(this).val();return null==n?null:Array.isArray(n)?S.map(n,function(i){return{name:r.name,value:i.replace(eE,"\r\n")}}):{name:r.name,value:n.replace(eE,"\r\n")}}).get()}});var eI=/%20/g,eA=/#.*$/,eP=/([?&])_=[^&]*/,ek=/^(.*?):[ \t]*([^\r\n]*)$/mg,eL=/^(?:GET|HEAD)$/,eM=/^\/\//,ez={},eD={},eR="*/".concat("*"),eB=v.createElement("a");function eO(i){return function(r,n){"string"!=typeof r&&(n=r,r="*");var o,a=0,s=r.toLowerCase().match(W)||[];if(_(n))for(;o=s[a++];)"+"===o[0]?(i[o=o.slice(1)||"*"]=i[o]||[]).unshift(n):(i[o]=i[o]||[]).push(n)}}function eF(i,r,n,o){var a={},s=i===eD;function l(u){var h;return a[u]=!0,S.each(i[u]||[],function(i,u){var c=u(r,n,o);return"string"!=typeof c||s||a[c]?s?!(h=c):void 0:(r.dataTypes.unshift(c),l(c),!1)}),h}return l(r.dataTypes[0])||!a["*"]&&l("*")}function eN(i,r){var n,o,a=S.ajaxSettings.flatOptions||{};for(n in r)void 0!==r[n]&&((a[n]?i:o||(o={}))[n]=r[n]);return o&&S.extend(!0,i,o),i}eB.href=ey.href,S.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:ey.href,type:"GET",isLocal:/^(?:about|app|app-storage|.+-extension|file|res|widget):$/.test(ey.protocol),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":eR,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":JSON.parse,"text xml":S.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(i,r){return r?eN(eN(i,S.ajaxSettings),r):eN(S.ajaxSettings,i)},ajaxPrefilter:eO(ez),ajaxTransport:eO(eD),ajax:function(r,n){"object"==typeof r&&(n=r,r=void 0),n=n||{};var o,a,s,l,u,h,c,d,p,f,m=S.ajaxSetup({},n),g=m.context||m,_=m.context&&(g.nodeType||g.jquery)?S(g):S.event,y=S.Deferred(),x=S.Callbacks("once memory"),b=m.statusCode||{},w={},T={},E="canceled",C={readyState:0,getResponseHeader:function(i){var r;if(c){if(!l)for(l={};r=ek.exec(s);)l[r[1].toLowerCase()+" "]=(l[r[1].toLowerCase()+" "]||[]).concat(r[2]);r=l[i.toLowerCase()+" "]}return null==r?null:r.join(", ")},getAllResponseHeaders:function(){return c?s:null},setRequestHeader:function(i,r){return null==c&&(w[i=T[i.toLowerCase()]=T[i.toLowerCase()]||i]=r),this},overrideMimeType:function(i){return null==c&&(m.mimeType=i),this},statusCode:function(i){var r;if(i){if(c)C.always(i[C.status]);else for(r in i)b[r]=[b[r],i[r]]}return this},abort:function(i){var r=i||E;return o&&o.abort(r),I(0,r),this}};if(y.promise(C),m.url=((r||m.url||ey.href)+"").replace(eM,ey.protocol+"//"),m.type=n.method||n.type||m.method||m.type,m.dataTypes=(m.dataType||"*").toLowerCase().match(W)||[""],null==m.crossDomain){h=v.createElement("a");try{h.href=m.url,h.href=h.href,m.crossDomain=eB.protocol+"//"+eB.host!=h.protocol+"//"+h.host}catch(i){m.crossDomain=!0}}if(m.data&&m.processData&&"string"!=typeof m.data&&(m.data=S.param(m.data,m.traditional)),eF(ez,m,n,C),c)return C;for(p in(d=S.event&&m.global)&&0==S.active++&&S.event.trigger("ajaxStart"),m.type=m.type.toUpperCase(),m.hasContent=!eL.test(m.type),a=m.url.replace(eA,""),m.hasContent?m.data&&m.processData&&0===(m.contentType||"").indexOf("application/x-www-form-urlencoded")&&(m.data=m.data.replace(eI,"+")):(f=m.url.slice(a.length),m.data&&(m.processData||"string"==typeof m.data)&&(a+=(ex.test(a)?"&":"?")+m.data,delete m.data),!1===m.cache&&(a=a.replace(eP,"$1"),f=(ex.test(a)?"&":"?")+"_="+ev.guid+++f),m.url=a+f),m.ifModified&&(S.lastModified[a]&&C.setRequestHeader("If-Modified-Since",S.lastModified[a]),S.etag[a]&&C.setRequestHeader("If-None-Match",S.etag[a])),(m.data&&m.hasContent&&!1!==m.contentType||n.contentType)&&C.setRequestHeader("Content-Type",m.contentType),C.setRequestHeader("Accept",m.dataTypes[0]&&m.accepts[m.dataTypes[0]]?m.accepts[m.dataTypes[0]]+("*"!==m.dataTypes[0]?", "+eR+"; q=0.01":""):m.accepts["*"]),m.headers)C.setRequestHeader(p,m.headers[p]);if(m.beforeSend&&(!1===m.beforeSend.call(g,C,m)||c))return C.abort();if(E="abort",x.add(m.complete),C.done(m.success),C.fail(m.error),o=eF(eD,m,n,C)){if(C.readyState=1,d&&_.trigger("ajaxSend",[C,m]),c)return C;m.async&&m.timeout>0&&(u=i.setTimeout(function(){C.abort("timeout")},m.timeout));try{c=!1,o.send(w,I)}catch(i){if(c)throw i;I(-1,i)}}else I(-1,"No Transport");function I(r,n,l,h){var p,f,v,w,T,E=n;c||(c=!0,u&&i.clearTimeout(u),o=void 0,s=h||"",C.readyState=r>0?4:0,p=r>=200&&r<300||304===r,l&&(w=function(i,r,n){for(var o,a,s,l,u=i.contents,h=i.dataTypes;"*"===h[0];)h.shift(),void 0===o&&(o=i.mimeType||r.getResponseHeader("Content-Type"));if(o){for(a in u)if(u[a]&&u[a].test(o)){h.unshift(a);break}}if(h[0]in n)s=h[0];else{for(a in n){if(!h[0]||i.converters[a+" "+h[0]]){s=a;break}l||(l=a)}s=s||l}if(s)return s!==h[0]&&h.unshift(s),n[s]}(m,C,l)),!p&&S.inArray("script",m.dataTypes)>-1&&0>S.inArray("json",m.dataTypes)&&(m.converters["text script"]=function(){}),w=function(i,r,n,o){var a,s,l,u,h,c={},d=i.dataTypes.slice();if(d[1])for(l in i.converters)c[l.toLowerCase()]=i.converters[l];for(s=d.shift();s;)if(i.responseFields[s]&&(n[i.responseFields[s]]=r),!h&&o&&i.dataFilter&&(r=i.dataFilter(r,i.dataType)),h=s,s=d.shift()){if("*"===s)s=h;else if("*"!==h&&h!==s){if(!(l=c[h+" "+s]||c["* "+s])){for(a in c)if((u=a.split(" "))[1]===s&&(l=c[h+" "+u[0]]||c["* "+u[0]])){!0===l?l=c[a]:!0!==c[a]&&(s=u[0],d.unshift(u[1]));break}}if(!0!==l){if(l&&i.throws)r=l(r);else try{r=l(r)}catch(i){return{state:"parsererror",error:l?i:"No conversion from "+h+" to "+s}}}}}return{state:"success",data:r}}(m,w,C,p),p?(m.ifModified&&((T=C.getResponseHeader("Last-Modified"))&&(S.lastModified[a]=T),(T=C.getResponseHeader("etag"))&&(S.etag[a]=T)),204===r||"HEAD"===m.type?E="nocontent":304===r?E="notmodified":(E=w.state,f=w.data,p=!(v=w.error))):(v=E,(r||!E)&&(E="error",r<0&&(r=0))),C.status=r,C.statusText=(n||E)+"",p?y.resolveWith(g,[f,E,C]):y.rejectWith(g,[C,E,v]),C.statusCode(b),b=void 0,d&&_.trigger(p?"ajaxSuccess":"ajaxError",[C,m,p?f:v]),x.fireWith(g,[C,E]),!d||(_.trigger("ajaxComplete",[C,m]),--S.active||S.event.trigger("ajaxStop")))}return C},getJSON:function(i,r,n){return S.get(i,r,n,"json")},getScript:function(i,r){return S.get(i,void 0,r,"script")}}),S.each(["get","post"],function(i,r){S[r]=function(i,n,o,a){return _(n)&&(a=a||o,o=n,n=void 0),S.ajax(S.extend({url:i,type:r,dataType:a,data:n,success:o},S.isPlainObject(i)&&i))}}),S.ajaxPrefilter(function(i){var r;for(r in i.headers)"content-type"===r.toLowerCase()&&(i.contentType=i.headers[r]||"")}),S._evalUrl=function(i,r,n){return S.ajax({url:i,type:"GET",dataType:"script",cache:!0,async:!1,global:!1,converters:{"text script":function(){}},dataFilter:function(i){S.globalEval(i,r,n)}})},S.fn.extend({wrapAll:function(i){var r;return this[0]&&(_(i)&&(i=i.call(this[0])),r=S(i,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&r.insertBefore(this[0]),r.map(function(){for(var i=this;i.firstElementChild;)i=i.firstElementChild;return i}).append(this)),this},wrapInner:function(i){return _(i)?this.each(function(r){S(this).wrapInner(i.call(this,r))}):this.each(function(){var r=S(this),n=r.contents();n.length?n.wrapAll(i):r.append(i)})},wrap:function(i){var r=_(i);return this.each(function(n){S(this).wrapAll(r?i.call(this,n):i)})},unwrap:function(i){return this.parent(i).not("body").each(function(){S(this).replaceWith(this.childNodes)}),this}}),S.expr.pseudos.hidden=function(i){return!S.expr.pseudos.visible(i)},S.expr.pseudos.visible=function(i){return!!(i.offsetWidth||i.offsetHeight||i.getClientRects().length)},S.ajaxSettings.xhr=function(){try{return new i.XMLHttpRequest}catch(i){}};var eU={0:200,1223:204},ej=S.ajaxSettings.xhr();g.cors=!!ej&&"withCredentials"in ej,g.ajax=ej=!!ej,S.ajaxTransport(function(r){var n,o;if(g.cors||ej&&!r.crossDomain)return{send:function(a,s){var l,u=r.xhr();if(u.open(r.type,r.url,r.async,r.username,r.password),r.xhrFields)for(l in r.xhrFields)u[l]=r.xhrFields[l];for(l in r.mimeType&&u.overrideMimeType&&u.overrideMimeType(r.mimeType),r.crossDomain||a["X-Requested-With"]||(a["X-Requested-With"]="XMLHttpRequest"),a)u.setRequestHeader(l,a[l]);n=function(i){return function(){n&&(n=o=u.onload=u.onerror=u.onabort=u.ontimeout=u.onreadystatechange=null,"abort"===i?u.abort():"error"===i?"number"!=typeof u.status?s(0,"error"):s(u.status,u.statusText):s(eU[u.status]||u.status,u.statusText,"text"!==(u.responseType||"text")||"string"!=typeof u.responseText?{binary:u.response}:{text:u.responseText},u.getAllResponseHeaders()))}},u.onload=n(),o=u.onerror=u.ontimeout=n("error"),void 0!==u.onabort?u.onabort=o:u.onreadystatechange=function(){4===u.readyState&&i.setTimeout(function(){n&&o()})},n=n("abort");try{u.send(r.hasContent&&r.data||null)}catch(i){if(n)throw i}},abort:function(){n&&n()}}}),S.ajaxPrefilter(function(i){i.crossDomain&&(i.contents.script=!1)}),S.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(i){return S.globalEval(i),i}}}),S.ajaxPrefilter("script",function(i){void 0===i.cache&&(i.cache=!1),i.crossDomain&&(i.type="GET")}),S.ajaxTransport("script",function(i){if(i.crossDomain||i.scriptAttrs){var r,n;return{send:function(o,a){r=S("<script>").attr(i.scriptAttrs||{}).prop({charset:i.scriptCharset,src:i.url}).on("load error",n=function(i){r.remove(),n=null,i&&a("error"===i.type?404:200,i.type)}),v.head.appendChild(r[0])},abort:function(){n&&n()}}}});var eZ=[],eV=/(=)\?(?=&|$)|\?\?/;S.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var i=eZ.pop()||S.expando+"_"+ev.guid++;return this[i]=!0,i}}),S.ajaxPrefilter("json jsonp",function(r,n,o){var a,s,l,u=!1!==r.jsonp&&(eV.test(r.url)?"url":"string"==typeof r.data&&0===(r.contentType||"").indexOf("application/x-www-form-urlencoded")&&eV.test(r.data)&&"data");if(u||"jsonp"===r.dataTypes[0])return a=r.jsonpCallback=_(r.jsonpCallback)?r.jsonpCallback():r.jsonpCallback,u?r[u]=r[u].replace(eV,"$1"+a):!1!==r.jsonp&&(r.url+=(ex.test(r.url)?"&":"?")+r.jsonp+"="+a),r.converters["script json"]=function(){return l||S.error(a+" was not called"),l[0]},r.dataTypes[0]="json",s=i[a],i[a]=function(){l=arguments},o.always(function(){void 0===s?S(i).removeProp(a):i[a]=s,r[a]&&(r.jsonpCallback=n.jsonpCallback,eZ.push(a)),l&&_(s)&&s(l[0]),l=s=void 0}),"script"}),g.createHTMLDocument=((n=v.implementation.createHTMLDocument("").body).innerHTML="<form></form><form></form>",2===n.childNodes.length),S.parseHTML=function(i,r,n){var o,a,s;return"string"!=typeof i?[]:("boolean"==typeof r&&(n=r,r=!1),r||(g.createHTMLDocument?((o=(r=v.implementation.createHTMLDocument("")).createElement("base")).href=v.location.href,r.head.appendChild(o)):r=v),a=N.exec(i),s=!n&&[],a)?[r.createElement(a[1])]:(a=tP([i],r,s),s&&s.length&&S(s).remove(),S.merge([],a.childNodes))},S.fn.load=function(i,r,n){var o,a,s,l=this,u=i.indexOf(" ");return u>-1&&(o=ef(i.slice(u)),i=i.slice(0,u)),_(r)?(n=r,r=void 0):r&&"object"==typeof r&&(a="POST"),l.length>0&&S.ajax({url:i,type:a||"GET",dataType:"html",data:r}).done(function(i){s=arguments,l.html(o?S("<div>").append(S.parseHTML(i)).find(o):i)}).always(n&&function(i,r){l.each(function(){n.apply(this,s||[i.responseText,r,i])})}),this},S.expr.pseudos.animated=function(i){return S.grep(S.timers,function(r){return i===r.elem}).length},S.offset={setOffset:function(i,r,n){var o,a,s,l,u,h,c=S.css(i,"position"),d=S(i),p={};"static"===c&&(i.style.position="relative"),u=d.offset(),s=S.css(i,"top"),h=S.css(i,"left"),("absolute"===c||"fixed"===c)&&(s+h).indexOf("auto")>-1?(l=(o=d.position()).top,a=o.left):(l=parseFloat(s)||0,a=parseFloat(h)||0),_(r)&&(r=r.call(i,n,S.extend({},u))),null!=r.top&&(p.top=r.top-u.top+l),null!=r.left&&(p.left=r.left-u.left+a),"using"in r?r.using.call(i,p):d.css(p)}},S.fn.extend({offset:function(i){if(arguments.length)return void 0===i?this:this.each(function(r){S.offset.setOffset(this,i,r)});var r,n,o=this[0];if(o)return o.getClientRects().length?(r=o.getBoundingClientRect(),n=o.ownerDocument.defaultView,{top:r.top+n.pageYOffset,left:r.left+n.pageXOffset}):{top:0,left:0}},position:function(){if(this[0]){var i,r,n,o=this[0],a={top:0,left:0};if("fixed"===S.css(o,"position"))r=o.getBoundingClientRect();else{for(r=this.offset(),n=o.ownerDocument,i=o.offsetParent||n.documentElement;i&&(i===n.body||i===n.documentElement)&&"static"===S.css(i,"position");)i=i.parentNode;i&&i!==o&&1===i.nodeType&&(a=S(i).offset(),a.top+=S.css(i,"borderTopWidth",!0),a.left+=S.css(i,"borderLeftWidth",!0))}return{top:r.top-a.top-S.css(o,"marginTop",!0),left:r.left-a.left-S.css(o,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var i=this.offsetParent;i&&"static"===S.css(i,"position");)i=i.offsetParent;return i||tm})}}),S.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(i,r){var n="pageYOffset"===r;S.fn[i]=function(o){return tt(this,function(i,o,a){var s;if(y(i)?s=i:9===i.nodeType&&(s=i.defaultView),void 0===a)return s?s[r]:i[o];s?s.scrollTo(n?s.pageXOffset:a,n?a:s.pageYOffset):i[o]=a},i,o,arguments.length)}}),S.each(["top","left"],function(i,r){S.cssHooks[r]=tK(g.pixelPosition,function(i,n){if(n)return n=tX(i,r),tq.test(n)?S(i).position()[r]+"px":n})}),S.each({Height:"height",Width:"width"},function(i,r){S.each({padding:"inner"+i,content:r,"":"outer"+i},function(n,o){S.fn[o]=function(a,s){var l=arguments.length&&(n||"boolean"!=typeof a),u=n||(!0===a||!0===s?"margin":"border");return tt(this,function(r,n,a){var s;return y(r)?0===o.indexOf("outer")?r["inner"+i]:r.document.documentElement["client"+i]:9===r.nodeType?(s=r.documentElement,Math.max(r.body["scroll"+i],s["scroll"+i],r.body["offset"+i],s["offset"+i],s["client"+i])):void 0===a?S.css(r,n,u):S.style(r,n,a,u)},r,l?a:void 0,l)}})}),S.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(i,r){S.fn[r]=function(i){return this.on(r,i)}}),S.fn.extend({bind:function(i,r,n){return this.on(i,null,r,n)},unbind:function(i,r){return this.off(i,null,r)},delegate:function(i,r,n,o){return this.on(r,i,n,o)},undelegate:function(i,r,n){return 1==arguments.length?this.off(i,"**"):this.off(r,i||"**",n)},hover:function(i,r){return this.mouseenter(i).mouseleave(r||i)}}),S.each("blur focus focusin focusout resize scroll click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup contextmenu".split(" "),function(i,r){S.fn[r]=function(i,n){return arguments.length>0?this.on(r,null,i,n):this.trigger(r)}});var eq=/^[\s\uFEFF\xA0]+|([^\s\uFEFF\xA0])[\s\uFEFF\xA0]+$/g;S.proxy=function(i,r){var n,o,a;if("string"==typeof r&&(n=i[r],r=i,i=n),_(i))return o=s.call(arguments,2),(a=function(){return i.apply(r||this,o.concat(s.call(arguments)))}).guid=i.guid=i.guid||S.guid++,a},S.holdReady=function(i){i?S.readyWait++:S.ready(!0)},S.isArray=Array.isArray,S.parseJSON=JSON.parse,S.nodeName=I,S.isFunction=_,S.isWindow=y,S.camelCase=tn,S.type=w,S.now=Date.now,S.isNumeric=function(i){var r=S.type(i);return("number"===r||"string"===r)&&!isNaN(i-parseFloat(i))},S.trim=function(i){return null==i?"":(i+"").replace(eq,"$1")},"function"==typeof define&&define.amd&&define("jquery",[],function(){return S});var eG=i.jQuery,e$=i.$;return S.noConflict=function(r){return i.$===S&&(i.$=e$),r&&i.jQuery===S&&(i.jQuery=eG),S},void 0===r&&(i.jQuery=i.$=S),S},"object"==typeof i.exports?i.exports=n.document?o(n,!0):function(i){if(!i.document)throw Error("jQuery requires a window with a document");return o(i)}:o(n)}),l.register("gDcFo",function(i,r){Object.defineProperty(i.exports,"__esModule",{value:!0,configurable:!0}),o(i.exports,"default",function(){return tn});var a="undefined"!=typeof window&&"undefined"!=typeof document&&"undefined"!=typeof navigator,s=function(){for(var i=["Edge","Trident","Firefox"],r=0;r<i.length;r+=1)if(a&&navigator.userAgent.indexOf(i[r])>=0)return 1;return 0}(),l=a&&window.Promise?function(i){var r=!1;return function(){r||(r=!0,window.Promise.resolve().then(function(){r=!1,i()}))}}:function(i){var r=!1;return function(){r||(r=!0,setTimeout(function(){r=!1,i()},s))}};function u(i){return i&&"[object Function]"===({}).toString.call(i)}function h(i,r){if(1!==i.nodeType)return[];var n=i.ownerDocument.defaultView.getComputedStyle(i,null);return r?n[r]:n}function c(i){return"HTML"===i.nodeName?i:i.parentNode||i.host}function d(i){if(!i)return document.body;switch(i.nodeName){case"HTML":case"BODY":return i.ownerDocument.body;case"#document":return i.body}var r=h(i),n=r.overflow,o=r.overflowX,a=r.overflowY;return/(auto|scroll|overlay)/.test(n+a+o)?i:d(c(i))}function p(i){return i&&i.referenceNode?i.referenceNode:i}var f=a&&!!(window.MSInputMethodContext&&document.documentMode),m=a&&/MSIE 10/.test(navigator.userAgent);function g(i){return 11===i?f:10===i?m:f||m}function _(i){if(!i)return document.documentElement;for(var r=g(10)?document.body:null,n=i.offsetParent||null;n===r&&i.nextElementSibling;)n=(i=i.nextElementSibling).offsetParent;var o=n&&n.nodeName;return o&&"BODY"!==o&&"HTML"!==o?-1!==["TH","TD","TABLE"].indexOf(n.nodeName)&&"static"===h(n,"position")?_(n):n:i?i.ownerDocument.documentElement:document.documentElement}function y(i){return null!==i.parentNode?y(i.parentNode):i}function v(i,r){if(!i||!i.nodeType||!r||!r.nodeType)return document.documentElement;var n,o=i.compareDocumentPosition(r)&Node.DOCUMENT_POSITION_FOLLOWING,a=o?i:r,s=o?r:i,l=document.createRange();l.setStart(a,0),l.setEnd(s,0);var u=l.commonAncestorContainer;if(i!==u&&r!==u||a.contains(s))return"BODY"!==(n=u.nodeName)&&("HTML"===n||_(u.firstElementChild)===u)?u:_(u);var h=y(i);return h.host?v(h.host,r):v(i,y(r).host)}function x(i){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"top",n="top"===r?"scrollTop":"scrollLeft",o=i.nodeName;if("BODY"===o||"HTML"===o){var a=i.ownerDocument.documentElement;return(i.ownerDocument.scrollingElement||a)[n]}return i[n]}function b(i,r){var n="x"===r?"Left":"Top";return parseFloat(i["border"+n+"Width"])+parseFloat(i["border"+("Left"===n?"Right":"Bottom")+"Width"])}function w(i,r,n,o){return Math.max(r["offset"+i],r["scroll"+i],n["client"+i],n["offset"+i],n["scroll"+i],g(10)?parseInt(n["offset"+i])+parseInt(o["margin"+("Height"===i?"Top":"Left")])+parseInt(o["margin"+("Height"===i?"Bottom":"Right")]):0)}function T(i){var r=i.body,n=i.documentElement,o=g(10)&&getComputedStyle(n);return{height:w("Height",r,n,o),width:w("Width",r,n,o)}}var E=function(i,r){if(!(i instanceof r))throw TypeError("Cannot call a class as a function")},S=function(){function i(i,r){for(var n=0;n<r.length;n++){var o=r[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(i,o.key,o)}}return function(r,n,o){return n&&i(r.prototype,n),o&&i(r,o),r}}(),C=function(i,r,n){return r in i?Object.defineProperty(i,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):i[r]=n,i},I=Object.assign||function(i){for(var r=1;r<arguments.length;r++){var n=arguments[r];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(i[o]=n[o])}return i};function A(i){return I({},i,{right:i.left+i.width,bottom:i.top+i.height})}function P(i){var r={};try{if(g(10)){r=i.getBoundingClientRect();var n=x(i,"top"),o=x(i,"left");r.top+=n,r.left+=o,r.bottom+=n,r.right+=o}else r=i.getBoundingClientRect()}catch(i){}var a={left:r.left,top:r.top,width:r.right-r.left,height:r.bottom-r.top},s="HTML"===i.nodeName?T(i.ownerDocument):{},l=s.width||i.clientWidth||a.width,u=s.height||i.clientHeight||a.height,c=i.offsetWidth-l,d=i.offsetHeight-u;if(c||d){var p=h(i);c-=b(p,"x"),d-=b(p,"y"),a.width-=c,a.height-=d}return A(a)}function k(i,r){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=g(10),a="HTML"===r.nodeName,s=P(i),l=P(r),u=d(i),c=h(r),p=parseFloat(c.borderTopWidth),f=parseFloat(c.borderLeftWidth);n&&a&&(l.top=Math.max(l.top,0),l.left=Math.max(l.left,0));var m=A({top:s.top-l.top-p,left:s.left-l.left-f,width:s.width,height:s.height});if(m.marginTop=0,m.marginLeft=0,!o&&a){var _=parseFloat(c.marginTop),y=parseFloat(c.marginLeft);m.top-=p-_,m.bottom-=p-_,m.left-=f-y,m.right-=f-y,m.marginTop=_,m.marginLeft=y}return(o&&!n?r.contains(u):r===u&&"BODY"!==u.nodeName)&&(m=function(i,r){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=x(r,"top"),a=x(r,"left"),s=n?-1:1;return i.top+=o*s,i.bottom+=o*s,i.left+=a*s,i.right+=a*s,i}(m,r)),m}function M(i){if(!i||!i.parentElement||g())return document.documentElement;for(var r=i.parentElement;r&&"none"===h(r,"transform");)r=r.parentElement;return r||document.documentElement}function z(i,r,n,o){var a=arguments.length>4&&void 0!==arguments[4]&&arguments[4],s={top:0,left:0},l=a?M(i):v(i,p(r));if("viewport"===o)s=function(i){var r=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=i.ownerDocument.documentElement,o=k(i,n),a=Math.max(n.clientWidth,window.innerWidth||0),s=Math.max(n.clientHeight,window.innerHeight||0),l=r?0:x(n),u=r?0:x(n,"left");return A({top:l-o.top+o.marginTop,left:u-o.left+o.marginLeft,width:a,height:s})}(l,a);else{var u=void 0;"scrollParent"===o?"BODY"===(u=d(c(r))).nodeName&&(u=i.ownerDocument.documentElement):u="window"===o?i.ownerDocument.documentElement:o;var f=k(u,l,a);if("HTML"===u.nodeName&&!function i(r){var n=r.nodeName;if("BODY"===n||"HTML"===n)return!1;if("fixed"===h(r,"position"))return!0;var o=c(r);return!!o&&i(o)}(l)){var m=T(i.ownerDocument),g=m.height,_=m.width;s.top+=f.top-f.marginTop,s.bottom=g+f.top,s.left+=f.left-f.marginLeft,s.right=_+f.left}else s=f}var y="number"==typeof(n=n||0);return s.left+=y?n:n.left||0,s.top+=y?n:n.top||0,s.right-=y?n:n.right||0,s.bottom-=y?n:n.bottom||0,s}function D(i,r,n,o,a){var s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;if(-1===i.indexOf("auto"))return i;var l=z(n,o,s,a),u={top:{width:l.width,height:r.top-l.top},right:{width:l.right-r.right,height:l.height},bottom:{width:l.width,height:l.bottom-r.bottom},left:{width:r.left-l.left,height:l.height}},h=Object.keys(u).map(function(i){var r;return I({key:i},u[i],{area:(r=u[i]).width*r.height})}).sort(function(i,r){return r.area-i.area}),c=h.filter(function(i){var r=i.width,o=i.height;return r>=n.clientWidth&&o>=n.clientHeight}),d=c.length>0?c[0].key:h[0].key,p=i.split("-")[1];return d+(p?"-"+p:"")}function R(i,r,n){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,a=o?M(r):v(r,p(n));return k(n,a,o)}function B(i){var r=i.ownerDocument.defaultView.getComputedStyle(i),n=parseFloat(r.marginTop||0)+parseFloat(r.marginBottom||0),o=parseFloat(r.marginLeft||0)+parseFloat(r.marginRight||0);return{width:i.offsetWidth+o,height:i.offsetHeight+n}}function O(i){var r={left:"right",right:"left",bottom:"top",top:"bottom"};return i.replace(/left|right|bottom|top/g,function(i){return r[i]})}function F(i,r,n){n=n.split("-")[0];var o=B(i),a={width:o.width,height:o.height},s=-1!==["right","left"].indexOf(n),l=s?"top":"left",u=s?"left":"top",h=s?"height":"width";return a[l]=r[l]+r[h]/2-o[h]/2,n===u?a[u]=r[u]-o[s?"width":"height"]:a[u]=r[O(u)],a}function N(i,r){return Array.prototype.find?i.find(r):i.filter(r)[0]}function U(i,r,n){return(void 0===n?i:i.slice(0,function(i,r,n){if(Array.prototype.findIndex)return i.findIndex(function(i){return i[r]===n});var o=N(i,function(i){return i[r]===n});return i.indexOf(o)}(i,"name",n))).forEach(function(i){i.function&&console.warn("`modifier.function` is deprecated, use `modifier.fn`!");var n=i.function||i.fn;i.enabled&&u(n)&&(r.offsets.popper=A(r.offsets.popper),r.offsets.reference=A(r.offsets.reference),r=n(r,i))}),r}function j(){if(!this.state.isDestroyed){var i={instance:this,styles:{},arrowStyles:{},attributes:{},flipped:!1,offsets:{}};i.offsets.reference=R(this.state,this.popper,this.reference,this.options.positionFixed),i.placement=D(this.options.placement,i.offsets.reference,this.popper,this.reference,this.options.modifiers.flip.boundariesElement,this.options.modifiers.flip.padding),i.originalPlacement=i.placement,i.positionFixed=this.options.positionFixed,i.offsets.popper=F(this.popper,i.offsets.reference,i.placement),i.offsets.popper.position=this.options.positionFixed?"fixed":"absolute",i=U(this.modifiers,i),this.state.isCreated?this.options.onUpdate(i):(this.state.isCreated=!0,this.options.onCreate(i))}}function Z(i,r){return i.some(function(i){var n=i.name;return i.enabled&&n===r})}function V(i){for(var r=[!1,"ms","Webkit","Moz","O"],n=i.charAt(0).toUpperCase()+i.slice(1),o=0;o<r.length;o++){var a=r[o],s=a?""+a+n:i;if(void 0!==document.body.style[s])return s}return null}function q(){return this.state.isDestroyed=!0,Z(this.modifiers,"applyStyle")&&(this.popper.removeAttribute("x-placement"),this.popper.style.position="",this.popper.style.top="",this.popper.style.left="",this.popper.style.right="",this.popper.style.bottom="",this.popper.style.willChange="",this.popper.style[V("transform")]=""),this.disableEventListeners(),this.options.removeOnDestroy&&this.popper.parentNode.removeChild(this.popper),this}function G(i){var r=i.ownerDocument;return r?r.defaultView:window}function W(){if(!this.state.eventsEnabled){var i,r,n,o;this.state=(i=this.reference,this.options,r=this.state,n=this.scheduleUpdate,r.updateBound=n,G(i).addEventListener("resize",r.updateBound,{passive:!0}),function i(r,n,o,a){var s="BODY"===r.nodeName,l=s?r.ownerDocument.defaultView:r;l.addEventListener(n,o,{passive:!0}),s||i(d(l.parentNode),n,o,a),a.push(l)}(o=d(i),"scroll",r.updateBound,r.scrollParents),r.scrollElement=o,r.eventsEnabled=!0,r)}}function H(){if(this.state.eventsEnabled){var i,r;cancelAnimationFrame(this.scheduleUpdate),this.state=(i=this.reference,r=this.state,G(i).removeEventListener("resize",r.updateBound),r.scrollParents.forEach(function(i){i.removeEventListener("scroll",r.updateBound)}),r.updateBound=null,r.scrollParents=[],r.scrollElement=null,r.eventsEnabled=!1,r)}}function X(i){return""!==i&&!isNaN(parseFloat(i))&&isFinite(i)}function K(i,r){Object.keys(r).forEach(function(n){var o="";-1!==["width","height","top","right","bottom","left"].indexOf(n)&&X(r[n])&&(o="px"),i.style[n]=r[n]+o})}var J=a&&/Firefox/i.test(navigator.userAgent);function Y(i,r,n){var o=N(i,function(i){return i.name===r}),a=!!o&&i.some(function(i){return i.name===n&&i.enabled&&i.order<o.order});if(!a){var s="`"+r+"`";console.warn("`"+n+"` modifier is required by "+s+" modifier in order to work, be sure to include it before "+s+"!")}return a}var Q=["auto-start","auto","auto-end","top-start","top","top-end","right-start","right","right-end","bottom-end","bottom","bottom-start","left-end","left","left-start"],tt=Q.slice(3);function te(i){var r=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=tt.indexOf(i),o=tt.slice(n+1).concat(tt.slice(0,n));return r?o.reverse():o}var ti={FLIP:"flip",CLOCKWISE:"clockwise",COUNTERCLOCKWISE:"counterclockwise"},tr=function(){function i(r,n){var o=this,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};E(this,i),this.scheduleUpdate=function(){return requestAnimationFrame(o.update)},this.update=l(this.update.bind(this)),this.options=I({},i.Defaults,a),this.state={isDestroyed:!1,isCreated:!1,scrollParents:[]},this.reference=r&&r.jquery?r[0]:r,this.popper=n&&n.jquery?n[0]:n,this.options.modifiers={},Object.keys(I({},i.Defaults.modifiers,a.modifiers)).forEach(function(r){o.options.modifiers[r]=I({},i.Defaults.modifiers[r]||{},a.modifiers?a.modifiers[r]:{})}),this.modifiers=Object.keys(this.options.modifiers).map(function(i){return I({name:i},o.options.modifiers[i])}).sort(function(i,r){return i.order-r.order}),this.modifiers.forEach(function(i){i.enabled&&u(i.onLoad)&&i.onLoad(o.reference,o.popper,o.options,i,o.state)}),this.update();var s=this.options.eventsEnabled;s&&this.enableEventListeners(),this.state.eventsEnabled=s}return S(i,[{key:"update",value:function(){return j.call(this)}},{key:"destroy",value:function(){return q.call(this)}},{key:"enableEventListeners",value:function(){return W.call(this)}},{key:"disableEventListeners",value:function(){return H.call(this)}}]),i}();tr.Utils=("undefined"!=typeof window?window:n).PopperUtils,tr.placements=Q,tr.Defaults={placement:"bottom",positionFixed:!1,eventsEnabled:!0,removeOnDestroy:!1,onCreate:function(){},onUpdate:function(){},modifiers:{shift:{order:100,enabled:!0,fn:function(i){var r=i.placement,n=r.split("-")[0],o=r.split("-")[1];if(o){var a=i.offsets,s=a.reference,l=a.popper,u=-1!==["bottom","top"].indexOf(n),h=u?"left":"top",c=u?"width":"height",d={start:C({},h,s[h]),end:C({},h,s[h]+s[c]-l[c])};i.offsets.popper=I({},l,d[o])}return i}},offset:{order:200,enabled:!0,fn:function(i,r){var n,o,a,s,l,u,h=r.offset,c=i.placement,d=i.offsets,p=d.popper,f=d.reference,m=c.split("-")[0],g=void 0;return X(+h)?g=[+h,0]:(n=[0,0],o=-1!==["right","left"].indexOf(m),s=(a=h.split(/(\+|\-)/).map(function(i){return i.trim()})).indexOf(N(a,function(i){return -1!==i.search(/,|\s/)})),a[s]&&-1===a[s].indexOf(",")&&console.warn("Offsets separated by white space(s) are deprecated, use a comma (,) instead."),l=/\s*,\s*|\s+/,(-1!==s?[a.slice(0,s).concat([a[s].split(l)[0]]),[a[s].split(l)[1]].concat(a.slice(s+1))]:[a]).map(function(i,r){var n=(1===r?!o:o)?"height":"width",a=!1;return i.reduce(function(i,r){return""===i[i.length-1]&&-1!==["+","-"].indexOf(r)?(i[i.length-1]=r,a=!0,i):a?(i[i.length-1]+=r,a=!1,i):i.concat(r)},[]).map(function(i){return function(i,r,n,o){var a=i.match(/((?:\-|\+)?\d*\.?\d*)(.*)/),s=+a[1],l=a[2];if(!s)return i;if(0===l.indexOf("%")){var u=void 0;return A("%p"===l?n:o)[r]/100*s}return"vh"!==l&&"vw"!==l?s:("vh"===l?Math.max(document.documentElement.clientHeight,window.innerHeight||0):Math.max(document.documentElement.clientWidth,window.innerWidth||0))/100*s}(i,n,p,f)})}).forEach(function(i,r){i.forEach(function(o,a){X(o)&&(n[r]+=o*("-"===i[a-1]?-1:1))})}),g=n),"left"===m?(p.top+=g[0],p.left-=g[1]):"right"===m?(p.top+=g[0],p.left+=g[1]):"top"===m?(p.left+=g[0],p.top-=g[1]):"bottom"===m&&(p.left+=g[0],p.top+=g[1]),i.popper=p,i},offset:0},preventOverflow:{order:300,enabled:!0,fn:function(i,r){var n=r.boundariesElement||_(i.instance.popper);i.instance.reference===n&&(n=_(n));var o=V("transform"),a=i.instance.popper.style,s=a.top,l=a.left,u=a[o];a.top="",a.left="",a[o]="";var h=z(i.instance.popper,i.instance.reference,r.padding,n,i.positionFixed);a.top=s,a.left=l,a[o]=u,r.boundaries=h;var c=r.priority,d=i.offsets.popper,p={primary:function(i){var n=d[i];return d[i]<h[i]&&!r.escapeWithReference&&(n=Math.max(d[i],h[i])),C({},i,n)},secondary:function(i){var n="right"===i?"left":"top",o=d[n];return d[i]>h[i]&&!r.escapeWithReference&&(o=Math.min(d[n],h[i]-("right"===i?d.width:d.height))),C({},n,o)}};return c.forEach(function(i){d=I({},d,p[-1!==["left","top"].indexOf(i)?"primary":"secondary"](i))}),i.offsets.popper=d,i},priority:["left","right","top","bottom"],padding:5,boundariesElement:"scrollParent"},keepTogether:{order:400,enabled:!0,fn:function(i){var r=i.offsets,n=r.popper,o=r.reference,a=i.placement.split("-")[0],s=Math.floor,l=-1!==["top","bottom"].indexOf(a),u=l?"right":"bottom",h=l?"left":"top";return n[u]<s(o[h])&&(i.offsets.popper[h]=s(o[h])-n[l?"width":"height"]),n[h]>s(o[u])&&(i.offsets.popper[h]=s(o[u])),i}},arrow:{order:500,enabled:!0,fn:function(i,r){if(!Y(i.instance.modifiers,"arrow","keepTogether"))return i;var n,o=r.element;if("string"==typeof o){if(!(o=i.instance.popper.querySelector(o)))return i}else if(!i.instance.popper.contains(o))return console.warn("WARNING: `arrow.element` must be child of its popper element!"),i;var a=i.placement.split("-")[0],s=i.offsets,l=s.popper,u=s.reference,c=-1!==["left","right"].indexOf(a),d=c?"height":"width",p=c?"Top":"Left",f=p.toLowerCase(),m=c?"bottom":"right",g=B(o)[d];u[m]-g<l[f]&&(i.offsets.popper[f]-=l[f]-(u[m]-g)),u[f]+g>l[m]&&(i.offsets.popper[f]+=u[f]+g-l[m]),i.offsets.popper=A(i.offsets.popper);var _=u[f]+u[d]/2-g/2,y=h(i.instance.popper),v=parseFloat(y["margin"+p]),x=parseFloat(y["border"+p+"Width"]),b=_-i.offsets.popper[f]-v-x;return b=Math.max(Math.min(l[d]-g,b),0),i.arrowElement=o,i.offsets.arrow=(C(n={},f,Math.round(b)),C(n,c?"left":"top",""),n),i},element:"[x-arrow]"},flip:{order:600,enabled:!0,fn:function(i,r){if(Z(i.instance.modifiers,"inner")||i.flipped&&i.placement===i.originalPlacement)return i;var n=z(i.instance.popper,i.instance.reference,r.padding,r.boundariesElement,i.positionFixed),o=i.placement.split("-")[0],a=O(o),s=i.placement.split("-")[1]||"",l=[];switch(r.behavior){case ti.FLIP:l=[o,a];break;case ti.CLOCKWISE:l=te(o);break;case ti.COUNTERCLOCKWISE:l=te(o,!0);break;default:l=r.behavior}return l.forEach(function(u,h){if(o!==u||l.length===h+1)return i;a=O(o=i.placement.split("-")[0]);var c,d=i.offsets.popper,p=i.offsets.reference,f=Math.floor,m="left"===o&&f(d.right)>f(p.left)||"right"===o&&f(d.left)<f(p.right)||"top"===o&&f(d.bottom)>f(p.top)||"bottom"===o&&f(d.top)<f(p.bottom),g=f(d.left)<f(n.left),_=f(d.right)>f(n.right),y=f(d.top)<f(n.top),v=f(d.bottom)>f(n.bottom),x="left"===o&&g||"right"===o&&_||"top"===o&&y||"bottom"===o&&v,b=-1!==["top","bottom"].indexOf(o),w=!!r.flipVariations&&(b&&"start"===s&&g||b&&"end"===s&&_||!b&&"start"===s&&y||!b&&"end"===s&&v),T=!!r.flipVariationsByContent&&(b&&"start"===s&&_||b&&"end"===s&&g||!b&&"start"===s&&v||!b&&"end"===s&&y),E=w||T;(m||x||E)&&(i.flipped=!0,(m||x)&&(o=l[h+1]),E&&(s="end"===(c=s)?"start":"start"===c?"end":c),i.placement=o+(s?"-"+s:""),i.offsets.popper=I({},i.offsets.popper,F(i.instance.popper,i.offsets.reference,i.placement)),i=U(i.instance.modifiers,i,"flip"))}),i},behavior:"flip",padding:5,boundariesElement:"viewport",flipVariations:!1,flipVariationsByContent:!1},inner:{order:700,enabled:!1,fn:function(i){var r=i.placement,n=r.split("-")[0],o=i.offsets,a=o.popper,s=-1!==["left","right"].indexOf(n),l=-1===["top","left"].indexOf(n);return a[s?"left":"top"]=o.reference[n]-(l?a[s?"width":"height"]:0),i.placement=O(r),i.offsets.popper=A(a),i}},hide:{order:800,enabled:!0,fn:function(i){if(!Y(i.instance.modifiers,"hide","preventOverflow"))return i;var r=i.offsets.reference,n=N(i.instance.modifiers,function(i){return"preventOverflow"===i.name}).boundaries;if(r.bottom<n.top||r.left>n.right||r.top>n.bottom||r.right<n.left){if(!0===i.hide)return i;i.hide=!0,i.attributes["x-out-of-boundaries"]=""}else{if(!1===i.hide)return i;i.hide=!1,i.attributes["x-out-of-boundaries"]=!1}return i}},computeStyle:{order:850,enabled:!0,fn:function(i,r){var n,o,a,s,l,u,h,c,d,p,f,m,g,y=r.x,v=r.y,x=i.offsets.popper,b=N(i.instance.modifiers,function(i){return"applyStyle"===i.name}).gpuAcceleration;void 0!==b&&console.warn("WARNING: `gpuAcceleration` option moved to `computeStyle` modifier and will not be supported in future versions of Popper.js!");var w=void 0!==b?b:r.gpuAcceleration,T=_(i.instance.popper),E=P(T),S={position:x.position},C=(n=window.devicePixelRatio<2||!J,a=(o=i.offsets).popper,s=o.reference,l=Math.round,u=Math.floor,h=function(i){return i},c=l(s.width),d=l(a.width),p=-1!==["left","right"].indexOf(i.placement),f=-1!==i.placement.indexOf("-"),m=n?p||f||c%2==d%2?l:u:h,g=n?l:h,{left:m(c%2==1&&d%2==1&&!f&&n?a.left-1:a.left),top:g(a.top),bottom:g(a.bottom),right:m(a.right)}),A="bottom"===y?"top":"bottom",k="right"===v?"left":"right",M=V("transform"),z=void 0,D=void 0;D="bottom"===A?"HTML"===T.nodeName?-T.clientHeight+C.bottom:-E.height+C.bottom:C.top,z="right"===k?"HTML"===T.nodeName?-T.clientWidth+C.right:-E.width+C.right:C.left,w&&M?(S[M]="translate3d("+z+"px, "+D+"px, 0)",S[A]=0,S[k]=0,S.willChange="transform"):(S[A]=D*("bottom"===A?-1:1),S[k]=z*("right"===k?-1:1),S.willChange=A+", "+k);var R={"x-placement":i.placement};return i.attributes=I({},R,i.attributes),i.styles=I({},S,i.styles),i.arrowStyles=I({},i.offsets.arrow,i.arrowStyles),i},gpuAcceleration:!0,x:"bottom",y:"right"},applyStyle:{order:900,enabled:!0,fn:function(i){return K(i.instance.popper,i.styles),function(i,r){Object.keys(r).forEach(function(n){!1!==r[n]?i.setAttribute(n,r[n]):i.removeAttribute(n)})}(i.instance.popper,i.attributes),i.arrowElement&&Object.keys(i.arrowStyles).length&&K(i.arrowElement,i.arrowStyles),i},onLoad:function(i,r,n,o,a){var s=R(a,r,i,n.positionFixed),l=D(n.placement,s,r,i,n.modifiers.flip.boundariesElement,n.modifiers.flip.padding);return r.setAttribute("x-placement",l),K(r,{position:n.positionFixed?"fixed":"absolute"}),n},gpuAcceleration:void 0}}};var tn=tr}),l.register("iLKzi",function(i,r){i.exports,function(i){"use strict";function r(i){var r,n,o,a;for(n=1,o=arguments.length;n<o;n++)for(r in a=arguments[n])i[r]=a[r];return i}var n,o,a,s,l,u,h,c,d,p,f=Object.create||function(){function i(){}return function(r){return i.prototype=r,new i}}();function m(i,r){var n=Array.prototype.slice;if(i.bind)return i.bind.apply(i,n.call(arguments,1));var o=n.call(arguments,2);return function(){return i.apply(r,o.length?o.concat(n.call(arguments)):arguments)}}var g=0;function _(i){return"_leaflet_id"in i||(i._leaflet_id=++g),i._leaflet_id}function y(i,r,n){var o,a,s,l;return l=function(){o=!1,a&&(s.apply(n,a),a=!1)},s=function(){o?a=arguments:(i.apply(n,arguments),setTimeout(l,r),o=!0)}}function v(i,r,n){var o=r[1],a=r[0],s=o-a;return i===o&&n?i:((i-a)%s+s)%s+a}function x(){return!1}function b(i,r){if(!1===r)return i;var n=Math.pow(10,void 0===r?6:r);return Math.round(i*n)/n}function w(i){return i.trim?i.trim():i.replace(/^\s+|\s+$/g,"")}function T(i){return w(i).split(/\s+/)}function E(i,r){for(var n in Object.prototype.hasOwnProperty.call(i,"options")||(i.options=i.options?f(i.options):{}),r)i.options[n]=r[n];return i.options}function S(i,r,n){var o=[];for(var a in i)o.push(encodeURIComponent(n?a.toUpperCase():a)+"="+encodeURIComponent(i[a]));return(r&&-1!==r.indexOf("?")?"&":"?")+o.join("&")}var C=/\{ *([\w_ -]+) *\}/g;function I(i,r){return i.replace(C,function(i,n){var o=r[n];if(void 0===o)throw Error("No value provided for variable "+i);return"function"==typeof o&&(o=o(r)),o})}var A=Array.isArray||function(i){return"[object Array]"===Object.prototype.toString.call(i)};function P(i,r){for(var n=0;n<i.length;n++)if(i[n]===r)return n;return -1}var k="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";function M(i){return window["webkit"+i]||window["moz"+i]||window["ms"+i]}var z=0;function D(i){var r=+new Date,n=Math.max(0,16-(r-z));return z=r+n,window.setTimeout(i,n)}var R=window.requestAnimationFrame||M("RequestAnimationFrame")||D,B=window.cancelAnimationFrame||M("CancelAnimationFrame")||M("CancelRequestAnimationFrame")||function(i){window.clearTimeout(i)};function O(i,r,n){if(!n||R!==D)return R.call(window,m(i,r));i.call(r)}function F(i){i&&B.call(window,i)}function N(){}N.extend=function(i){var n=function(){E(this),this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},o=n.__super__=this.prototype,a=f(o);for(var s in a.constructor=n,n.prototype=a,this)Object.prototype.hasOwnProperty.call(this,s)&&"prototype"!==s&&"__super__"!==s&&(n[s]=this[s]);return i.statics&&r(n,i.statics),i.includes&&(function(i){if("undefined"!=typeof L&&L&&L.Mixin){i=A(i)?i:[i];for(var r=0;r<i.length;r++)i[r]===L.Mixin.Events&&console.warn("Deprecated include of L.Mixin.Events: this property will be removed in future releases, please inherit from L.Evented instead.",Error().stack)}}(i.includes),r.apply(null,[a].concat(i.includes))),r(a,i),delete a.statics,delete a.includes,a.options&&(a.options=o.options?f(o.options):{},r(a.options,i.options)),a._initHooks=[],a.callInitHooks=function(){if(!this._initHooksCalled){o.callInitHooks&&o.callInitHooks.call(this),this._initHooksCalled=!0;for(var i=0,r=a._initHooks.length;i<r;i++)a._initHooks[i].call(this)}},n},N.include=function(i){var n=this.prototype.options;return r(this.prototype,i),i.options&&(this.prototype.options=n,this.mergeOptions(i.options)),this},N.mergeOptions=function(i){return r(this.prototype.options,i),this},N.addInitHook=function(i){var r=Array.prototype.slice.call(arguments,1),n="function"==typeof i?i:function(){this[i].apply(this,r)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(n),this};var U={on:function(i,r,n){if("object"==typeof i)for(var o in i)this._on(o,i[o],r);else{i=T(i);for(var a=0,s=i.length;a<s;a++)this._on(i[a],r,n)}return this},off:function(i,r,n){if(arguments.length){if("object"==typeof i)for(var o in i)this._off(o,i[o],r);else{i=T(i);for(var a=1==arguments.length,s=0,l=i.length;s<l;s++)a?this._off(i[s]):this._off(i[s],r,n)}}else delete this._events;return this},_on:function(i,r,n,o){if("function"!=typeof r){console.warn("wrong listener type: "+typeof r);return}if(!1===this._listens(i,r,n)){n===this&&(n=void 0);var a={fn:r,ctx:n};o&&(a.once=!0),this._events=this._events||{},this._events[i]=this._events[i]||[],this._events[i].push(a)}},_off:function(i,r,n){if(this._events&&(o=this._events[i])){if(1==arguments.length){if(this._firingCount)for(a=0,s=o.length;a<s;a++)o[a].fn=x;delete this._events[i];return}if("function"!=typeof r){console.warn("wrong listener type: "+typeof r);return}var o,a,s,l=this._listens(i,r,n);if(!1!==l){var u=o[l];this._firingCount&&(u.fn=x,this._events[i]=o=o.slice()),o.splice(l,1)}}},fire:function(i,n,o){if(!this.listens(i,o))return this;var a=r({},n,{type:i,target:this,sourceTarget:n&&n.sourceTarget||this});if(this._events){var s=this._events[i];if(s){this._firingCount=this._firingCount+1||1;for(var l=0,u=s.length;l<u;l++){var h=s[l],c=h.fn;h.once&&this.off(i,c,h.ctx),c.call(h.ctx||this,a)}this._firingCount--}}return o&&this._propagateEvent(a),this},listens:function(i,r,n,o){"string"!=typeof i&&console.warn('"string" type argument expected');var a=r;"function"!=typeof r&&(o=!!r,a=void 0,n=void 0);var s=this._events&&this._events[i];if(s&&s.length&&!1!==this._listens(i,a,n))return!0;if(o){for(var l in this._eventParents)if(this._eventParents[l].listens(i,r,n,o))return!0}return!1},_listens:function(i,r,n){if(!this._events)return!1;var o=this._events[i]||[];if(!r)return!!o.length;n===this&&(n=void 0);for(var a=0,s=o.length;a<s;a++)if(o[a].fn===r&&o[a].ctx===n)return a;return!1},once:function(i,r,n){if("object"==typeof i)for(var o in i)this._on(o,i[o],r,!0);else{i=T(i);for(var a=0,s=i.length;a<s;a++)this._on(i[a],r,n,!0)}return this},addEventParent:function(i){return this._eventParents=this._eventParents||{},this._eventParents[_(i)]=i,this},removeEventParent:function(i){return this._eventParents&&delete this._eventParents[_(i)],this},_propagateEvent:function(i){for(var n in this._eventParents)this._eventParents[n].fire(i.type,r({layer:i.target,propagatedFrom:i.target},i),!0)}};U.addEventListener=U.on,U.removeEventListener=U.clearAllEventListeners=U.off,U.addOneTimeEventListener=U.once,U.fireEvent=U.fire,U.hasEventListeners=U.listens;var j=N.extend(U);function Z(i,r,n){this.x=n?Math.round(i):i,this.y=n?Math.round(r):r}var V=Math.trunc||function(i){return i>0?Math.floor(i):Math.ceil(i)};function q(i,r,n){return i instanceof Z?i:A(i)?new Z(i[0],i[1]):null==i?i:"object"==typeof i&&"x"in i&&"y"in i?new Z(i.x,i.y):new Z(i,r,n)}function G(i,r){if(i)for(var n=r?[i,r]:i,o=0,a=n.length;o<a;o++)this.extend(n[o])}function W(i,r){return!i||i instanceof G?i:new G(i,r)}function H(i,r){if(i)for(var n=r?[i,r]:i,o=0,a=n.length;o<a;o++)this.extend(n[o])}function X(i,r){return i instanceof H?i:new H(i,r)}function K(i,r,n){if(isNaN(i)||isNaN(r))throw Error("Invalid LatLng object: ("+i+", "+r+")");this.lat=+i,this.lng=+r,void 0!==n&&(this.alt=+n)}function J(i,r,n){return i instanceof K?i:A(i)&&"object"!=typeof i[0]?3===i.length?new K(i[0],i[1],i[2]):2===i.length?new K(i[0],i[1]):null:null==i?i:"object"==typeof i&&"lat"in i?new K(i.lat,"lng"in i?i.lng:i.lon,i.alt):void 0===r?null:new K(i,r,n)}Z.prototype={clone:function(){return new Z(this.x,this.y)},add:function(i){return this.clone()._add(q(i))},_add:function(i){return this.x+=i.x,this.y+=i.y,this},subtract:function(i){return this.clone()._subtract(q(i))},_subtract:function(i){return this.x-=i.x,this.y-=i.y,this},divideBy:function(i){return this.clone()._divideBy(i)},_divideBy:function(i){return this.x/=i,this.y/=i,this},multiplyBy:function(i){return this.clone()._multiplyBy(i)},_multiplyBy:function(i){return this.x*=i,this.y*=i,this},scaleBy:function(i){return new Z(this.x*i.x,this.y*i.y)},unscaleBy:function(i){return new Z(this.x/i.x,this.y/i.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},trunc:function(){return this.clone()._trunc()},_trunc:function(){return this.x=V(this.x),this.y=V(this.y),this},distanceTo:function(i){var r=(i=q(i)).x-this.x,n=i.y-this.y;return Math.sqrt(r*r+n*n)},equals:function(i){return(i=q(i)).x===this.x&&i.y===this.y},contains:function(i){return Math.abs((i=q(i)).x)<=Math.abs(this.x)&&Math.abs(i.y)<=Math.abs(this.y)},toString:function(){return"Point("+b(this.x)+", "+b(this.y)+")"}},G.prototype={extend:function(i){var r,n;if(!i)return this;if(i instanceof Z||"number"==typeof i[0]||"x"in i)r=n=q(i);else if(r=(i=W(i)).min,n=i.max,!r||!n)return this;return this.min||this.max?(this.min.x=Math.min(r.x,this.min.x),this.max.x=Math.max(n.x,this.max.x),this.min.y=Math.min(r.y,this.min.y),this.max.y=Math.max(n.y,this.max.y)):(this.min=r.clone(),this.max=n.clone()),this},getCenter:function(i){return q((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,i)},getBottomLeft:function(){return q(this.min.x,this.max.y)},getTopRight:function(){return q(this.max.x,this.min.y)},getTopLeft:function(){return this.min},getBottomRight:function(){return this.max},getSize:function(){return this.max.subtract(this.min)},contains:function(i){var r,n;return(i="number"==typeof i[0]||i instanceof Z?q(i):W(i))instanceof G?(r=i.min,n=i.max):r=n=i,r.x>=this.min.x&&n.x<=this.max.x&&r.y>=this.min.y&&n.y<=this.max.y},intersects:function(i){i=W(i);var r=this.min,n=this.max,o=i.min,a=i.max,s=a.x>=r.x&&o.x<=n.x,l=a.y>=r.y&&o.y<=n.y;return s&&l},overlaps:function(i){i=W(i);var r=this.min,n=this.max,o=i.min,a=i.max,s=a.x>r.x&&o.x<n.x,l=a.y>r.y&&o.y<n.y;return s&&l},isValid:function(){return!!(this.min&&this.max)},pad:function(i){var r=this.min,n=this.max,o=Math.abs(r.x-n.x)*i,a=Math.abs(r.y-n.y)*i;return W(q(r.x-o,r.y-a),q(n.x+o,n.y+a))},equals:function(i){return!!i&&(i=W(i),this.min.equals(i.getTopLeft())&&this.max.equals(i.getBottomRight()))}},H.prototype={extend:function(i){var r,n,o=this._southWest,a=this._northEast;if(i instanceof K)r=i,n=i;else if(!(i instanceof H))return i?this.extend(J(i)||X(i)):this;else if(r=i._southWest,n=i._northEast,!r||!n)return this;return o||a?(o.lat=Math.min(r.lat,o.lat),o.lng=Math.min(r.lng,o.lng),a.lat=Math.max(n.lat,a.lat),a.lng=Math.max(n.lng,a.lng)):(this._southWest=new K(r.lat,r.lng),this._northEast=new K(n.lat,n.lng)),this},pad:function(i){var r=this._southWest,n=this._northEast,o=Math.abs(r.lat-n.lat)*i,a=Math.abs(r.lng-n.lng)*i;return new H(new K(r.lat-o,r.lng-a),new K(n.lat+o,n.lng+a))},getCenter:function(){return new K((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new K(this.getNorth(),this.getWest())},getSouthEast:function(){return new K(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(i){i="number"==typeof i[0]||i instanceof K||"lat"in i?J(i):X(i);var r,n,o=this._southWest,a=this._northEast;return i instanceof H?(r=i.getSouthWest(),n=i.getNorthEast()):r=n=i,r.lat>=o.lat&&n.lat<=a.lat&&r.lng>=o.lng&&n.lng<=a.lng},intersects:function(i){i=X(i);var r=this._southWest,n=this._northEast,o=i.getSouthWest(),a=i.getNorthEast(),s=a.lat>=r.lat&&o.lat<=n.lat,l=a.lng>=r.lng&&o.lng<=n.lng;return s&&l},overlaps:function(i){i=X(i);var r=this._southWest,n=this._northEast,o=i.getSouthWest(),a=i.getNorthEast(),s=a.lat>r.lat&&o.lat<n.lat,l=a.lng>r.lng&&o.lng<n.lng;return s&&l},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(i,r){return!!i&&(i=X(i),this._southWest.equals(i.getSouthWest(),r)&&this._northEast.equals(i.getNorthEast(),r))},isValid:function(){return!!(this._southWest&&this._northEast)}},K.prototype={equals:function(i,r){return!!i&&(i=J(i),Math.max(Math.abs(this.lat-i.lat),Math.abs(this.lng-i.lng))<=(void 0===r?1e-9:r))},toString:function(i){return"LatLng("+b(this.lat,i)+", "+b(this.lng,i)+")"},distanceTo:function(i){return Q.distance(this,J(i))},wrap:function(){return Q.wrapLatLng(this)},toBounds:function(i){var r=180*i/40075017,n=r/Math.cos(Math.PI/180*this.lat);return X([this.lat-r,this.lng-n],[this.lat+r,this.lng+n])},clone:function(){return new K(this.lat,this.lng,this.alt)}};var Y={latLngToPoint:function(i,r){var n=this.projection.project(i),o=this.scale(r);return this.transformation._transform(n,o)},pointToLatLng:function(i,r){var n=this.scale(r),o=this.transformation.untransform(i,n);return this.projection.unproject(o)},project:function(i){return this.projection.project(i)},unproject:function(i){return this.projection.unproject(i)},scale:function(i){return 256*Math.pow(2,i)},zoom:function(i){return Math.log(i/256)/Math.LN2},getProjectedBounds:function(i){if(this.infinite)return null;var r=this.projection.bounds,n=this.scale(i),o=this.transformation.transform(r.min,n),a=this.transformation.transform(r.max,n);return new G(o,a)},infinite:!1,wrapLatLng:function(i){var r=this.wrapLng?v(i.lng,this.wrapLng,!0):i.lng,n=this.wrapLat?v(i.lat,this.wrapLat,!0):i.lat,o=i.alt;return new K(n,r,o)},wrapLatLngBounds:function(i){var r=i.getCenter(),n=this.wrapLatLng(r),o=r.lat-n.lat,a=r.lng-n.lng;if(0===o&&0===a)return i;var s=i.getSouthWest(),l=i.getNorthEast(),u=new K(s.lat-o,s.lng-a),h=new K(l.lat-o,l.lng-a);return new H(u,h)}},Q=r({},Y,{wrapLng:[-180,180],R:6371e3,distance:function(i,r){var n=Math.PI/180,o=i.lat*n,a=r.lat*n,s=Math.sin((r.lat-i.lat)*n/2),l=Math.sin((r.lng-i.lng)*n/2),u=s*s+Math.cos(o)*Math.cos(a)*l*l,h=2*Math.atan2(Math.sqrt(u),Math.sqrt(1-u));return this.R*h}}),tt={R:6378137,MAX_LATITUDE:85.0511287798,project:function(i){var r=Math.PI/180,n=this.MAX_LATITUDE,o=Math.sin(Math.max(Math.min(n,i.lat),-n)*r);return new Z(this.R*i.lng*r,this.R*Math.log((1+o)/(1-o))/2)},unproject:function(i){var r=180/Math.PI;return new K((2*Math.atan(Math.exp(i.y/this.R))-Math.PI/2)*r,i.x*r/this.R)},bounds:(h=6378137*Math.PI,new G([-h,-h],[h,h]))};function te(i,r,n,o){if(A(i)){this._a=i[0],this._b=i[1],this._c=i[2],this._d=i[3];return}this._a=i,this._b=r,this._c=n,this._d=o}function ti(i,r,n,o){return new te(i,r,n,o)}te.prototype={transform:function(i,r){return this._transform(i.clone(),r)},_transform:function(i,r){return r=r||1,i.x=r*(this._a*i.x+this._b),i.y=r*(this._c*i.y+this._d),i},untransform:function(i,r){return r=r||1,new Z((i.x/r-this._b)/this._a,(i.y/r-this._d)/this._c)}};var tr=r({},Q,{code:"EPSG:3857",projection:tt,transformation:ti(c=.5/(Math.PI*tt.R),.5,-c,.5)}),tn=r({},tr,{code:"EPSG:900913"});function to(i){return document.createElementNS("http://www.w3.org/2000/svg",i)}function ta(i,r){var n,o,a,s,l,u,h="";for(n=0,a=i.length;n<a;n++){for(o=0,s=(l=i[n]).length;o<s;o++)u=l[o],h+=(o?"L":"M")+u.x+" "+u.y;h+=r?tN.svg?"z":"x":""}return h||"M0 0"}var ts=document.documentElement.style,tl="ActiveXObject"in window,tu=tl&&!document.addEventListener,th="msLaunchUri"in navigator&&!("documentMode"in document),tc=tF("webkit"),td=tF("android"),tp=tF("android 2")||tF("android 3"),tf=parseInt(/WebKit\/([0-9]+)|$/.exec(navigator.userAgent)[1],10),tm=td&&tF("Google")&&tf<537&&!("AudioNode"in window),tg=!!window.opera,t_=!th&&tF("chrome"),ty=tF("gecko")&&!tc&&!tg&&!tl,tv=!t_&&tF("safari"),tx=tF("phantom"),tb="OTransition"in ts,tw=0===navigator.platform.indexOf("Win"),tT=tl&&"transition"in ts,tE="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!tp,tS="MozPerspective"in ts,tC=!window.L_DISABLE_3D&&(tT||tE||tS)&&!tb&&!tx,tI="undefined"!=typeof orientation||tF("mobile"),tA=!window.PointerEvent&&window.MSPointerEvent,tP=!!(window.PointerEvent||tA),tk="ontouchstart"in window||!!window.TouchEvent,tL=!window.L_NO_TOUCH&&(tk||tP),tM=(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI)>1,tz=function(){var i=!1;try{var r=Object.defineProperty({},"passive",{get:function(){i=!0}});window.addEventListener("testPassiveEventSupport",x,r),window.removeEventListener("testPassiveEventSupport",x,r)}catch(i){}return i}(),tD=!!document.createElement("canvas").getContext,tR=!!(document.createElementNS&&to("svg").createSVGRect),tB=!!tR&&((d=document.createElement("div")).innerHTML="<svg/>","http://www.w3.org/2000/svg"===(d.firstChild&&d.firstChild.namespaceURI)),tO=!tR&&function(){try{var i=document.createElement("div");i.innerHTML='<v:shape adj="1"/>';var r=i.firstChild;return r.style.behavior="url(#default#VML)",r&&"object"==typeof r.adj}catch(i){return!1}}();function tF(i){return navigator.userAgent.toLowerCase().indexOf(i)>=0}var tN={ie:tl,ielt9:tu,edge:th,webkit:tc,android:td,android23:tp,androidStock:tm,opera:tg,chrome:t_,gecko:ty,safari:tv,phantom:tx,opera12:tb,win:tw,ie3d:tT,webkit3d:tE,gecko3d:tS,any3d:tC,mobile:tI,mobileWebkit:tI&&tc,mobileWebkit3d:tI&&tE,msPointer:tA,pointer:tP,touch:tL,touchNative:tk,mobileOpera:tI&&tg,mobileGecko:tI&&ty,retina:tM,passiveEvents:tz,canvas:tD,svg:tR,vml:tO,inlineSvg:tB,mac:0===navigator.platform.indexOf("Mac"),linux:0===navigator.platform.indexOf("Linux")},tU=tN.msPointer?"MSPointerDown":"pointerdown",tj=tN.msPointer?"MSPointerMove":"pointermove",tZ=tN.msPointer?"MSPointerUp":"pointerup",tV=tN.msPointer?"MSPointerCancel":"pointercancel",tq={touchstart:tU,touchmove:tj,touchend:tZ,touchcancel:tV},tG={touchstart:function(i,r){r.MSPOINTER_TYPE_TOUCH&&r.pointerType===r.MSPOINTER_TYPE_TOUCH&&eS(r),tJ(i,r)},touchmove:tJ,touchend:tJ,touchcancel:tJ},t$={},tW=!1;function tH(i){t$[i.pointerId]=i}function tX(i){t$[i.pointerId]&&(t$[i.pointerId]=i)}function tK(i){delete t$[i.pointerId]}function tJ(i,r){if(r.pointerType!==(r.MSPOINTER_TYPE_MOUSE||"mouse")){for(var n in r.touches=[],t$)r.touches.push(t$[n]);r.changedTouches=[r],i(r)}}var tY=en(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),tQ=en(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),t0="webkitTransition"===tQ||"OTransition"===tQ?tQ+"End":"transitionend";function t1(i){return"string"==typeof i?document.getElementById(i):i}function t2(i,r){var n=i.style[r]||i.currentStyle&&i.currentStyle[r];if((!n||"auto"===n)&&document.defaultView){var o=document.defaultView.getComputedStyle(i,null);n=o?o[r]:null}return"auto"===n?null:n}function t3(i,r,n){var o=document.createElement(i);return o.className=r||"",n&&n.appendChild(o),o}function t5(i){var r=i.parentNode;r&&r.removeChild(i)}function t4(i){for(;i.firstChild;)i.removeChild(i.firstChild)}function t6(i){var r=i.parentNode;r&&r.lastChild!==i&&r.appendChild(i)}function t8(i){var r=i.parentNode;r&&r.firstChild!==i&&r.insertBefore(i,r.firstChild)}function t9(i,r){if(void 0!==i.classList)return i.classList.contains(r);var n=ei(i);return n.length>0&&RegExp("(^|\\s)"+r+"(\\s|$)").test(n)}function t7(i,r){if(void 0!==i.classList)for(var n=T(r),o=0,a=n.length;o<a;o++)i.classList.add(n[o]);else if(!t9(i,r)){var s=ei(i);ee(i,(s?s+" ":"")+r)}}function et(i,r){void 0!==i.classList?i.classList.remove(r):ee(i,w((" "+ei(i)+" ").replace(" "+r+" "," ")))}function ee(i,r){void 0===i.className.baseVal?i.className=r:i.className.baseVal=r}function ei(i){return i.correspondingElement&&(i=i.correspondingElement),void 0===i.className.baseVal?i.className:i.className.baseVal}function er(i,r){"opacity"in i.style?i.style.opacity=r:"filter"in i.style&&function(i,r){var n=!1,o="DXImageTransform.Microsoft.Alpha";try{n=i.filters.item(o)}catch(i){if(1===r)return}r=Math.round(100*r),n?(n.Enabled=100!==r,n.Opacity=r):i.style.filter+=" progid:"+o+"(opacity="+r+")"}(i,r)}function en(i){for(var r=document.documentElement.style,n=0;n<i.length;n++)if(i[n]in r)return i[n];return!1}function eo(i,r,n){var o=r||new Z(0,0);i.style[tY]=(tN.ie3d?"translate("+o.x+"px,"+o.y+"px)":"translate3d("+o.x+"px,"+o.y+"px,0)")+(n?" scale("+n+")":"")}function ea(i,r){i._leaflet_pos=r,tN.any3d?eo(i,r):(i.style.left=r.x+"px",i.style.top=r.y+"px")}function es(i){return i._leaflet_pos||new Z(0,0)}if("onselectstart"in document)n=function(){em(window,"selectstart",eS)},o=function(){e_(window,"selectstart",eS)};else{var el=en(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);n=function(){if(el){var i=document.documentElement.style;a=i[el],i[el]="none"}},o=function(){el&&(document.documentElement.style[el]=a,a=void 0)}}function eu(){em(window,"dragstart",eS)}function eh(){e_(window,"dragstart",eS)}function ec(i){for(;-1===i.tabIndex;)i=i.parentNode;i.style&&(ed(),s=i,l=i.style.outlineStyle,i.style.outlineStyle="none",em(window,"keydown",ed))}function ed(){s&&(s.style.outlineStyle=l,s=void 0,l=void 0,e_(window,"keydown",ed))}function ep(i){do i=i.parentNode;while((!i.offsetWidth||!i.offsetHeight)&&i!==document.body)return i}function ef(i){var r=i.getBoundingClientRect();return{x:r.width/i.offsetWidth||1,y:r.height/i.offsetHeight||1,boundingClientRect:r}}function em(i,r,n,o){if(r&&"object"==typeof r)for(var a in r)ex(i,a,r[a],n);else{r=T(r);for(var s=0,l=r.length;s<l;s++)ex(i,r[s],n,o)}return this}var eg="_leaflet_events";function e_(i,r,n,o){if(1==arguments.length)ey(i),delete i[eg];else if(r&&"object"==typeof r)for(var a in r)eb(i,a,r[a],n);else if(r=T(r),2==arguments.length)ey(i,function(i){return -1!==P(r,i)});else for(var s=0,l=r.length;s<l;s++)eb(i,r[s],n,o);return this}function ey(i,r){for(var n in i[eg]){var o=n.split(/\d/)[0];(!r||r(o))&&eb(i,o,null,null,n)}}var ev={mouseenter:"mouseover",mouseleave:"mouseout",wheel:!("onwheel"in window)&&"mousewheel"};function ex(i,r,n,o){var a=r+_(n)+(o?"_"+_(o):"");if(i[eg]&&i[eg][a])return this;var s=function(r){return n.call(o||i,r||window.event)},l=s;!tN.touchNative&&tN.pointer&&0===r.indexOf("touch")?s=function(i,r,n){return("touchstart"===r&&(tW||(document.addEventListener(tU,tH,!0),document.addEventListener(tj,tX,!0),document.addEventListener(tZ,tK,!0),document.addEventListener(tV,tK,!0),tW=!0)),tG[r])?(n=tG[r].bind(this,n),i.addEventListener(tq[r],n,!1),n):(console.warn("wrong event specified:",r),x)}(i,r,s):tN.touch&&"dblclick"===r?s=function(i,r){i.addEventListener("dblclick",r);var n,o=0;function a(i){if(1!==i.detail){n=i.detail;return}if("mouse"!==i.pointerType&&(!i.sourceCapabilities||i.sourceCapabilities.firesTouchEvents)){var a=eI(i);if(!a.some(function(i){return i instanceof HTMLLabelElement&&i.attributes.for})||a.some(function(i){return i instanceof HTMLInputElement||i instanceof HTMLSelectElement})){var s=Date.now();s-o<=200?2==++n&&r(function(i){var r,n,o={};for(n in i)r=i[n],o[n]=r&&r.bind?r.bind(i):r;return i=o,o.type="dblclick",o.detail=2,o.isTrusted=!1,o._simulated=!0,o}(i)):n=1,o=s}}}return i.addEventListener("click",a),{dblclick:r,simDblclick:a}}(i,s):"addEventListener"in i?"touchstart"===r||"touchmove"===r||"wheel"===r||"mousewheel"===r?i.addEventListener(ev[r]||r,s,!!tN.passiveEvents&&{passive:!1}):"mouseenter"===r||"mouseleave"===r?(s=function(r){r=r||window.event,eL(i,r)&&l(r)},i.addEventListener(ev[r],s,!1)):i.addEventListener(r,l,!1):i.attachEvent("on"+r,s),i[eg]=i[eg]||{},i[eg][a]=s}function eb(i,r,n,o,a){a=a||r+_(n)+(o?"_"+_(o):"");var s=i[eg]&&i[eg][a];if(!s)return this;!tN.touchNative&&tN.pointer&&0===r.indexOf("touch")?function(i,r,n){if(!tq[r]){console.warn("wrong event specified:",r);return}i.removeEventListener(tq[r],n,!1)}(i,r,s):tN.touch&&"dblclick"===r?(i.removeEventListener("dblclick",s.dblclick),i.removeEventListener("click",s.simDblclick)):"removeEventListener"in i?i.removeEventListener(ev[r]||r,s,!1):i.detachEvent("on"+r,s),i[eg][a]=null}function ew(i){return i.stopPropagation?i.stopPropagation():i.originalEvent?i.originalEvent._stopped=!0:i.cancelBubble=!0,this}function eT(i){return ex(i,"wheel",ew),this}function eE(i){return em(i,"mousedown touchstart dblclick contextmenu",ew),i._leaflet_disable_click=!0,this}function eS(i){return i.preventDefault?i.preventDefault():i.returnValue=!1,this}function eC(i){return eS(i),ew(i),this}function eI(i){if(i.composedPath)return i.composedPath();for(var r=[],n=i.target;n;)r.push(n),n=n.parentNode;return r}function eA(i,r){if(!r)return new Z(i.clientX,i.clientY);var n=ef(r),o=n.boundingClientRect;return new Z((i.clientX-o.left)/n.x-r.clientLeft,(i.clientY-o.top)/n.y-r.clientTop)}var eP=tN.linux&&tN.chrome?window.devicePixelRatio:tN.mac?3*window.devicePixelRatio:window.devicePixelRatio>0?2*window.devicePixelRatio:1;function ek(i){return tN.edge?i.wheelDeltaY/2:i.deltaY&&0===i.deltaMode?-i.deltaY/eP:i.deltaY&&1===i.deltaMode?-(20*i.deltaY):i.deltaY&&2===i.deltaMode?-(60*i.deltaY):i.deltaX||i.deltaZ?0:i.wheelDelta?(i.wheelDeltaY||i.wheelDelta)/2:i.detail&&32765>Math.abs(i.detail)?-(20*i.detail):i.detail?-(60*(i.detail/32765)):0}function eL(i,r){var n=r.relatedTarget;if(!n)return!0;try{for(;n&&n!==i;)n=n.parentNode}catch(i){return!1}return n!==i}var eM=j.extend({run:function(i,r,n,o){this.stop(),this._el=i,this._inProgress=!0,this._duration=n||.25,this._easeOutPower=1/Math.max(o||.5,.2),this._startPos=es(i),this._offset=r.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=O(this._animate,this),this._step()},_step:function(i){var r=+new Date-this._startTime,n=1e3*this._duration;r<n?this._runFrame(this._easeOut(r/n),i):(this._runFrame(1),this._complete())},_runFrame:function(i,r){var n=this._startPos.add(this._offset.multiplyBy(i));r&&n._round(),ea(this._el,n),this.fire("step")},_complete:function(){F(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(i){return 1-Math.pow(1-i,this._easeOutPower)}}),ez=j.extend({options:{crs:tr,center:void 0,zoom:void 0,minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(i,r){r=E(this,r),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this._initContainer(i),this._initLayout(),this._onResize=m(this._onResize,this),this._initEvents(),r.maxBounds&&this.setMaxBounds(r.maxBounds),void 0!==r.zoom&&(this._zoom=this._limitZoom(r.zoom)),r.center&&void 0!==r.zoom&&this.setView(J(r.center),r.zoom,{reset:!0}),this.callInitHooks(),this._zoomAnimated=tQ&&tN.any3d&&!tN.mobileOpera&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),em(this._proxy,t0,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)},setView:function(i,n,o){return(n=void 0===n?this._zoom:this._limitZoom(n),i=this._limitCenter(J(i),n,this.options.maxBounds),o=o||{},this._stop(),this._loaded&&!o.reset&&!0!==o&&(void 0!==o.animate&&(o.zoom=r({animate:o.animate},o.zoom),o.pan=r({animate:o.animate,duration:o.duration},o.pan)),this._zoom!==n?this._tryAnimatedZoom&&this._tryAnimatedZoom(i,n,o.zoom):this._tryAnimatedPan(i,o.pan)))?clearTimeout(this._sizeTimer):this._resetView(i,n,o.pan&&o.pan.noMoveStart),this},setZoom:function(i,r){return this._loaded?this.setView(this.getCenter(),i,{zoom:r}):(this._zoom=i,this)},zoomIn:function(i,r){return i=i||(tN.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom+i,r)},zoomOut:function(i,r){return i=i||(tN.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom-i,r)},setZoomAround:function(i,r,n){var o=this.getZoomScale(r),a=this.getSize().divideBy(2),s=(i instanceof Z?i:this.latLngToContainerPoint(i)).subtract(a).multiplyBy(1-1/o),l=this.containerPointToLatLng(a.add(s));return this.setView(l,r,{zoom:n})},_getBoundsCenterZoom:function(i,r){r=r||{},i=i.getBounds?i.getBounds():X(i);var n=q(r.paddingTopLeft||r.padding||[0,0]),o=q(r.paddingBottomRight||r.padding||[0,0]),a=this.getBoundsZoom(i,!1,n.add(o));if((a="number"==typeof r.maxZoom?Math.min(r.maxZoom,a):a)===1/0)return{center:i.getCenter(),zoom:a};var s=o.subtract(n).divideBy(2),l=this.project(i.getSouthWest(),a),u=this.project(i.getNorthEast(),a);return{center:this.unproject(l.add(u).divideBy(2).add(s),a),zoom:a}},fitBounds:function(i,r){if(!(i=X(i)).isValid())throw Error("Bounds are not valid.");var n=this._getBoundsCenterZoom(i,r);return this.setView(n.center,n.zoom,r)},fitWorld:function(i){return this.fitBounds([[-90,-180],[90,180]],i)},panTo:function(i,r){return this.setView(i,this._zoom,{pan:r})},panBy:function(i,r){if(i=q(i).round(),r=r||{},!i.x&&!i.y)return this.fire("moveend");if(!0!==r.animate&&!this.getSize().contains(i))return this._resetView(this.unproject(this.project(this.getCenter()).add(i)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new eM,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),r.noMoveStart||this.fire("movestart"),!1!==r.animate){t7(this._mapPane,"leaflet-pan-anim");var n=this._getMapPanePos().subtract(i).round();this._panAnim.run(this._mapPane,n,r.duration||.25,r.easeLinearity)}else this._rawPanBy(i),this.fire("move").fire("moveend");return this},flyTo:function(i,r,n){if(!1===(n=n||{}).animate||!tN.any3d)return this.setView(i,r,n);this._stop();var o=this.project(this.getCenter()),a=this.project(i),s=this.getSize(),l=this._zoom;i=J(i),r=void 0===r?l:r;var u=Math.max(s.x,s.y),h=u*this.getZoomScale(l,r),c=a.distanceTo(o)||1;function d(i){var r=i?h:u,n=(h*h-u*u+(i?-1:1)*4.0658689599999995*c*c)/(2*r*2.0164*c),o=Math.sqrt(n*n+1)-n;return o<1e-9?-18:Math.log(o)}function p(i){return(Math.exp(i)-Math.exp(-i))/2}function f(i){return(Math.exp(i)+Math.exp(-i))/2}var m=d(0),g=Date.now(),_=(d(1)-m)/1.42,y=n.duration?1e3*n.duration:1e3*_*.8;return this._moveStart(!0,n.noMoveStart),(function n(){var s,h=(Date.now()-g)/y,d=(1-Math.pow(1-h,1.5))*_;h<=1?(this._flyToFrame=O(n,this),this._move(this.unproject(o.add(a.subtract(o).multiplyBy(u*(f(m)*(p(s=m+1.42*d)/f(s))-p(m))/2.0164/c)),l),this.getScaleZoom(u/(u*(f(m)/f(m+1.42*d))),l),{flyTo:!0})):this._move(i,r)._moveEnd(!0)}).call(this),this},flyToBounds:function(i,r){var n=this._getBoundsCenterZoom(i,r);return this.flyTo(n.center,n.zoom,r)},setMaxBounds:function(i){return(i=X(i),this.listens("moveend",this._panInsideMaxBounds)&&this.off("moveend",this._panInsideMaxBounds),i.isValid())?(this.options.maxBounds=i,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this)},setMinZoom:function(i){var r=this.options.minZoom;return(this.options.minZoom=i,this._loaded&&r!==i&&(this.fire("zoomlevelschange"),this.getZoom()<this.options.minZoom))?this.setZoom(i):this},setMaxZoom:function(i){var r=this.options.maxZoom;return(this.options.maxZoom=i,this._loaded&&r!==i&&(this.fire("zoomlevelschange"),this.getZoom()>this.options.maxZoom))?this.setZoom(i):this},panInsideBounds:function(i,r){this._enforcingBounds=!0;var n=this.getCenter(),o=this._limitCenter(n,this._zoom,X(i));return n.equals(o)||this.panTo(o,r),this._enforcingBounds=!1,this},panInside:function(i,r){var n=q((r=r||{}).paddingTopLeft||r.padding||[0,0]),o=q(r.paddingBottomRight||r.padding||[0,0]),a=this.project(this.getCenter()),s=this.project(i),l=this.getPixelBounds(),u=W([l.min.add(n),l.max.subtract(o)]),h=u.getSize();if(!u.contains(s)){this._enforcingBounds=!0;var c=s.subtract(u.getCenter()),d=u.extend(s).getSize().subtract(h);a.x+=c.x<0?-d.x:d.x,a.y+=c.y<0?-d.y:d.y,this.panTo(this.unproject(a),r),this._enforcingBounds=!1}return this},invalidateSize:function(i){if(!this._loaded)return this;i=r({animate:!1,pan:!0},!0===i?{animate:!0}:i);var n=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var o=this.getSize(),a=n.divideBy(2).round(),s=o.divideBy(2).round(),l=a.subtract(s);return l.x||l.y?(i.animate&&i.pan?this.panBy(l):(i.pan&&this._rawPanBy(l),this.fire("move"),i.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(m(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:n,newSize:o})):this},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(i){if(i=this._locateOptions=r({timeout:1e4,watch:!1},i),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var n=m(this._handleGeolocationResponse,this),o=m(this._handleGeolocationError,this);return i.watch?this._locationWatchId=navigator.geolocation.watchPosition(n,o,i):navigator.geolocation.getCurrentPosition(n,o,i),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(i){if(this._container._leaflet_id){var r=i.code,n=i.message||(1===r?"permission denied":2===r?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:r,message:"Geolocation error: "+n+"."})}},_handleGeolocationResponse:function(i){if(this._container._leaflet_id){var r=i.coords.latitude,n=i.coords.longitude,o=new K(r,n),a=o.toBounds(2*i.coords.accuracy),s=this._locateOptions;if(s.setView){var l=this.getBoundsZoom(a);this.setView(o,s.maxZoom?Math.min(l,s.maxZoom):l)}var u={latlng:o,bounds:a,timestamp:i.timestamp};for(var h in i.coords)"number"==typeof i.coords[h]&&(u[h]=i.coords[h]);this.fire("locationfound",u)}},addHandler:function(i,r){if(!r)return this;var n=this[i]=new r(this);return this._handlers.push(n),this.options[i]&&n.enable(),this},remove:function(){var i;if(this._initEvents(!0),this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this._containerId!==this._container._leaflet_id)throw Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch(i){this._container._leaflet_id=void 0,this._containerId=void 0}for(i in void 0!==this._locationWatchId&&this.stopLocate(),this._stop(),t5(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._resizeRequest&&(F(this._resizeRequest),this._resizeRequest=null),this._clearHandlers(),this._loaded&&this.fire("unload"),this._layers)this._layers[i].remove();for(i in this._panes)t5(this._panes[i]);return this._layers=[],this._panes=[],delete this._mapPane,delete this._renderer,this},createPane:function(i,r){var n=t3("div","leaflet-pane"+(i?" leaflet-"+i.replace("Pane","")+"-pane":""),r||this._mapPane);return i&&(this._panes[i]=n),n},getCenter:function(){return(this._checkIfLoaded(),this._lastCenter&&!this._moved())?this._lastCenter.clone():this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var i=this.getPixelBounds(),r=this.unproject(i.getBottomLeft()),n=this.unproject(i.getTopRight());return new H(r,n)},getMinZoom:function(){return void 0===this.options.minZoom?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return void 0===this.options.maxZoom?void 0===this._layersMaxZoom?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(i,r,n){i=X(i),n=q(n||[0,0]);var o=this.getZoom()||0,a=this.getMinZoom(),s=this.getMaxZoom(),l=i.getNorthWest(),u=i.getSouthEast(),h=this.getSize().subtract(n),c=W(this.project(u,o),this.project(l,o)).getSize(),d=tN.any3d?this.options.zoomSnap:1,p=h.x/c.x,f=h.y/c.y,m=r?Math.max(p,f):Math.min(p,f);return o=this.getScaleZoom(m,o),d&&(o=Math.round(o/(d/100))*(d/100),o=r?Math.ceil(o/d)*d:Math.floor(o/d)*d),Math.max(a,Math.min(s,o))},getSize:function(){return(!this._size||this._sizeChanged)&&(this._size=new Z(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(i,r){var n=this._getTopLeftPoint(i,r);return new G(n,n.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(i){return this.options.crs.getProjectedBounds(void 0===i?this.getZoom():i)},getPane:function(i){return"string"==typeof i?this._panes[i]:i},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(i,r){var n=this.options.crs;return r=void 0===r?this._zoom:r,n.scale(i)/n.scale(r)},getScaleZoom:function(i,r){var n=this.options.crs;r=void 0===r?this._zoom:r;var o=n.zoom(i*n.scale(r));return isNaN(o)?1/0:o},project:function(i,r){return r=void 0===r?this._zoom:r,this.options.crs.latLngToPoint(J(i),r)},unproject:function(i,r){return r=void 0===r?this._zoom:r,this.options.crs.pointToLatLng(q(i),r)},layerPointToLatLng:function(i){var r=q(i).add(this.getPixelOrigin());return this.unproject(r)},latLngToLayerPoint:function(i){return this.project(J(i))._round()._subtract(this.getPixelOrigin())},wrapLatLng:function(i){return this.options.crs.wrapLatLng(J(i))},wrapLatLngBounds:function(i){return this.options.crs.wrapLatLngBounds(X(i))},distance:function(i,r){return this.options.crs.distance(J(i),J(r))},containerPointToLayerPoint:function(i){return q(i).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(i){return q(i).add(this._getMapPanePos())},containerPointToLatLng:function(i){var r=this.containerPointToLayerPoint(q(i));return this.layerPointToLatLng(r)},latLngToContainerPoint:function(i){return this.layerPointToContainerPoint(this.latLngToLayerPoint(J(i)))},mouseEventToContainerPoint:function(i){return eA(i,this._container)},mouseEventToLayerPoint:function(i){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(i))},mouseEventToLatLng:function(i){return this.layerPointToLatLng(this.mouseEventToLayerPoint(i))},_initContainer:function(i){var r=this._container=t1(i);if(r){if(r._leaflet_id)throw Error("Map container is already initialized.")}else throw Error("Map container not found.");em(r,"scroll",this._onScroll,this),this._containerId=_(r)},_initLayout:function(){var i=this._container;this._fadeAnimated=this.options.fadeAnimation&&tN.any3d,t7(i,"leaflet-container"+(tN.touch?" leaflet-touch":"")+(tN.retina?" leaflet-retina":"")+(tN.ielt9?" leaflet-oldie":"")+(tN.safari?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var r=t2(i,"position");"absolute"!==r&&"relative"!==r&&"fixed"!==r&&"sticky"!==r&&(i.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var i=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),ea(this._mapPane,new Z(0,0)),this.createPane("tilePane"),this.createPane("overlayPane"),this.createPane("shadowPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(t7(i.markerPane,"leaflet-zoom-hide"),t7(i.shadowPane,"leaflet-zoom-hide"))},_resetView:function(i,r,n){ea(this._mapPane,new Z(0,0));var o=!this._loaded;this._loaded=!0,r=this._limitZoom(r),this.fire("viewprereset");var a=this._zoom!==r;this._moveStart(a,n)._move(i,r)._moveEnd(a),this.fire("viewreset"),o&&this.fire("load")},_moveStart:function(i,r){return i&&this.fire("zoomstart"),r||this.fire("movestart"),this},_move:function(i,r,n,o){void 0===r&&(r=this._zoom);var a=this._zoom!==r;return this._zoom=r,this._lastCenter=i,this._pixelOrigin=this._getNewPixelOrigin(i),o?n&&n.pinch&&this.fire("zoom",n):((a||n&&n.pinch)&&this.fire("zoom",n),this.fire("move",n)),this},_moveEnd:function(i){return i&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return F(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(i){ea(this._mapPane,this._getMapPanePos().subtract(i))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw Error("Set map center and zoom first.")},_initEvents:function(i){this._targets={},this._targets[_(this._container)]=this;var r=i?e_:em;r(this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress keydown keyup",this._handleDOMEvent,this),this.options.trackResize&&r(window,"resize",this._onResize,this),tN.any3d&&this.options.transform3DLimit&&(i?this.off:this.on).call(this,"moveend",this._onMoveEnd)},_onResize:function(){F(this._resizeRequest),this._resizeRequest=O(function(){this.invalidateSize({debounceMoveend:!0})},this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var i=this._getMapPanePos();Math.max(Math.abs(i.x),Math.abs(i.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(i,r){for(var n,o=[],a="mouseout"===r||"mouseover"===r,s=i.target||i.srcElement,l=!1;s;){if((n=this._targets[_(s)])&&("click"===r||"preclick"===r)&&this._draggableMoved(n)){l=!0;break}if(n&&n.listens(r,!0)&&(a&&!eL(s,i)||(o.push(n),a))||s===this._container)break;s=s.parentNode}return!o.length&&!l&&!a&&this.listens(r,!0)&&(o=[this]),o},_isClickDisabled:function(i){for(;i&&i!==this._container;){if(i._leaflet_disable_click)return!0;i=i.parentNode}},_handleDOMEvent:function(i){var r=i.target||i.srcElement;if(!(!this._loaded||r._leaflet_disable_events||"click"===i.type&&this._isClickDisabled(r))){var n=i.type;"mousedown"===n&&ec(r),this._fireDOMEvent(i,n)}},_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:function(i,n,o){if("click"===i.type){var a=r({},i);a.type="preclick",this._fireDOMEvent(a,a.type,o)}var s=this._findEventTargets(i,n);if(o){for(var l=[],u=0;u<o.length;u++)o[u].listens(n,!0)&&l.push(o[u]);s=l.concat(s)}if(s.length){"contextmenu"===n&&eS(i);var h=s[0],c={originalEvent:i};if("keypress"!==i.type&&"keydown"!==i.type&&"keyup"!==i.type){var d=h.getLatLng&&(!h._radius||h._radius<=10);c.containerPoint=d?this.latLngToContainerPoint(h.getLatLng()):this.mouseEventToContainerPoint(i),c.layerPoint=this.containerPointToLayerPoint(c.containerPoint),c.latlng=d?h.getLatLng():this.layerPointToLatLng(c.layerPoint)}for(u=0;u<s.length;u++)if(s[u].fire(n,c,!0),c.originalEvent._stopped||!1===s[u].options.bubblingMouseEvents&&-1!==P(this._mouseEvents,n))return}},_draggableMoved:function(i){return(i=i.dragging&&i.dragging.enabled()?i:this).dragging&&i.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var i=0,r=this._handlers.length;i<r;i++)this._handlers[i].disable()},whenReady:function(i,r){return this._loaded?i.call(r||this,{target:this}):this.on("load",i,r),this},_getMapPanePos:function(){return es(this._mapPane)||new Z(0,0)},_moved:function(){var i=this._getMapPanePos();return i&&!i.equals([0,0])},_getTopLeftPoint:function(i,r){return(i&&void 0!==r?this._getNewPixelOrigin(i,r):this.getPixelOrigin()).subtract(this._getMapPanePos())},_getNewPixelOrigin:function(i,r){var n=this.getSize()._divideBy(2);return this.project(i,r)._subtract(n)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(i,r,n){var o=this._getNewPixelOrigin(n,r);return this.project(i,r)._subtract(o)},_latLngBoundsToNewLayerBounds:function(i,r,n){var o=this._getNewPixelOrigin(n,r);return W([this.project(i.getSouthWest(),r)._subtract(o),this.project(i.getNorthWest(),r)._subtract(o),this.project(i.getSouthEast(),r)._subtract(o),this.project(i.getNorthEast(),r)._subtract(o)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(i){return this.latLngToLayerPoint(i).subtract(this._getCenterLayerPoint())},_limitCenter:function(i,r,n){if(!n)return i;var o=this.project(i,r),a=this.getSize().divideBy(2),s=new G(o.subtract(a),o.add(a)),l=this._getBoundsOffset(s,n,r);return 1>=Math.abs(l.x)&&1>=Math.abs(l.y)?i:this.unproject(o.add(l),r)},_limitOffset:function(i,r){if(!r)return i;var n=this.getPixelBounds(),o=new G(n.min.add(i),n.max.add(i));return i.add(this._getBoundsOffset(o,r))},_getBoundsOffset:function(i,r,n){var o=W(this.project(r.getNorthEast(),n),this.project(r.getSouthWest(),n)),a=o.min.subtract(i.min),s=o.max.subtract(i.max),l=this._rebound(a.x,-s.x),u=this._rebound(a.y,-s.y);return new Z(l,u)},_rebound:function(i,r){return i+r>0?Math.round(i-r)/2:Math.max(0,Math.ceil(i))-Math.max(0,Math.floor(r))},_limitZoom:function(i){var r=this.getMinZoom(),n=this.getMaxZoom(),o=tN.any3d?this.options.zoomSnap:1;return o&&(i=Math.round(i/o)*o),Math.max(r,Math.min(n,i))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){et(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(i,r){var n=this._getCenterOffset(i)._trunc();return!!(!0===(r&&r.animate)||this.getSize().contains(n))&&(this.panBy(n,r),!0)},_createAnimProxy:function(){var i=this._proxy=t3("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(i),this.on("zoomanim",function(i){var r=this._proxy.style[tY];eo(this._proxy,this.project(i.center,i.zoom),this.getZoomScale(i.zoom,1)),r===this._proxy.style[tY]&&this._animatingZoom&&this._onZoomTransitionEnd()},this),this.on("load moveend",this._animMoveEnd,this),this._on("unload",this._destroyAnimProxy,this)},_destroyAnimProxy:function(){t5(this._proxy),this.off("load moveend",this._animMoveEnd,this),delete this._proxy},_animMoveEnd:function(){var i=this.getCenter(),r=this.getZoom();eo(this._proxy,this.project(i,r),this.getZoomScale(r,1))},_catchTransitionEnd:function(i){this._animatingZoom&&i.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(i,r,n){if(this._animatingZoom)return!0;if(n=n||{},!this._zoomAnimated||!1===n.animate||this._nothingToAnimate()||Math.abs(r-this._zoom)>this.options.zoomAnimationThreshold)return!1;var o=this.getZoomScale(r),a=this._getCenterOffset(i)._divideBy(1-1/o);return!!(!0===n.animate||this.getSize().contains(a))&&(O(function(){this._moveStart(!0,n.noMoveStart||!1)._animateZoom(i,r,!0)},this),!0)},_animateZoom:function(i,r,n,o){this._mapPane&&(n&&(this._animatingZoom=!0,this._animateToCenter=i,this._animateToZoom=r,t7(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:i,zoom:r,noUpdate:o}),this._tempFireZoomEvent||(this._tempFireZoomEvent=this._zoom!==this._animateToZoom),this._move(this._animateToCenter,this._animateToZoom,void 0,!0),setTimeout(m(this._onZoomTransitionEnd,this),250))},_onZoomTransitionEnd:function(){this._animatingZoom&&(this._mapPane&&et(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom,void 0,!0),this._tempFireZoomEvent&&this.fire("zoom"),delete this._tempFireZoomEvent,this.fire("move"),this._moveEnd(!0))}}),eD=N.extend({options:{position:"topright"},initialize:function(i){E(this,i)},getPosition:function(){return this.options.position},setPosition:function(i){var r=this._map;return r&&r.removeControl(this),this.options.position=i,r&&r.addControl(this),this},getContainer:function(){return this._container},addTo:function(i){this.remove(),this._map=i;var r=this._container=this.onAdd(i),n=this.getPosition(),o=i._controlCorners[n];return t7(r,"leaflet-control"),-1!==n.indexOf("bottom")?o.insertBefore(r,o.firstChild):o.appendChild(r),this._map.on("unload",this.remove,this),this},remove:function(){return this._map&&(t5(this._container),this.onRemove&&this.onRemove(this._map),this._map.off("unload",this.remove,this),this._map=null),this},_refocusOnMap:function(i){this._map&&i&&i.screenX>0&&i.screenY>0&&this._map.getContainer().focus()}}),eR=function(i){return new eD(i)};ez.include({addControl:function(i){return i.addTo(this),this},removeControl:function(i){return i.remove(),this},_initControlPos:function(){var i=this._controlCorners={},r="leaflet-",n=this._controlContainer=t3("div",r+"control-container",this._container);function o(o,a){var s=r+o+" "+r+a;i[o+a]=t3("div",s,n)}o("top","left"),o("top","right"),o("bottom","left"),o("bottom","right")},_clearControlPos:function(){for(var i in this._controlCorners)t5(this._controlCorners[i]);t5(this._controlContainer),delete this._controlCorners,delete this._controlContainer}});var eB=eD.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(i,r,n,o){return n<o?-1:o<n?1:0}},initialize:function(i,r,n){for(var o in E(this,n),this._layerControlInputs=[],this._layers=[],this._lastZIndex=0,this._handlingClick=!1,this._preventClick=!1,i)this._addLayer(i[o],o);for(o in r)this._addLayer(r[o],o,!0)},onAdd:function(i){this._initLayout(),this._update(),this._map=i,i.on("zoomend",this._checkDisabledLayers,this);for(var r=0;r<this._layers.length;r++)this._layers[r].layer.on("add remove",this._onLayerChange,this);return this._container},addTo:function(i){return eD.prototype.addTo.call(this,i),this._expandIfNotCollapsed()},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var i=0;i<this._layers.length;i++)this._layers[i].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(i,r){return this._addLayer(i,r),this._map?this._update():this},addOverlay:function(i,r){return this._addLayer(i,r,!0),this._map?this._update():this},removeLayer:function(i){i.off("add remove",this._onLayerChange,this);var r=this._getLayer(_(i));return r&&this._layers.splice(this._layers.indexOf(r),1),this._map?this._update():this},expand:function(){t7(this._container,"leaflet-control-layers-expanded"),this._section.style.height=null;var i=this._map.getSize().y-(this._container.offsetTop+50);return i<this._section.clientHeight?(t7(this._section,"leaflet-control-layers-scrollbar"),this._section.style.height=i+"px"):et(this._section,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return et(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var i="leaflet-control-layers",r=this._container=t3("div",i),n=this.options.collapsed;r.setAttribute("aria-haspopup",!0),eE(r),eT(r);var o=this._section=t3("section",i+"-list");n&&(this._map.on("click",this.collapse,this),em(r,{mouseenter:this._expandSafely,mouseleave:this.collapse},this));var a=this._layersLink=t3("a",i+"-toggle",r);a.href="#",a.title="Layers",a.setAttribute("role","button"),em(a,{keydown:function(i){13===i.keyCode&&this._expandSafely()},click:function(i){eS(i),this._expandSafely()}},this),n||this.expand(),this._baseLayersList=t3("div",i+"-base",o),this._separator=t3("div",i+"-separator",o),this._overlaysList=t3("div",i+"-overlays",o),r.appendChild(o)},_getLayer:function(i){for(var r=0;r<this._layers.length;r++)if(this._layers[r]&&_(this._layers[r].layer)===i)return this._layers[r]},_addLayer:function(i,r,n){this._map&&i.on("add remove",this._onLayerChange,this),this._layers.push({layer:i,name:r,overlay:n}),this.options.sortLayers&&this._layers.sort(m(function(i,r){return this.options.sortFunction(i.layer,r.layer,i.name,r.name)},this)),this.options.autoZIndex&&i.setZIndex&&(this._lastZIndex++,i.setZIndex(this._lastZIndex)),this._expandIfNotCollapsed()},_update:function(){if(!this._container)return this;t4(this._baseLayersList),t4(this._overlaysList),this._layerControlInputs=[];var i,r,n,o,a=0;for(n=0;n<this._layers.length;n++)o=this._layers[n],this._addItem(o),r=r||o.overlay,i=i||!o.overlay,a+=o.overlay?0:1;return this.options.hideSingleBase&&(i=i&&a>1,this._baseLayersList.style.display=i?"":"none"),this._separator.style.display=r&&i?"":"none",this},_onLayerChange:function(i){this._handlingClick||this._update();var r=this._getLayer(_(i.target)),n=r.overlay?"add"===i.type?"overlayadd":"overlayremove":"add"===i.type?"baselayerchange":null;n&&this._map.fire(n,r)},_createRadioElement:function(i,r){var n=document.createElement("div");return n.innerHTML='<input type="radio" class="leaflet-control-layers-selector" name="'+i+'"'+(r?' checked="checked"':"")+"/>",n.firstChild},_addItem:function(i){var r,n=document.createElement("label"),o=this._map.hasLayer(i.layer);i.overlay?((r=document.createElement("input")).type="checkbox",r.className="leaflet-control-layers-selector",r.defaultChecked=o):r=this._createRadioElement("leaflet-base-layers_"+_(this),o),this._layerControlInputs.push(r),r.layerId=_(i.layer),em(r,"click",this._onInputClick,this);var a=document.createElement("span");a.innerHTML=" "+i.name;var s=document.createElement("span");return n.appendChild(s),s.appendChild(r),s.appendChild(a),(i.overlay?this._overlaysList:this._baseLayersList).appendChild(n),this._checkDisabledLayers(),n},_onInputClick:function(){if(!this._preventClick){var i,r,n=this._layerControlInputs,o=[],a=[];this._handlingClick=!0;for(var s=n.length-1;s>=0;s--)i=n[s],r=this._getLayer(i.layerId).layer,i.checked?o.push(r):i.checked||a.push(r);for(s=0;s<a.length;s++)this._map.hasLayer(a[s])&&this._map.removeLayer(a[s]);for(s=0;s<o.length;s++)this._map.hasLayer(o[s])||this._map.addLayer(o[s]);this._handlingClick=!1,this._refocusOnMap()}},_checkDisabledLayers:function(){for(var i,r,n=this._layerControlInputs,o=this._map.getZoom(),a=n.length-1;a>=0;a--)i=n[a],r=this._getLayer(i.layerId).layer,i.disabled=void 0!==r.options.minZoom&&o<r.options.minZoom||void 0!==r.options.maxZoom&&o>r.options.maxZoom},_expandIfNotCollapsed:function(){return this._map&&!this.options.collapsed&&this.expand(),this},_expandSafely:function(){var i=this._section;this._preventClick=!0,em(i,"click",eS),this.expand();var r=this;setTimeout(function(){e_(i,"click",eS),r._preventClick=!1})}}),eO=eD.extend({options:{position:"topleft",zoomInText:'<span aria-hidden="true">+</span>',zoomInTitle:"Zoom in",zoomOutText:'<span aria-hidden="true">&#x2212;</span>',zoomOutTitle:"Zoom out"},onAdd:function(i){var r="leaflet-control-zoom",n=t3("div",r+" leaflet-bar"),o=this.options;return this._zoomInButton=this._createButton(o.zoomInText,o.zoomInTitle,r+"-in",n,this._zoomIn),this._zoomOutButton=this._createButton(o.zoomOutText,o.zoomOutTitle,r+"-out",n,this._zoomOut),this._updateDisabled(),i.on("zoomend zoomlevelschange",this._updateDisabled,this),n},onRemove:function(i){i.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(i){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(i.shiftKey?3:1))},_zoomOut:function(i){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(i.shiftKey?3:1))},_createButton:function(i,r,n,o,a){var s=t3("a",n,o);return s.innerHTML=i,s.href="#",s.title=r,s.setAttribute("role","button"),s.setAttribute("aria-label",r),eE(s),em(s,"click",eC),em(s,"click",a,this),em(s,"click",this._refocusOnMap,this),s},_updateDisabled:function(){var i=this._map,r="leaflet-disabled";et(this._zoomInButton,r),et(this._zoomOutButton,r),this._zoomInButton.setAttribute("aria-disabled","false"),this._zoomOutButton.setAttribute("aria-disabled","false"),(this._disabled||i._zoom===i.getMinZoom())&&(t7(this._zoomOutButton,r),this._zoomOutButton.setAttribute("aria-disabled","true")),(this._disabled||i._zoom===i.getMaxZoom())&&(t7(this._zoomInButton,r),this._zoomInButton.setAttribute("aria-disabled","true"))}});ez.mergeOptions({zoomControl:!0}),ez.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new eO,this.addControl(this.zoomControl))});var eF=eD.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(i){var r="leaflet-control-scale",n=t3("div",r),o=this.options;return this._addScales(o,r+"-line",n),i.on(o.updateWhenIdle?"moveend":"move",this._update,this),i.whenReady(this._update,this),n},onRemove:function(i){i.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(i,r,n){i.metric&&(this._mScale=t3("div",r,n)),i.imperial&&(this._iScale=t3("div",r,n))},_update:function(){var i=this._map,r=i.getSize().y/2,n=i.distance(i.containerPointToLatLng([0,r]),i.containerPointToLatLng([this.options.maxWidth,r]));this._updateScales(n)},_updateScales:function(i){this.options.metric&&i&&this._updateMetric(i),this.options.imperial&&i&&this._updateImperial(i)},_updateMetric:function(i){var r=this._getRoundNum(i),n=r<1e3?r+" m":r/1e3+" km";this._updateScale(this._mScale,n,r/i)},_updateImperial:function(i){var r,n,o,a=3.2808399*i;a>5280?(r=a/5280,n=this._getRoundNum(r),this._updateScale(this._iScale,n+" mi",n/r)):(o=this._getRoundNum(a),this._updateScale(this._iScale,o+" ft",o/a))},_updateScale:function(i,r,n){i.style.width=Math.round(this.options.maxWidth*n)+"px",i.innerHTML=r},_getRoundNum:function(i){var r=Math.pow(10,(Math.floor(i)+"").length-1),n=i/r;return r*(n=n>=10?10:n>=5?5:n>=3?3:n>=2?2:1)}}),eN=eD.extend({options:{position:"bottomright",prefix:'<a href="https://leafletjs.com" title="A JavaScript library for interactive maps">'+(tN.inlineSvg?'<svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="12" height="8" viewBox="0 0 12 8" class="leaflet-attribution-flag"><path fill="#4C7BE1" d="M0 0h12v4H0z"/><path fill="#FFD500" d="M0 4h12v3H0z"/><path fill="#E0BC00" d="M0 7h12v1H0z"/></svg> ':"")+"Leaflet</a>"},initialize:function(i){E(this,i),this._attributions={}},onAdd:function(i){for(var r in i.attributionControl=this,this._container=t3("div","leaflet-control-attribution"),eE(this._container),i._layers)i._layers[r].getAttribution&&this.addAttribution(i._layers[r].getAttribution());return this._update(),i.on("layeradd",this._addAttribution,this),this._container},onRemove:function(i){i.off("layeradd",this._addAttribution,this)},_addAttribution:function(i){i.layer.getAttribution&&(this.addAttribution(i.layer.getAttribution()),i.layer.once("remove",function(){this.removeAttribution(i.layer.getAttribution())},this))},setPrefix:function(i){return this.options.prefix=i,this._update(),this},addAttribution:function(i){return i&&(this._attributions[i]||(this._attributions[i]=0),this._attributions[i]++,this._update()),this},removeAttribution:function(i){return i&&this._attributions[i]&&(this._attributions[i]--,this._update()),this},_update:function(){if(this._map){var i=[];for(var r in this._attributions)this._attributions[r]&&i.push(r);var n=[];this.options.prefix&&n.push(this.options.prefix),i.length&&n.push(i.join(", ")),this._container.innerHTML=n.join(' <span aria-hidden="true">|</span> ')}}});ez.mergeOptions({attributionControl:!0}),ez.addInitHook(function(){this.options.attributionControl&&new eN().addTo(this)}),eD.Layers=eB,eD.Zoom=eO,eD.Scale=eF,eD.Attribution=eN,eR.layers=function(i,r,n){return new eB(i,r,n)},eR.zoom=function(i){return new eO(i)},eR.scale=function(i){return new eF(i)},eR.attribution=function(i){return new eN(i)};var eU=N.extend({initialize:function(i){this._map=i},enable:function(){return this._enabled||(this._enabled=!0,this.addHooks()),this},disable:function(){return this._enabled&&(this._enabled=!1,this.removeHooks()),this},enabled:function(){return!!this._enabled}});eU.addTo=function(i,r){return i.addHandler(r,this),this};var ej=tN.touch?"touchstart mousedown":"mousedown",eZ=j.extend({options:{clickTolerance:3},initialize:function(i,r,n,o){E(this,o),this._element=i,this._dragStartTarget=r||i,this._preventOutline=n},enable:function(){this._enabled||(em(this._dragStartTarget,ej,this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(eZ._dragging===this&&this.finishDrag(!0),e_(this._dragStartTarget,ej,this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(i){if(!(!this._enabled||(this._moved=!1,t9(this._element,"leaflet-zoom-anim")))){if(i.touches&&1!==i.touches.length){eZ._dragging===this&&this.finishDrag();return}if(!eZ._dragging&&!i.shiftKey&&(1===i.which||1===i.button||i.touches)&&(eZ._dragging=this,this._preventOutline&&ec(this._element),eu(),n(),!this._moving)){this.fire("down");var r=i.touches?i.touches[0]:i,o=ep(this._element);this._startPoint=new Z(r.clientX,r.clientY),this._startPos=es(this._element),this._parentScale=ef(o);var a="mousedown"===i.type;em(document,a?"mousemove":"touchmove",this._onMove,this),em(document,a?"mouseup":"touchend touchcancel",this._onUp,this)}}},_onMove:function(i){if(this._enabled){if(i.touches&&i.touches.length>1){this._moved=!0;return}var r=i.touches&&1===i.touches.length?i.touches[0]:i,n=new Z(r.clientX,r.clientY)._subtract(this._startPoint);(n.x||n.y)&&(Math.abs(n.x)+Math.abs(n.y)<this.options.clickTolerance||(n.x/=this._parentScale.x,n.y/=this._parentScale.y,eS(i),this._moved||(this.fire("dragstart"),this._moved=!0,t7(document.body,"leaflet-dragging"),this._lastTarget=i.target||i.srcElement,window.SVGElementInstance&&this._lastTarget instanceof window.SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),t7(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(n),this._moving=!0,this._lastEvent=i,this._updatePosition()))}},_updatePosition:function(){var i={originalEvent:this._lastEvent};this.fire("predrag",i),ea(this._element,this._newPos),this.fire("drag",i)},_onUp:function(){this._enabled&&this.finishDrag()},finishDrag:function(i){et(document.body,"leaflet-dragging"),this._lastTarget&&(et(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null),e_(document,"mousemove touchmove",this._onMove,this),e_(document,"mouseup touchend touchcancel",this._onUp,this),eh(),o();var r=this._moved&&this._moving;this._moving=!1,eZ._dragging=!1,r&&this.fire("dragend",{noInertia:i,distance:this._newPos.distanceTo(this._startPos)})}});function eV(i,r,n){var o,a,s,l,u,h,c,d,p,f=[1,4,2,8];for(a=0,c=i.length;a<c;a++)i[a]._code=eK(i[a],r);for(l=0;l<4;l++){for(a=0,d=f[l],o=[],s=(c=i.length)-1;a<c;s=a++)u=i[a],h=i[s],u._code&d?h._code&d||((p=eX(h,u,d,r,n))._code=eK(p,r),o.push(p)):(h._code&d&&((p=eX(h,u,d,r,n))._code=eK(p,r),o.push(p)),o.push(u));i=o}return i}function eq(i,r){if(!i||0===i.length)throw Error("latlngs not passed");eY(i)||(console.warn("latlngs are not flat! Only the first ring will be used"),i=i[0]);var n,o,a,s,l,u,h,c,d,p=J([0,0]),f=X(i);f.getNorthWest().distanceTo(f.getSouthWest())*f.getNorthEast().distanceTo(f.getNorthWest())<1700&&(p=eG(i));var m=i.length,g=[];for(n=0;n<m;n++){var _=J(i[n]);g.push(r.project(J([_.lat-p.lat,_.lng-p.lng])))}for(n=0,u=h=c=0,o=m-1;n<m;o=n++)a=g[n],s=g[o],l=a.y*s.x-s.y*a.x,h+=(a.x+s.x)*l,c+=(a.y+s.y)*l,u+=3*l;d=0===u?g[0]:[h/u,c/u];var y=r.unproject(q(d));return J([y.lat+p.lat,y.lng+p.lng])}function eG(i){for(var r=0,n=0,o=0,a=0;a<i.length;a++){var s=J(i[a]);r+=s.lat,n+=s.lng,o++}return J([r/o,n/o])}function e$(i,r){if(!r||!i.length)return i.slice();var n=r*r;return i=function(i,r){var n=i.length,o=new("undefined"!=typeof Uint8Array?Uint8Array:Array)(n);o[0]=o[n-1]=1,function i(r,n,o,a,s){var l,u,h,c=0;for(u=a+1;u<=s-1;u++)(h=eJ(r[u],r[a],r[s],!0))>c&&(l=u,c=h);c>o&&(n[l]=1,i(r,n,o,a,l),i(r,n,o,l,s))}(i,o,r,0,n-1);var a,s=[];for(a=0;a<n;a++)o[a]&&s.push(i[a]);return s}(i=function(i,r){for(var n=[i[0]],o=1,a=0,s=i.length;o<s;o++)(function(i,r){var n=r.x-i.x,o=r.y-i.y;return n*n+o*o})(i[o],i[a])>r&&(n.push(i[o]),a=o);return a<s-1&&n.push(i[s-1]),n}(i,n),n)}function eW(i,r,n){return Math.sqrt(eJ(i,r,n,!0))}function eH(i,r,n,o,a){var s,l,h,c=o?u:eK(i,n),d=eK(r,n);for(u=d;;){if(!(c|d))return[i,r];if(c&d)return!1;s=c||d,h=eK(l=eX(i,r,s,n,a),n),s===c?(i=l,c=h):(r=l,d=h)}}function eX(i,r,n,o,a){var s,l,u=r.x-i.x,h=r.y-i.y,c=o.min,d=o.max;return 8&n?(s=i.x+u*(d.y-i.y)/h,l=d.y):4&n?(s=i.x+u*(c.y-i.y)/h,l=c.y):2&n?(s=d.x,l=i.y+h*(d.x-i.x)/u):1&n&&(s=c.x,l=i.y+h*(c.x-i.x)/u),new Z(s,l,a)}function eK(i,r){var n=0;return i.x<r.min.x?n|=1:i.x>r.max.x&&(n|=2),i.y<r.min.y?n|=4:i.y>r.max.y&&(n|=8),n}function eJ(i,r,n,o){var a,s=r.x,l=r.y,u=n.x-s,h=n.y-l,c=u*u+h*h;return c>0&&((a=((i.x-s)*u+(i.y-l)*h)/c)>1?(s=n.x,l=n.y):a>0&&(s+=u*a,l+=h*a)),u=i.x-s,h=i.y-l,o?u*u+h*h:new Z(s,l)}function eY(i){return!A(i[0])||"object"!=typeof i[0][0]&&void 0!==i[0][0]}function eQ(i){return console.warn("Deprecated use of _flat, please use L.LineUtil.isFlat instead."),eY(i)}function e0(i,r){if(!i||0===i.length)throw Error("latlngs not passed");eY(i)||(console.warn("latlngs are not flat! Only the first ring will be used"),i=i[0]);var n,o,a,s,l,u,h,c,d=J([0,0]),p=X(i);p.getNorthWest().distanceTo(p.getSouthWest())*p.getNorthEast().distanceTo(p.getNorthWest())<1700&&(d=eG(i));var f=i.length,m=[];for(n=0;n<f;n++){var g=J(i[n]);m.push(r.project(J([g.lat-d.lat,g.lng-d.lng])))}for(n=0,o=0;n<f-1;n++)o+=m[n].distanceTo(m[n+1])/2;if(0===o)c=m[0];else for(n=0,s=0;n<f-1;n++)if(l=m[n],u=m[n+1],(s+=a=l.distanceTo(u))>o){h=(s-o)/a,c=[u.x-h*(u.x-l.x),u.y-h*(u.y-l.y)];break}var _=r.unproject(q(c));return J([_.lat+d.lat,_.lng+d.lng])}var e1={project:function(i){return new Z(i.lng,i.lat)},unproject:function(i){return new K(i.y,i.x)},bounds:new G([-180,-90],[180,90])},e2={R:6378137,R_MINOR:6356752.314245179,bounds:new G([-20037508.34279,-15496570.73972],[20037508.34279,18764656.23138]),project:function(i){var r=Math.PI/180,n=this.R,o=i.lat*r,a=this.R_MINOR/n,s=Math.sqrt(1-a*a),l=s*Math.sin(o);return o=-n*Math.log(Math.max(Math.tan(Math.PI/4-o/2)/Math.pow((1-l)/(1+l),s/2),1e-10)),new Z(i.lng*r*n,o)},unproject:function(i){for(var r,n=180/Math.PI,o=this.R,a=this.R_MINOR/o,s=Math.sqrt(1-a*a),l=Math.exp(-i.y/o),u=Math.PI/2-2*Math.atan(l),h=0,c=.1;h<15&&Math.abs(c)>1e-7;h++)r=Math.pow((1-(r=s*Math.sin(u)))/(1+r),s/2),c=Math.PI/2-2*Math.atan(l*r)-u,u+=c;return new K(u*n,i.x*n/o)}},e3=r({},Q,{code:"EPSG:3395",projection:e2,transformation:ti(p=.5/(Math.PI*e2.R),.5,-p,.5)}),e5=r({},Q,{code:"EPSG:4326",projection:e1,transformation:ti(1/180,1,-1/180,.5)}),e4=r({},Y,{projection:e1,transformation:ti(1,0,-1,0),scale:function(i){return Math.pow(2,i)},zoom:function(i){return Math.log(i)/Math.LN2},distance:function(i,r){var n=r.lng-i.lng,o=r.lat-i.lat;return Math.sqrt(n*n+o*o)},infinite:!0});Y.Earth=Q,Y.EPSG3395=e3,Y.EPSG3857=tr,Y.EPSG900913=tn,Y.EPSG4326=e5,Y.Simple=e4;var e6=j.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(i){return i.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(i){return i&&i.removeLayer(this),this},getPane:function(i){return this._map.getPane(i?this.options[i]||i:this.options.pane)},addInteractiveTarget:function(i){return this._map._targets[_(i)]=this,this},removeInteractiveTarget:function(i){return delete this._map._targets[_(i)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(i){var r=i.target;if(r.hasLayer(this)){if(this._map=r,this._zoomAnimated=r._zoomAnimated,this.getEvents){var n=this.getEvents();r.on(n,this),this.once("remove",function(){r.off(n,this)},this)}this.onAdd(r),this.fire("add"),r.fire("layeradd",{layer:this})}}});ez.include({addLayer:function(i){if(!i._layerAdd)throw Error("The provided object is not a Layer.");var r=_(i);return this._layers[r]||(this._layers[r]=i,i._mapToAdd=this,i.beforeAdd&&i.beforeAdd(this),this.whenReady(i._layerAdd,i)),this},removeLayer:function(i){var r=_(i);return this._layers[r]&&(this._loaded&&i.onRemove(this),delete this._layers[r],this._loaded&&(this.fire("layerremove",{layer:i}),i.fire("remove")),i._map=i._mapToAdd=null),this},hasLayer:function(i){return _(i) in this._layers},eachLayer:function(i,r){for(var n in this._layers)i.call(r,this._layers[n]);return this},_addLayers:function(i){i=i?A(i)?i:[i]:[];for(var r=0,n=i.length;r<n;r++)this.addLayer(i[r])},_addZoomLimit:function(i){isNaN(i.options.maxZoom)&&isNaN(i.options.minZoom)||(this._zoomBoundLayers[_(i)]=i,this._updateZoomLevels())},_removeZoomLimit:function(i){var r=_(i);this._zoomBoundLayers[r]&&(delete this._zoomBoundLayers[r],this._updateZoomLevels())},_updateZoomLevels:function(){var i=1/0,r=-1/0,n=this._getZoomSpan();for(var o in this._zoomBoundLayers){var a=this._zoomBoundLayers[o].options;i=void 0===a.minZoom?i:Math.min(i,a.minZoom),r=void 0===a.maxZoom?r:Math.max(r,a.maxZoom)}this._layersMaxZoom=r===-1/0?void 0:r,this._layersMinZoom=i===1/0?void 0:i,n!==this._getZoomSpan()&&this.fire("zoomlevelschange"),void 0===this.options.maxZoom&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),void 0===this.options.minZoom&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});var e8=e6.extend({initialize:function(i,r){var n,o;if(E(this,r),this._layers={},i)for(n=0,o=i.length;n<o;n++)this.addLayer(i[n])},addLayer:function(i){var r=this.getLayerId(i);return this._layers[r]=i,this._map&&this._map.addLayer(i),this},removeLayer:function(i){var r=i in this._layers?i:this.getLayerId(i);return this._map&&this._layers[r]&&this._map.removeLayer(this._layers[r]),delete this._layers[r],this},hasLayer:function(i){return("number"==typeof i?i:this.getLayerId(i))in this._layers},clearLayers:function(){return this.eachLayer(this.removeLayer,this)},invoke:function(i){var r,n,o=Array.prototype.slice.call(arguments,1);for(r in this._layers)(n=this._layers[r])[i]&&n[i].apply(n,o);return this},onAdd:function(i){this.eachLayer(i.addLayer,i)},onRemove:function(i){this.eachLayer(i.removeLayer,i)},eachLayer:function(i,r){for(var n in this._layers)i.call(r,this._layers[n]);return this},getLayer:function(i){return this._layers[i]},getLayers:function(){var i=[];return this.eachLayer(i.push,i),i},setZIndex:function(i){return this.invoke("setZIndex",i)},getLayerId:function(i){return _(i)}}),e9=e8.extend({addLayer:function(i){return this.hasLayer(i)?this:(i.addEventParent(this),e8.prototype.addLayer.call(this,i),this.fire("layeradd",{layer:i}))},removeLayer:function(i){return this.hasLayer(i)?(i in this._layers&&(i=this._layers[i]),i.removeEventParent(this),e8.prototype.removeLayer.call(this,i),this.fire("layerremove",{layer:i})):this},setStyle:function(i){return this.invoke("setStyle",i)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var i=new H;for(var r in this._layers){var n=this._layers[r];i.extend(n.getBounds?n.getBounds():n.getLatLng())}return i}}),e7=N.extend({options:{popupAnchor:[0,0],tooltipAnchor:[0,0],crossOrigin:!1},initialize:function(i){E(this,i)},createIcon:function(i){return this._createIcon("icon",i)},createShadow:function(i){return this._createIcon("shadow",i)},_createIcon:function(i,r){var n=this._getIconUrl(i);if(!n){if("icon"===i)throw Error("iconUrl not set in Icon options (see the docs).");return null}var o=this._createImg(n,r&&"IMG"===r.tagName?r:null);return this._setIconStyles(o,i),(this.options.crossOrigin||""===this.options.crossOrigin)&&(o.crossOrigin=!0===this.options.crossOrigin?"":this.options.crossOrigin),o},_setIconStyles:function(i,r){var n=this.options,o=n[r+"Size"];"number"==typeof o&&(o=[o,o]);var a=q(o),s=q("shadow"===r&&n.shadowAnchor||n.iconAnchor||a&&a.divideBy(2,!0));i.className="leaflet-marker-"+r+" "+(n.className||""),s&&(i.style.marginLeft=-s.x+"px",i.style.marginTop=-s.y+"px"),a&&(i.style.width=a.x+"px",i.style.height=a.y+"px")},_createImg:function(i,r){return(r=r||document.createElement("img")).src=i,r},_getIconUrl:function(i){return tN.retina&&this.options[i+"RetinaUrl"]||this.options[i+"Url"]}}),it=e7.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(i){return"string"!=typeof it.imagePath&&(it.imagePath=this._detectIconPath()),(this.options.imagePath||it.imagePath)+e7.prototype._getIconUrl.call(this,i)},_stripUrl:function(i){var r=function(i,r,n){var o=r.exec(i);return o&&o[n]};return(i=r(i,/^url\((['"])?(.+)\1\)$/,2))&&r(i,/^(.*)marker-icon\.png$/,1)},_detectIconPath:function(){var i=t3("div","leaflet-default-icon-path",document.body),r=t2(i,"background-image")||t2(i,"backgroundImage");if(document.body.removeChild(i),r=this._stripUrl(r))return r;var n=document.querySelector('link[href$="leaflet.css"]');return n?n.href.substring(0,n.href.length-11-1):""}}),ie=eU.extend({initialize:function(i){this._marker=i},addHooks:function(){var i=this._marker._icon;this._draggable||(this._draggable=new eZ(i,i,!0)),this._draggable.on({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),t7(i,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&et(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_adjustPan:function(i){var r=this._marker,n=r._map,o=this._marker.options.autoPanSpeed,a=this._marker.options.autoPanPadding,s=es(r._icon),l=n.getPixelBounds(),u=n.getPixelOrigin(),h=W(l.min._subtract(u).add(a),l.max._subtract(u).subtract(a));if(!h.contains(s)){var c=q((Math.max(h.max.x,s.x)-h.max.x)/(l.max.x-h.max.x)-(Math.min(h.min.x,s.x)-h.min.x)/(l.min.x-h.min.x),(Math.max(h.max.y,s.y)-h.max.y)/(l.max.y-h.max.y)-(Math.min(h.min.y,s.y)-h.min.y)/(l.min.y-h.min.y)).multiplyBy(o);n.panBy(c,{animate:!1}),this._draggable._newPos._add(c),this._draggable._startPos._add(c),ea(r._icon,this._draggable._newPos),this._onDrag(i),this._panRequest=O(this._adjustPan.bind(this,i))}},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup&&this._marker.closePopup(),this._marker.fire("movestart").fire("dragstart")},_onPreDrag:function(i){this._marker.options.autoPan&&(F(this._panRequest),this._panRequest=O(this._adjustPan.bind(this,i)))},_onDrag:function(i){var r=this._marker,n=r._shadow,o=es(r._icon),a=r._map.layerPointToLatLng(o);n&&ea(n,o),r._latlng=a,i.latlng=a,i.oldLatLng=this._oldLatLng,r.fire("move",i).fire("drag",i)},_onDragEnd:function(i){F(this._panRequest),delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",i)}}),ii=e6.extend({options:{icon:new it,interactive:!0,keyboard:!0,title:"",alt:"Marker",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",shadowPane:"shadowPane",bubblingMouseEvents:!1,autoPanOnFocus:!0,draggable:!1,autoPan:!1,autoPanPadding:[50,50],autoPanSpeed:10},initialize:function(i,r){E(this,r),this._latlng=J(i)},onAdd:function(i){this._zoomAnimated=this._zoomAnimated&&i.options.markerZoomAnimation,this._zoomAnimated&&i.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(i){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),delete this.dragging,this._zoomAnimated&&i.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(i){var r=this._latlng;return this._latlng=J(i),this.update(),this.fire("move",{oldLatLng:r,latlng:this._latlng})},setZIndexOffset:function(i){return this.options.zIndexOffset=i,this.update()},getIcon:function(){return this.options.icon},setIcon:function(i){return this.options.icon=i,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon&&this._map){var i=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(i)}return this},_initIcon:function(){var i=this.options,r="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),n=i.icon.createIcon(this._icon),o=!1;n!==this._icon&&(this._icon&&this._removeIcon(),o=!0,i.title&&(n.title=i.title),"IMG"===n.tagName&&(n.alt=i.alt||"")),t7(n,r),i.keyboard&&(n.tabIndex="0",n.setAttribute("role","button")),this._icon=n,i.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&em(n,"focus",this._panOnFocus,this);var a=i.icon.createShadow(this._shadow),s=!1;a!==this._shadow&&(this._removeShadow(),s=!0),a&&(t7(a,r),a.alt=""),this._shadow=a,i.opacity<1&&this._updateOpacity(),o&&this.getPane().appendChild(this._icon),this._initInteraction(),a&&s&&this.getPane(i.shadowPane).appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&e_(this._icon,"focus",this._panOnFocus,this),t5(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&t5(this._shadow),this._shadow=null},_setPos:function(i){this._icon&&ea(this._icon,i),this._shadow&&ea(this._shadow,i),this._zIndex=i.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(i){this._icon&&(this._icon.style.zIndex=this._zIndex+i)},_animateZoom:function(i){var r=this._map._latLngToNewLayerPoint(this._latlng,i.zoom,i.center).round();this._setPos(r)},_initInteraction:function(){if(this.options.interactive&&(t7(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),ie)){var i=this.options.draggable;this.dragging&&(i=this.dragging.enabled(),this.dragging.disable()),this.dragging=new ie(this),i&&this.dragging.enable()}},setOpacity:function(i){return this.options.opacity=i,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var i=this.options.opacity;this._icon&&er(this._icon,i),this._shadow&&er(this._shadow,i)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_panOnFocus:function(){var i=this._map;if(i){var r=this.options.icon.options,n=r.iconSize?q(r.iconSize):q(0,0),o=r.iconAnchor?q(r.iconAnchor):q(0,0);i.panInside(this._latlng,{paddingTopLeft:o,paddingBottomRight:n.subtract(o)})}},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor}}),ir=e6.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(i){this._renderer=i.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(i){return E(this,i),this._renderer&&(this._renderer._updateStyle(this),this.options.stroke&&i&&Object.prototype.hasOwnProperty.call(i,"weight")&&this._updateBounds()),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+(this._renderer.options.tolerance||0)}}),io=ir.extend({options:{fill:!0,radius:10},initialize:function(i,r){E(this,r),this._latlng=J(i),this._radius=this.options.radius},setLatLng:function(i){var r=this._latlng;return this._latlng=J(i),this.redraw(),this.fire("move",{oldLatLng:r,latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(i){return this.options.radius=this._radius=i,this.redraw()},getRadius:function(){return this._radius},setStyle:function(i){var r=i&&i.radius||this._radius;return ir.prototype.setStyle.call(this,i),this.setRadius(r),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var i=this._radius,r=this._radiusY||i,n=this._clickTolerance(),o=[i+n,r+n];this._pxBounds=new G(this._point.subtract(o),this._point.add(o))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(i){return i.distanceTo(this._point)<=this._radius+this._clickTolerance()}}),ia=io.extend({initialize:function(i,n,o){if("number"==typeof n&&(n=r({},o,{radius:n})),E(this,n),this._latlng=J(i),isNaN(this.options.radius))throw Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(i){return this._mRadius=i,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var i=[this._radius,this._radiusY||this._radius];return new H(this._map.layerPointToLatLng(this._point.subtract(i)),this._map.layerPointToLatLng(this._point.add(i)))},setStyle:ir.prototype.setStyle,_project:function(){var i=this._latlng.lng,r=this._latlng.lat,n=this._map,o=n.options.crs;if(o.distance===Q.distance){var a=Math.PI/180,s=this._mRadius/Q.R/a,l=n.project([r+s,i]),u=n.project([r-s,i]),h=l.add(u).divideBy(2),c=n.unproject(h).lat,d=Math.acos((Math.cos(s*a)-Math.sin(r*a)*Math.sin(c*a))/(Math.cos(r*a)*Math.cos(c*a)))/a;(isNaN(d)||0===d)&&(d=s/Math.cos(Math.PI/180*r)),this._point=h.subtract(n.getPixelOrigin()),this._radius=isNaN(d)?0:h.x-n.project([c,i-d]).x,this._radiusY=h.y-l.y}else{var p=o.unproject(o.project(this._latlng).subtract([this._mRadius,0]));this._point=n.latLngToLayerPoint(this._latlng),this._radius=this._point.x-n.latLngToLayerPoint(p).x}this._updateBounds()}}),is=ir.extend({options:{smoothFactor:1,noClip:!1},initialize:function(i,r){E(this,r),this._setLatLngs(i)},getLatLngs:function(){return this._latlngs},setLatLngs:function(i){return this._setLatLngs(i),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(i){for(var r,n,o=1/0,a=null,s=eJ,l=0,u=this._parts.length;l<u;l++)for(var h=this._parts[l],c=1,d=h.length;c<d;c++){var p=s(i,r=h[c-1],n=h[c],!0);p<o&&(o=p,a=s(i,r,n))}return a&&(a.distance=Math.sqrt(o)),a},getCenter:function(){if(!this._map)throw Error("Must add layer to map before using getCenter()");return e0(this._defaultShape(),this._map.options.crs)},getBounds:function(){return this._bounds},addLatLng:function(i,r){return r=r||this._defaultShape(),i=J(i),r.push(i),this._bounds.extend(i),this.redraw()},_setLatLngs:function(i){this._bounds=new H,this._latlngs=this._convertLatLngs(i)},_defaultShape:function(){return eY(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(i){for(var r=[],n=eY(i),o=0,a=i.length;o<a;o++)n?(r[o]=J(i[o]),this._bounds.extend(r[o])):r[o]=this._convertLatLngs(i[o]);return r},_project:function(){var i=new G;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,i),this._bounds.isValid()&&i.isValid()&&(this._rawPxBounds=i,this._updateBounds())},_updateBounds:function(){var i=this._clickTolerance(),r=new Z(i,i);this._rawPxBounds&&(this._pxBounds=new G([this._rawPxBounds.min.subtract(r),this._rawPxBounds.max.add(r)]))},_projectLatlngs:function(i,r,n){var o,a,s=i[0]instanceof K,l=i.length;if(s){for(o=0,a=[];o<l;o++)a[o]=this._map.latLngToLayerPoint(i[o]),n.extend(a[o]);r.push(a)}else for(o=0;o<l;o++)this._projectLatlngs(i[o],r,n)},_clipPoints:function(){var i=this._renderer._bounds;if(this._parts=[],this._pxBounds&&this._pxBounds.intersects(i)){if(this.options.noClip){this._parts=this._rings;return}var r,n,o,a,s,l,u,h=this._parts;for(r=0,o=0,a=this._rings.length;r<a;r++)for(n=0,s=(u=this._rings[r]).length;n<s-1;n++)(l=eH(u[n],u[n+1],i,n,!0))&&(h[o]=h[o]||[],h[o].push(l[0]),(l[1]!==u[n+1]||n===s-2)&&(h[o].push(l[1]),o++))}},_simplifyPoints:function(){for(var i=this._parts,r=this.options.smoothFactor,n=0,o=i.length;n<o;n++)i[n]=e$(i[n],r)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)},_containsPoint:function(i,r){var n,o,a,s,l,u,h=this._clickTolerance();if(!this._pxBounds||!this._pxBounds.contains(i))return!1;for(n=0,s=this._parts.length;n<s;n++)for(o=0,a=(l=(u=this._parts[n]).length)-1;o<l;a=o++)if((r||0!==o)&&eW(i,u[a],u[o])<=h)return!0;return!1}});is._flat=eQ;var il=is.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw Error("Must add layer to map before using getCenter()");return eq(this._defaultShape(),this._map.options.crs)},_convertLatLngs:function(i){var r=is.prototype._convertLatLngs.call(this,i),n=r.length;return n>=2&&r[0]instanceof K&&r[0].equals(r[n-1])&&r.pop(),r},_setLatLngs:function(i){is.prototype._setLatLngs.call(this,i),eY(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return eY(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var i=this._renderer._bounds,r=this.options.weight,n=new Z(r,r);if(i=new G(i.min.subtract(n),i.max.add(n)),this._parts=[],this._pxBounds&&this._pxBounds.intersects(i)){if(this.options.noClip){this._parts=this._rings;return}for(var o,a=0,s=this._rings.length;a<s;a++)(o=eV(this._rings[a],i,!0)).length&&this._parts.push(o)}},_updatePath:function(){this._renderer._updatePoly(this,!0)},_containsPoint:function(i){var r,n,o,a,s,l,u,h,c=!1;if(!this._pxBounds||!this._pxBounds.contains(i))return!1;for(a=0,u=this._parts.length;a<u;a++)for(s=0,l=(h=(r=this._parts[a]).length)-1;s<h;l=s++)n=r[s],o=r[l],n.y>i.y!=o.y>i.y&&i.x<(o.x-n.x)*(i.y-n.y)/(o.y-n.y)+n.x&&(c=!c);return c||is.prototype._containsPoint.call(this,i,!0)}}),iu=e9.extend({initialize:function(i,r){E(this,r),this._layers={},i&&this.addData(i)},addData:function(i){var r,n,o,a=A(i)?i:i.features;if(a){for(r=0,n=a.length;r<n;r++)((o=a[r]).geometries||o.geometry||o.features||o.coordinates)&&this.addData(o);return this}var s=this.options;if(s.filter&&!s.filter(i))return this;var l=ih(i,s);return l?(l.feature=iy(i),l.defaultOptions=l.options,this.resetStyle(l),s.onEachFeature&&s.onEachFeature(i,l),this.addLayer(l)):this},resetStyle:function(i){return void 0===i?this.eachLayer(this.resetStyle,this):(i.options=r({},i.defaultOptions),this._setLayerStyle(i,this.options.style),this)},setStyle:function(i){return this.eachLayer(function(r){this._setLayerStyle(r,i)},this)},_setLayerStyle:function(i,r){i.setStyle&&("function"==typeof r&&(r=r(i.feature)),i.setStyle(r))}});function ih(i,r){var n,o,a,s,l="Feature"===i.type?i.geometry:i,u=l?l.coordinates:null,h=[],c=r&&r.pointToLayer,d=r&&r.coordsToLatLng||id;if(!u&&!l)return null;switch(l.type){case"Point":return ic(c,i,n=d(u),r);case"MultiPoint":for(a=0,s=u.length;a<s;a++)n=d(u[a]),h.push(ic(c,i,n,r));return new e9(h);case"LineString":case"MultiLineString":return o=ip(u,"LineString"===l.type?0:1,d),new is(o,r);case"Polygon":case"MultiPolygon":return o=ip(u,"Polygon"===l.type?1:2,d),new il(o,r);case"GeometryCollection":for(a=0,s=l.geometries.length;a<s;a++){var p=ih({geometry:l.geometries[a],type:"Feature",properties:i.properties},r);p&&h.push(p)}return new e9(h);case"FeatureCollection":for(a=0,s=l.features.length;a<s;a++){var f=ih(l.features[a],r);f&&h.push(f)}return new e9(h);default:throw Error("Invalid GeoJSON object.")}}function ic(i,r,n,o){return i?i(r,n):new ii(n,o&&o.markersInheritOptions&&o)}function id(i){return new K(i[1],i[0],i[2])}function ip(i,r,n){for(var o=[],a=0,s=i.length;a<s;a++)o.push(r?ip(i[a],r-1,n):(n||id)(i[a]));return o}function im(i,r){return void 0!==(i=J(i)).alt?[b(i.lng,r),b(i.lat,r),b(i.alt,r)]:[b(i.lng,r),b(i.lat,r)]}function ig(i,r,n,o){for(var a=[],s=0,l=i.length;s<l;s++)a.push(r?ig(i[s],eY(i[s])?0:r-1,n,o):im(i[s],o));return!r&&n&&a.length>0&&a.push(a[0].slice()),a}function i_(i,n){return i.feature?r({},i.feature,{geometry:n}):iy(n)}function iy(i){return"Feature"===i.type||"FeatureCollection"===i.type?i:{type:"Feature",properties:{},geometry:i}}var iv={toGeoJSON:function(i){return i_(this,{type:"Point",coordinates:im(this.getLatLng(),i)})}};function ix(i,r){return new iu(i,r)}ii.include(iv),ia.include(iv),io.include(iv),is.include({toGeoJSON:function(i){var r=!eY(this._latlngs),n=ig(this._latlngs,r?1:0,!1,i);return i_(this,{type:(r?"Multi":"")+"LineString",coordinates:n})}}),il.include({toGeoJSON:function(i){var r=!eY(this._latlngs),n=r&&!eY(this._latlngs[0]),o=ig(this._latlngs,n?2:r?1:0,!0,i);return r||(o=[o]),i_(this,{type:(n?"Multi":"")+"Polygon",coordinates:o})}}),e8.include({toMultiPoint:function(i){var r=[];return this.eachLayer(function(n){r.push(n.toGeoJSON(i).geometry.coordinates)}),i_(this,{type:"MultiPoint",coordinates:r})},toGeoJSON:function(i){var r=this.feature&&this.feature.geometry&&this.feature.geometry.type;if("MultiPoint"===r)return this.toMultiPoint(i);var n="GeometryCollection"===r,o=[];return(this.eachLayer(function(r){if(r.toGeoJSON){var a=r.toGeoJSON(i);if(n)o.push(a.geometry);else{var s=iy(a);"FeatureCollection"===s.type?o.push.apply(o,s.features):o.push(s)}}}),n)?i_(this,{geometries:o,type:"GeometryCollection"}):{type:"FeatureCollection",features:o}}});var ib=e6.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:function(i,r,n){this._url=i,this._bounds=X(r),E(this,n)},onAdd:function(){!this._image&&(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(t7(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){t5(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(i){return this.options.opacity=i,this._image&&this._updateOpacity(),this},setStyle:function(i){return i.opacity&&this.setOpacity(i.opacity),this},bringToFront:function(){return this._map&&t6(this._image),this},bringToBack:function(){return this._map&&t8(this._image),this},setUrl:function(i){return this._url=i,this._image&&(this._image.src=i),this},setBounds:function(i){return this._bounds=X(i),this._map&&this._reset(),this},getEvents:function(){var i={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(i.zoomanim=this._animateZoom),i},setZIndex:function(i){return this.options.zIndex=i,this._updateZIndex(),this},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var i="IMG"===this._url.tagName,r=this._image=i?this._url:t3("img");if(t7(r,"leaflet-image-layer"),this._zoomAnimated&&t7(r,"leaflet-zoom-animated"),this.options.className&&t7(r,this.options.className),r.onselectstart=x,r.onmousemove=x,r.onload=m(this.fire,this,"load"),r.onerror=m(this._overlayOnError,this,"error"),(this.options.crossOrigin||""===this.options.crossOrigin)&&(r.crossOrigin=!0===this.options.crossOrigin?"":this.options.crossOrigin),this.options.zIndex&&this._updateZIndex(),i){this._url=r.src;return}r.src=this._url,r.alt=this.options.alt},_animateZoom:function(i){var r=this._map.getZoomScale(i.zoom),n=this._map._latLngBoundsToNewLayerBounds(this._bounds,i.zoom,i.center).min;eo(this._image,n,r)},_reset:function(){var i=this._image,r=new G(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),n=r.getSize();ea(i,r.min),i.style.width=n.x+"px",i.style.height=n.y+"px"},_updateOpacity:function(){er(this._image,this.options.opacity)},_updateZIndex:function(){this._image&&void 0!==this.options.zIndex&&null!==this.options.zIndex&&(this._image.style.zIndex=this.options.zIndex)},_overlayOnError:function(){this.fire("error");var i=this.options.errorOverlayUrl;i&&this._url!==i&&(this._url=i,this._image.src=i)},getCenter:function(){return this._bounds.getCenter()}}),iw=ib.extend({options:{autoplay:!0,loop:!0,keepAspectRatio:!0,muted:!1,playsInline:!0},_initImage:function(){var i="VIDEO"===this._url.tagName,r=this._image=i?this._url:t3("video");if(t7(r,"leaflet-image-layer"),this._zoomAnimated&&t7(r,"leaflet-zoom-animated"),this.options.className&&t7(r,this.options.className),r.onselectstart=x,r.onmousemove=x,r.onloadeddata=m(this.fire,this,"load"),i){for(var n=r.getElementsByTagName("source"),o=[],a=0;a<n.length;a++)o.push(n[a].src);this._url=n.length>0?o:[r.src];return}A(this._url)||(this._url=[this._url]),!this.options.keepAspectRatio&&Object.prototype.hasOwnProperty.call(r.style,"objectFit")&&(r.style.objectFit="fill"),r.autoplay=!!this.options.autoplay,r.loop=!!this.options.loop,r.muted=!!this.options.muted,r.playsInline=!!this.options.playsInline;for(var s=0;s<this._url.length;s++){var l=t3("source");l.src=this._url[s],r.appendChild(l)}}}),iT=ib.extend({_initImage:function(){var i=this._image=this._url;t7(i,"leaflet-image-layer"),this._zoomAnimated&&t7(i,"leaflet-zoom-animated"),this.options.className&&t7(i,this.options.className),i.onselectstart=x,i.onmousemove=x}}),iE=e6.extend({options:{interactive:!1,offset:[0,0],className:"",pane:void 0,content:""},initialize:function(i,r){i&&(i instanceof K||A(i))?(this._latlng=J(i),E(this,r)):(E(this,i),this._source=r),this.options.content&&(this._content=this.options.content)},openOn:function(i){return i=arguments.length?i:this._source._map,i.hasLayer(this)||i.addLayer(this),this},close:function(){return this._map&&this._map.removeLayer(this),this},toggle:function(i){return this._map?this.close():(arguments.length?this._source=i:i=this._source,this._prepareOpen(),this.openOn(i._map)),this},onAdd:function(i){this._zoomAnimated=i._zoomAnimated,this._container||this._initLayout(),i._fadeAnimated&&er(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),i._fadeAnimated&&er(this._container,1),this.bringToFront(),this.options.interactive&&(t7(this._container,"leaflet-interactive"),this.addInteractiveTarget(this._container))},onRemove:function(i){i._fadeAnimated?(er(this._container,0),this._removeTimeout=setTimeout(m(t5,void 0,this._container),200)):t5(this._container),this.options.interactive&&(et(this._container,"leaflet-interactive"),this.removeInteractiveTarget(this._container))},getLatLng:function(){return this._latlng},setLatLng:function(i){return this._latlng=J(i),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(i){return this._content=i,this.update(),this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var i={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(i.zoomanim=this._animateZoom),i},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&t6(this._container),this},bringToBack:function(){return this._map&&t8(this._container),this},_prepareOpen:function(i){var r=this._source;if(!r._map)return!1;if(r instanceof e9){r=null;var n=this._source._layers;for(var o in n)if(n[o]._map){r=n[o];break}if(!r)return!1;this._source=r}if(!i){if(r.getCenter)i=r.getCenter();else if(r.getLatLng)i=r.getLatLng();else if(r.getBounds)i=r.getBounds().getCenter();else throw Error("Unable to get source layer LatLng.")}return this.setLatLng(i),this._map&&this.update(),!0},_updateContent:function(){if(this._content){var i=this._contentNode,r="function"==typeof this._content?this._content(this._source||this):this._content;if("string"==typeof r)i.innerHTML=r;else{for(;i.hasChildNodes();)i.removeChild(i.firstChild);i.appendChild(r)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var i=this._map.latLngToLayerPoint(this._latlng),r=q(this.options.offset),n=this._getAnchor();this._zoomAnimated?ea(this._container,i.add(n)):r=r.add(i).add(n);var o=this._containerBottom=-r.y,a=this._containerLeft=-Math.round(this._containerWidth/2)+r.x;this._container.style.bottom=o+"px",this._container.style.left=a+"px"}},_getAnchor:function(){return[0,0]}});ez.include({_initOverlay:function(i,r,n,o){var a=r;return a instanceof i||(a=new i(o).setContent(r)),n&&a.setLatLng(n),a}}),e6.include({_initOverlay:function(i,r,n,o){var a=n;return a instanceof i?(E(a,o),a._source=this):(a=r&&!o?r:new i(o,this)).setContent(n),a}});var iS=iE.extend({options:{pane:"popupPane",offset:[0,7],maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,closeOnEscapeKey:!0,className:""},openOn:function(i){return i=arguments.length?i:this._source._map,!i.hasLayer(this)&&i._popup&&i._popup.options.autoClose&&i.removeLayer(i._popup),i._popup=this,iE.prototype.openOn.call(this,i)},onAdd:function(i){iE.prototype.onAdd.call(this,i),i.fire("popupopen",{popup:this}),!this._source||(this._source.fire("popupopen",{popup:this},!0),this._source instanceof ir||this._source.on("preclick",ew))},onRemove:function(i){iE.prototype.onRemove.call(this,i),i.fire("popupclose",{popup:this}),!this._source||(this._source.fire("popupclose",{popup:this},!0),this._source instanceof ir||this._source.off("preclick",ew))},getEvents:function(){var i=iE.prototype.getEvents.call(this);return(void 0!==this.options.closeOnClick?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(i.preclick=this.close),this.options.keepInView&&(i.moveend=this._adjustPan),i},_initLayout:function(){var i="leaflet-popup",r=this._container=t3("div",i+" "+(this.options.className||"")+" leaflet-zoom-animated"),n=this._wrapper=t3("div",i+"-content-wrapper",r);if(this._contentNode=t3("div",i+"-content",n),eE(r),eT(this._contentNode),em(r,"contextmenu",ew),this._tipContainer=t3("div",i+"-tip-container",r),this._tip=t3("div",i+"-tip",this._tipContainer),this.options.closeButton){var o=this._closeButton=t3("a",i+"-close-button",r);o.setAttribute("role","button"),o.setAttribute("aria-label","Close popup"),o.href="#close",o.innerHTML='<span aria-hidden="true">&#215;</span>',em(o,"click",function(i){eS(i),this.close()},this)}},_updateLayout:function(){var i=this._contentNode,r=i.style;r.width="",r.whiteSpace="nowrap";var n=i.offsetWidth;n=Math.max(n=Math.min(n,this.options.maxWidth),this.options.minWidth),r.width=n+1+"px",r.whiteSpace="",r.height="";var o=i.offsetHeight,a=this.options.maxHeight,s="leaflet-popup-scrolled";a&&o>a?(r.height=a+"px",t7(i,s)):et(i,s),this._containerWidth=this._container.offsetWidth},_animateZoom:function(i){var r=this._map._latLngToNewLayerPoint(this._latlng,i.zoom,i.center),n=this._getAnchor();ea(this._container,r.add(n))},_adjustPan:function(){if(this.options.autoPan){if(this._map._panAnim&&this._map._panAnim.stop(),this._autopanning){this._autopanning=!1;return}var i=this._map,r=parseInt(t2(this._container,"marginBottom"),10)||0,n=this._container.offsetHeight+r,o=this._containerWidth,a=new Z(this._containerLeft,-n-this._containerBottom);a._add(es(this._container));var s=i.layerPointToContainerPoint(a),l=q(this.options.autoPanPadding),u=q(this.options.autoPanPaddingTopLeft||l),h=q(this.options.autoPanPaddingBottomRight||l),c=i.getSize(),d=0,p=0;s.x+o+h.x>c.x&&(d=s.x+o-c.x+h.x),s.x-d-u.x<0&&(d=s.x-u.x),s.y+n+h.y>c.y&&(p=s.y+n-c.y+h.y),s.y-p-u.y<0&&(p=s.y-u.y),(d||p)&&(this.options.keepInView&&(this._autopanning=!0),i.fire("autopanstart").panBy([d,p]))}},_getAnchor:function(){return q(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}});ez.mergeOptions({closePopupOnClick:!0}),ez.include({openPopup:function(i,r,n){return this._initOverlay(iS,i,r,n).openOn(this),this},closePopup:function(i){return i=arguments.length?i:this._popup,i&&i.close(),this}}),e6.include({bindPopup:function(i,r){return this._popup=this._initOverlay(iS,this._popup,i,r),this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(i){return this._popup&&(this instanceof e9||(this._popup._source=this),this._popup._prepareOpen(i||this._latlng)&&this._popup.openOn(this._map)),this},closePopup:function(){return this._popup&&this._popup.close(),this},togglePopup:function(){return this._popup&&this._popup.toggle(this),this},isPopupOpen:function(){return!!this._popup&&this._popup.isOpen()},setPopupContent:function(i){return this._popup&&this._popup.setContent(i),this},getPopup:function(){return this._popup},_openPopup:function(i){if(this._popup&&this._map){eC(i);var r=i.layer||i.target;if(this._popup._source===r&&!(r instanceof ir)){this._map.hasLayer(this._popup)?this.closePopup():this.openPopup(i.latlng);return}this._popup._source=r,this.openPopup(i.latlng)}},_movePopup:function(i){this._popup.setLatLng(i.latlng)},_onKeyPress:function(i){13===i.originalEvent.keyCode&&this._openPopup(i)}});var iC=iE.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,opacity:.9},onAdd:function(i){iE.prototype.onAdd.call(this,i),this.setOpacity(this.options.opacity),i.fire("tooltipopen",{tooltip:this}),this._source&&(this.addEventParent(this._source),this._source.fire("tooltipopen",{tooltip:this},!0))},onRemove:function(i){iE.prototype.onRemove.call(this,i),i.fire("tooltipclose",{tooltip:this}),this._source&&(this.removeEventParent(this._source),this._source.fire("tooltipclose",{tooltip:this},!0))},getEvents:function(){var i=iE.prototype.getEvents.call(this);return this.options.permanent||(i.preclick=this.close),i},_initLayout:function(){var i="leaflet-tooltip "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide");this._contentNode=this._container=t3("div",i),this._container.setAttribute("role","tooltip"),this._container.setAttribute("id","leaflet-tooltip-"+_(this))},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(i){var r,n,o=this._map,a=this._container,s=o.latLngToContainerPoint(o.getCenter()),l=o.layerPointToContainerPoint(i),u=this.options.direction,h=a.offsetWidth,c=a.offsetHeight,d=q(this.options.offset),p=this._getAnchor();"top"===u?(r=h/2,n=c):"bottom"===u?(r=h/2,n=0):("center"===u?r=h/2:"right"===u?r=0:"left"===u?r=h:l.x<s.x?(u="right",r=0):(u="left",r=h+(d.x+p.x)*2),n=c/2),i=i.subtract(q(r,n,!0)).add(d).add(p),et(a,"leaflet-tooltip-right"),et(a,"leaflet-tooltip-left"),et(a,"leaflet-tooltip-top"),et(a,"leaflet-tooltip-bottom"),t7(a,"leaflet-tooltip-"+u),ea(a,i)},_updatePosition:function(){var i=this._map.latLngToLayerPoint(this._latlng);this._setPosition(i)},setOpacity:function(i){this.options.opacity=i,this._container&&er(this._container,i)},_animateZoom:function(i){var r=this._map._latLngToNewLayerPoint(this._latlng,i.zoom,i.center);this._setPosition(r)},_getAnchor:function(){return q(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}});ez.include({openTooltip:function(i,r,n){return this._initOverlay(iC,i,r,n).openOn(this),this},closeTooltip:function(i){return i.close(),this}}),e6.include({bindTooltip:function(i,r){return this._tooltip&&this.isTooltipOpen()&&this.unbindTooltip(),this._tooltip=this._initOverlay(iC,this._tooltip,i,r),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(i){if(i||!this._tooltipHandlersAdded){var r={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?r.add=this._openTooltip:(r.mouseover=this._openTooltip,r.mouseout=this.closeTooltip,r.click=this._openTooltip,this._map?this._addFocusListeners():r.add=this._addFocusListeners),this._tooltip.options.sticky&&(r.mousemove=this._moveTooltip),this[i?"off":"on"](r),this._tooltipHandlersAdded=!i}},openTooltip:function(i){return this._tooltip&&(this instanceof e9||(this._tooltip._source=this),this._tooltip._prepareOpen(i)&&(this._tooltip.openOn(this._map),this.getElement?this._setAriaDescribedByOnLayer(this):this.eachLayer&&this.eachLayer(this._setAriaDescribedByOnLayer,this))),this},closeTooltip:function(){if(this._tooltip)return this._tooltip.close()},toggleTooltip:function(){return this._tooltip&&this._tooltip.toggle(this),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(i){return this._tooltip&&this._tooltip.setContent(i),this},getTooltip:function(){return this._tooltip},_addFocusListeners:function(){this.getElement?this._addFocusListenersOnLayer(this):this.eachLayer&&this.eachLayer(this._addFocusListenersOnLayer,this)},_addFocusListenersOnLayer:function(i){var r="function"==typeof i.getElement&&i.getElement();r&&(em(r,"focus",function(){this._tooltip._source=i,this.openTooltip()},this),em(r,"blur",this.closeTooltip,this))},_setAriaDescribedByOnLayer:function(i){var r="function"==typeof i.getElement&&i.getElement();r&&r.setAttribute("aria-describedby",this._tooltip._container.id)},_openTooltip:function(i){if(this._tooltip&&this._map){if(this._map.dragging&&this._map.dragging.moving()&&!this._openOnceFlag){this._openOnceFlag=!0;var r=this;this._map.once("moveend",function(){r._openOnceFlag=!1,r._openTooltip(i)});return}this._tooltip._source=i.layer||i.target,this.openTooltip(this._tooltip.options.sticky?i.latlng:void 0)}},_moveTooltip:function(i){var r,n,o=i.latlng;this._tooltip.options.sticky&&i.originalEvent&&(r=this._map.mouseEventToContainerPoint(i.originalEvent),n=this._map.containerPointToLayerPoint(r),o=this._map.layerPointToLatLng(n)),this._tooltip.setLatLng(o)}});var iI=e7.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(i){var r=i&&"DIV"===i.tagName?i:document.createElement("div"),n=this.options;if(n.html instanceof Element?(t4(r),r.appendChild(n.html)):r.innerHTML=!1!==n.html?n.html:"",n.bgPos){var o=q(n.bgPos);r.style.backgroundPosition=-o.x+"px "+-o.y+"px"}return this._setIconStyles(r,"icon"),r},createShadow:function(){return null}});e7.Default=it;var iA=e6.extend({options:{tileSize:256,opacity:1,updateWhenIdle:tN.mobile,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:void 0,maxNativeZoom:void 0,minNativeZoom:void 0,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(i){E(this,i)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView()},beforeAdd:function(i){i._addZoomLimit(this)},onRemove:function(i){this._removeAllTiles(),t5(this._container),i._removeZoomLimit(this),this._container=null,this._tileZoom=void 0},bringToFront:function(){return this._map&&(t6(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(t8(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(i){return this.options.opacity=i,this._updateOpacity(),this},setZIndex:function(i){return this.options.zIndex=i,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){if(this._map){this._removeAllTiles();var i=this._clampZoom(this._map.getZoom());i!==this._tileZoom&&(this._tileZoom=i,this._updateLevels()),this._update()}return this},getEvents:function(){var i={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=y(this._onMoveEnd,this.options.updateInterval,this)),i.move=this._onMove),this._zoomAnimated&&(i.zoomanim=this._animateZoom),i},createTile:function(){return document.createElement("div")},getTileSize:function(){var i=this.options.tileSize;return i instanceof Z?i:new Z(i,i)},_updateZIndex:function(){this._container&&void 0!==this.options.zIndex&&null!==this.options.zIndex&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(i){for(var r,n=this.getPane().children,o=-i(-1/0,1/0),a=0,s=n.length;a<s;a++)r=n[a].style.zIndex,n[a]!==this._container&&r&&(o=i(o,+r));isFinite(o)&&(this.options.zIndex=o+i(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!tN.ielt9){er(this._container,this.options.opacity);var i=+new Date,r=!1,n=!1;for(var o in this._tiles){var a=this._tiles[o];if(a.current&&a.loaded){var s=Math.min(1,(i-a.loaded)/200);er(a.el,s),s<1?r=!0:(a.active?n=!0:this._onOpaqueTile(a),a.active=!0)}}n&&!this._noPrune&&this._pruneTiles(),r&&(F(this._fadeFrame),this._fadeFrame=O(this._updateOpacity,this))}},_onOpaqueTile:x,_initContainer:function(){this._container||(this._container=t3("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var i=this._tileZoom,r=this.options.maxZoom;if(void 0!==i){for(var n in this._levels)n=Number(n),this._levels[n].el.children.length||n===i?(this._levels[n].el.style.zIndex=r-Math.abs(i-n),this._onUpdateLevel(n)):(t5(this._levels[n].el),this._removeTilesAtZoom(n),this._onRemoveLevel(n),delete this._levels[n]);var o=this._levels[i],a=this._map;return o||((o=this._levels[i]={}).el=t3("div","leaflet-tile-container leaflet-zoom-animated",this._container),o.el.style.zIndex=r,o.origin=a.project(a.unproject(a.getPixelOrigin()),i).round(),o.zoom=i,this._setZoomTransform(o,a.getCenter(),a.getZoom()),x(o.el.offsetWidth),this._onCreateLevel(o)),this._level=o,o}},_onUpdateLevel:x,_onRemoveLevel:x,_onCreateLevel:x,_pruneTiles:function(){if(this._map){var i,r,n=this._map.getZoom();if(n>this.options.maxZoom||n<this.options.minZoom){this._removeAllTiles();return}for(i in this._tiles)(r=this._tiles[i]).retain=r.current;for(i in this._tiles)if((r=this._tiles[i]).current&&!r.active){var o=r.coords;this._retainParent(o.x,o.y,o.z,o.z-5)||this._retainChildren(o.x,o.y,o.z,o.z+2)}for(i in this._tiles)this._tiles[i].retain||this._removeTile(i)}},_removeTilesAtZoom:function(i){for(var r in this._tiles)this._tiles[r].coords.z===i&&this._removeTile(r)},_removeAllTiles:function(){for(var i in this._tiles)this._removeTile(i)},_invalidateAll:function(){for(var i in this._levels)t5(this._levels[i].el),this._onRemoveLevel(Number(i)),delete this._levels[i];this._removeAllTiles(),this._tileZoom=void 0},_retainParent:function(i,r,n,o){var a=Math.floor(i/2),s=Math.floor(r/2),l=n-1,u=new Z(+a,+s);u.z=+l;var h=this._tileCoordsToKey(u),c=this._tiles[h];return c&&c.active?(c.retain=!0,!0):(c&&c.loaded&&(c.retain=!0),l>o&&this._retainParent(a,s,l,o))},_retainChildren:function(i,r,n,o){for(var a=2*i;a<2*i+2;a++)for(var s=2*r;s<2*r+2;s++){var l=new Z(a,s);l.z=n+1;var u=this._tileCoordsToKey(l),h=this._tiles[u];if(h&&h.active){h.retain=!0;continue}h&&h.loaded&&(h.retain=!0),n+1<o&&this._retainChildren(a,s,n+1,o)}},_resetView:function(i){var r=i&&(i.pinch||i.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),r,r)},_animateZoom:function(i){this._setView(i.center,i.zoom,!0,i.noUpdate)},_clampZoom:function(i){var r=this.options;return void 0!==r.minNativeZoom&&i<r.minNativeZoom?r.minNativeZoom:void 0!==r.maxNativeZoom&&r.maxNativeZoom<i?r.maxNativeZoom:i},_setView:function(i,r,n,o){var a=Math.round(r);a=void 0!==this.options.maxZoom&&a>this.options.maxZoom||void 0!==this.options.minZoom&&a<this.options.minZoom?void 0:this._clampZoom(a);var s=this.options.updateWhenZooming&&a!==this._tileZoom;(!o||s)&&(this._tileZoom=a,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),void 0!==a&&this._update(i),n||this._pruneTiles(),this._noPrune=!!n),this._setZoomTransforms(i,r)},_setZoomTransforms:function(i,r){for(var n in this._levels)this._setZoomTransform(this._levels[n],i,r)},_setZoomTransform:function(i,r,n){var o=this._map.getZoomScale(n,i.zoom),a=i.origin.multiplyBy(o).subtract(this._map._getNewPixelOrigin(r,n)).round();tN.any3d?eo(i.el,a,o):ea(i.el,a)},_resetGrid:function(){var i=this._map,r=i.options.crs,n=this._tileSize=this.getTileSize(),o=this._tileZoom,a=this._map.getPixelWorldBounds(this._tileZoom);a&&(this._globalTileRange=this._pxBoundsToTileRange(a)),this._wrapX=r.wrapLng&&!this.options.noWrap&&[Math.floor(i.project([0,r.wrapLng[0]],o).x/n.x),Math.ceil(i.project([0,r.wrapLng[1]],o).x/n.y)],this._wrapY=r.wrapLat&&!this.options.noWrap&&[Math.floor(i.project([r.wrapLat[0],0],o).y/n.x),Math.ceil(i.project([r.wrapLat[1],0],o).y/n.y)]},_onMoveEnd:function(){this._map&&!this._map._animatingZoom&&this._update()},_getTiledPixelBounds:function(i){var r=this._map,n=r._animatingZoom?Math.max(r._animateToZoom,r.getZoom()):r.getZoom(),o=r.getZoomScale(n,this._tileZoom),a=r.project(i,this._tileZoom).floor(),s=r.getSize().divideBy(2*o);return new G(a.subtract(s),a.add(s))},_update:function(i){var r=this._map;if(r){var n=this._clampZoom(r.getZoom());if(void 0===i&&(i=r.getCenter()),void 0!==this._tileZoom){var o=this._getTiledPixelBounds(i),a=this._pxBoundsToTileRange(o),s=a.getCenter(),l=[],u=this.options.keepBuffer,h=new G(a.getBottomLeft().subtract([u,-u]),a.getTopRight().add([u,-u]));if(!(isFinite(a.min.x)&&isFinite(a.min.y)&&isFinite(a.max.x)&&isFinite(a.max.y)))throw Error("Attempted to load an infinite number of tiles");for(var c in this._tiles){var d=this._tiles[c].coords;d.z===this._tileZoom&&h.contains(new Z(d.x,d.y))||(this._tiles[c].current=!1)}if(Math.abs(n-this._tileZoom)>1){this._setView(i,n);return}for(var p=a.min.y;p<=a.max.y;p++)for(var f=a.min.x;f<=a.max.x;f++){var m=new Z(f,p);if(m.z=this._tileZoom,this._isValidTile(m)){var g=this._tiles[this._tileCoordsToKey(m)];g?g.current=!0:l.push(m)}}if(l.sort(function(i,r){return i.distanceTo(s)-r.distanceTo(s)}),0!==l.length){this._loading||(this._loading=!0,this.fire("loading"));var _=document.createDocumentFragment();for(f=0;f<l.length;f++)this._addTile(l[f],_);this._level.el.appendChild(_)}}}},_isValidTile:function(i){var r=this._map.options.crs;if(!r.infinite){var n=this._globalTileRange;if(!r.wrapLng&&(i.x<n.min.x||i.x>n.max.x)||!r.wrapLat&&(i.y<n.min.y||i.y>n.max.y))return!1}if(!this.options.bounds)return!0;var o=this._tileCoordsToBounds(i);return X(this.options.bounds).overlaps(o)},_keyToBounds:function(i){return this._tileCoordsToBounds(this._keyToTileCoords(i))},_tileCoordsToNwSe:function(i){var r=this._map,n=this.getTileSize(),o=i.scaleBy(n),a=o.add(n);return[r.unproject(o,i.z),r.unproject(a,i.z)]},_tileCoordsToBounds:function(i){var r=this._tileCoordsToNwSe(i),n=new H(r[0],r[1]);return this.options.noWrap||(n=this._map.wrapLatLngBounds(n)),n},_tileCoordsToKey:function(i){return i.x+":"+i.y+":"+i.z},_keyToTileCoords:function(i){var r=i.split(":"),n=new Z(+r[0],+r[1]);return n.z=+r[2],n},_removeTile:function(i){var r=this._tiles[i];r&&(t5(r.el),delete this._tiles[i],this.fire("tileunload",{tile:r.el,coords:this._keyToTileCoords(i)}))},_initTile:function(i){t7(i,"leaflet-tile");var r=this.getTileSize();i.style.width=r.x+"px",i.style.height=r.y+"px",i.onselectstart=x,i.onmousemove=x,tN.ielt9&&this.options.opacity<1&&er(i,this.options.opacity)},_addTile:function(i,r){var n=this._getTilePos(i),o=this._tileCoordsToKey(i),a=this.createTile(this._wrapCoords(i),m(this._tileReady,this,i));this._initTile(a),this.createTile.length<2&&O(m(this._tileReady,this,i,null,a)),ea(a,n),this._tiles[o]={el:a,coords:i,current:!0},r.appendChild(a),this.fire("tileloadstart",{tile:a,coords:i})},_tileReady:function(i,r,n){r&&this.fire("tileerror",{error:r,tile:n,coords:i});var o=this._tileCoordsToKey(i);(n=this._tiles[o])&&(n.loaded=+new Date,this._map._fadeAnimated?(er(n.el,0),F(this._fadeFrame),this._fadeFrame=O(this._updateOpacity,this)):(n.active=!0,this._pruneTiles()),r||(t7(n.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:n.el,coords:i})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),tN.ielt9||!this._map._fadeAnimated?O(this._pruneTiles,this):setTimeout(m(this._pruneTiles,this),250)))},_getTilePos:function(i){return i.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(i){var r=new Z(this._wrapX?v(i.x,this._wrapX):i.x,this._wrapY?v(i.y,this._wrapY):i.y);return r.z=i.z,r},_pxBoundsToTileRange:function(i){var r=this.getTileSize();return new G(i.min.unscaleBy(r).floor(),i.max.unscaleBy(r).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var i in this._tiles)if(!this._tiles[i].loaded)return!1;return!0}}),iP=iA.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1,referrerPolicy:!1},initialize:function(i,r){this._url=i,(r=E(this,r)).detectRetina&&tN.retina&&r.maxZoom>0?(r.tileSize=Math.floor(r.tileSize/2),r.zoomReverse?(r.zoomOffset--,r.minZoom=Math.min(r.maxZoom,r.minZoom+1)):(r.zoomOffset++,r.maxZoom=Math.max(r.minZoom,r.maxZoom-1)),r.minZoom=Math.max(0,r.minZoom)):r.zoomReverse?r.minZoom=Math.min(r.maxZoom,r.minZoom):r.maxZoom=Math.max(r.minZoom,r.maxZoom),"string"==typeof r.subdomains&&(r.subdomains=r.subdomains.split("")),this.on("tileunload",this._onTileRemove)},setUrl:function(i,r){return this._url===i&&void 0===r&&(r=!0),this._url=i,r||this.redraw(),this},createTile:function(i,r){var n=document.createElement("img");return em(n,"load",m(this._tileOnLoad,this,r,n)),em(n,"error",m(this._tileOnError,this,r,n)),(this.options.crossOrigin||""===this.options.crossOrigin)&&(n.crossOrigin=!0===this.options.crossOrigin?"":this.options.crossOrigin),"string"==typeof this.options.referrerPolicy&&(n.referrerPolicy=this.options.referrerPolicy),n.alt="",n.src=this.getTileUrl(i),n},getTileUrl:function(i){var n={r:tN.retina?"@2x":"",s:this._getSubdomain(i),x:i.x,y:i.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){var o=this._globalTileRange.max.y-i.y;this.options.tms&&(n.y=o),n["-y"]=o}return I(this._url,r(n,this.options))},_tileOnLoad:function(i,r){tN.ielt9?setTimeout(m(i,this,null,r),0):i(null,r)},_tileOnError:function(i,r,n){var o=this.options.errorTileUrl;o&&r.getAttribute("src")!==o&&(r.src=o),i(n,r)},_onTileRemove:function(i){i.tile.onload=null},_getZoomForUrl:function(){var i=this._tileZoom,r=this.options.maxZoom,n=this.options.zoomReverse,o=this.options.zoomOffset;return n&&(i=r-i),i+o},_getSubdomain:function(i){var r=Math.abs(i.x+i.y)%this.options.subdomains.length;return this.options.subdomains[r]},_abortLoading:function(){var i,r;for(i in this._tiles)if(this._tiles[i].coords.z!==this._tileZoom&&((r=this._tiles[i].el).onload=x,r.onerror=x,!r.complete)){r.src=k;var n=this._tiles[i].coords;t5(r),delete this._tiles[i],this.fire("tileabort",{tile:r,coords:n})}},_removeTile:function(i){var r=this._tiles[i];if(r)return r.el.setAttribute("src",k),iA.prototype._removeTile.call(this,i)},_tileReady:function(i,r,n){if(this._map&&(!n||n.getAttribute("src")!==k))return iA.prototype._tileReady.call(this,i,r,n)}});function ik(i,r){return new iP(i,r)}var iL=iP.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(i,n){this._url=i;var o=r({},this.defaultWmsParams);for(var a in n)a in this.options||(o[a]=n[a]);var s=(n=E(this,n)).detectRetina&&tN.retina?2:1,l=this.getTileSize();o.width=l.x*s,o.height=l.y*s,this.wmsParams=o},onAdd:function(i){this._crs=this.options.crs||i.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var r=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[r]=this._crs.code,iP.prototype.onAdd.call(this,i)},getTileUrl:function(i){var r=this._tileCoordsToNwSe(i),n=this._crs,o=W(n.project(r[0]),n.project(r[1])),a=o.min,s=o.max,l=(this._wmsVersion>=1.3&&this._crs===e5?[a.y,a.x,s.y,s.x]:[a.x,a.y,s.x,s.y]).join(","),u=iP.prototype.getTileUrl.call(this,i);return u+S(this.wmsParams,u,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+l},setParams:function(i,n){return r(this.wmsParams,i),n||this.redraw(),this}});iP.WMS=iL,ik.wms=function(i,r){return new iL(i,r)};var iM=e6.extend({options:{padding:.1},initialize:function(i){E(this,i),_(this),this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),t7(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this)},onRemove:function(){this.off("update",this._updatePaths,this),this._destroyContainer()},getEvents:function(){var i={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(i.zoomanim=this._onAnimZoom),i},_onAnimZoom:function(i){this._updateTransform(i.center,i.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(i,r){var n=this._map.getZoomScale(r,this._zoom),o=this._map.getSize().multiplyBy(.5+this.options.padding),a=this._map.project(this._center,r),s=o.multiplyBy(-n).add(a).subtract(this._map._getNewPixelOrigin(i,r));tN.any3d?eo(this._container,s,n):ea(this._container,s)},_reset:function(){for(var i in this._update(),this._updateTransform(this._center,this._zoom),this._layers)this._layers[i]._reset()},_onZoomEnd:function(){for(var i in this._layers)this._layers[i]._project()},_updatePaths:function(){for(var i in this._layers)this._layers[i]._update()},_update:function(){var i=this.options.padding,r=this._map.getSize(),n=this._map.containerPointToLayerPoint(r.multiplyBy(-i)).round();this._bounds=new G(n,n.add(r.multiplyBy(1+2*i)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),iz=iM.extend({options:{tolerance:0},getEvents:function(){var i=iM.prototype.getEvents.call(this);return i.viewprereset=this._onViewPreReset,i},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){iM.prototype.onAdd.call(this),this._draw()},_initContainer:function(){var i=this._container=document.createElement("canvas");em(i,"mousemove",this._onMouseMove,this),em(i,"click dblclick mousedown mouseup contextmenu",this._onClick,this),em(i,"mouseout",this._handleMouseOut,this),i._leaflet_disable_events=!0,this._ctx=i.getContext("2d")},_destroyContainer:function(){F(this._redrawRequest),delete this._ctx,t5(this._container),e_(this._container),delete this._container},_updatePaths:function(){if(!this._postponeUpdatePaths){for(var i in this._redrawBounds=null,this._layers)this._layers[i]._update();this._redraw()}},_update:function(){if(!this._map._animatingZoom||!this._bounds){iM.prototype._update.call(this);var i=this._bounds,r=this._container,n=i.getSize(),o=tN.retina?2:1;ea(r,i.min),r.width=o*n.x,r.height=o*n.y,r.style.width=n.x+"px",r.style.height=n.y+"px",tN.retina&&this._ctx.scale(2,2),this._ctx.translate(-i.min.x,-i.min.y),this.fire("update")}},_reset:function(){iM.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(i){this._updateDashArray(i),this._layers[_(i)]=i;var r=i._order={layer:i,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=r),this._drawLast=r,this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(i){this._requestRedraw(i)},_removePath:function(i){var r=i._order,n=r.next,o=r.prev;n?n.prev=o:this._drawLast=o,o?o.next=n:this._drawFirst=n,delete i._order,delete this._layers[_(i)],this._requestRedraw(i)},_updatePath:function(i){this._extendRedrawBounds(i),i._project(),i._update(),this._requestRedraw(i)},_updateStyle:function(i){this._updateDashArray(i),this._requestRedraw(i)},_updateDashArray:function(i){if("string"==typeof i.options.dashArray){var r,n,o=i.options.dashArray.split(/[, ]+/),a=[];for(n=0;n<o.length;n++){if(isNaN(r=Number(o[n])))return;a.push(r)}i.options._dashArray=a}else i.options._dashArray=i.options.dashArray},_requestRedraw:function(i){this._map&&(this._extendRedrawBounds(i),this._redrawRequest=this._redrawRequest||O(this._redraw,this))},_extendRedrawBounds:function(i){if(i._pxBounds){var r=(i.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new G,this._redrawBounds.extend(i._pxBounds.min.subtract([r,r])),this._redrawBounds.extend(i._pxBounds.max.add([r,r]))}},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},_clear:function(){var i=this._redrawBounds;if(i){var r=i.getSize();this._ctx.clearRect(i.min.x,i.min.y,r.x,r.y)}else this._ctx.save(),this._ctx.setTransform(1,0,0,1,0,0),this._ctx.clearRect(0,0,this._container.width,this._container.height),this._ctx.restore()},_draw:function(){var i,r=this._redrawBounds;if(this._ctx.save(),r){var n=r.getSize();this._ctx.beginPath(),this._ctx.rect(r.min.x,r.min.y,n.x,n.y),this._ctx.clip()}this._drawing=!0;for(var o=this._drawFirst;o;o=o.next)i=o.layer,(!r||i._pxBounds&&i._pxBounds.intersects(r))&&i._updatePath();this._drawing=!1,this._ctx.restore()},_updatePoly:function(i,r){if(this._drawing){var n,o,a,s,l=i._parts,u=l.length,h=this._ctx;if(u){for(h.beginPath(),n=0;n<u;n++){for(o=0,a=l[n].length;o<a;o++)s=l[n][o],h[o?"lineTo":"moveTo"](s.x,s.y);r&&h.closePath()}this._fillStroke(h,i)}}},_updateCircle:function(i){if(!(!this._drawing||i._empty())){var r=i._point,n=this._ctx,o=Math.max(Math.round(i._radius),1),a=(Math.max(Math.round(i._radiusY),1)||o)/o;1!==a&&(n.save(),n.scale(1,a)),n.beginPath(),n.arc(r.x,r.y/a,o,0,2*Math.PI,!1),1!==a&&n.restore(),this._fillStroke(n,i)}},_fillStroke:function(i,r){var n=r.options;n.fill&&(i.globalAlpha=n.fillOpacity,i.fillStyle=n.fillColor||n.color,i.fill(n.fillRule||"evenodd")),n.stroke&&0!==n.weight&&(i.setLineDash&&i.setLineDash(r.options&&r.options._dashArray||[]),i.globalAlpha=n.opacity,i.lineWidth=n.weight,i.strokeStyle=n.color,i.lineCap=n.lineCap,i.lineJoin=n.lineJoin,i.stroke())},_onClick:function(i){for(var r,n,o=this._map.mouseEventToLayerPoint(i),a=this._drawFirst;a;a=a.next)(r=a.layer).options.interactive&&r._containsPoint(o)&&(!("click"===i.type||"preclick"===i.type)||!this._map._draggableMoved(r))&&(n=r);this._fireEvent(!!n&&[n],i)},_onMouseMove:function(i){if(!(!this._map||this._map.dragging.moving())&&!this._map._animatingZoom){var r=this._map.mouseEventToLayerPoint(i);this._handleMouseHover(i,r)}},_handleMouseOut:function(i){var r=this._hoveredLayer;r&&(et(this._container,"leaflet-interactive"),this._fireEvent([r],i,"mouseout"),this._hoveredLayer=null,this._mouseHoverThrottled=!1)},_handleMouseHover:function(i,r){if(!this._mouseHoverThrottled){for(var n,o,a=this._drawFirst;a;a=a.next)(n=a.layer).options.interactive&&n._containsPoint(r)&&(o=n);o!==this._hoveredLayer&&(this._handleMouseOut(i),o&&(t7(this._container,"leaflet-interactive"),this._fireEvent([o],i,"mouseover"),this._hoveredLayer=o)),this._fireEvent(!!this._hoveredLayer&&[this._hoveredLayer],i),this._mouseHoverThrottled=!0,setTimeout(m(function(){this._mouseHoverThrottled=!1},this),32)}},_fireEvent:function(i,r,n){this._map._fireDOMEvent(r,n||r.type,i)},_bringToFront:function(i){var r=i._order;if(r){var n=r.next,o=r.prev;if(!n)return;n.prev=o,o?o.next=n:n&&(this._drawFirst=n),r.prev=this._drawLast,this._drawLast.next=r,r.next=null,this._drawLast=r,this._requestRedraw(i)}},_bringToBack:function(i){var r=i._order;if(r){var n=r.next,o=r.prev;if(!o)return;o.next=n,n?n.prev=o:o&&(this._drawLast=o),r.prev=null,r.next=this._drawFirst,this._drawFirst.prev=r,this._drawFirst=r,this._requestRedraw(i)}}});function iD(i){return tN.canvas?new iz(i):null}var iR=function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(i){return document.createElement("<lvml:"+i+' class="lvml">')}}catch(i){}return function(i){return document.createElement("<"+i+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}}(),iB=tN.vml?iR:to,iO=iM.extend({_initContainer:function(){this._container=iB("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=iB("g"),this._container.appendChild(this._rootGroup)},_destroyContainer:function(){t5(this._container),e_(this._container),delete this._container,delete this._rootGroup,delete this._svgSize},_update:function(){if(!this._map._animatingZoom||!this._bounds){iM.prototype._update.call(this);var i=this._bounds,r=i.getSize(),n=this._container;this._svgSize&&this._svgSize.equals(r)||(this._svgSize=r,n.setAttribute("width",r.x),n.setAttribute("height",r.y)),ea(n,i.min),n.setAttribute("viewBox",[i.min.x,i.min.y,r.x,r.y].join(" ")),this.fire("update")}},_initPath:function(i){var r=i._path=iB("path");i.options.className&&t7(r,i.options.className),i.options.interactive&&t7(r,"leaflet-interactive"),this._updateStyle(i),this._layers[_(i)]=i},_addPath:function(i){this._rootGroup||this._initContainer(),this._rootGroup.appendChild(i._path),i.addInteractiveTarget(i._path)},_removePath:function(i){t5(i._path),i.removeInteractiveTarget(i._path),delete this._layers[_(i)]},_updatePath:function(i){i._project(),i._update()},_updateStyle:function(i){var r=i._path,n=i.options;r&&(n.stroke?(r.setAttribute("stroke",n.color),r.setAttribute("stroke-opacity",n.opacity),r.setAttribute("stroke-width",n.weight),r.setAttribute("stroke-linecap",n.lineCap),r.setAttribute("stroke-linejoin",n.lineJoin),n.dashArray?r.setAttribute("stroke-dasharray",n.dashArray):r.removeAttribute("stroke-dasharray"),n.dashOffset?r.setAttribute("stroke-dashoffset",n.dashOffset):r.removeAttribute("stroke-dashoffset")):r.setAttribute("stroke","none"),n.fill?(r.setAttribute("fill",n.fillColor||n.color),r.setAttribute("fill-opacity",n.fillOpacity),r.setAttribute("fill-rule",n.fillRule||"evenodd")):r.setAttribute("fill","none"))},_updatePoly:function(i,r){this._setPath(i,ta(i._parts,r))},_updateCircle:function(i){var r=i._point,n=Math.max(Math.round(i._radius),1),o=Math.max(Math.round(i._radiusY),1)||n,a="a"+n+","+o+" 0 1,0 ",s=i._empty()?"M0 0":"M"+(r.x-n)+","+r.y+a+2*n+",0 "+a+-(2*n)+",0 ";this._setPath(i,s)},_setPath:function(i,r){i._path.setAttribute("d",r)},_bringToFront:function(i){t6(i._path)},_bringToBack:function(i){t8(i._path)}});function iF(i){return tN.svg||tN.vml?new iO(i):null}tN.vml&&iO.include({_initContainer:function(){this._container=t3("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(iM.prototype._update.call(this),this.fire("update"))},_initPath:function(i){var r=i._container=iR("shape");t7(r,"leaflet-vml-shape "+(this.options.className||"")),r.coordsize="1 1",i._path=iR("path"),r.appendChild(i._path),this._updateStyle(i),this._layers[_(i)]=i},_addPath:function(i){var r=i._container;this._container.appendChild(r),i.options.interactive&&i.addInteractiveTarget(r)},_removePath:function(i){var r=i._container;t5(r),i.removeInteractiveTarget(r),delete this._layers[_(i)]},_updateStyle:function(i){var r=i._stroke,n=i._fill,o=i.options,a=i._container;a.stroked=!!o.stroke,a.filled=!!o.fill,o.stroke?(r||(r=i._stroke=iR("stroke")),a.appendChild(r),r.weight=o.weight+"px",r.color=o.color,r.opacity=o.opacity,o.dashArray?r.dashStyle=A(o.dashArray)?o.dashArray.join(" "):o.dashArray.replace(/( *, *)/g," "):r.dashStyle="",r.endcap=o.lineCap.replace("butt","flat"),r.joinstyle=o.lineJoin):r&&(a.removeChild(r),i._stroke=null),o.fill?(n||(n=i._fill=iR("fill")),a.appendChild(n),n.color=o.fillColor||o.color,n.opacity=o.fillOpacity):n&&(a.removeChild(n),i._fill=null)},_updateCircle:function(i){var r=i._point.round(),n=Math.round(i._radius),o=Math.round(i._radiusY||n);this._setPath(i,i._empty()?"M0 0":"AL "+r.x+","+r.y+" "+n+","+o+" 0,23592600")},_setPath:function(i,r){i._path.v=r},_bringToFront:function(i){t6(i._container)},_bringToBack:function(i){t8(i._container)}}),ez.include({getRenderer:function(i){var r=i.options.renderer||this._getPaneRenderer(i.options.pane)||this.options.renderer||this._renderer;return r||(r=this._renderer=this._createRenderer()),this.hasLayer(r)||this.addLayer(r),r},_getPaneRenderer:function(i){if("overlayPane"===i||void 0===i)return!1;var r=this._paneRenderers[i];return void 0===r&&(r=this._createRenderer({pane:i}),this._paneRenderers[i]=r),r},_createRenderer:function(i){return this.options.preferCanvas&&iD(i)||iF(i)}});var iN=il.extend({initialize:function(i,r){il.prototype.initialize.call(this,this._boundsToLatLngs(i),r)},setBounds:function(i){return this.setLatLngs(this._boundsToLatLngs(i))},_boundsToLatLngs:function(i){return[(i=X(i)).getSouthWest(),i.getNorthWest(),i.getNorthEast(),i.getSouthEast()]}});iO.create=iB,iO.pointsToPath=ta,iu.geometryToLayer=ih,iu.coordsToLatLng=id,iu.coordsToLatLngs=ip,iu.latLngToCoords=im,iu.latLngsToCoords=ig,iu.getFeature=i_,iu.asFeature=iy,ez.mergeOptions({boxZoom:!0});var iU=eU.extend({initialize:function(i){this._map=i,this._container=i._container,this._pane=i._panes.overlayPane,this._resetStateTimeout=0,i.on("unload",this._destroy,this)},addHooks:function(){em(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){e_(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_destroy:function(){t5(this._pane),delete this._pane},_resetState:function(){this._resetStateTimeout=0,this._moved=!1},_clearDeferredResetState:function(){0!==this._resetStateTimeout&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0)},_onMouseDown:function(i){if(!i.shiftKey||1!==i.which&&1!==i.button)return!1;this._clearDeferredResetState(),this._resetState(),n(),eu(),this._startPoint=this._map.mouseEventToContainerPoint(i),em(document,{contextmenu:eC,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(i){this._moved||(this._moved=!0,this._box=t3("div","leaflet-zoom-box",this._container),t7(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(i);var r=new G(this._point,this._startPoint),n=r.getSize();ea(this._box,r.min),this._box.style.width=n.x+"px",this._box.style.height=n.y+"px"},_finish:function(){this._moved&&(t5(this._box),et(this._container,"leaflet-crosshair")),o(),eh(),e_(document,{contextmenu:eC,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(i){if((1===i.which||1===i.button)&&(this._finish(),this._moved)){this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(m(this._resetState,this),0);var r=new H(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(r).fire("boxzoomend",{boxZoomBounds:r})}},_onKeyDown:function(i){27===i.keyCode&&(this._finish(),this._clearDeferredResetState(),this._resetState())}});ez.addInitHook("addHandler","boxZoom",iU),ez.mergeOptions({doubleClickZoom:!0});var ij=eU.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(i){var r=this._map,n=r.getZoom(),o=r.options.zoomDelta,a=i.originalEvent.shiftKey?n-o:n+o;"center"===r.options.doubleClickZoom?r.setZoom(a):r.setZoomAround(i.containerPoint,a)}});ez.addInitHook("addHandler","doubleClickZoom",ij),ez.mergeOptions({dragging:!0,inertia:!0,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});var iZ=eU.extend({addHooks:function(){if(!this._draggable){var i=this._map;this._draggable=new eZ(i._mapPane,i._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),i.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),i.on("zoomend",this._onZoomEnd,this),i.whenReady(this._onZoomEnd,this))}t7(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){et(this._map._container,"leaflet-grab"),et(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDragStart:function(){var i=this._map;if(i._stop(),this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var r=X(this._map.options.maxBounds);this._offsetLimit=W(this._map.latLngToContainerPoint(r.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(r.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;i.fire("movestart").fire("dragstart"),i.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(i){if(this._map.options.inertia){var r=this._lastTime=+new Date,n=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(n),this._times.push(r),this._prunePositions(r)}this._map.fire("move",i).fire("drag",i)},_prunePositions:function(i){for(;this._positions.length>1&&i-this._times[0]>50;)this._positions.shift(),this._times.shift()},_onZoomEnd:function(){var i=this._map.getSize().divideBy(2),r=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=r.subtract(i).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(i,r){return i-(i-r)*this._viscosity},_onPreDragLimit:function(){if(this._viscosity&&this._offsetLimit){var i=this._draggable._newPos.subtract(this._draggable._startPos),r=this._offsetLimit;i.x<r.min.x&&(i.x=this._viscousLimit(i.x,r.min.x)),i.y<r.min.y&&(i.y=this._viscousLimit(i.y,r.min.y)),i.x>r.max.x&&(i.x=this._viscousLimit(i.x,r.max.x)),i.y>r.max.y&&(i.y=this._viscousLimit(i.y,r.max.y)),this._draggable._newPos=this._draggable._startPos.add(i)}},_onPreDragWrap:function(){var i=this._worldWidth,r=Math.round(i/2),n=this._initialWorldOffset,o=this._draggable._newPos.x,a=(o-r+n)%i+r-n,s=(o+r+n)%i-r-n,l=Math.abs(a+n)<Math.abs(s+n)?a:s;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=l},_onDragEnd:function(i){var r=this._map,n=r.options,o=!n.inertia||i.noInertia||this._times.length<2;if(r.fire("dragend",i),o)r.fire("moveend");else{this._prunePositions(+new Date);var a=this._lastPos.subtract(this._positions[0]),s=(this._lastTime-this._times[0])/1e3,l=n.easeLinearity,u=a.multiplyBy(l/s),h=u.distanceTo([0,0]),c=Math.min(n.inertiaMaxSpeed,h),d=u.multiplyBy(c/h),p=c/(n.inertiaDeceleration*l),f=d.multiplyBy(-p/2).round();f.x||f.y?(f=r._limitOffset(f,r.options.maxBounds),O(function(){r.panBy(f,{duration:p,easeLinearity:l,noMoveStart:!0,animate:!0})})):r.fire("moveend")}}});ez.addInitHook("addHandler","dragging",iZ),ez.mergeOptions({keyboard:!0,keyboardPanDelta:80});var iV=eU.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(i){this._map=i,this._setPanDelta(i.options.keyboardPanDelta),this._setZoomDelta(i.options.zoomDelta)},addHooks:function(){var i=this._map._container;i.tabIndex<=0&&(i.tabIndex="0"),em(i,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),e_(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var i=document.body,r=document.documentElement,n=i.scrollTop||r.scrollTop,o=i.scrollLeft||r.scrollLeft;this._map._container.focus(),window.scrollTo(o,n)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(i){var r,n,o=this._panKeys={},a=this.keyCodes;for(r=0,n=a.left.length;r<n;r++)o[a.left[r]]=[-1*i,0];for(r=0,n=a.right.length;r<n;r++)o[a.right[r]]=[i,0];for(r=0,n=a.down.length;r<n;r++)o[a.down[r]]=[0,i];for(r=0,n=a.up.length;r<n;r++)o[a.up[r]]=[0,-1*i]},_setZoomDelta:function(i){var r,n,o=this._zoomKeys={},a=this.keyCodes;for(r=0,n=a.zoomIn.length;r<n;r++)o[a.zoomIn[r]]=i;for(r=0,n=a.zoomOut.length;r<n;r++)o[a.zoomOut[r]]=-i},_addHooks:function(){em(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){e_(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(i){if(!i.altKey&&!i.ctrlKey&&!i.metaKey){var r,n=i.keyCode,o=this._map;if(n in this._panKeys){if(!o._panAnim||!o._panAnim._inProgress){if(r=this._panKeys[n],i.shiftKey&&(r=q(r).multiplyBy(3)),o.options.maxBounds&&(r=o._limitOffset(q(r),o.options.maxBounds)),o.options.worldCopyJump){var a=o.wrapLatLng(o.unproject(o.project(o.getCenter()).add(r)));o.panTo(a)}else o.panBy(r)}}else if(n in this._zoomKeys)o.setZoom(o.getZoom()+(i.shiftKey?3:1)*this._zoomKeys[n]);else{if(27!==n||!o._popup||!o._popup.options.closeOnEscapeKey)return;o.closePopup()}eC(i)}}});ez.addInitHook("addHandler","keyboard",iV),ez.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});var iq=eU.extend({addHooks:function(){em(this._map._container,"wheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){e_(this._map._container,"wheel",this._onWheelScroll,this)},_onWheelScroll:function(i){var r=ek(i),n=this._map.options.wheelDebounceTime;this._delta+=r,this._lastMousePos=this._map.mouseEventToContainerPoint(i),this._startTime||(this._startTime=+new Date);var o=Math.max(n-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(m(this._performZoom,this),o),eC(i)},_performZoom:function(){var i=this._map,r=i.getZoom(),n=this._map.options.zoomSnap||0;i._stop();var o=4*Math.log(2/(1+Math.exp(-Math.abs(this._delta/(4*this._map.options.wheelPxPerZoomLevel)))))/Math.LN2,a=n?Math.ceil(o/n)*n:o,s=i._limitZoom(r+(this._delta>0?a:-a))-r;this._delta=0,this._startTime=null,s&&("center"===i.options.scrollWheelZoom?i.setZoom(r+s):i.setZoomAround(this._lastMousePos,r+s))}});ez.addInitHook("addHandler","scrollWheelZoom",iq),ez.mergeOptions({tapHold:tN.touchNative&&tN.safari&&tN.mobile,tapTolerance:15});var iG=eU.extend({addHooks:function(){em(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){e_(this._map._container,"touchstart",this._onDown,this)},_onDown:function(i){if(clearTimeout(this._holdTimeout),1===i.touches.length){var r=i.touches[0];this._startPos=this._newPos=new Z(r.clientX,r.clientY),this._holdTimeout=setTimeout(m(function(){this._cancel(),this._isTapValid()&&(em(document,"touchend",eS),em(document,"touchend touchcancel",this._cancelClickPrevent),this._simulateEvent("contextmenu",r))},this),600),em(document,"touchend touchcancel contextmenu",this._cancel,this),em(document,"touchmove",this._onMove,this)}},_cancelClickPrevent:function i(){e_(document,"touchend",eS),e_(document,"touchend touchcancel",i)},_cancel:function(){clearTimeout(this._holdTimeout),e_(document,"touchend touchcancel contextmenu",this._cancel,this),e_(document,"touchmove",this._onMove,this)},_onMove:function(i){var r=i.touches[0];this._newPos=new Z(r.clientX,r.clientY)},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_simulateEvent:function(i,r){var n=new MouseEvent(i,{bubbles:!0,cancelable:!0,view:window,screenX:r.screenX,screenY:r.screenY,clientX:r.clientX,clientY:r.clientY});n._simulated=!0,r.target.dispatchEvent(n)}});ez.addInitHook("addHandler","tapHold",iG),ez.mergeOptions({touchZoom:tN.touch,bounceAtZoomLimits:!0});var i$=eU.extend({addHooks:function(){t7(this._map._container,"leaflet-touch-zoom"),em(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){et(this._map._container,"leaflet-touch-zoom"),e_(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(i){var r=this._map;if(i.touches&&2===i.touches.length&&!r._animatingZoom&&!this._zooming){var n=r.mouseEventToContainerPoint(i.touches[0]),o=r.mouseEventToContainerPoint(i.touches[1]);this._centerPoint=r.getSize()._divideBy(2),this._startLatLng=r.containerPointToLatLng(this._centerPoint),"center"!==r.options.touchZoom&&(this._pinchStartLatLng=r.containerPointToLatLng(n.add(o)._divideBy(2))),this._startDist=n.distanceTo(o),this._startZoom=r.getZoom(),this._moved=!1,this._zooming=!0,r._stop(),em(document,"touchmove",this._onTouchMove,this),em(document,"touchend touchcancel",this._onTouchEnd,this),eS(i)}},_onTouchMove:function(i){if(i.touches&&2===i.touches.length&&this._zooming){var r=this._map,n=r.mouseEventToContainerPoint(i.touches[0]),o=r.mouseEventToContainerPoint(i.touches[1]),a=n.distanceTo(o)/this._startDist;if(this._zoom=r.getScaleZoom(a,this._startZoom),!r.options.bounceAtZoomLimits&&(this._zoom<r.getMinZoom()&&a<1||this._zoom>r.getMaxZoom()&&a>1)&&(this._zoom=r._limitZoom(this._zoom)),"center"===r.options.touchZoom){if(this._center=this._startLatLng,1===a)return}else{var s=n._add(o)._divideBy(2)._subtract(this._centerPoint);if(1===a&&0===s.x&&0===s.y)return;this._center=r.unproject(r.project(this._pinchStartLatLng,this._zoom).subtract(s),this._zoom)}this._moved||(r._moveStart(!0,!1),this._moved=!0),F(this._animRequest);var l=m(r._move,r,this._center,this._zoom,{pinch:!0,round:!1},void 0);this._animRequest=O(l,this,!0),eS(i)}},_onTouchEnd:function(){if(!this._moved||!this._zooming){this._zooming=!1;return}this._zooming=!1,F(this._animRequest),e_(document,"touchmove",this._onTouchMove,this),e_(document,"touchend touchcancel",this._onTouchEnd,this),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))}});ez.addInitHook("addHandler","touchZoom",i$),ez.BoxZoom=iU,ez.DoubleClickZoom=ij,ez.Drag=iZ,ez.Keyboard=iV,ez.ScrollWheelZoom=iq,ez.TapHold=iG,ez.TouchZoom=i$,i.Bounds=G,i.Browser=tN,i.CRS=Y,i.Canvas=iz,i.Circle=ia,i.CircleMarker=io,i.Class=N,i.Control=eD,i.DivIcon=iI,i.DivOverlay=iE,i.DomEvent={__proto__:null,on:em,off:e_,stopPropagation:ew,disableScrollPropagation:eT,disableClickPropagation:eE,preventDefault:eS,stop:eC,getPropagationPath:eI,getMousePosition:eA,getWheelDelta:ek,isExternalTarget:eL,addListener:em,removeListener:e_},i.DomUtil={__proto__:null,TRANSFORM:tY,TRANSITION:tQ,TRANSITION_END:t0,get:t1,getStyle:t2,create:t3,remove:t5,empty:t4,toFront:t6,toBack:t8,hasClass:t9,addClass:t7,removeClass:et,setClass:ee,getClass:ei,setOpacity:er,testProp:en,setTransform:eo,setPosition:ea,getPosition:es,get disableTextSelection(){return n},get enableTextSelection(){return o},disableImageDrag:eu,enableImageDrag:eh,preventOutline:ec,restoreOutline:ed,getSizedParentNode:ep,getScale:ef},i.Draggable=eZ,i.Evented=j,i.FeatureGroup=e9,i.GeoJSON=iu,i.GridLayer=iA,i.Handler=eU,i.Icon=e7,i.ImageOverlay=ib,i.LatLng=K,i.LatLngBounds=H,i.Layer=e6,i.LayerGroup=e8,i.LineUtil={__proto__:null,simplify:e$,pointToSegmentDistance:eW,closestPointOnSegment:function(i,r,n){return eJ(i,r,n)},clipSegment:eH,_getEdgeIntersection:eX,_getBitCode:eK,_sqClosestPointOnSegment:eJ,isFlat:eY,_flat:eQ,polylineCenter:e0},i.Map=ez,i.Marker=ii,i.Mixin={Events:U},i.Path=ir,i.Point=Z,i.PolyUtil={__proto__:null,clipPolygon:eV,polygonCenter:eq,centroid:eG},i.Polygon=il,i.Polyline=is,i.Popup=iS,i.PosAnimation=eM,i.Projection={__proto__:null,LonLat:e1,Mercator:e2,SphericalMercator:tt},i.Rectangle=iN,i.Renderer=iM,i.SVG=iO,i.SVGOverlay=iT,i.TileLayer=iP,i.Tooltip=iC,i.Transformation=te,i.Util={__proto__:null,extend:r,create:f,bind:m,get lastId(){return g},stamp:_,throttle:y,wrapNum:v,falseFn:x,formatNum:b,trim:w,splitWords:T,setOptions:E,getParamString:S,template:I,isArray:A,indexOf:P,emptyImageUrl:k,requestFn:R,cancelFn:B,requestAnimFrame:O,cancelAnimFrame:F},i.VideoOverlay=iw,i.bind=m,i.bounds=W,i.canvas=iD,i.circle=function(i,r,n){return new ia(i,r,n)},i.circleMarker=function(i,r){return new io(i,r)},i.control=eR,i.divIcon=function(i){return new iI(i)},i.extend=r,i.featureGroup=function(i,r){return new e9(i,r)},i.geoJSON=ix,i.geoJson=ix,i.gridLayer=function(i){return new iA(i)},i.icon=function(i){return new e7(i)},i.imageOverlay=function(i,r,n){return new ib(i,r,n)},i.latLng=J,i.latLngBounds=X,i.layerGroup=function(i,r){return new e8(i,r)},i.map=function(i,r){return new ez(i,r)},i.marker=function(i,r){return new ii(i,r)},i.point=q,i.polygon=function(i,r){return new il(i,r)},i.polyline=function(i,r){return new is(i,r)},i.popup=function(i,r){return new iS(i,r)},i.rectangle=function(i,r){return new iN(i,r)},i.setOptions=E,i.stamp=_,i.svg=iF,i.svgOverlay=function(i,r,n){return new iT(i,r,n)},i.tileLayer=ik,i.tooltip=function(i,r){return new iC(i,r)},i.transformation=ti,i.version="1.9.4",i.videoOverlay=function(i,r,n){return new iw(i,r,n)};var iW=window.L;i.noConflict=function(){return window.L=iW,this},window.L=i}(i.exports)}),l.register("k23sD",function(i,r){o(i.exports,"VERSION",function(){return a}),o(i.exports,"Support",function(){return l("bNpnD").Support}),o(i.exports,"options",function(){return l("hm4bN").options}),o(i.exports,"Util",function(){return l("k6IM7").EsriUtil}),o(i.exports,"get",function(){return l("cIGnu").get}),o(i.exports,"post",function(){return l("cIGnu").post}),o(i.exports,"request",function(){return l("cIGnu").request}),o(i.exports,"Task",function(){return l("hY3s0").Task}),o(i.exports,"task",function(){return l("hY3s0").task}),o(i.exports,"Query",function(){return l("ga874").Query}),o(i.exports,"query",function(){return l("ga874").query}),o(i.exports,"Find",function(){return l("jVf2K").Find}),o(i.exports,"find",function(){return l("jVf2K").find}),o(i.exports,"Identify",function(){return l("c8FNr").Identify}),o(i.exports,"identify",function(){return l("c8FNr").identify}),o(i.exports,"IdentifyFeatures",function(){return l("hybbU").IdentifyFeatures}),o(i.exports,"identifyFeatures",function(){return l("hybbU").identifyFeatures}),o(i.exports,"IdentifyImage",function(){return l("hXemC").IdentifyImage}),o(i.exports,"identifyImage",function(){return l("hXemC").identifyImage}),o(i.exports,"Service",function(){return l("cOlq6").Service}),o(i.exports,"service",function(){return l("cOlq6").service}),o(i.exports,"MapService",function(){return l("1AQfr").MapService}),o(i.exports,"mapService",function(){return l("1AQfr").mapService}),o(i.exports,"ImageService",function(){return l("cwl41").ImageService}),o(i.exports,"imageService",function(){return l("cwl41").imageService}),o(i.exports,"FeatureLayerService",function(){return l("fQi3s").FeatureLayerService}),o(i.exports,"featureLayerService",function(){return l("fQi3s").featureLayerService}),o(i.exports,"BasemapLayer",function(){return l("bxfxf").BasemapLayer}),o(i.exports,"basemapLayer",function(){return l("bxfxf").basemapLayer}),o(i.exports,"TiledMapLayer",function(){return l("5N6lL").TiledMapLayer}),o(i.exports,"tiledMapLayer",function(){return l("5N6lL").tiledMapLayer}),o(i.exports,"RasterLayer",function(){return l("9zrxg").RasterLayer}),o(i.exports,"ImageMapLayer",function(){return l("fkZG8").ImageMapLayer}),o(i.exports,"imageMapLayer",function(){return l("fkZG8").imageMapLayer}),o(i.exports,"DynamicMapLayer",function(){return l("1xokt").DynamicMapLayer}),o(i.exports,"dynamicMapLayer",function(){return l("1xokt").dynamicMapLayer}),o(i.exports,"FeatureManager",function(){return l("g1lPh").FeatureManager}),o(i.exports,"FeatureLayer",function(){return l("9T7st").FeatureLayer}),o(i.exports,"featureLayer",function(){return l("9T7st").featureLayer});var n=l("g7FwT");l("bNpnD"),l("hm4bN"),l("k6IM7"),l("cIGnu"),l("hY3s0"),l("ga874"),l("jVf2K"),l("c8FNr"),l("hybbU"),l("hXemC"),l("cOlq6"),l("1AQfr"),l("cwl41"),l("fQi3s"),l("bxfxf"),l("5N6lL"),l("9zrxg"),l("fkZG8"),l("1xokt"),l("g1lPh"),l("9T7st");var a=(n&&n.__esModule?n.default:n).version}),l.register("g7FwT",function(i,r){i.exports=JSON.parse('{"name":"esri-leaflet","description":"Leaflet plugins for consuming ArcGIS Online and ArcGIS Server services.","version":"3.0.10","author":"Patrick Arlt <parlt@esri.com> (http://patrickarlt.com)","bugs":{"url":"https://github.com/esri/esri-leaflet/issues"},"contributors":["Patrick Arlt <parlt@esri.com> (http://patrickarlt.com)","John Gravois (https://johngravois.com)","Gavin Rehkemper <grehkemper@esri.com> (https://gavinr.com)","Jacob Wasilkowski (https://jwasilgeo.github.io)"],"dependencies":{"@terraformer/arcgis":"^2.1.0","tiny-binary-search":"^1.0.3"},"devDependencies":{"@rollup/plugin-json":"^6.0.0","@rollup/plugin-node-resolve":"^15.0.1","@rollup/plugin-terser":"^0.3.0","chai":"4.3.7","chokidar-cli":"^3.0.0","gh-release":"^7.0.1","highlight.js":"^11.7.0","http-server":"^14.1.1","husky":"^1.1.1","karma":"^6.4.1","karma-chrome-launcher":"^3.1.1","karma-coverage":"^2.2.0","karma-edgium-launcher":"github:matracey/karma-edgium-launcher","karma-firefox-launcher":"^2.1.2","karma-mocha":"^2.0.1","karma-mocha-reporter":"^2.2.5","karma-safari-launcher":"~1.0.0","karma-sinon-chai":"^2.0.2","karma-sourcemap-loader":"^0.3.8","leaflet":"^1.6.0","mkdirp":"^1.0.4","mocha":"^10.2.0","npm-run-all":"^4.1.5","rollup":"^2.79.1","semistandard":"^14.2.3","sinon":"^15.0.1","sinon-chai":"3.7.0","snazzy":"^9.0.0"},"files":["src/**/*.js","dist/esri-leaflet.js","dist/esri-leaflet.js.map","dist/esri-leaflet-debug.js.map","dist/siteData.json","profiles/*.js"],"homepage":"https://developers.arcgis.com/esri-leaflet/","module":"src/EsriLeaflet.js","jsnext:main":"src/EsriLeaflet.js","jspm":{"registry":"npm","format":"es6","main":"src/EsriLeaflet.js"},"keywords":["arcgis","esri","esri leaflet","gis","leaflet plugin","mapping"],"license":"Apache-2.0","main":"dist/esri-leaflet-debug.js","peerDependencies":{"leaflet":"^1.0.0"},"readmeFilename":"README.md","repository":{"type":"git","url":"git@github.com:Esri/esri-leaflet.git"},"scripts":{"build":"rollup -c profiles/debug.js & rollup -c profiles/production.js","lint":"semistandard | snazzy","prebuild":"mkdirp dist","pretest":"npm run build","precommit":"npm run lint","fix":"semistandard --fix","release":"./scripts/release.sh","start-watch":"chokidar src -c \\"npm run build\\"","start":"run-p start-watch serve","serve":"http-server -p 5000 -c-1 -o","test":"npm run lint && karma start"},"semistandard":{"globals":["expect","L","XMLHttpRequest","sinon","xhr","proj4"]},"unpkg":"dist/esri-leaflet-debug.js"}')}),l.register("bNpnD",function(i,r){o(i.exports,"cors",function(){return n}),o(i.exports,"pointerEvents",function(){return a}),o(i.exports,"Support",function(){return s});var n=window.XMLHttpRequest&&"withCredentials"in new window.XMLHttpRequest,a=""===document.documentElement.style.pointerEvents,s={cors:n,pointerEvents:a}}),l.register("hm4bN",function(i,r){o(i.exports,"options",function(){return n});var n={attributionWidthOffset:55}}),l.register("k6IM7",function(i,r){o(i.exports,"geojsonToArcGIS",function(){return d}),o(i.exports,"extentToBounds",function(){return f}),o(i.exports,"boundsToExtent",function(){return m}),o(i.exports,"responseToFeatureCollection",function(){return v}),o(i.exports,"cleanUrl",function(){return x}),o(i.exports,"getUrlParams",function(){return b}),o(i.exports,"isArcgisOnline",function(){return w}),o(i.exports,"setEsriAttribution",function(){return S}),o(i.exports,"removeEsriAttribution",function(){return C}),o(i.exports,"_setGeometry",function(){return I}),o(i.exports,"_getAttributionData",function(){return A}),o(i.exports,"_updateMapAttribution",function(){return P}),o(i.exports,"EsriUtil",function(){return k}),o(i.exports,"warn",function(){return l("cIGnu").warn});var n=l("iLKzi"),a=l("cIGnu"),s=l("hm4bN"),u=l("bNpnD"),h=l("78T1s"),c='<a href="http://leafletjs.com" title="A JS library for interactive maps">Leaflet</a>';function d(i,r){return(0,h.geojsonToArcGIS)(i,r)}function p(i,r){return(0,h.arcgisToGeoJSON)(i,r)}function f(i){if("NaN"===i.xmin||"NaN"===i.ymin||"NaN"===i.xmax||"NaN"===i.ymax)return null;var r=(0,n.latLng)(i.ymin,i.xmin),o=(0,n.latLng)(i.ymax,i.xmax);return(0,n.latLngBounds)(r,o)}function m(i){return{xmin:(i=(0,n.latLngBounds)(i)).getSouthWest().lng,ymin:i.getSouthWest().lat,xmax:i.getNorthEast().lng,ymax:i.getNorthEast().lat,spatialReference:{wkid:4326}}}var g=/^(OBJECTID|FID|OID|ID)$/i;function _(i){var r;if(i.objectIdFieldName)r=i.objectIdFieldName;else if(i.fields){for(var n=0;n<=i.fields.length-1;n++)if("esriFieldTypeOID"===i.fields[n].type){r=i.fields[n].name;break}if(!r){for(n=0;n<=i.fields.length-1;n++)if(i.fields[n].name.match(g)){r=i.fields[n].name;break}}}return r}function y(i){for(var r in i.attributes)if(r.match(g))return r}function v(i,r){var n,o=i.features||i.results,a=o&&o.length;n=r||_(i);var s={type:"FeatureCollection",features:[]};if(a)for(var l=o.length-1;l>=0;l--){var u=p(o[l],n||y(o[l]));s.features.push(u)}return s}function x(i){return"/"!==(i=(0,n.Util).trim(i))[i.length-1]&&(i+="/"),i}function b(i){if(-1!==i.url.indexOf("?")){i.requestParams=i.requestParams||{};var r=i.url.substring(i.url.indexOf("?")+1);i.url=i.url.split("?")[0],i.requestParams=JSON.parse('{"'+decodeURI(r).replace(/"/g,'\\"').replace(/&/g,'","').replace(/=/g,'":"')+'"}')}return i.url=x(i.url.split("?")[0]),i}function w(i){return/^(?!.*utility\.arcgis\.com).*\.arcgis\.com.*FeatureServer/i.test(i)}function T(i){var r;switch(i){case"Point":r="esriGeometryPoint";break;case"MultiPoint":r="esriGeometryMultipoint";break;case"LineString":case"MultiLineString":r="esriGeometryPolyline";break;case"Polygon":case"MultiPolygon":r="esriGeometryPolygon"}return r}function E(i){return i.getSize().x-s.options.attributionWidthOffset+"px"}function S(i){if(i.attributionControl){if(i.attributionControl._esriAttributionLayerCount||(i.attributionControl._esriAttributionLayerCount=0),0===i.attributionControl._esriAttributionLayerCount){if(!i.attributionControl._esriAttributionAddedOnce){var r=document.createElement("style");r.type="text/css",r.innerHTML=".esri-truncated-attribution:hover {white-space: normal;}",document.getElementsByTagName("head")[0].appendChild(r);var o=document.createElement("style");o.type="text/css",o.innerHTML=".esri-truncated-attribution {vertical-align: -3px;white-space: nowrap;overflow: hidden;text-overflow: ellipsis;display: inline-block;transition: 0s white-space;transition-delay: 1s;max-width: "+E(i)+";}",document.getElementsByTagName("head")[0].appendChild(o),i.on("resize",function(r){i.attributionControl&&(i.attributionControl._container.style.maxWidth=E(r.target))}),i.attributionControl._esriAttributionAddedOnce=!0}i.attributionControl.setPrefix(c+' | Powered by <a href="https://www.esri.com">Esri</a>'),(0,n.DomUtil).addClass(i.attributionControl._container,"esri-truncated-attribution:hover"),(0,n.DomUtil).addClass(i.attributionControl._container,"esri-truncated-attribution")}i.attributionControl._esriAttributionLayerCount=i.attributionControl._esriAttributionLayerCount+1}}function C(i){i.attributionControl&&(i.attributionControl._esriAttributionLayerCount&&1===i.attributionControl._esriAttributionLayerCount&&(i.attributionControl.setPrefix(c),(0,n.DomUtil).removeClass(i.attributionControl._container,"esri-truncated-attribution:hover"),(0,n.DomUtil).removeClass(i.attributionControl._container,"esri-truncated-attribution")),i.attributionControl._esriAttributionLayerCount=i.attributionControl._esriAttributionLayerCount-1)}function I(i){var r={geometry:null,geometryType:null};return i instanceof n.LatLngBounds?(r.geometry=m(i),r.geometryType="esriGeometryEnvelope",r):(i.getLatLng&&(i=i.getLatLng()),i instanceof n.LatLng&&(i={type:"Point",coordinates:[i.lng,i.lat]}),i instanceof n.GeoJSON&&(i=i.getLayers()[0].feature.geometry,r.geometry=d(i),r.geometryType=T(i.type)),i.toGeoJSON&&(i=i.toGeoJSON()),"Feature"===i.type&&(i=i.geometry),"Point"===i.type||"LineString"===i.type||"Polygon"===i.type||"MultiPolygon"===i.type)?(r.geometry=d(i),r.geometryType=T(i.type),r):void(0,a.warn)("invalid geometry passed to spatial query. Should be L.LatLng, L.LatLngBounds, L.Marker or a GeoJSON Point, Line, Polygon or MultiPolygon object")}function A(i,r){u.Support.cors&&(0,a.request)(i,{},(0,n.Util).bind(function(i,o){if(!i){r._esriAttributions=[];for(var a=0;a<o.contributors.length;a++)for(var s=o.contributors[a],l=0;l<s.coverageAreas.length;l++){var u=s.coverageAreas[l],h=(0,n.latLng)(u.bbox[0],u.bbox[1]),c=(0,n.latLng)(u.bbox[2],u.bbox[3]);r._esriAttributions.push({attribution:s.attribution,score:u.score,bounds:(0,n.latLngBounds)(h,c),minZoom:u.zoomMin,maxZoom:u.zoomMax})}r._esriAttributions.sort(function(i,r){return r.score-i.score}),P({target:r})}},this))}function P(i){var r=i.target,o=r._esriAttributions;if(r&&r.attributionControl){var a=r.attributionControl._container.querySelector(".esri-dynamic-attribution");if(a&&o){for(var s="",l=r.getBounds(),u=(0,n.latLngBounds)(l.getSouthWest().wrap(),l.getNorthEast().wrap()),h=r.getZoom(),c=0;c<o.length;c++){var d=o[c],p=d.attribution;!s.match(p)&&d.bounds.intersects(u)&&h>=d.minZoom&&h<=d.maxZoom&&(s+=", "+p)}s=s.substr(2),a.innerHTML=s,a.style.maxWidth=E(r),r.fire("attributionupdated",{attribution:s})}}}var k={warn:a.warn,cleanUrl:x,getUrlParams:b,isArcgisOnline:w,geojsonTypeToArcGIS:T,responseToFeatureCollection:v,geojsonToArcGIS:d,arcgisToGeoJSON:p,boundsToExtent:m,extentToBounds:f,calcAttributionWidth:E,setEsriAttribution:S,_setGeometry:I,_getAttributionData:A,_updateMapAttribution:P,_findIdAttributeFromFeature:y,_findIdAttributeFromResponse:_}}),l.register("cIGnu",function(i,r){o(i.exports,"post",function(){return c}),o(i.exports,"request",function(){return p}),o(i.exports,"warn",function(){return g}),o(i.exports,"get",function(){return m}),o(i.exports,"default",function(){return _});var n=l("iLKzi"),a=l("bNpnD"),s=0;function u(i){var r="";for(var n in i.f=i.f||"json",i)if(Object.prototype.hasOwnProperty.call(i,n)){var o,a=i[n],s=Object.prototype.toString.call(a);r.length&&(r+="&"),o="[object Array]"===s?"[object Object]"===Object.prototype.toString.call(a[0])?JSON.stringify(a):a.join(","):"[object Object]"===s?JSON.stringify(a):"[object Date]"===s?a.valueOf():a,r+=encodeURIComponent(n)+"="+encodeURIComponent(o)}return r}function h(i,r){var o=new window.XMLHttpRequest;return o.onerror=function(a){o.onreadystatechange=n.Util.falseFn,i.call(r,{error:{code:500,message:"XMLHttpRequest error"}},null)},o.onreadystatechange=function(){var a,s;if(4===o.readyState){try{a=JSON.parse(o.responseText)}catch(i){a=null,s={code:500,message:"Could not parse response as JSON. This could also be caused by a CORS or XMLHttpRequest error."}}!s&&a.error&&(s=a.error,a=null),o.onerror=n.Util.falseFn,i.call(r,s,a)}},o.ontimeout=function(){this.onerror()},o}function c(i,r,n,o){var a=h(n,o);return a.open("POST",i),null!=o&&void 0!==o.options&&(a.timeout=o.options.timeout),a.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8"),a.send(u(r)),a}function d(i,r,n,o){var a=h(n,o);return a.open("GET",i+"?"+u(r),!0),null!=o&&void 0!==o.options&&(a.timeout=o.options.timeout,o.options.withCredentials&&(a.withCredentials=!0)),a.send(null),a}function p(i,r,n,o){var s=u(r),l=h(n,o),c=(i+"?"+s).length;if(c<=2e3&&a.Support.cors?l.open("GET",i+"?"+s):c>2e3&&a.Support.cors&&(l.open("POST",i),l.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8")),null!=o&&void 0!==o.options&&(l.timeout=o.options.timeout,o.options.withCredentials&&(l.withCredentials=!0)),c<=2e3&&a.Support.cors)l.send(null);else{if(!(c>2e3)||!a.Support.cors)return c<=2e3&&!a.Support.cors?f(i,r,n,o):void g("a request to "+i+" was longer then 2000 characters and this browser cannot make a cross-domain post request. Please use a proxy https://developers.arcgis.com/esri-leaflet/api-reference/request/");l.send(s)}return l}function f(i,r,o,a){window._EsriLeafletCallbacks=window._EsriLeafletCallbacks||{};var l="c"+s;r.callback="window._EsriLeafletCallbacks."+l,window._EsriLeafletCallbacks[l]=function(i){if(!0!==window._EsriLeafletCallbacks[l]){var r,n=Object.prototype.toString.call(i);"[object Object]"===n||"[object Array]"===n||(r={error:{code:500,message:"Expected array or object as JSONP response"}},i=null),!r&&i.error&&(r=i,i=null),o.call(a,r,i),window._EsriLeafletCallbacks[l]=!0}};var h=(0,n.DomUtil).create("script",null,document.body);return h.type="text/javascript",h.src=i+"?"+u(r),h.id=l,h.onerror=function(i){i&&!0!==window._EsriLeafletCallbacks[l]&&(o.call(a,{error:{code:500,message:"An unknown error occurred"}}),window._EsriLeafletCallbacks[l]=!0)},(0,n.DomUtil).addClass(h,"esri-leaflet-jsonp"),s++,{id:l,url:h.src,abort:function(){window._EsriLeafletCallbacks._callback[l]({code:0,message:"Request aborted."})}}}var m=a.Support.cors?d:f;function g(){console&&console.warn&&console.warn.apply(console,arguments)}m.CORS=d,m.JSONP=f;var _={request:p,get:m,post:c}}),l.register("78T1s",function(i,r){o(i.exports,"arcgisToGeoJSON",function(){return m}),o(i.exports,"geojsonToArcGIS",function(){return y});var n=function(i,r,n,o){var a=(o[0]-n[0])*(i[1]-n[1])-(o[1]-n[1])*(i[0]-n[0]),s=(r[0]-i[0])*(i[1]-n[1])-(r[1]-i[1])*(i[0]-n[0]),l=(o[1]-n[1])*(r[0]-i[0])-(o[0]-n[0])*(r[1]-i[1]);if(0!==l){var u=a/l,h=s/l;if(u>=0&&u<=1&&h>=0&&h<=1)return!0}return!1},a=function(i,r){for(var n=!1,o=-1,a=i.length,s=a-1;++o<a;s=o)(i[o][1]<=r[1]&&r[1]<i[s][1]||i[s][1]<=r[1]&&r[1]<i[o][1])&&r[0]<(i[s][0]-i[o][0])*(r[1]-i[o][1])/(i[s][1]-i[o][1])+i[o][0]&&(n=!n);return n},s=function(i,r){for(var n=0;n<i.length;n++)if(i[n]!==r[n])return!1;return!0},l=function(i,r){for(var o=0;o<i.length-1;o++)for(var a=0;a<r.length-1;a++)if(n(i[o],i[o+1],r[a],r[a+1]))return!0;return!1},u=function(i){return s(i[0],i[i.length-1])||i.push(i[0]),i},h=function(i){for(var r,n=0,o=0,a=i.length,s=i[o];o<a-1;o++)n+=((r=i[o+1])[0]-s[0])*(r[1]+s[1]),s=r;return n>=0},c=function(i){var r={};for(var n in i)i.hasOwnProperty(n)&&(r[n]=i[n]);return r},d=function(i,r){var n=l(i,r),o=a(i,r[0]);return!n&&!!o},p=function(i){for(var r,n,o=[],a=[],s=0;s<i.length;s++){var c=u(i[s].slice(0));if(!(c.length<4)){if(h(c)){var p=[c.slice().reverse()];o.push(p)}else a.push(c.slice().reverse())}}for(var f=[];a.length;){n=a.pop();var m=!1;for(r=o.length-1;r>=0;r--)if(d(o[r][0],n)){o[r].push(n),m=!0;break}m||f.push(n)}for(;f.length;){n=f.pop();var g=!1;for(r=o.length-1;r>=0;r--)if(l(o[r][0],n)){o[r].push(n),g=!0;break}g||o.push([n.reverse()])}return 1===o.length?{type:"Polygon",coordinates:o[0]}:{type:"MultiPolygon",coordinates:o}},f=function(i,r){for(var n=r?[r,"OBJECTID","FID"]:["OBJECTID","FID"],o=0;o<n.length;o++){var a=n[o];if(a in i&&("string"==typeof i[a]||"number"==typeof i[a]))return i[a]}throw Error("No valid id attribute found")},m=function i(r,n){var o={};if(r.features){o.type="FeatureCollection",o.features=[];for(var a=0;a<r.features.length;a++)o.features.push(i(r.features[a],n))}if("number"==typeof r.x&&"number"==typeof r.y&&(o.type="Point",o.coordinates=[r.x,r.y],"number"==typeof r.z&&o.coordinates.push(r.z)),r.points&&(o.type="MultiPoint",o.coordinates=r.points.slice(0)),r.paths&&(1===r.paths.length?(o.type="LineString",o.coordinates=r.paths[0].slice(0)):(o.type="MultiLineString",o.coordinates=r.paths.slice(0))),r.rings&&(o=p(r.rings.slice(0))),"number"==typeof r.xmin&&"number"==typeof r.ymin&&"number"==typeof r.xmax&&"number"==typeof r.ymax&&(o.type="Polygon",o.coordinates=[[[r.xmax,r.ymax],[r.xmin,r.ymax],[r.xmin,r.ymin],[r.xmax,r.ymin],[r.xmax,r.ymax]]]),(r.geometry||r.attributes)&&(o.type="Feature",o.geometry=r.geometry?i(r.geometry):null,o.properties=r.attributes?c(r.attributes):null,r.attributes))try{o.id=f(r.attributes,n)}catch(i){}return JSON.stringify(o.geometry)===JSON.stringify({})&&(o.geometry=null),r.spatialReference&&r.spatialReference.wkid&&4326!==r.spatialReference.wkid&&console.warn("Object converted in non-standard crs - "+JSON.stringify(r.spatialReference)),o},g=function(i){var r=[],n=i.slice(0),o=u(n.shift().slice(0));if(o.length>=4){h(o)||o.reverse(),r.push(o);for(var a=0;a<n.length;a++){var s=u(n[a].slice(0));s.length>=4&&(h(s)&&s.reverse(),r.push(s))}}return r},_=function(i){for(var r=[],n=0;n<i.length;n++)for(var o=g(i[n]),a=o.length-1;a>=0;a--){var s=o[a].slice(0);r.push(s)}return r},y=function i(r,n){n=n||"OBJECTID";var o,a={wkid:4326},s={};switch(r.type){case"Point":s.x=r.coordinates[0],s.y=r.coordinates[1],null!=r.coordinates[2]&&(s.z=r.coordinates[2]),s.spatialReference=a;break;case"MultiPoint":s.points=r.coordinates.slice(0),null!=r.coordinates[0][2]&&(s.hasZ=!0),s.spatialReference=a;break;case"LineString":s.paths=[r.coordinates.slice(0)],null!=r.coordinates[0][2]&&(s.hasZ=!0),s.spatialReference=a;break;case"MultiLineString":s.paths=r.coordinates.slice(0),null!=r.coordinates[0][0][2]&&(s.hasZ=!0),s.spatialReference=a;break;case"Polygon":s.rings=g(r.coordinates.slice(0)),null!=r.coordinates[0][0][2]&&(s.hasZ=!0),s.spatialReference=a;break;case"MultiPolygon":s.rings=_(r.coordinates.slice(0)),null!=r.coordinates[0][0][0][2]&&(s.hasZ=!0),s.spatialReference=a;break;case"Feature":r.geometry&&(s.geometry=i(r.geometry,n)),s.attributes=r.properties?c(r.properties):{},r.id&&(s.attributes[n]=r.id);break;case"FeatureCollection":for(o=0,s=[];o<r.features.length;o++)s.push(i(r.features[o],n));break;case"GeometryCollection":for(o=0,s=[];o<r.geometries.length;o++)s.push(i(r.geometries[o],n))}return s}}),l.register("hY3s0",function(i,r){o(i.exports,"Task",function(){return h}),o(i.exports,"task",function(){return c});var n=l("iLKzi"),a=l("bNpnD"),s=l("k6IM7"),u=l("cIGnu"),h=(0,n.Class).extend({options:{proxy:!1,useCors:a.cors},generateSetter:function(i,r){return(0,n.Util).bind(function(r){return this.params[i]=r,this},r)},initialize:function(i){if(i.request&&i.options?(this._service=i,(0,n.Util).setOptions(this,i.options)):((0,n.Util).setOptions(this,i),this.options.url=(0,s.cleanUrl)(i.url)),this.params=(0,n.Util).extend({},this.params||{}),this.setters)for(var r in this.setters){var o=this.setters[r];this[r]=this.generateSetter(o,this)}},token:function(i){return this._service?this._service.authenticate(i):this.params.token=i,this},apikey:function(i){return this.token(i)},format:function(i){return this.params.returnUnformattedValues=!i,this},request:function(i,r){return(this.options.requestParams&&(0,n.Util).extend(this.params,this.options.requestParams),this._service)?this._service.request(this.path,this.params,i,r):this._request("request",this.path,this.params,i,r)},_request:function(i,r,n,o,a){var s=this.options.proxy?this.options.proxy+"?"+this.options.url+r:this.options.url+r;return"get"!==i&&"request"!==i||this.options.useCors?(0,u.default)[i](s,n,o,a):(0,u.default).get.JSONP(s,n,o,a)}});function c(i){return i=(0,s.getUrlParams)(i),new h(i)}}),l.register("ga874",function(i,r){o(i.exports,"Query",function(){return h}),o(i.exports,"query",function(){return c}),o(i.exports,"default",function(){return d});var n=l("iLKzi"),a=l("hY3s0"),s=l("k6IM7"),u=l("cIGnu"),h=(0,a.Task).extend({setters:{offset:"resultOffset",limit:"resultRecordCount",fields:"outFields",precision:"geometryPrecision",featureIds:"objectIds",returnGeometry:"returnGeometry",returnM:"returnM",transform:"datumTransformation",token:"token"},path:"query",params:{returnGeometry:!0,where:"1=1",outSR:4326,outFields:"*"},within:function(i){return this._setGeometryParams(i),this.params.spatialRel="esriSpatialRelContains",this},intersects:function(i){return this._setGeometryParams(i),this.params.spatialRel="esriSpatialRelIntersects",this},contains:function(i){return this._setGeometryParams(i),this.params.spatialRel="esriSpatialRelWithin",this},crosses:function(i){return this._setGeometryParams(i),this.params.spatialRel="esriSpatialRelCrosses",this},touches:function(i){return this._setGeometryParams(i),this.params.spatialRel="esriSpatialRelTouches",this},overlaps:function(i){return this._setGeometryParams(i),this.params.spatialRel="esriSpatialRelOverlaps",this},bboxIntersects:function(i){return this._setGeometryParams(i),this.params.spatialRel="esriSpatialRelEnvelopeIntersects",this},indexIntersects:function(i){return this._setGeometryParams(i),this.params.spatialRel="esriSpatialRelIndexIntersects",this},nearby:function(i,r){return i=(0,n.latLng)(i),this.params.geometry=[i.lng,i.lat],this.params.geometryType="esriGeometryPoint",this.params.spatialRel="esriSpatialRelIntersects",this.params.units="esriSRUnit_Meter",this.params.distance=r,this.params.inSR=4326,this},where:function(i){return this.params.where=i,this},between:function(i,r){return this.params.time=[i.valueOf(),r.valueOf()],this},simplify:function(i,r){var n=Math.abs(i.getBounds().getWest()-i.getBounds().getEast());return this.params.maxAllowableOffset=n/i.getSize().y*r,this},orderBy:function(i,r){return r=r||"ASC",this.params.orderByFields=this.params.orderByFields?this.params.orderByFields+",":"",this.params.orderByFields+=[i,r].join(" "),this},run:function(i,r){return(this._cleanParams(),this.options.isModern||(0,s.isArcgisOnline)(this.options.url)&&void 0===this.options.isModern)?(this.params.f="geojson",this.request(function(n,o){this._trapSQLerrors(n),i.call(r,n,o,o)},this)):this.request(function(n,o){this._trapSQLerrors(n),i.call(r,n,o&&(0,s.responseToFeatureCollection)(o),o)},this)},count:function(i,r){return this._cleanParams(),this.params.returnCountOnly=!0,this.request(function(r,n){i.call(this,r,n&&n.count,n)},r)},ids:function(i,r){return this._cleanParams(),this.params.returnIdsOnly=!0,this.request(function(r,n){i.call(this,r,n&&n.objectIds,n)},r)},bounds:function(i,r){return this._cleanParams(),this.params.returnExtentOnly=!0,this.request(function(n,o){o&&o.extent&&(0,s.extentToBounds)(o.extent)?i.call(r,n,(0,s.extentToBounds)(o.extent),o):(n={message:"Invalid Bounds"},i.call(r,n,null,o))},r)},distinct:function(){return this.params.returnGeometry=!1,this.params.returnDistinctValues=!0,this},pixelSize:function(i){var r=(0,n.point)(i);return this.params.pixelSize=[r.x,r.y],this},layer:function(i){return this.path=i+"/query",this},_trapSQLerrors:function(i){i&&"400"===i.code&&(0,u.warn)("one common syntax error in query requests is encasing string values in double quotes instead of single quotes")},_cleanParams:function(){delete this.params.returnIdsOnly,delete this.params.returnExtentOnly,delete this.params.returnCountOnly},_setGeometryParams:function(i){this.params.inSR=4326;var r=(0,s._setGeometry)(i);this.params.geometry=r.geometry,this.params.geometryType=r.geometryType}});function c(i){return new h(i)}var d=c}),l.register("jVf2K",function(i,r){o(i.exports,"Find",function(){return s}),o(i.exports,"find",function(){return u}),o(i.exports,"default",function(){return h});var n=l("hY3s0"),a=l("k6IM7"),s=(0,n.Task).extend({setters:{contains:"contains",text:"searchText",fields:"searchFields",spatialReference:"sr",sr:"sr",layers:"layers",returnGeometry:"returnGeometry",maxAllowableOffset:"maxAllowableOffset",precision:"geometryPrecision",dynamicLayers:"dynamicLayers",returnZ:"returnZ",returnM:"returnM",gdbVersion:"gdbVersion",token:"token"},path:"find",params:{sr:4326,contains:!0,returnGeometry:!0,returnZ:!0,returnM:!1},layerDefs:function(i,r){return this.params.layerDefs=this.params.layerDefs?this.params.layerDefs+";":"",this.params.layerDefs+=[i,r].join(":"),this},simplify:function(i,r){var n=Math.abs(i.getBounds().getWest()-i.getBounds().getEast());return this.params.maxAllowableOffset=n/i.getSize().y*r,this},run:function(i,r){return this.request(function(n,o){i.call(r,n,o&&(0,a.responseToFeatureCollection)(o),o)},r)}});function u(i){return new s(i)}var h=u}),l.register("c8FNr",function(i,r){o(i.exports,"Identify",function(){return n}),o(i.exports,"identify",function(){return a});var n=(0,l("hY3s0").Task).extend({path:"identify",between:function(i,r){return this.params.time=[i.valueOf(),r.valueOf()],this}});function a(i){return new n(i)}}),l.register("hybbU",function(i,r){o(i.exports,"IdentifyFeatures",function(){return u}),o(i.exports,"identifyFeatures",function(){return h}),o(i.exports,"default",function(){return c});var n=l("iLKzi"),a=l("c8FNr"),s=l("k6IM7"),u=(0,a.Identify).extend({setters:{layers:"layers",precision:"geometryPrecision",tolerance:"tolerance",returnGeometry:"returnGeometry"},params:{sr:4326,layers:"all",tolerance:3,returnGeometry:!0},on:function(i){var r=(0,s.boundsToExtent)(i.getBounds()),n=i.getSize();return this.params.imageDisplay=[n.x,n.y,96],this.params.mapExtent=[r.xmin,r.ymin,r.xmax,r.ymax],this},at:function(i){return 2===i.length&&(i=(0,n.latLng)(i)),this._setGeometryParams(i),this},layerDef:function(i,r){return this.params.layerDefs=this.params.layerDefs?this.params.layerDefs+";":"",this.params.layerDefs+=[i,r].join(":"),this},simplify:function(i,r){var n=Math.abs(i.getBounds().getWest()-i.getBounds().getEast());return this.params.maxAllowableOffset=n/i.getSize().y*r,this},run:function(i,r){return this.request(function(n,o){if(n)i.call(r,n,void 0,o);else{var a=(0,s.responseToFeatureCollection)(o);o.results=o.results.reverse();for(var l=0;l<a.features.length;l++)a.features[l].layerId=o.results[l].layerId;i.call(r,void 0,a,o)}})},_setGeometryParams:function(i){var r=(0,s._setGeometry)(i);this.params.geometry=r.geometry,this.params.geometryType=r.geometryType}});function h(i){return new u(i)}var c=h}),l.register("hXemC",function(i,r){o(i.exports,"IdentifyImage",function(){return u}),o(i.exports,"identifyImage",function(){return h}),o(i.exports,"default",function(){return c});var n=l("iLKzi"),a=l("c8FNr"),s=l("k6IM7"),u=(0,a.Identify).extend({setters:{setMosaicRule:"mosaicRule",setRenderingRule:"renderingRule",setPixelSize:"pixelSize",returnCatalogItems:"returnCatalogItems",returnGeometry:"returnGeometry"},params:{returnGeometry:!1},at:function(i){return i=(0,n.latLng)(i),this.params.geometry=JSON.stringify({x:i.lng,y:i.lat,spatialReference:{wkid:4326}}),this.params.geometryType="esriGeometryPoint",this},getMosaicRule:function(){return this.params.mosaicRule},getRenderingRule:function(){return this.params.renderingRule},getPixelSize:function(){return this.params.pixelSize},run:function(i,r){return this.request(function(n,o){i.call(r,n,o&&this._responseToGeoJSON(o),o)},this)},_responseToGeoJSON:function(i){var r=i.location,n=i.catalogItems,o=i.catalogItemVisibilities,a={pixel:{type:"Feature",geometry:{type:"Point",coordinates:[r.x,r.y]},crs:{type:"EPSG",properties:{code:r.spatialReference.wkid}},properties:{OBJECTID:i.objectId,name:i.name,value:i.value},id:i.objectId}};if(i.properties&&i.properties.Values&&(a.pixel.properties.values=i.properties.Values),n&&n.features&&(a.catalogItems=(0,s.responseToFeatureCollection)(n),o&&o.length===a.catalogItems.features.length))for(var l=o.length-1;l>=0;l--)a.catalogItems.features[l].properties.catalogItemVisibility=o[l];return a}});function h(i){return new u(i)}var c=h}),l.register("cOlq6",function(i,r){o(i.exports,"Service",function(){return h}),o(i.exports,"service",function(){return c});var n=l("iLKzi"),a=l("bNpnD"),s=l("k6IM7"),u=l("cIGnu"),h=(0,n.Evented).extend({options:{proxy:!1,useCors:a.cors,timeout:0},initialize:function(i){i=i||{},this._requestQueue=[],this._authenticating=!1,(0,n.Util).setOptions(this,i),this.options.url=(0,s.cleanUrl)(this.options.url)},get:function(i,r,n,o){return this._request("get",i,r,n,o)},post:function(i,r,n,o){return this._request("post",i,r,n,o)},request:function(i,r,n,o){return this._request("request",i,r,n,o)},metadata:function(i,r){return this._request("get","",{},i,r)},authenticate:function(i){return this._authenticating=!1,this.options.token=i,this._runQueue(),this},getTimeout:function(){return this.options.timeout},setTimeout:function(i){this.options.timeout=i},_request:function(i,r,o,a,s){this.fire("requeststart",{url:this.options.url+r,params:o,method:i},!0);var l=this._createServiceCallback(i,r,o,a,s);if(this.options.token&&(o.token=this.options.token),this.options.requestParams&&(0,n.Util).extend(o,this.options.requestParams),this._authenticating)this._requestQueue.push([i,r,o,a,s]);else{var h=this.options.proxy?this.options.proxy+"?"+this.options.url+r:this.options.url+r;return"get"!==i&&"request"!==i||this.options.useCors?(0,u.default)[i](h,o,l,s):(0,u.default).get.JSONP(h,o,l,s)}},_createServiceCallback:function(i,r,o,a,s){return(0,n.Util).bind(function(l,u){l&&(499===l.code||498===l.code)&&(this._authenticating=!0,this._requestQueue.push([i,r,o,a,s]),this.fire("authenticationrequired",{authenticate:(0,n.Util).bind(this.authenticate,this)},!0),l.authenticate=(0,n.Util).bind(this.authenticate,this)),a.call(s,l,u),l?this.fire("requesterror",{url:this.options.url+r,params:o,message:l.message,code:l.code,method:i},!0):this.fire("requestsuccess",{url:this.options.url+r,params:o,response:u,method:i},!0),this.fire("requestend",{url:this.options.url+r,params:o,method:i},!0)},this)},_runQueue:function(){for(var i=this._requestQueue.length-1;i>=0;i--){var r=this._requestQueue[i];this[r.shift()].apply(this,r)}this._requestQueue=[]}});function c(i){return i=(0,s.getUrlParams)(i),new h(i)}}),l.register("1AQfr",function(i,r){o(i.exports,"MapService",function(){return h}),o(i.exports,"mapService",function(){return c}),o(i.exports,"default",function(){return d});var n=l("cOlq6"),a=l("hybbU"),s=l("ga874"),u=l("jVf2K"),h=(0,n.Service).extend({identify:function(){return(0,a.default)(this)},find:function(){return(0,u.default)(this)},query:function(){return(0,s.default)(this)}});function c(i){return new h(i)}var d=c}),l.register("cwl41",function(i,r){o(i.exports,"ImageService",function(){return u}),o(i.exports,"imageService",function(){return h}),o(i.exports,"default",function(){return c});var n=l("cOlq6"),a=l("hXemC"),s=l("ga874"),u=(0,n.Service).extend({query:function(){return(0,s.default)(this)},identify:function(){return(0,a.default)(this)}});function h(i){return new u(i)}var c=h}),l.register("fQi3s",function(i,r){o(i.exports,"FeatureLayerService",function(){return u}),o(i.exports,"featureLayerService",function(){return h}),o(i.exports,"default",function(){return c});var n=l("cOlq6"),a=l("ga874"),s=l("k6IM7"),u=(0,n.Service).extend({options:{idAttribute:"OBJECTID"},query:function(){return(0,a.default)(this)},addFeature:function(i,r,n){this.addFeatures(i,r,n)},addFeatures:function(i,r,n){for(var o=i.features?i.features:[i],a=o.length-1;a>=0;a--)delete o[a].id;return i=(0,s.geojsonToArcGIS)(i),i=o.length>1?i:[i],this.post("addFeatures",{features:i},function(i,o){var a=o&&o.addResults?o.addResults.length>1?o.addResults:o.addResults[0]:void 0;r&&r.call(n,i||o.addResults[0].error,a)},n)},updateFeature:function(i,r,n){this.updateFeatures(i,r,n)},updateFeatures:function(i,r,n){var o=i.features?i.features:[i];return i=(0,s.geojsonToArcGIS)(i,this.options.idAttribute),i=o.length>1?i:[i],this.post("updateFeatures",{features:i},function(i,o){var a=o&&o.updateResults?o.updateResults.length>1?o.updateResults:o.updateResults[0]:void 0;r&&r.call(n,i||o.updateResults[0].error,a)},n)},deleteFeature:function(i,r,n){this.deleteFeatures(i,r,n)},deleteFeatures:function(i,r,n){return this.post("deleteFeatures",{objectIds:i},function(i,o){var a=o&&o.deleteResults?o.deleteResults.length>1?o.deleteResults:o.deleteResults[0]:void 0;r&&r.call(n,i||o.deleteResults[0].error,a)},n)}});function h(i){return new u(i)}var c=h}),l.register("bxfxf",function(i,r){o(i.exports,"BasemapLayer",function(){return h}),o(i.exports,"basemapLayer",function(){return c});var n=l("iLKzi"),a=l("bNpnD"),s=l("k6IM7"),u="https:"!==window.location.protocol?"http:":"https:",h=(0,n.TileLayer).extend({statics:{TILES:{Streets:{urlTemplate:u+"//{s}.arcgisonline.com/ArcGIS/rest/services/World_Street_Map/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:19,subdomains:["server","services"],attribution:"USGS, NOAA",attributionUrl:"https://static.arcgis.com/attribution/World_Street_Map"}},Topographic:{urlTemplate:u+"//{s}.arcgisonline.com/ArcGIS/rest/services/World_Topo_Map/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:19,subdomains:["server","services"],attribution:"USGS, NOAA",attributionUrl:"https://static.arcgis.com/attribution/World_Topo_Map"}},Oceans:{urlTemplate:u+"//{s}.arcgisonline.com/arcgis/rest/services/Ocean/World_Ocean_Base/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:16,subdomains:["server","services"],attribution:"USGS, NOAA",attributionUrl:"https://static.arcgis.com/attribution/Ocean_Basemap"}},OceansLabels:{urlTemplate:u+"//{s}.arcgisonline.com/arcgis/rest/services/Ocean/World_Ocean_Reference/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:16,subdomains:["server","services"],pane:a.pointerEvents?"esri-labels":"tilePane",attribution:""}},NationalGeographic:{urlTemplate:u+"//{s}.arcgisonline.com/ArcGIS/rest/services/NatGeo_World_Map/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:16,subdomains:["server","services"],attribution:"National Geographic, DeLorme, HERE, UNEP-WCMC, USGS, NASA, ESA, METI, NRCAN, GEBCO, NOAA, increment P Corp."}},DarkGray:{urlTemplate:u+"//{s}.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Dark_Gray_Base/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:16,subdomains:["server","services"],attribution:"HERE, DeLorme, MapmyIndia, &copy; OpenStreetMap contributors"}},DarkGrayLabels:{urlTemplate:u+"//{s}.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Dark_Gray_Reference/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:16,subdomains:["server","services"],pane:a.pointerEvents?"esri-labels":"tilePane",attribution:""}},Gray:{urlTemplate:u+"//{s}.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Light_Gray_Base/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:16,subdomains:["server","services"],attribution:"HERE, DeLorme, MapmyIndia, &copy; OpenStreetMap contributors"}},GrayLabels:{urlTemplate:u+"//{s}.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Light_Gray_Reference/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:16,subdomains:["server","services"],pane:a.pointerEvents?"esri-labels":"tilePane",attribution:""}},Imagery:{urlTemplate:u+"//{s}.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:19,subdomains:["server","services"],attribution:"DigitalGlobe, GeoEye, i-cubed, USDA, USGS, AEX, Getmapping, Aerogrid, IGN, IGP, swisstopo, and the GIS User Community",attributionUrl:"https://static.arcgis.com/attribution/World_Imagery"}},ImageryLabels:{urlTemplate:u+"//{s}.arcgisonline.com/ArcGIS/rest/services/Reference/World_Boundaries_and_Places/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:19,subdomains:["server","services"],pane:a.pointerEvents?"esri-labels":"tilePane",attribution:""}},ImageryTransportation:{urlTemplate:u+"//{s}.arcgisonline.com/ArcGIS/rest/services/Reference/World_Transportation/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:19,subdomains:["server","services"],pane:a.pointerEvents?"esri-labels":"tilePane",attribution:""}},ShadedRelief:{urlTemplate:u+"//{s}.arcgisonline.com/ArcGIS/rest/services/World_Shaded_Relief/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:13,subdomains:["server","services"],attribution:"USGS"}},ShadedReliefLabels:{urlTemplate:u+"//{s}.arcgisonline.com/ArcGIS/rest/services/Reference/World_Boundaries_and_Places_Alternate/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:12,subdomains:["server","services"],pane:a.pointerEvents?"esri-labels":"tilePane",attribution:""}},Terrain:{urlTemplate:u+"//{s}.arcgisonline.com/ArcGIS/rest/services/World_Terrain_Base/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:13,subdomains:["server","services"],attribution:"USGS, NOAA"}},TerrainLabels:{urlTemplate:u+"//{s}.arcgisonline.com/ArcGIS/rest/services/Reference/World_Reference_Overlay/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:13,subdomains:["server","services"],pane:a.pointerEvents?"esri-labels":"tilePane",attribution:""}},USATopo:{urlTemplate:u+"//{s}.arcgisonline.com/ArcGIS/rest/services/USA_Topo_Maps/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:15,subdomains:["server","services"],attribution:"USGS, National Geographic Society, i-cubed"}},ImageryClarity:{urlTemplate:u+"//clarity.maptiles.arcgis.com/arcgis/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:19,attribution:"Esri, DigitalGlobe, GeoEye, Earthstar Geographics, CNES/Airbus DS, USDA, USGS, AeroGRID, IGN, and the GIS User Community"}},Physical:{urlTemplate:u+"//{s}.arcgisonline.com/arcgis/rest/services/World_Physical_Map/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:8,subdomains:["server","services"],attribution:"U.S. National Park Service"}},ImageryFirefly:{urlTemplate:u+"//fly.maptiles.arcgis.com/arcgis/rest/services/World_Imagery_Firefly/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:19,attribution:"Esri, DigitalGlobe, GeoEye, Earthstar Geographics, CNES/Airbus DS, USDA, USGS, AeroGRID, IGN, and the GIS User Community",attributionUrl:"https://static.arcgis.com/attribution/World_Imagery"}}}},initialize:function(i,r){if("object"==typeof i&&i.urlTemplate&&i.options)o=i;else if("string"==typeof i&&h.TILES[i])o=h.TILES[i];else throw Error('L.esri.BasemapLayer: Invalid parameter. Use one of "Streets", "Topographic", "Oceans", "OceansLabels", "NationalGeographic", "Physical", "Gray", "GrayLabels", "DarkGray", "DarkGrayLabels", "Imagery", "ImageryLabels", "ImageryTransportation", "ImageryClarity", "ImageryFirefly", ShadedRelief", "ShadedReliefLabels", "Terrain", "TerrainLabels" or "USATopo"');var o,a=(0,n.Util).extend(o.options,r);(0,n.Util).setOptions(this,a),this.options.ignoreDeprecationWarning||console.warn("WARNING: L.esri.BasemapLayer uses data services that are in mature support and are not being updated. Please use L.esri.Vector.vectorBasemapLayer instead. More info: https://esriurl.com/esri-leaflet-basemap"),this.options.token&&-1===o.urlTemplate.indexOf("token=")&&(o.urlTemplate+="?token="+this.options.token),this.options.proxy&&(o.urlTemplate=this.options.proxy+"?"+o.urlTemplate),(0,n.TileLayer).prototype.initialize.call(this,o.urlTemplate,a)},onAdd:function(i){(0,s.setEsriAttribution)(i),"esri-labels"===this.options.pane&&this._initPane(),this.options.attributionUrl&&(0,s._getAttributionData)((this.options.proxy?this.options.proxy+"?":"")+this.options.attributionUrl,i),i.on("moveend",s._updateMapAttribution),(0,n.TileLayer).prototype.onAdd.call(this,i)},onRemove:function(i){(0,s.removeEsriAttribution)(i),i.off("moveend",s._updateMapAttribution),(0,n.TileLayer).prototype.onRemove.call(this,i)},_initPane:function(){if(!this._map.getPane(this.options.pane)){var i=this._map.createPane(this.options.pane);i.style.pointerEvents="none",i.style.zIndex=500}},getAttribution:function(){if(this.options.attribution)var i='<span class="esri-dynamic-attribution">'+this.options.attribution+"</span>";return i}});function c(i,r){return new h(i,r)}}),l.register("5N6lL",function(i,r){o(i.exports,"TiledMapLayer",function(){return h}),o(i.exports,"tiledMapLayer",function(){return c});var n=l("iLKzi"),a=l("k6IM7"),s=l("cIGnu"),u=l("1AQfr"),h=(0,n.TileLayer).extend({options:{zoomOffsetAllowance:.1,errorTileUrl:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQAAAAEABAMAAACuXLVVAAAAA1BMVEUzNDVszlHHAAAAAXRSTlMAQObYZgAAAAlwSFlzAAAAAAAAAAAB6mUWpAAAADZJREFUeJztwQEBAAAAgiD/r25IQAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA7waBAAABw08RwAAAAABJRU5ErkJggg=="},statics:{MercatorZoomLevels:{0:156543.033928,1:78271.5169639999,2:39135.7584820001,3:19567.8792409999,4:9783.93962049996,5:4891.96981024998,6:2445.98490512499,7:1222.99245256249,8:611.49622628138,9:305.748113140558,10:152.874056570411,11:76.4370282850732,12:38.2185141425366,13:19.1092570712683,14:9.55462853563415,15:4.77731426794937,16:2.38865713397468,17:1.19432856685505,18:.597164283559817,19:.298582141647617,20:.14929107082381,21:.07464553541191,22:.0373227677059525,23:.0186613838529763}},initialize:function(i){i=(0,n.Util).setOptions(this,i),i=(0,a.getUrlParams)(i),this.tileUrl=(i.proxy?i.proxy+"?":"")+i.url+"tile/{z}/{y}/{x}"+(i.requestParams&&Object.keys(i.requestParams).length>0?(0,n.Util).getParamString(i.requestParams):""),-1!==i.url.indexOf("{s}")&&i.subdomains&&(i.url=i.url.replace("{s}",i.subdomains[0])),this.service=(0,u.default)(i),this.service.addEventParent(this),new RegExp(/tiles.arcgis(online)?\.com/g).test(i.url)&&(this.tileUrl=this.tileUrl.replace("://tiles","://tiles{s}"),i.subdomains=["1","2","3","4"]),this.options.token&&(this.tileUrl+="?token="+this.options.token),(0,n.TileLayer).prototype.initialize.call(this,this.tileUrl,i)},getTileUrl:function(i){var r=this._getZoomForUrl();return(0,n.Util).template(this.tileUrl,(0,n.Util).extend({s:this._getSubdomain(i),x:i.x,y:i.y,z:this._lodMap&&this._lodMap[r]?this._lodMap[r]:r},this.options))},createTile:function(i,r){var o=document.createElement("img");return(0,n.DomEvent).on(o,"load",(0,n.Util).bind(this._tileOnLoad,this,r,o)),(0,n.DomEvent).on(o,"error",(0,n.Util).bind(this._tileOnError,this,r,o)),this.options.crossOrigin&&(o.crossOrigin=""),o.alt="",!this._lodMap||this._lodMap&&this._lodMap[this._getZoomForUrl()]?o.src=this.getTileUrl(i):this.once("lodmap",function(){o.src=this.getTileUrl(i)},this),o},onAdd:function(i){(0,a.setEsriAttribution)(i),this._lodMap||this.metadata(function(r,o){if(!r&&o.spatialReference){var a=o.spatialReference.latestWkid||o.spatialReference.wkid;if(!this.options.attribution&&i.attributionControl&&o.copyrightText&&(this.options.attribution=o.copyrightText,i.attributionControl.addAttribution(this.getAttribution())),i.options.crs===n.CRS.EPSG3857&&(102100===a||3857===a)){this._lodMap={};for(var l=o.tileInfo.lods,u=h.MercatorZoomLevels,c=0;c<l.length;c++){var d=l[c];for(var p in u){var f=u[p];if(this._withinPercentage(d.resolution,f,this.options.zoomOffsetAllowance)){this._lodMap[p]=d.level;break}}}this.fire("lodmap")}else i.options.crs&&i.options.crs.code&&i.options.crs.code.indexOf(a)>-1||(0,s.warn)("L.esri.TiledMapLayer is using a non-mercator spatial reference. Support may be available through Proj4Leaflet https://developers.arcgis.com/esri-leaflet/samples/non-mercator-projection/")}},this),(0,n.TileLayer).prototype.onAdd.call(this,i)},onRemove:function(i){(0,a.removeEsriAttribution)(i),(0,n.TileLayer).prototype.onRemove.call(this,i)},metadata:function(i,r){return this.service.metadata(i,r),this},identify:function(){return this.service.identify()},find:function(){return this.service.find()},query:function(){return this.service.query()},authenticate:function(i){var r="?token="+i;return this.tileUrl=this.options.token?this.tileUrl.replace(/\?token=(.+)/g,r):this.tileUrl+r,this.options.token=i,this.service.authenticate(i),this},_withinPercentage:function(i,r,n){return Math.abs(i/r-1)<n}});function c(i,r){return new h(i,r)}}),l.register("9zrxg",function(i,r){o(i.exports,"RasterLayer",function(){return h});var n=l("iLKzi"),a=l("bNpnD"),s=l("k6IM7"),u=(0,n.ImageOverlay).extend({onAdd:function(i){this._topLeft=i.getPixelBounds().min,(0,n.ImageOverlay).prototype.onAdd.call(this,i)},_reset:function(){this._map.options.crs===n.CRS.EPSG3857?(0,n.ImageOverlay).prototype._reset.call(this):(0,n.DomUtil).setPosition(this._image,this._topLeft.subtract(this._map.getPixelOrigin()))}}),h=(0,n.Layer).extend({options:{opacity:1,position:"front",f:"image",useCors:a.cors,attribution:null,interactive:!1,alt:""},onAdd:function(i){(0,s.setEsriAttribution)(i),this.options.zIndex&&(this.options.position=null),this._update=(0,n.Util).throttle(this._update,this.options.updateInterval,this),i.on("moveend",this._update,this),this._currentImage&&this._currentImage._bounds.equals(this._map.getBounds())?i.addLayer(this._currentImage):this._currentImage&&(this._map.removeLayer(this._currentImage),this._currentImage=null),this._update(),this._popup&&(this._map.on("click",this._getPopupData,this),this._map.on("dblclick",this._resetPopupState,this)),this.metadata(function(r,n){!r&&!this.options.attribution&&i.attributionControl&&n.copyrightText&&(this.options.attribution=n.copyrightText,i.attributionControl.addAttribution(this.getAttribution()))},this)},onRemove:function(i){(0,s.removeEsriAttribution)(i),this._currentImage&&this._map.removeLayer(this._currentImage),this._popup&&(this._map.off("click",this._getPopupData,this),this._map.off("dblclick",this._resetPopupState,this)),this._map.off("moveend",this._update,this)},bindPopup:function(i,r){return this._shouldRenderPopup=!1,this._lastClick=!1,this._popup=(0,n.popup)(r),this._popupFunction=i,this._map&&(this._map.on("click",this._getPopupData,this),this._map.on("dblclick",this._resetPopupState,this)),this},unbindPopup:function(){return this._map&&(this._map.closePopup(this._popup),this._map.off("click",this._getPopupData,this),this._map.off("dblclick",this._resetPopupState,this)),this._popup=!1,this},bringToFront:function(){return this.options.position="front",this._currentImage&&(this._currentImage.bringToFront(),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this.options.position="back",this._currentImage&&(this._currentImage.bringToBack(),this._setAutoZIndex(Math.min)),this},setZIndex:function(i){return this.options.zIndex=i,this._currentImage&&this._currentImage.setZIndex(i),this},_setAutoZIndex:function(i){if(this._currentImage){for(var r,n=this._currentImage.getPane().children,o=-i(-1/0,1/0),a=0,s=n.length;a<s;a++)r=n[a].style.zIndex,n[a]!==this._currentImage._image&&r&&(o=i(o,+r));isFinite(o)&&(this.options.zIndex=o+i(-1,1),this.setZIndex(this.options.zIndex))}},getAttribution:function(){return this.options.attribution},getOpacity:function(){return this.options.opacity},setOpacity:function(i){return this.options.opacity=i,this._currentImage&&this._currentImage.setOpacity(i),this},getTimeRange:function(){return[this.options.from,this.options.to]},setTimeRange:function(i,r){return this.options.from=i,this.options.to=r,this._update(),this},metadata:function(i,r){return this.service.metadata(i,r),this},authenticate:function(i){return this.service.authenticate(i),this},redraw:function(){this._update()},_renderImage:function(i,r,n){if(this._map&&(n&&(i="data:"+n+";base64,"+i),i)){var o=new u(i,r,{opacity:0,crossOrigin:this.options.withCredentials?"use-credentials":this.options.useCors,alt:this.options.alt,pane:this.options.pane||this.getPane(),interactive:this.options.interactive}).addTo(this._map),a=function(){this._map.removeLayer(o),this.fire("error"),o.off("load",s,this)},s=function(i){if(o.off("error",a,this),this._map){var n=i.target,s=this._currentImage;n._bounds.equals(r)&&n._bounds.equals(this._map.getBounds())?(this._currentImage=n,"front"===this.options.position?this.bringToFront():"back"===this.options.position&&this.bringToBack(),this.options.zIndex&&this.setZIndex(this.options.zIndex),this._map&&this._currentImage._map?this._currentImage.setOpacity(this.options.opacity):this._currentImage._map.removeLayer(this._currentImage),s&&this._map&&this._map.removeLayer(s),s&&s._map&&s._map.removeLayer(s)):this._map.removeLayer(n)}this.fire("load",{bounds:r})};o.once("error",a,this),o.once("load",s,this)}},_update:function(){if(this._map){var i=this._map.getZoom(),r=this._map.getBounds();if(!this._animatingZoom&&(!this._map._panTransition||!this._map._panTransition._inProgress)){if(i>this.options.maxZoom||i<this.options.minZoom){this._currentImage&&(this._currentImage._map.removeLayer(this._currentImage),this._currentImage=null);return}var o=this._buildExportParams();(0,n.Util).extend(o,this.options.requestParams),o?(this._requestExport(o,r),this.fire("loading",{bounds:r})):this._currentImage&&(this._currentImage._map.removeLayer(this._currentImage),this._currentImage=null)}}},_renderPopup:function(i,r,o,a){if(i=(0,n.latLng)(i),this._shouldRenderPopup&&this._lastClick.equals(i)){var s=this._popupFunction(r,o,a);s&&this._popup.setLatLng(i).setContent(s).openOn(this._map)}},_resetPopupState:function(i){this._shouldRenderPopup=!1,this._lastClick=i.latlng},_calculateBbox:function(){var i=this._map.getPixelBounds(),r=this._map.unproject(i.getBottomLeft()),o=this._map.unproject(i.getTopRight()),a=this._map.options.crs.project(o),s=this._map.options.crs.project(r),l=(0,n.bounds)(a,s);return[l.getBottomLeft().x,l.getBottomLeft().y,l.getTopRight().x,l.getTopRight().y].join(",")},_calculateImageSize:function(){var i=this._map.getPixelBounds(),r=this._map.getSize(),n=this._map.unproject(i.getBottomLeft()),o=this._map.unproject(i.getTopRight()),a=this._map.latLngToLayerPoint(o).y,s=this._map.latLngToLayerPoint(n).y;return(a>0||s<r.y)&&(r.y=s-a),r.x+","+r.y}})}),l.register("fkZG8",function(i,r){o(i.exports,"ImageMapLayer",function(){return h}),o(i.exports,"imageMapLayer",function(){return c});var n=l("iLKzi"),a=l("9zrxg"),s=l("k6IM7"),u=l("cwl41"),h=(0,a.RasterLayer).extend({options:{updateInterval:150,format:"jpgpng",transparent:!0,f:"image"},query:function(){return this.service.query()},identify:function(){return this.service.identify()},initialize:function(i){i=(0,s.getUrlParams)(i),this.service=(0,u.default)(i),this.service.addEventParent(this),(0,n.Util).setOptions(this,i)},setPixelType:function(i){return this.options.pixelType=i,this._update(),this},getPixelType:function(){return this.options.pixelType},setBandIds:function(i){return(0,n.Util).isArray(i)?this.options.bandIds=i.join(","):this.options.bandIds=i.toString(),this._update(),this},getBandIds:function(){return this.options.bandIds},setNoData:function(i,r){return(0,n.Util).isArray(i)?this.options.noData=i.join(","):this.options.noData=i.toString(),r&&(this.options.noDataInterpretation=r),this._update(),this},getNoData:function(){return this.options.noData},getNoDataInterpretation:function(){return this.options.noDataInterpretation},setRenderingRule:function(i){this.options.renderingRule=i,this._update()},getRenderingRule:function(){return this.options.renderingRule},setMosaicRule:function(i){this.options.mosaicRule=i,this._update()},getMosaicRule:function(){return this.options.mosaicRule},_getPopupData:function(i){var r=(0,n.Util).bind(function(r,o,a){r||setTimeout((0,n.Util).bind(function(){this._renderPopup(i.latlng,r,o,a)},this),300)},this),o=this.identify().at(i.latlng);this.options.mosaicRule&&o.setMosaicRule(this.options.mosaicRule),o.run(r),this._shouldRenderPopup=!0,this._lastClick=i.latlng},_buildExportParams:function(){var i=parseInt(this._map.options.crs.code.split(":")[1],10),r={bbox:this._calculateBbox(),size:this._calculateImageSize(),format:this.options.format,transparent:this.options.transparent,bboxSR:i,imageSR:i};return this.options.from&&this.options.to&&(r.time=this.options.from.valueOf()+","+this.options.to.valueOf()),this.options.pixelType&&(r.pixelType=this.options.pixelType),this.options.interpolation&&(r.interpolation=this.options.interpolation),this.options.compressionQuality&&(r.compressionQuality=this.options.compressionQuality),this.options.bandIds&&(r.bandIds=this.options.bandIds),(0===this.options.noData||this.options.noData)&&(r.noData=this.options.noData),this.options.noDataInterpretation&&(r.noDataInterpretation=this.options.noDataInterpretation),this.service.options.token&&(r.token=this.service.options.token),this.options.renderingRule&&(r.renderingRule=JSON.stringify(this.options.renderingRule)),this.options.mosaicRule&&(r.mosaicRule=JSON.stringify(this.options.mosaicRule)),r},_requestExport:function(i,r){if("json"===this.options.f)this.service.request("exportImage",i,function(i,n){i||(this.options.token&&(n.href+="?token="+this.options.token),this.options.proxy&&(n.href=this.options.proxy+"?"+n.href),this._renderImage(n.href,r))},this);else{i.f="image";var o=this.options.url+"exportImage"+(0,n.Util).getParamString(i);this.options.proxy&&(o=this.options.proxy+"?"+o),this._renderImage(o,r)}}});function c(i,r){return new h(i,r)}}),l.register("1xokt",function(i,r){o(i.exports,"DynamicMapLayer",function(){return h}),o(i.exports,"dynamicMapLayer",function(){return c});var n=l("iLKzi"),a=l("9zrxg"),s=l("k6IM7"),u=l("1AQfr"),h=(0,a.RasterLayer).extend({options:{updateInterval:150,layers:!1,layerDefs:!1,timeOptions:!1,format:"png32",transparent:!0,f:"json"},initialize:function(i){i=(0,s.getUrlParams)(i),this.service=(0,u.default)(i),this.service.addEventParent(this),(0,n.Util).setOptions(this,i)},getDynamicLayers:function(){return this.options.dynamicLayers},setDynamicLayers:function(i){return this.options.dynamicLayers=i,this._update(),this},getLayers:function(){return this.options.layers},setLayers:function(i){return this.options.layers=i,this._update(),this},getLayerDefs:function(){return this.options.layerDefs},setLayerDefs:function(i){return this.options.layerDefs=i,this._update(),this},getTimeOptions:function(){return this.options.timeOptions},setTimeOptions:function(i){return this.options.timeOptions=i,this._update(),this},query:function(){return this.service.query()},identify:function(){return this.service.identify()},find:function(){return this.service.find()},_getPopupData:function(i){var r,o=(0,n.Util).bind(function(r,o,a){r||setTimeout((0,n.Util).bind(function(){this._renderPopup(i.latlng,r,o,a)},this),300)},this);if((r=this.options.popup?this.options.popup.on(this._map).at(i.latlng):this.identify().on(this._map).at(i.latlng)).params.maxAllowableOffset||r.simplify(this._map,.5),this.options.popup&&this.options.popup.params&&this.options.popup.params.layers||(this.options.layers?r.layers("visible:"+this.options.layers.join(",")):r.layers("visible")),this.options.layerDefs&&"string"!=typeof this.options.layerDefs&&!r.params.layerDefs)for(var a in this.options.layerDefs)Object.prototype.hasOwnProperty.call(this.options.layerDefs,a)&&r.layerDef(a,this.options.layerDefs[a]);r.run(o),this._shouldRenderPopup=!0,this._lastClick=i.latlng},_buildExportParams:function(){var i=parseInt(this._map.options.crs.code.split(":")[1],10),r={bbox:this._calculateBbox(),size:this._calculateImageSize(),dpi:96,format:this.options.format,transparent:this.options.transparent,bboxSR:i,imageSR:i};if(this.options.dynamicLayers&&(r.dynamicLayers=this.options.dynamicLayers),this.options.layers){if(0===this.options.layers.length)return;r.layers="show:"+this.options.layers.join(",")}return this.options.layerDefs&&(r.layerDefs="string"==typeof this.options.layerDefs?this.options.layerDefs:JSON.stringify(this.options.layerDefs)),this.options.timeOptions&&(r.timeOptions=JSON.stringify(this.options.timeOptions)),this.options.from&&this.options.to&&(r.time=this.options.from.valueOf()+","+this.options.to.valueOf()),this.service.options.token&&(r.token=this.service.options.token),this.options.proxy&&(r.proxy=this.options.proxy),this.options.disableCache&&(r._ts=Date.now()),r},_requestExport:function(i,r){if("json"===this.options.f)this.service.request("export",i,function(i,n){i||(this.options.token&&n.href&&(n.href+="?token="+this.options.token),this.options.proxy&&n.href&&(n.href=this.options.proxy+"?"+n.href),n.href?this._renderImage(n.href,r):this._renderImage(n.imageData,r,n.contentType))},this);else{i.f="image";var o=this.options.url+"export"+(0,n.Util).getParamString(i);this.options.proxy&&(o=this.options.proxy+"?"+o),this._renderImage(o,r)}}});function c(i,r){return new h(i,r)}}),l.register("g1lPh",function(i,r){o(i.exports,"FeatureManager",function(){return d});var n=l("iLKzi"),a=l("fQi3s"),s=l("k6IM7"),u=l("cIGnu"),h=l("7rViH"),c=l("aUpz5"),d=(0,h.FeatureGrid).extend({options:{attribution:null,where:"1=1",fields:["*"],from:!1,to:!1,timeField:!1,timeFilterMode:"server",simplifyFactor:0,precision:6,fetchAllFeatures:!1},initialize:function(i){if((0,h.FeatureGrid).prototype.initialize.call(this,i),i=(0,s.getUrlParams)(i),i=(0,n.Util).setOptions(this,i),this.service=(0,a.default)(i),this.service.addEventParent(this),"*"!==this.options.fields[0]){for(var r=!1,o=0;o<this.options.fields.length;o++)this.options.fields[o].match(/^(OBJECTID|FID|OID|ID)$/i)&&(r=!0);!1===r&&(0,u.warn)("no known esriFieldTypeOID field detected in fields Array.  Please add an attribute field containing unique IDs to ensure the layer can be drawn correctly.")}this.options.timeField.start&&this.options.timeField.end?(this._startTimeIndex=new c.default,this._endTimeIndex=new c.default):this.options.timeField&&(this._timeIndex=new c.default),this._cache={},this._currentSnapshot=[],this._activeRequests=0},onAdd:function(i){return(0,s.setEsriAttribution)(i),this.service.metadata(function(r,n){if(!r){var o=n.supportedQueryFormats,a=!1;(!1===this.service.options.isModern||this.options.fetchAllFeatures)&&(a=!0),!a&&o&&-1!==o.indexOf("geoJSON")&&(this.service.options.isModern=!0),n.objectIdField&&(this.service.options.idAttribute=n.objectIdField),!this.options.attribution&&i.attributionControl&&n.copyrightText&&(this.options.attribution=n.copyrightText,i.attributionControl.addAttribution(this.getAttribution()))}},this),i.on("zoomend",this._handleZoomChange,this),(0,h.FeatureGrid).prototype.onAdd.call(this,i)},onRemove:function(i){return(0,s.removeEsriAttribution)(i),i.off("zoomend",this._handleZoomChange,this),(0,h.FeatureGrid).prototype.onRemove.call(this,i)},getAttribution:function(){return this.options.attribution},createCell:function(i,r){this._visibleZoom()&&this._requestFeatures(i,r)},_requestFeatures:function(i,r,o,a){this._activeRequests++,a=a||0;var s=this.options.where;return 1===this._activeRequests&&this.fire("loading",{bounds:i},!0),this._buildQuery(i,a).run(function(l,u,h){h&&h.exceededTransferLimit&&this.fire("drawlimitexceeded"),this.options.where===s&&(!l&&u&&u.features.length&&(0,n.Util).requestAnimFrame((0,n.Util).bind(function(){this._addFeatures(u.features,r),this._postProcessFeatures(i)},this)),l||!u||u.features.length||this._postProcessFeatures(i),l&&this._postProcessFeatures(i),o&&o.call(this,l,u),h&&(h.exceededTransferLimit||h.properties&&h.properties.exceededTransferLimit)&&this.options.fetchAllFeatures&&this._requestFeatures(i,r,o,a+u.features.length))},this)},_postProcessFeatures:function(i){this._activeRequests--,this._activeRequests<=0&&this.fire("load",{bounds:i})},_cacheKey:function(i){return i.z+":"+i.x+":"+i.y},_addFeatures:function(i,r){if(r){var n=this._cacheKey(r);this._cache[n]=this._cache[n]||[]}for(var o=i.length-1;o>=0;o--){var a=i[o].id;-1===this._currentSnapshot.indexOf(a)&&this._currentSnapshot.push(a),void 0!==n&&-1===this._cache[n].indexOf(a)&&this._cache[n].push(a)}this.options.timeField&&this._buildTimeIndexes(i),this.createLayers(i)},_buildQuery:function(i,r){var o=this.service.query().intersects(i).where(this.options.where).fields(this.options.fields).precision(this.options.precision);return this.options.fetchAllFeatures&&!isNaN(parseInt(r))&&(o=o.offset(r)),o.params.resultType="tile",this.options.requestParams&&(0,n.Util).extend(o.params,this.options.requestParams),this.options.simplifyFactor&&o.simplify(this._map,this.options.simplifyFactor),"server"===this.options.timeFilterMode&&this.options.from&&this.options.to&&o.between(this.options.from,this.options.to),o},setWhere:function(i,r,o){this.options.where=i&&i.length?i:"1=1";for(var a=[],s=[],l=0,u=null,h=(0,n.Util).bind(function(h,c){if(h&&(u=h),c)for(var d=c.features.length-1;d>=0;d--)s.push(c.features[d].id);--l<=0&&this._visibleZoom()&&i===this.options.where&&(this._currentSnapshot=s,(0,n.Util).requestAnimFrame((0,n.Util).bind(function(){this.removeLayers(a),this.addLayers(s),r&&r.call(o,u)},this)))},this),c=this._currentSnapshot.length-1;c>=0;c--)a.push(this._currentSnapshot[c]);for(var d in this._cache={},this._cells){l++;var p=this._keyToCellCoords(d),f=this._cellCoordsToBounds(p);this._requestFeatures(f,p,h)}return this},getWhere:function(){return this.options.where},getTimeRange:function(){return[this.options.from,this.options.to]},setTimeRange:function(i,r,o,a){var s=this.options.from,l=this.options.to,u=0,h=null,c=(0,n.Util).bind(function(n){n&&(h=n),this._filterExistingFeatures(s,l,i,r),u--,o&&u<=0&&o.call(a,h)},this);if(this.options.from=i,this.options.to=r,this._filterExistingFeatures(s,l,i,r),"server"===this.options.timeFilterMode)for(var d in this._cells){u++;var p=this._keyToCellCoords(d),f=this._cellCoordsToBounds(p);this._requestFeatures(f,p,c)}return this},refresh:function(){this.setWhere(this.options.where)},_filterExistingFeatures:function(i,r,o,a){var s=i&&r?this._getFeaturesInTimeRange(i,r):this._currentSnapshot,l=this._getFeaturesInTimeRange(o,a);if(l.indexOf)for(var u=0;u<l.length;u++){var h=s.indexOf(l[u]);h>=0&&s.splice(h,1)}(0,n.Util).requestAnimFrame((0,n.Util).bind(function(){this.removeLayers(s),this.addLayers(l)},this))},_getFeaturesInTimeRange:function(i,r){var n,o=[];if(this.options.timeField.start&&this.options.timeField.end){var a=this._startTimeIndex.between(i,r),s=this._endTimeIndex.between(i,r);n=a.concat(s)}else{if(!this._timeIndex)return(0,u.warn)("You must set timeField in the layer constructor in order to manipulate the start and end time filter."),[];n=this._timeIndex.between(i,r)}for(var l=n.length-1;l>=0;l--)o.push(n[l].id);return o},_buildTimeIndexes:function(i){if(this.options.timeField.start&&this.options.timeField.end){var r,n,o=[],a=[];for(r=i.length-1;r>=0;r--)n=i[r],o.push({id:n.id,value:new Date(n.properties[this.options.timeField.start])}),a.push({id:n.id,value:new Date(n.properties[this.options.timeField.end])});this._startTimeIndex.bulkAdd(o),this._endTimeIndex.bulkAdd(a)}else{var s=[];for(r=i.length-1;r>=0;r--)n=i[r],s.push({id:n.id,value:new Date(n.properties[this.options.timeField])});this._timeIndex.bulkAdd(s)}},_featureWithinTimeRange:function(i){if(!this.options.from||!this.options.to)return!0;var r=+this.options.from.valueOf(),n=+this.options.to.valueOf();if("string"==typeof this.options.timeField){var o=+i.properties[this.options.timeField];return o>=r&&o<=n}if(this.options.timeField.start&&this.options.timeField.end){var a=+i.properties[this.options.timeField.start],s=+i.properties[this.options.timeField.end];return a>=r&&a<=n||s>=r&&s<=n||a<=r&&s>=n}},_visibleZoom:function(){if(!this._map)return!1;var i=this._map.getZoom();return!(i>this.options.maxZoom)&&!(i<this.options.minZoom)},_handleZoomChange:function(){if(this._visibleZoom())for(var i in this._cells){var r=this._cells[i].coords,n=this._cacheKey(r);this._cache[n]&&this.addLayers(this._cache[n])}else this.removeLayers(this._currentSnapshot),this._currentSnapshot=[]},authenticate:function(i){return this.service.authenticate(i),this},metadata:function(i,r){return this.service.metadata(i,r),this},query:function(){return this.service.query()},_getMetadata:function(i){this._metadata?i(void 0,this._metadata):this.metadata((0,n.Util).bind(function(r,n){this._metadata=n,i(r,this._metadata)},this))},addFeature:function(i,r,n){this.addFeatures(i,r,n)},addFeatures:function(i,r,o){this._getMetadata((0,n.Util).bind(function(a,s){if(a){r&&r.call(this,a,null);return}var l=i.features?i.features:[i];this.service.addFeatures(i,(0,n.Util).bind(function(i,n){if(!i){for(var a=l.length-1;a>=0;a--)l[a].properties[s.objectIdField]=l.length>1?n[a].objectId:n.objectId,l[a].id=l.length>1?n[a].objectId:n.objectId;this._addFeatures(l)}r&&r.call(o,i,n)},this))},this))},updateFeature:function(i,r,n){this.updateFeatures(i,r,n)},updateFeatures:function(i,r,n){var o=i.features?i.features:[i];this.service.updateFeatures(i,function(i,a){if(!i){for(var s=o.length-1;s>=0;s--)this.removeLayers([o[s].id],!0);this._addFeatures(o)}r&&r.call(n,i,a)},this)},deleteFeature:function(i,r,n){this.deleteFeatures(i,r,n)},deleteFeatures:function(i,r,n){return this.service.deleteFeatures(i,function(i,o){var a=o.length?o:[o];if(!i&&a.length>0)for(var s=a.length-1;s>=0;s--)this.removeLayers([a[s].objectId],!0);r&&r.call(n,i,o)},this)}})}),l.register("7rViH",function(i,r){o(i.exports,"FeatureGrid",function(){return a});var n=l("iLKzi"),a=(0,n.Layer).extend({options:{cellSize:512,updateWhenIdle:n.Browser.mobile,updateInterval:150,noWrap:!1,keepBuffer:1.5},initialize:function(i){(0,n.Util).setOptions(this,i)},onAdd:function(i){this._cells={},this._activeCells={},this._resetView(),this._update()},onRemove:function(i){this._removeAllCells(),this._cellZoom=void 0},isLoading:function(){return this._loading},redraw:function(){return this._map&&(this._removeAllCells(),this._update()),this},getEvents:function(){var i={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=(0,n.Util).throttle(this._onMoveEnd,this.options.updateInterval,this)),i.move=this._onMove),i},createCell:function(){return document.createElement("div")},removeCell:function(){},reuseCell:function(){},cellLeave:function(){},cellEnter:function(){},getCellSize:function(){var i=this.options.cellSize;return i instanceof n.Point?i:new n.Point(i,i)},_pruneCells:function(){if(this._map){for(i in this._cells)(r=this._cells[i]).retain=r.current;for(i in this._cells)if((r=this._cells[i]).current&&!r.active){var i,r,n=r.coords;this._retainParent(n.x,n.y,n.z,n.z-5)||this._retainChildren(n.x,n.y,n.z,n.z+2)}for(i in this._cells)this._cells[i].retain||this._removeCell(i)}},_removeAllCells:function(){for(var i in this._cells)this._removeCell(i)},_invalidateAll:function(){this._removeAllCells(),this._cellZoom=void 0},_retainParent:function(i,r,o,a){var s=Math.floor(i/2),l=Math.floor(r/2),u=o-1,h=new n.Point(+s,+l);h.z=+u;var c=this._cellCoordsToKey(h),d=this._cells[c];return d&&d.active?(d.retain=!0,!0):(d&&d.loaded&&(d.retain=!0),u>a&&this._retainParent(s,l,u,a))},_retainChildren:function(i,r,o,a){for(var s=2*i;s<2*i+2;s++)for(var l=2*r;l<2*r+2;l++){var u=new n.Point(s,l);u.z=o+1;var h=this._cellCoordsToKey(u),c=this._cells[h];if(c&&c.active){c.retain=!0;continue}c&&c.loaded&&(c.retain=!0),o+1<a&&this._retainChildren(s,l,o+1,a)}},_resetView:function(i){var r=i&&(i.pinch||i.flyTo);r||this._setView(this._map.getCenter(),this._map.getZoom(),r,r)},_setView:function(i,r,n,o){var a=Math.round(r);o||(this._cellZoom=a,this._abortLoading&&this._abortLoading(),this._resetGrid(),void 0!==a&&this._update(i),n||this._pruneCells(),this._noPrune=!!n)},_resetGrid:function(){var i=this._map,r=i.options.crs,n=this._cellSize=this.getCellSize(),o=this._cellZoom,a=this._map.getPixelWorldBounds(this._cellZoom);a&&(this._globalCellRange=this._pxBoundsToCellRange(a)),this._wrapX=r.wrapLng&&!this.options.noWrap&&[Math.floor(i.project([0,r.wrapLng[0]],o).x/n.x),Math.ceil(i.project([0,r.wrapLng[1]],o).x/n.y)],this._wrapY=r.wrapLat&&!this.options.noWrap&&[Math.floor(i.project([r.wrapLat[0],0],o).y/n.x),Math.ceil(i.project([r.wrapLat[1],0],o).y/n.y)]},_onMoveEnd:function(i){i&&(i.pinch||i.flyTo)||!this._map||this._map._animatingZoom||this._update()},_getCelldPixelBounds:function(i){var r=this._map,o=r._animatingZoom?Math.max(r._animateToZoom,r.getZoom()):r.getZoom(),a=r.getZoomScale(o,this._cellZoom),s=r.project(i,this._cellZoom).floor(),l=r.getSize().divideBy(2*a);return new n.Bounds(s.subtract(l),s.add(l))},_update:function(i){var r=this._map;if(r){var o=Math.round(r.getZoom());void 0===i&&(i=r.getCenter());var a=this._getCelldPixelBounds(i),s=this._pxBoundsToCellRange(a),l=s.getCenter(),u=[],h=this.options.keepBuffer,c=new n.Bounds(s.getBottomLeft().subtract([h,-h]),s.getTopRight().add([h,-h]));if(!(isFinite(s.min.x)&&isFinite(s.min.y)&&isFinite(s.max.x)&&isFinite(s.max.y)))throw Error("Attempted to load an infinite number of cells");for(var d in this._cells){var p=this._cells[d].coords;p.z===this._cellZoom&&c.contains(new n.Point(p.x,p.y))||(this._cells[d].current=!1)}if(Math.abs(o-this._cellZoom)>1){this._setView(i,o);return}for(var f=s.min.y;f<=s.max.y;f++)for(var m=s.min.x;m<=s.max.x;m++){var g=new n.Point(m,f);if(g.z=this._cellZoom,this._isValidCell(g)){var _=this._cells[this._cellCoordsToKey(g)];_?_.current=!0:u.push(g)}}if(u.sort(function(i,r){return i.distanceTo(l)-r.distanceTo(l)}),0!==u.length)for(this._loading||(this._loading=!0),m=0;m<u.length;m++){var y=this._cellCoordsToKey(u[m]),v=this._keyToCellCoords(y);this._activeCells[v]?this._reuseCell(u[m]):this._createCell(u[m])}}},_isValidCell:function(i){var r=this._map.options.crs;if(!r.infinite){var o=this._globalCellRange;if(!r.wrapLng&&(i.x<o.min.x||i.x>o.max.x)||!r.wrapLat&&(i.y<o.min.y||i.y>o.max.y))return!1}if(!this.options.bounds)return!0;var a=this._cellCoordsToBounds(i);return(0,n.toLatLngBounds)(this.options.bounds).overlaps(a)},_keyToBounds:function(i){return this._cellCoordsToBounds(this._keyToCellCoords(i))},_cellCoordsToNwSe:function(i){var r=this._map,n=this.getCellSize(),o=i.scaleBy(n),a=o.add(n);return[r.unproject(o,i.z),r.unproject(a,i.z)]},_cellCoordsToBounds:function(i){var r=this._cellCoordsToNwSe(i),o=new n.LatLngBounds(r[0],r[1]);return this.options.noWrap||(o=this._map.wrapLatLngBounds(o)),o},_cellCoordsToKey:function(i){return i.x+":"+i.y+":"+i.z},_keyToCellCoords:function(i){var r=i.split(":"),o=new n.Point(+r[0],+r[1]);return o.z=+r[2],o},_removeCell:function(i){var r=this._cells[i];if(r){var n=this._keyToCellCoords(i),o=this._wrapCoords(n),a=this._cellCoordsToBounds(this._wrapCoords(n));r.current=!1,delete this._cells[i],this._activeCells[i]=r,this.cellLeave(a,o,i),this.fire("cellleave",{key:i,coords:o,bounds:a})}},_reuseCell:function(i){var r=this._cellCoordsToKey(i);this._cells[r]=this._activeCells[r],this._cells[r].current=!0;var n=this._wrapCoords(i),o=this._cellCoordsToBounds(this._wrapCoords(i));this.cellEnter(o,n,r),this.fire("cellenter",{key:r,coords:n,bounds:o})},_createCell:function(i){var r=this._cellCoordsToKey(i),o=this._wrapCoords(i),a=this._cellCoordsToBounds(this._wrapCoords(i));this.createCell(a,o,r),this.fire("cellcreate",{key:r,coords:o,bounds:a}),this._cells[r]={coords:i,current:!0},(0,n.Util).requestAnimFrame(this._pruneCells,this)},_cellReady:function(i,r,n){var o=this._cellCoordsToKey(i);(n=this._cells[o])&&(n.loaded=+new Date,n.active=!0)},_getCellPos:function(i){return i.scaleBy(this.getCellSize())},_wrapCoords:function(i){var r=new n.Point(this._wrapX?(0,n.Util).wrapNum(i.x,this._wrapX):i.x,this._wrapY?(0,n.Util).wrapNum(i.y,this._wrapY):i.y);return r.z=i.z,r},_pxBoundsToCellRange:function(i){var r=this.getCellSize();return new n.Bounds(i.min.unscaleBy(r).floor(),i.max.unscaleBy(r).ceil().subtract([1,1]))}})}),l.register("aUpz5",function(i,r){function n(i){this.values=[].concat(i||[])}o(i.exports,"default",function(){return a}),n.prototype.query=function(i){var r=this.getIndex(i);return this.values[r]},n.prototype.getIndex=function(i){this.dirty&&this.sort();for(var r,n,o=0,a=this.values.length-1;o<=a;)if(r=(o+a)/2|0,+(n=this.values[Math.round(r)]).value<+i)o=r+1;else{if(!(+n.value>+i))return r;a=r-1}return Math.abs(~a)},n.prototype.between=function(i,r){var n=this.getIndex(i),o=this.getIndex(r);if(0===n&&0===o)return[];for(;this.values[n-1]&&this.values[n-1].value===i;)n--;for(;this.values[o+1]&&this.values[o+1].value===r;)o++;return this.values[o]&&this.values[o].value===r&&this.values[o+1]&&o++,this.values.slice(n,o)},n.prototype.insert=function(i){return this.values.splice(this.getIndex(i.value),0,i),this},n.prototype.bulkAdd=function(i,r){return this.values=this.values.concat([].concat(i||[])),r?this.sort():this.dirty=!0,this},n.prototype.sort=function(){return this.values.sort(function(i,r){return+r.value-+i.value}).reverse(),this.dirty=!1,this};var a=n}),l.register("9T7st",function(i,r){o(i.exports,"FeatureLayer",function(){return u}),o(i.exports,"featureLayer",function(){return h});var n=l("iLKzi"),a=l("g1lPh");l("k6IM7");var s=l("cIGnu"),u=(0,a.FeatureManager).extend({options:{cacheLayers:!0},initialize:function(i){i.apikey&&(i.token=i.apikey),(0,a.FeatureManager).prototype.initialize.call(this,i),this._originalStyle=this.options.style,this._layers={}},onRemove:function(i){for(var r in this._layers)i.removeLayer(this._layers[r]),this.fire("removefeature",{feature:this._layers[r].feature,permanent:!1},!0);return(0,a.FeatureManager).prototype.onRemove.call(this,i)},createNewLayer:function(i){var r=(0,n.GeoJSON).geometryToLayer(i,this.options);return r&&(r.defaultOptions=r.options),r},_updateLayer:function(i,r){var o=[],a=this.options.coordsToLatLng||n.GeoJSON.coordsToLatLng;switch(r.properties&&(i.feature.properties=r.properties),r.geometry.type){case"Point":o=(0,n.GeoJSON).coordsToLatLng(r.geometry.coordinates),i.setLatLng(o);break;case"LineString":o=(0,n.GeoJSON).coordsToLatLngs(r.geometry.coordinates,0,a),i.setLatLngs(o);break;case"MultiLineString":case"Polygon":o=(0,n.GeoJSON).coordsToLatLngs(r.geometry.coordinates,1,a),i.setLatLngs(o);break;case"MultiPolygon":o=(0,n.GeoJSON).coordsToLatLngs(r.geometry.coordinates,2,a),i.setLatLngs(o)}this.redraw(i.feature.id)},createLayers:function(i){for(var r=i.length-1;r>=0;r--){var n,o=i[r],a=this._layers[o.id];this._visibleZoom()&&a&&!this._map.hasLayer(a)&&(!this.options.timeField||this._featureWithinTimeRange(o))&&(this._map.addLayer(a),this.fire("addfeature",{feature:a.feature},!0)),a&&(a.setLatLngs||a.setLatLng)&&this._updateLayer(a,o),!a&&((n=this.createNewLayer(o))?(n.feature=o,n.addEventParent(this),this.options.onEachFeature&&this.options.onEachFeature(n.feature,n),this._layers[n.feature.id]=n,this.setFeatureStyle(n.feature.id,this.options.style),this.fire("createfeature",{feature:n.feature},!0),this._visibleZoom()&&(!this.options.timeField||this.options.timeField&&this._featureWithinTimeRange(o))&&this._map.addLayer(n)):(0,s.warn)("invalid GeoJSON encountered"))}},addLayers:function(i){for(var r=i.length-1;r>=0;r--){var n=this._layers[i[r]];n&&(!this.options.timeField||this._featureWithinTimeRange(n.feature))&&(this._map.addLayer(n),this.fire("addfeature",{feature:n.feature},!0))}},removeLayers:function(i,r){for(var n=i.length-1;n>=0;n--){var o=i[n],a=this._layers[o];a&&(this.fire("removefeature",{feature:a.feature,permanent:r},!0),this._map.removeLayer(a)),a&&r&&delete this._layers[o]}},cellEnter:function(i,r){this._visibleZoom()&&!this._zooming&&this._map&&(0,n.Util).requestAnimFrame((0,n.Util).bind(function(){var i=this._cacheKey(r),n=this._cellCoordsToKey(r),o=this._cache[i];this._activeCells[n]&&o&&this.addLayers(o)},this))},cellLeave:function(i,r){this._zooming||(0,n.Util).requestAnimFrame((0,n.Util).bind(function(){if(this._map){var i=this._cacheKey(r),n=this._cellCoordsToKey(r),o=this._cache[i],a=this._map.getBounds();if(!this._activeCells[n]&&o){for(var s=!0,l=0;l<o.length;l++){var u=this._layers[o[l]];u&&u.getBounds&&a.intersects(u.getBounds())&&(s=!1)}s&&this.removeLayers(o,!this.options.cacheLayers),!this.options.cacheLayers&&s&&(delete this._cache[i],delete this._cells[n],delete this._activeCells[n])}}},this))},resetStyle:function(){return this.options.style=this._originalStyle,this.eachFeature(function(i){this.resetFeatureStyle(i.feature.id)},this),this},setStyle:function(i){return this.options.style=i,this.eachFeature(function(r){this.setFeatureStyle(r.feature.id,i)},this),this},resetFeatureStyle:function(i){var r=this._layers[i],o=this._originalStyle||n.Path.prototype.options;return r&&((0,n.Util).extend(r.options,r.defaultOptions),this.setFeatureStyle(i,o)),this},setFeatureStyle:function(i,r){var n=this._layers[i];return"function"==typeof r&&(r=r(n.feature)),n.setStyle&&n.setStyle(r),this},eachActiveFeature:function(i,r){if(this._map){var n=this._map.getBounds();for(var o in this._layers)-1!==this._currentSnapshot.indexOf(this._layers[o].feature.id)&&("function"==typeof this._layers[o].getLatLng&&n.contains(this._layers[o].getLatLng())?i.call(r,this._layers[o]):"function"==typeof this._layers[o].getBounds&&n.intersects(this._layers[o].getBounds())&&i.call(r,this._layers[o]))}return this},eachFeature:function(i,r){for(var n in this._layers)i.call(r,this._layers[n]);return this},getFeature:function(i){return this._layers[i]},bringToBack:function(){this.eachFeature(function(i){i.bringToBack&&i.bringToBack()})},bringToFront:function(){this.eachFeature(function(i){i.bringToFront&&i.bringToFront()})},redraw:function(i){return i&&this._redraw(i),this},_redraw:function(i){var r=this._layers[i],o=r.feature;if(r&&r.setIcon&&this.options.pointToLayer&&this.options.pointToLayer){var a=this.options.pointToLayer(o,(0,n.latLng)(o.geometry.coordinates[1],o.geometry.coordinates[0])).options.icon;r.setIcon(a)}if(r&&r.setStyle&&this.options.pointToLayer){var s=this.options.pointToLayer(o,(0,n.latLng)(o.geometry.coordinates[1],o.geometry.coordinates[0])).options;this.setFeatureStyle(o.id,s)}r&&r.setStyle&&this.options.style&&this.resetFeatureStyle(o.id)},openPopup(i){return this._popup&&this._popup._prepareOpen(i||this._latlng)&&this._popup.openOn(this._map),this},openTooltip(i){return this._tooltip&&this._tooltip._prepareOpen(i)&&(this._tooltip.openOn(this._map),this.getElement?this._setAriaDescribedByOnLayer(this):this.eachLayer&&this.eachLayer(this._setAriaDescribedByOnLayer,this)),this}});function h(i){return new u(i)}}),l.register("8s90F",function(i,r){i.exports,i.exports=function(){"use strict";var i,r,n;function o(o,a){if(i){if(r){var s="var sharedChunk = {}; ("+i+")(sharedChunk); ("+r+")(sharedChunk);",l={};i(l),n=a(l),"undefined"!=typeof window&&(n.workerUrl=window.URL.createObjectURL(new Blob([s],{type:"text/javascript"})))}else r=a}else i=a}return o(["exports"],function(i){let r,n;function o(i,r,n,o){this.cx=3*i,this.bx=3*(n-i)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*r,this.by=3*(o-r)-this.cy,this.ay=1-this.cy-this.by,this.p1x=i,this.p1y=r,this.p2x=n,this.p2y=o}function a(i,r,n,a){let s=new o(i,r,n,a);return function(i){return s.solve(i)}}o.prototype={sampleCurveX:function(i){return((this.ax*i+this.bx)*i+this.cx)*i},sampleCurveY:function(i){return((this.ay*i+this.by)*i+this.cy)*i},sampleCurveDerivativeX:function(i){return(3*this.ax*i+2*this.bx)*i+this.cx},solveCurveX:function(i,r){if(void 0===r&&(r=1e-6),i<0)return 0;if(i>1)return 1;for(var n=i,o=0;o<8;o++){var a=this.sampleCurveX(n)-i;if(Math.abs(a)<r)return n;var s=this.sampleCurveDerivativeX(n);if(1e-6>Math.abs(s))break;n-=a/s}var l=0,u=1;for(n=i,o=0;o<20&&!(Math.abs((a=this.sampleCurveX(n))-i)<r);o++)i>a?l=n:u=n,n=.5*(u-l)+l;return n},solve:function(i,r){return this.sampleCurveY(this.solveCurveX(i,r))}};let s=a(.25,.1,.25,1);function l(i,r,n){return Math.min(n,Math.max(r,i))}function u(i,r,n){let o=n-r,a=((i-r)%o+o)%o+r;return a===r?n:a}function h(i,...r){for(let n of r)for(let r in n)i[r]=n[r];return i}let c=1;function d(i,r){i.forEach(i=>{r[i]&&(r[i]=r[i].bind(r))})}function p(i,r,n){let o={};for(let a in i)o[a]=r.call(n||this,i[a],a,i);return o}function f(i,r,n){let o={};for(let a in i)r.call(n||this,i[a],a,i)&&(o[a]=i[a]);return o}function m(i){return Array.isArray(i)?i.map(m):"object"==typeof i&&i?p(i,m):i}let g={};function _(i){g[i]||("undefined"!=typeof console&&console.warn(i),g[i]=!0)}function y(i,r,n){return(n.y-i.y)*(r.x-i.x)>(r.y-i.y)*(n.x-i.x)}function v(){return"undefined"!=typeof WorkerGlobalScope&&"undefined"!=typeof self&&self instanceof WorkerGlobalScope}function x(i){let r={};if(i.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(i,n,o,a)=>{let s=o||a;return r[n]=!s||s.toLowerCase(),""}),r["max-age"]){let i=parseInt(r["max-age"],10);isNaN(i)?delete r["max-age"]:r["max-age"]=i}return r}let b,w,T=null;function E(i){if(null==T){let r=i.navigator?i.navigator.userAgent:null;T=!!i.safari||!(!r||!(/\b(iPad|iPhone|iPod)\b/.test(r)||r.match("Safari")&&!r.match("Chrome")))}return T}function S(i){return"undefined"!=typeof ImageBitmap&&i instanceof ImageBitmap}let C={now:"undefined"!=typeof performance&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),frame(i){let r=requestAnimationFrame(i);return{cancel:()=>cancelAnimationFrame(r)}},getImageData(i,r=0){let n=window.document.createElement("canvas"),o=n.getContext("2d");if(!o)throw Error("failed to create canvas 2d context");return n.width=i.width,n.height=i.height,o.drawImage(i,0,0,i.width,i.height),o.getImageData(-r,-r,i.width+2*r,i.height+2*r)},resolveURL:i=>(b||(b=document.createElement("a")),b.href=i,b.href),hardwareConcurrency:"undefined"!=typeof navigator&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return!!matchMedia&&(null==w&&(w=matchMedia("(prefers-reduced-motion: reduce)")),w.matches)}};var I=A;function A(i,r){this.x=i,this.y=r}A.prototype={clone:function(){return new A(this.x,this.y)},add:function(i){return this.clone()._add(i)},sub:function(i){return this.clone()._sub(i)},multByPoint:function(i){return this.clone()._multByPoint(i)},divByPoint:function(i){return this.clone()._divByPoint(i)},mult:function(i){return this.clone()._mult(i)},div:function(i){return this.clone()._div(i)},rotate:function(i){return this.clone()._rotate(i)},rotateAround:function(i,r){return this.clone()._rotateAround(i,r)},matMult:function(i){return this.clone()._matMult(i)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(i){return this.x===i.x&&this.y===i.y},dist:function(i){return Math.sqrt(this.distSqr(i))},distSqr:function(i){var r=i.x-this.x,n=i.y-this.y;return r*r+n*n},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(i){return Math.atan2(this.y-i.y,this.x-i.x)},angleWith:function(i){return this.angleWithSep(i.x,i.y)},angleWithSep:function(i,r){return Math.atan2(this.x*r-this.y*i,this.x*i+this.y*r)},_matMult:function(i){var r=i[2]*this.x+i[3]*this.y;return this.x=i[0]*this.x+i[1]*this.y,this.y=r,this},_add:function(i){return this.x+=i.x,this.y+=i.y,this},_sub:function(i){return this.x-=i.x,this.y-=i.y,this},_mult:function(i){return this.x*=i,this.y*=i,this},_div:function(i){return this.x/=i,this.y/=i,this},_multByPoint:function(i){return this.x*=i.x,this.y*=i.y,this},_divByPoint:function(i){return this.x/=i.x,this.y/=i.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var i=this.y;return this.y=this.x,this.x=-i,this},_rotate:function(i){var r=Math.cos(i),n=Math.sin(i),o=n*this.x+r*this.y;return this.x=r*this.x-n*this.y,this.y=o,this},_rotateAround:function(i,r){var n=Math.cos(i),o=Math.sin(i),a=r.y+o*(this.x-r.x)+n*(this.y-r.y);return this.x=r.x+n*(this.x-r.x)-o*(this.y-r.y),this.y=a,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},A.convert=function(i){return i instanceof A?i:Array.isArray(i)?new A(i[0],i[1]):i};let P={MAX_PARALLEL_IMAGE_REQUESTS:16,REGISTERED_PROTOCOLS:{}},k="mapbox-tiles",M,z,D=500,R=50;function B(){"undefined"==typeof caches||M||(M=caches.open(k))}let O=1/0,F={supported:!1,testSupport:function(i){!j&&U&&(Z?V(i):N=i)}},N,U,j=!1,Z=!1;function V(i){let r=i.createTexture();i.bindTexture(i.TEXTURE_2D,r);try{if(i.texImage2D(i.TEXTURE_2D,0,i.RGBA,i.RGBA,i.UNSIGNED_BYTE,U),i.isContextLost())return;F.supported=!0}catch(i){}i.deleteTexture(r),j=!0}"undefined"!=typeof document&&((U=document.createElement("img")).onload=function(){N&&V(N),N=null,Z=!0},U.onerror=function(){j=!0,N=null},U.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");let q={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};"function"==typeof Object.freeze&&Object.freeze(q);class G extends Error{constructor(i,r,n,o){super(`AJAXError: ${r} (${i}): ${n}`),this.status=i,this.statusText=r,this.url=n,this.body=o}}let W=v()?()=>self.worker&&self.worker.referrer:()=>("blob:"===window.location.protocol?window.parent:window).location.href;function H(i,r){let n=new AbortController,o=new Request(i.url,{method:i.method||"GET",body:i.body,credentials:i.credentials,headers:i.headers,referrer:W(),signal:n.signal}),a=!1,s=!1;return"json"===i.type&&o.headers.set("Accept","application/json"),((n,l,u)=>{if(s)return;let h=Date.now();fetch(o).then(n=>n.ok?((n,l,u)=>{("arrayBuffer"===i.type?n.arrayBuffer():"json"===i.type?n.json():n.text()).then(i=>{s||(l&&u&&function(i,r,n){if(B(),!M)return;let o={status:r.status,statusText:r.statusText,headers:new Headers};r.headers.forEach((i,r)=>o.headers.set(r,i));let a=x(r.headers.get("Cache-Control")||"");a["no-store"]||(a["max-age"]&&o.headers.set("Expires",new Date(n+1e3*a["max-age"]).toUTCString()),new Date(o.headers.get("Expires")).getTime()-n<42e4||function(i,r){if(void 0===z)try{new Response(new ReadableStream),z=!0}catch(i){z=!1}z?r(i.body):i.blob().then(r)}(r,r=>{let n=new Response(r,o);B(),M&&M.then(r=>r.put(function(i){let r=i.indexOf("?");return r<0?i:i.slice(0,r)}(i.url),n)).catch(i=>_(i.message))}))}(o,l,u),a=!0,r(null,i,n.headers.get("Cache-Control"),n.headers.get("Expires")))}).catch(i=>{s||r(Error(i.message))})})(n,null,h):n.blob().then(o=>r(new G(n.status,n.statusText,i.url,o)))).catch(i=>{20!==i.code&&r(Error(i.message))})})(),{cancel:()=>{s=!0,a||n.abort()}}}let X=function(i,r){var n;if(/:\/\//.test(i.url)&&!/^https?:|^file:/.test(i.url)){if(v()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",i,r);if(!v()){let n=i.url.substring(0,i.url.indexOf("://"));return(P.REGISTERED_PROTOCOLS[n]||H)(i,r)}}if(!(/^file:/.test(n=i.url)||/^file:/.test(W())&&!/^\w+:/.test(n))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return H(i,r);if(v()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",i,r,void 0,!0)}return function(i,r){let n=new XMLHttpRequest;for(let r in n.open(i.method||"GET",i.url,!0),"arrayBuffer"===i.type&&(n.responseType="arraybuffer"),i.headers)n.setRequestHeader(r,i.headers[r]);return"json"===i.type&&(n.responseType="text",n.setRequestHeader("Accept","application/json")),n.withCredentials="include"===i.credentials,n.onerror=()=>{r(Error(n.statusText))},n.onload=()=>{if((n.status>=200&&n.status<300||0===n.status)&&null!==n.response){let o=n.response;if("json"===i.type)try{o=JSON.parse(n.response)}catch(i){return r(i)}r(null,o,n.getResponseHeader("Cache-Control"),n.getResponseHeader("Expires"))}else{let o=new Blob([n.response],{type:n.getResponseHeader("Content-Type")});r(new G(n.status,n.statusText,i.url,o))}},n.send(i.body),{cancel:()=>n.abort()}}(i,r)},K=function(i,r){return X(h(i,{type:"arrayBuffer"}),r)},J="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";r=[],n=0;let Y=function(i,o){if(F.supported&&(i.headers||(i.headers={}),i.headers.accept="image/webp,*/*"),n>=P.MAX_PARALLEL_IMAGE_REQUESTS){let n={requestParameters:i,callback:o,cancelled:!1,cancel(){this.cancelled=!0}};return r.push(n),n}n++;let a=!1,s=()=>{if(!a)for(a=!0,n--;r.length&&n<P.MAX_PARALLEL_IMAGE_REQUESTS;){let i=r.shift(),{requestParameters:n,callback:o,cancelled:a}=i;a||(i.cancel=Y(n,o).cancel)}},l=K(i,(i,r,n,a)=>{var l;s(),i?o(i):r&&(l=(i,r)=>{null!=i?o(i):null!=r&&o(null,r,{cacheControl:n,expires:a})},"function"==typeof createImageBitmap?function(i,r){let n=new Blob([new Uint8Array(i)],{type:"image/png"});createImageBitmap(n).then(i=>{r(null,i)}).catch(i=>{r(Error(`Could not load image because of ${i.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})}(r,l):function(i,r){let n=new Image;n.onload=()=>{r(null,n),URL.revokeObjectURL(n.src),n.onload=null,window.requestAnimationFrame(()=>{n.src=J})},n.onerror=()=>r(Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));let o=new Blob([new Uint8Array(i)],{type:"image/png"});n.src=i.byteLength?URL.createObjectURL(o):J}(r,l))});return{cancel:()=>{l.cancel(),s()}}};function Q(i,r,n){n[i]&&-1!==n[i].indexOf(r)||(n[i]=n[i]||[],n[i].push(r))}function tt(i,r,n){if(n&&n[i]){let o=n[i].indexOf(r);-1!==o&&n[i].splice(o,1)}}class te{constructor(i,r={}){h(this,r),this.type=i}}class ti extends te{constructor(i,r={}){super("error",h({error:i},r))}}class tr{on(i,r){return this._listeners=this._listeners||{},Q(i,r,this._listeners),this}off(i,r){return tt(i,r,this._listeners),tt(i,r,this._oneTimeListeners),this}once(i,r){return this._oneTimeListeners=this._oneTimeListeners||{},Q(i,r,this._oneTimeListeners),this}fire(i,r){"string"==typeof i&&(i=new te(i,r||{}));let n=i.type;if(this.listens(n)){i.target=this;let r=this._listeners&&this._listeners[n]?this._listeners[n].slice():[];for(let n of r)n.call(this,i);let o=this._oneTimeListeners&&this._oneTimeListeners[n]?this._oneTimeListeners[n].slice():[];for(let r of o)tt(n,r,this._oneTimeListeners),r.call(this,i);let a=this._eventedParent;a&&(h(i,"function"==typeof this._eventedParentData?this._eventedParentData():this._eventedParentData),a.fire(i))}else i instanceof ti&&console.error(i.error);return this}listens(i){return this._listeners&&this._listeners[i]&&this._listeners[i].length>0||this._oneTimeListeners&&this._oneTimeListeners[i]&&this._oneTimeListeners[i].length>0||this._eventedParent&&this._eventedParent.listens(i)}setEventedParent(i,r){return this._eventedParent=i,this._eventedParentData=r,this}}var tn={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"string"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{}},default:"mapbox"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{},within:{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1},elevationOffset:{type:"number",default:450}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};class to{constructor(i,r,n,o){this.message=(i?`${i}: `:"")+n,o&&(this.identifier=o),null!=r&&r.__line__&&(this.line=r.__line__)}}function ta(i){let r=i.value;return r?[new to(i.key,r,"constants have been deprecated as of v8")]:[]}function ts(i,...r){for(let n of r)for(let r in n)i[r]=n[r];return i}function tl(i){return i instanceof Number||i instanceof String||i instanceof Boolean?i.valueOf():i}function tu(i){if(Array.isArray(i))return i.map(tu);if(i instanceof Object&&!(i instanceof Number||i instanceof String||i instanceof Boolean)){let r={};for(let n in i)r[n]=tu(i[n]);return r}return tl(i)}class th extends Error{constructor(i,r){super(r),this.message=r,this.key=i}}class tc{constructor(i,r=[]){for(let[n,o]of(this.parent=i,this.bindings={},r))this.bindings[n]=o}concat(i){return new tc(this,i)}get(i){if(this.bindings[i])return this.bindings[i];if(this.parent)return this.parent.get(i);throw Error(`${i} not found in scope.`)}has(i){return!!this.bindings[i]||!!this.parent&&this.parent.has(i)}}let td={kind:"null"},tp={kind:"number"},tf={kind:"string"},tm={kind:"boolean"},tg={kind:"color"},t_={kind:"object"},ty={kind:"value"},tv={kind:"collator"},tx={kind:"formatted"},tb={kind:"padding"},tw={kind:"resolvedImage"};function tT(i,r){return{kind:"array",itemType:i,N:r}}function tE(i){if("array"===i.kind){let r=tE(i.itemType);return"number"==typeof i.N?`array<${r}, ${i.N}>`:"value"===i.itemType.kind?"array":`array<${r}>`}return i.kind}let tS=[td,tp,tf,tm,tg,tx,t_,tT(ty),tb,tw];function tC(i,r){if("error"===r.kind)return null;if("array"===i.kind){if("array"===r.kind&&(0===r.N&&"value"===r.itemType.kind||!tC(i.itemType,r.itemType))&&("number"!=typeof i.N||i.N===r.N))return null}else{if(i.kind===r.kind)return null;if("value"===i.kind){for(let i of tS)if(!tC(i,r))return null}}return`Expected ${tE(i)} but found ${tE(r)} instead.`}function tI(i,r){return r.some(r=>r.kind===i.kind)}function tA(i,r){return r.some(r=>"null"===r?null===i:"array"===r?Array.isArray(i):"object"===r?i&&!Array.isArray(i)&&"object"==typeof i:r===typeof i)}var tP,tk,tL={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function tM(i){return(i=Math.round(i))<0?0:i>255?255:i}function tz(i){return tM("%"===i[i.length-1]?parseFloat(i)/100*255:parseInt(i))}function tD(i){var r;return(r="%"===i[i.length-1]?parseFloat(i)/100:parseFloat(i))<0?0:r>1?1:r}function tR(i,r,n){return n<0?n+=1:n>1&&(n-=1),6*n<1?i+(r-i)*n*6:2*n<1?r:3*n<2?i+(r-i)*(2/3-n)*6:i}try{tk=({}).parseCSSColor=function(i){var r,n=i.replace(/ /g,"").toLowerCase();if(n in tL)return tL[n].slice();if("#"===n[0])return 4===n.length?(r=parseInt(n.substr(1),16))>=0&&r<=4095?[(3840&r)>>4|(3840&r)>>8,240&r|(240&r)>>4,15&r|(15&r)<<4,1]:null:7===n.length&&(r=parseInt(n.substr(1),16))>=0&&r<=16777215?[(16711680&r)>>16,(65280&r)>>8,255&r,1]:null;var o=n.indexOf("("),a=n.indexOf(")");if(-1!==o&&a+1===n.length){var s=n.substr(0,o),l=n.substr(o+1,a-(o+1)).split(","),u=1;switch(s){case"rgba":if(4!==l.length)break;u=tD(l.pop());case"rgb":return 3!==l.length?null:[tz(l[0]),tz(l[1]),tz(l[2]),u];case"hsla":if(4!==l.length)break;u=tD(l.pop());case"hsl":if(3!==l.length)break;var h=(parseFloat(l[0])%360+360)%360/360,c=tD(l[1]),d=tD(l[2]),p=d<=.5?d*(c+1):d+c-d*c,f=2*d-p;return[tM(255*tR(f,p,h+1/3)),tM(255*tR(f,p,h)),tM(255*tR(f,p,h-1/3)),u]}}return null}}catch(i){}class tB{constructor(i,r,n,o=1){this.r=i,this.g=r,this.b=n,this.a=o}static parse(i){if(!i)return;if(i instanceof tB)return i;if("string"!=typeof i)return;let r=tk(i);return r?new tB(r[0]/255*r[3],r[1]/255*r[3],r[2]/255*r[3],r[3]):void 0}toString(){let[i,r,n,o]=this.toArray();return`rgba(${Math.round(i)},${Math.round(r)},${Math.round(n)},${o})`}toArray(){let{r:i,g:r,b:n,a:o}=this;return 0===o?[0,0,0,0]:[255*i/o,255*r/o,255*n/o,o]}}tB.black=new tB(0,0,0,1),tB.white=new tB(1,1,1,1),tB.transparent=new tB(0,0,0,0),tB.red=new tB(1,0,0,1);class tO{constructor(i,r,n){this.sensitivity=i?r?"variant":"case":r?"accent":"base",this.locale=n,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(i,r){return this.collator.compare(i,r)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class tF{constructor(i,r,n,o,a){this.text=i,this.image=r,this.scale=n,this.fontStack=o,this.textColor=a}}class tN{constructor(i){this.sections=i}static fromString(i){return new tN([new tF(i,null,null,null,null)])}isEmpty(){return 0===this.sections.length||!this.sections.some(i=>0!==i.text.length||i.image&&0!==i.image.name.length)}static factory(i){return i instanceof tN?i:tN.fromString(i)}toString(){return 0===this.sections.length?"":this.sections.map(i=>i.text).join("")}}class tU{constructor(i){this.values=i.slice()}static parse(i){if(i instanceof tU)return i;if("number"==typeof i)return new tU([i,i,i,i]);if(Array.isArray(i)&&!(i.length<1||i.length>4)){for(let r of i)if("number"!=typeof r)return;switch(i.length){case 1:i=[i[0],i[0],i[0],i[0]];break;case 2:i=[i[0],i[1],i[0],i[1]];break;case 3:i=[i[0],i[1],i[2],i[1]]}return new tU(i)}}toString(){return JSON.stringify(this.values)}}class tj{constructor(i){this.name=i.name,this.available=i.available}toString(){return this.name}static fromString(i){return i?new tj({name:i,available:!1}):null}}function tZ(i,r,n,o){return"number"==typeof i&&i>=0&&i<=255&&"number"==typeof r&&r>=0&&r<=255&&"number"==typeof n&&n>=0&&n<=255?void 0===o||"number"==typeof o&&o>=0&&o<=1?null:`Invalid rgba value [${[i,r,n,o].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${("number"==typeof o?[i,r,n,o]:[i,r,n]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function tV(i){if(null===i||"string"==typeof i||"boolean"==typeof i||"number"==typeof i||i instanceof tB||i instanceof tO||i instanceof tN||i instanceof tU||i instanceof tj)return!0;if(Array.isArray(i)){for(let r of i)if(!tV(r))return!1;return!0}if("object"==typeof i){for(let r in i)if(!tV(i[r]))return!1;return!0}return!1}function tq(i){if(null===i)return td;if("string"==typeof i)return tf;if("boolean"==typeof i)return tm;if("number"==typeof i)return tp;if(i instanceof tB)return tg;if(i instanceof tO)return tv;if(i instanceof tN)return tx;if(i instanceof tU)return tb;if(i instanceof tj)return tw;if(Array.isArray(i)){let r;let n=i.length;for(let n of i){let i=tq(n);if(r){if(r===i)continue;r=ty;break}r=i}return tT(r||ty,n)}return t_}function tG(i){let r=typeof i;return null===i?"":"string"===r||"number"===r||"boolean"===r?String(i):i instanceof tB||i instanceof tN||i instanceof tU||i instanceof tj?i.toString():JSON.stringify(i)}class t${constructor(i,r){this.type=i,this.value=r}static parse(i,r){if(2!==i.length)return r.error(`'literal' expression requires exactly one argument, but found ${i.length-1} instead.`);if(!tV(i[1]))return r.error("invalid value");let n=i[1],o=tq(n),a=r.expectedType;return"array"===o.kind&&0===o.N&&a&&"array"===a.kind&&("number"!=typeof a.N||0===a.N)&&(o=a),new t$(o,n)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}class tW{constructor(i){this.name="ExpressionEvaluationError",this.message=i}toJSON(){return this.message}}let tH={string:tf,number:tp,boolean:tm,object:t_};class tX{constructor(i,r){this.type=i,this.args=r}static parse(i,r){if(i.length<2)return r.error("Expected at least one argument.");let n,o=1,a=i[0];if("array"===a){let a,s;if(i.length>2){let n=i[1];if("string"!=typeof n||!(n in tH)||"object"===n)return r.error('The item type argument of "array" must be one of string, number, boolean',1);a=tH[n],o++}else a=ty;if(i.length>3){if(null!==i[2]&&("number"!=typeof i[2]||i[2]<0||i[2]!==Math.floor(i[2])))return r.error('The length argument to "array" must be a positive integer literal',2);s=i[2],o++}n=tT(a,s)}else{if(!tH[a])throw Error(`Types doesn't contain name = ${a}`);n=tH[a]}let s=[];for(;o<i.length;o++){let n=r.parse(i[o],o,ty);if(!n)return null;s.push(n)}return new tX(n,s)}evaluate(i){for(let r=0;r<this.args.length;r++){let n=this.args[r].evaluate(i);if(!tC(this.type,tq(n)))return n;if(r===this.args.length-1)throw new tW(`Expected value to be of type ${tE(this.type)}, but found ${tE(tq(n))} instead.`)}throw Error()}eachChild(i){this.args.forEach(i)}outputDefined(){return this.args.every(i=>i.outputDefined())}}let tK={"to-boolean":tm,"to-color":tg,"to-number":tp,"to-string":tf};class tJ{constructor(i,r){this.type=i,this.args=r}static parse(i,r){if(i.length<2)return r.error("Expected at least one argument.");let n=i[0];if(!tK[n])throw Error(`Can't parse ${n} as it is not part of the known types`);if(("to-boolean"===n||"to-string"===n)&&2!==i.length)return r.error("Expected one argument.");let o=tK[n],a=[];for(let n=1;n<i.length;n++){let o=r.parse(i[n],n,ty);if(!o)return null;a.push(o)}return new tJ(o,a)}evaluate(i){if("boolean"===this.type.kind)return!!this.args[0].evaluate(i);if("color"===this.type.kind){let r,n;for(let o of this.args){if(r=o.evaluate(i),n=null,r instanceof tB)return r;if("string"==typeof r){let n=i.parseColor(r);if(n)return n}else if(Array.isArray(r)&&!(n=r.length<3||r.length>4?`Invalid rbga value ${JSON.stringify(r)}: expected an array containing either three or four numeric values.`:tZ(r[0],r[1],r[2],r[3])))return new tB(r[0]/255,r[1]/255,r[2]/255,r[3])}throw new tW(n||`Could not parse color from value '${"string"==typeof r?r:JSON.stringify(r)}'`)}if("padding"===this.type.kind){let r;for(let n of this.args){r=n.evaluate(i);let o=tU.parse(r);if(o)return o}throw new tW(`Could not parse padding from value '${"string"==typeof r?r:JSON.stringify(r)}'`)}if("number"===this.type.kind){let r=null;for(let n of this.args){if(null===(r=n.evaluate(i)))return 0;let o=Number(r);if(!isNaN(o))return o}throw new tW(`Could not convert ${JSON.stringify(r)} to number.`)}return"formatted"===this.type.kind?tN.fromString(tG(this.args[0].evaluate(i))):"resolvedImage"===this.type.kind?tj.fromString(tG(this.args[0].evaluate(i))):tG(this.args[0].evaluate(i))}eachChild(i){this.args.forEach(i)}outputDefined(){return this.args.every(i=>i.outputDefined())}}let tY=["Unknown","Point","LineString","Polygon"];class tQ{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?"number"==typeof this.feature.type?tY[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(i){let r=this._parseColorCache[i];return r||(r=this._parseColorCache[i]=tB.parse(i)),r}}class t0{constructor(i,r,n,o){this.name=i,this.type=r,this._evaluate=n,this.args=o}evaluate(i){return this._evaluate(i,this.args)}eachChild(i){this.args.forEach(i)}outputDefined(){return!1}static parse(i,r){let n=i[0],o=t0.definitions[n];if(!o)return r.error(`Unknown expression "${n}". If you wanted a literal array, use ["literal", [...]].`,0);let a=Array.isArray(o)?o[0]:o.type,s=Array.isArray(o)?[[o[1],o[2]]]:o.overloads,l=s.filter(([r])=>!Array.isArray(r)||r.length===i.length-1),u=null;for(let[o,s]of l){u=new es(r.registry,r.path,null,r.scope);let l=[],h=!1;for(let r=1;r<i.length;r++){let n=i[r],a=Array.isArray(o)?o[r-1]:o.type,s=u.parse(n,1+l.length,a);if(!s){h=!0;break}l.push(s)}if(!h){if(Array.isArray(o)&&o.length!==l.length)u.error(`Expected ${o.length} arguments, but found ${l.length} instead.`);else{for(let i=0;i<l.length;i++){let r=Array.isArray(o)?o[i]:o.type,n=l[i];u.concat(i+1).checkSubtype(r,n.type)}if(0===u.errors.length)return new t0(n,a,s,l)}}}if(1===l.length)r.errors.push(...u.errors);else{let n=(l.length?l:s).map(([i])=>Array.isArray(i)?`(${i.map(tE).join(", ")})`:`(${tE(i.type)}...)`).join(" | "),o=[];for(let n=1;n<i.length;n++){let a=r.parse(i[n],1+o.length);if(!a)return null;o.push(tE(a.type))}r.error(`Expected arguments of type ${n}, but found (${o.join(", ")}) instead.`)}return null}static register(i,r){for(let n in t0.definitions=r,r)i[n]=t0}}class t1{constructor(i,r,n){this.type=tv,this.locale=n,this.caseSensitive=i,this.diacriticSensitive=r}static parse(i,r){if(2!==i.length)return r.error("Expected one argument.");let n=i[1];if("object"!=typeof n||Array.isArray(n))return r.error("Collator options argument must be an object.");let o=r.parse(void 0!==n["case-sensitive"]&&n["case-sensitive"],1,tm);if(!o)return null;let a=r.parse(void 0!==n["diacritic-sensitive"]&&n["diacritic-sensitive"],1,tm);if(!a)return null;let s=null;return!n.locale||(s=r.parse(n.locale,1,tf))?new t1(o,a,s):null}evaluate(i){return new tO(this.caseSensitive.evaluate(i),this.diacriticSensitive.evaluate(i),this.locale?this.locale.evaluate(i):null)}eachChild(i){i(this.caseSensitive),i(this.diacriticSensitive),this.locale&&i(this.locale)}outputDefined(){return!1}}function t2(i,r){i[0]=Math.min(i[0],r[0]),i[1]=Math.min(i[1],r[1]),i[2]=Math.max(i[2],r[0]),i[3]=Math.max(i[3],r[1])}function t3(i,r){return!(i[0]<=r[0]||i[2]>=r[2]||i[1]<=r[1]||i[3]>=r[3])}function t5(i,r){var n,o;let a=!1;for(let s=0,l=r.length;s<l;s++){let l=r[s];for(let r=0,s=l.length;r<s-1;r++){if(function(i,r,n){let o=i[0]-r[0],a=i[1]-r[1],s=i[0]-n[0],l=i[1]-n[1];return o*l-s*a==0&&o*s<=0&&a*l<=0}(i,l[r],l[r+1]))return!1;(n=l[r])[1]>i[1]!=(o=l[r+1])[1]>i[1]&&i[0]<(o[0]-n[0])*(i[1]-n[1])/(o[1]-n[1])+n[0]&&(a=!a)}}return a}function t4(i,r,n,o){let a=o[0]-n[0],s=o[1]-n[1],l=(i[0]-n[0])*s-a*(i[1]-n[1]),u=(r[0]-n[0])*s-a*(r[1]-n[1]);return l>0&&u<0||l<0&&u>0}function t6(i,r){for(let n=0;n<i.length;++n)if(!t5(i[n],r))return!1;for(let n=0;n<i.length-1;++n)if(function(i,r,n){var o,a,s,l;for(let u of n)for(let n=0;n<u.length-1;++n)if(0!=(s=[(a=u[n+1])[0]-(o=u[n])[0],a[1]-o[1]])[0]*(l=[r[0]-i[0],r[1]-i[1]])[1]-s[1]*l[0]&&t4(i,r,o,a)&&t4(o,a,i,r))return!0;return!1}(i[n],i[n+1],r))return!1;return!0}function t8(i,r,n){let o=[];for(let a=0;a<i.length;a++){let s=[];for(let o=0;o<i[a].length;o++){let l=function(i,r){let n=(180+i[0])/360,o=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+i[1]*Math.PI/360)))/360,a=Math.pow(2,r.z);return[Math.round(n*a*8192),Math.round(o*a*8192)]}(i[a][o],n);t2(r,l),s.push(l)}o.push(s)}return o}function t9(i,r,n){let o=[];for(let a=0;a<i.length;a++){let s=t8(i[a],r,n);o.push(s)}return o}function t7(i,r,n,o){if(i[0]<n[0]||i[0]>n[2]){let r=.5*o,a=i[0]-n[0]>r?-o:n[0]-i[0]>r?o:0;0===a&&(a=i[0]-n[2]>r?-o:n[2]-i[0]>r?o:0),i[0]+=a}t2(r,i)}function et(i,r,n,o){let a=8192*Math.pow(2,o.z),s=[8192*o.x,8192*o.y],l=[];for(let o of i)for(let i of o){let o=[i.x+s[0],i.y+s[1]];t7(o,r,n,a),l.push(o)}return l}function ee(i,r,n,o){let a=8192*Math.pow(2,o.z),s=[8192*o.x,8192*o.y],l=[];for(let n of i){let i=[];for(let o of n){let n=[o.x+s[0],o.y+s[1]];t2(r,n),i.push(n)}l.push(i)}if(r[2]-r[0]<=a/2)for(let i of(r[0]=r[1]=1/0,r[2]=r[3]=-1/0,l))for(let o of i)t7(o,r,n,a);return l}class ei{constructor(i,r){this.type=tm,this.geojson=i,this.geometries=r}static parse(i,r){if(2!==i.length)return r.error(`'within' expression requires exactly one argument, but found ${i.length-1} instead.`);if(tV(i[1])){let r=i[1];if("FeatureCollection"===r.type)for(let i=0;i<r.features.length;++i){let n=r.features[i].geometry.type;if("Polygon"===n||"MultiPolygon"===n)return new ei(r,r.features[i].geometry)}else if("Feature"===r.type){let i=r.geometry.type;if("Polygon"===i||"MultiPolygon"===i)return new ei(r,r.geometry)}else if("Polygon"===r.type||"MultiPolygon"===r.type)return new ei(r,r)}return r.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(i){if(null!=i.geometry()&&null!=i.canonicalID()){if("Point"===i.geometryType())return function(i,r){let n=[1/0,1/0,-1/0,-1/0],o=[1/0,1/0,-1/0,-1/0],a=i.canonicalID();if("Polygon"===r.type){let s=t8(r.coordinates,o,a),l=et(i.geometry(),n,o,a);if(!t3(n,o))return!1;for(let i of l)if(!t5(i,s))return!1}if("MultiPolygon"===r.type){let s=t9(r.coordinates,o,a),l=et(i.geometry(),n,o,a);if(!t3(n,o))return!1;for(let i of l)if(!function(i,r){for(let n=0;n<r.length;n++)if(t5(i,r[n]))return!0;return!1}(i,s))return!1}return!0}(i,this.geometries);if("LineString"===i.geometryType())return function(i,r){let n=[1/0,1/0,-1/0,-1/0],o=[1/0,1/0,-1/0,-1/0],a=i.canonicalID();if("Polygon"===r.type){let s=t8(r.coordinates,o,a),l=ee(i.geometry(),n,o,a);if(!t3(n,o))return!1;for(let i of l)if(!t6(i,s))return!1}if("MultiPolygon"===r.type){let s=t9(r.coordinates,o,a),l=ee(i.geometry(),n,o,a);if(!t3(n,o))return!1;for(let i of l)if(!function(i,r){for(let n=0;n<r.length;n++)if(t6(i,r[n]))return!0;return!1}(i,s))return!1}return!0}(i,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}function er(i){if(i instanceof t0&&("get"===i.name&&1===i.args.length||"feature-state"===i.name||"has"===i.name&&1===i.args.length||"properties"===i.name||"geometry-type"===i.name||"id"===i.name||/^filter-/.test(i.name))||i instanceof ei)return!1;let r=!0;return i.eachChild(i=>{r&&!er(i)&&(r=!1)}),r}function en(i){if(i instanceof t0&&"feature-state"===i.name)return!1;let r=!0;return i.eachChild(i=>{r&&!en(i)&&(r=!1)}),r}function eo(i,r){if(i instanceof t0&&r.indexOf(i.name)>=0)return!1;let n=!0;return i.eachChild(i=>{n&&!eo(i,r)&&(n=!1)}),n}class ea{constructor(i,r){this.type=r.type,this.name=i,this.boundExpression=r}static parse(i,r){if(2!==i.length||"string"!=typeof i[1])return r.error("'var' expression requires exactly one string literal argument.");let n=i[1];return r.scope.has(n)?new ea(n,r.scope.get(n)):r.error(`Unknown variable "${n}". Make sure "${n}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(i){return this.boundExpression.evaluate(i)}eachChild(){}outputDefined(){return!1}}class es{constructor(i,r=[],n,o=new tc,a=[]){this.registry=i,this.path=r,this.key=r.map(i=>`[${i}]`).join(""),this.scope=o,this.errors=a,this.expectedType=n}parse(i,r,n,o,a={}){return r?this.concat(r,n,o)._parse(i,a):this._parse(i,a)}_parse(i,r){function n(i,r,n){return"assert"===n?new tX(r,[i]):"coerce"===n?new tJ(r,[i]):i}if(null!==i&&"string"!=typeof i&&"boolean"!=typeof i&&"number"!=typeof i||(i=["literal",i]),Array.isArray(i)){if(0===i.length)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');let o=i[0];if("string"!=typeof o)return this.error(`Expression name must be a string, but found ${typeof o} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;let a=this.registry[o];if(a){let o=a.parse(i,this);if(!o)return null;if(this.expectedType){let i=this.expectedType,a=o.type;if("string"!==i.kind&&"number"!==i.kind&&"boolean"!==i.kind&&"object"!==i.kind&&"array"!==i.kind||"value"!==a.kind){if("color"!==i.kind&&"formatted"!==i.kind&&"resolvedImage"!==i.kind||"value"!==a.kind&&"string"!==a.kind){if("padding"!==i.kind||"value"!==a.kind&&"number"!==a.kind&&"array"!==a.kind){if(this.checkSubtype(i,a))return null}else o=n(o,i,r.typeAnnotation||"coerce")}else o=n(o,i,r.typeAnnotation||"coerce")}else o=n(o,i,r.typeAnnotation||"assert")}if(!(o instanceof t$)&&"resolvedImage"!==o.type.kind&&function i(r){if(r instanceof ea)return i(r.boundExpression);if(r instanceof t0&&"error"===r.name||r instanceof t1||r instanceof ei)return!1;let n=r instanceof tJ||r instanceof tX,o=!0;return r.eachChild(r=>{o=n?o&&i(r):o&&r instanceof t$}),!!o&&er(r)&&eo(r,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}(o)){let i=new tQ;try{o=new t$(o.type,o.evaluate(i))}catch(i){return this.error(i.message),null}}return o}return this.error(`Unknown expression "${o}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(void 0===i?"'undefined' value invalid. Use null instead.":"object"==typeof i?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof i} instead.`)}concat(i,r,n){let o="number"==typeof i?this.path.concat(i):this.path,a=n?this.scope.concat(n):this.scope;return new es(this.registry,o,r||null,a,this.errors)}error(i,...r){let n=`${this.key}${r.map(i=>`[${i}]`).join("")}`;this.errors.push(new th(n,i))}checkSubtype(i,r){let n=tC(i,r);return n&&this.error(n),n}}function el(i,r){let n=i.length-1,o,a,s=0,l=n,u=0;for(;s<=l;)if(o=i[u=Math.floor((s+l)/2)],a=i[u+1],o<=r){if(u===n||r<a)return u;s=u+1}else{if(!(o>r))throw new tW("Input is not a number.");l=u-1}return 0}class eu{constructor(i,r,n){for(let[o,a]of(this.type=i,this.input=r,this.labels=[],this.outputs=[],n))this.labels.push(o),this.outputs.push(a)}static parse(i,r){if(i.length-1<4)return r.error(`Expected at least 4 arguments, but found only ${i.length-1}.`);if((i.length-1)%2!=0)return r.error("Expected an even number of arguments.");let n=r.parse(i[1],1,tp);if(!n)return null;let o=[],a=null;r.expectedType&&"value"!==r.expectedType.kind&&(a=r.expectedType);for(let n=1;n<i.length;n+=2){let s=1===n?-1/0:i[n],l=i[n+1],u=n,h=n+1;if("number"!=typeof s)return r.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',u);if(o.length&&o[o.length-1][0]>=s)return r.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',u);let c=r.parse(l,h,a);if(!c)return null;a=a||c.type,o.push([s,c])}return new eu(a,n,o)}evaluate(i){let r=this.labels,n=this.outputs;if(1===r.length)return n[0].evaluate(i);let o=this.input.evaluate(i);if(o<=r[0])return n[0].evaluate(i);let a=r.length;return o>=r[a-1]?n[a-1].evaluate(i):n[el(r,o)].evaluate(i)}eachChild(i){for(let r of(i(this.input),this.outputs))i(r)}outputDefined(){return this.outputs.every(i=>i.outputDefined())}}function eh(i,r,n){return i*(1-n)+r*n}var ec=Object.freeze({__proto__:null,number:eh,color:function(i,r,n){return new tB(eh(i.r,r.r,n),eh(i.g,r.g,n),eh(i.b,r.b,n),eh(i.a,r.a,n))},array:function(i,r,n){return i.map((i,o)=>eh(i,r[o],n))},padding:function(i,r,n){let o=i.values,a=r.values;return new tU([eh(o[0],a[0],n),eh(o[1],a[1],n),eh(o[2],a[2],n),eh(o[3],a[3],n)])}});let ed=4/29,ep=6/29,ef=3*ep*ep,em=Math.PI/180,eg=180/Math.PI;function e_(i){return i>.008856451679035631?Math.pow(i,1/3):i/ef+ed}function ey(i){return i>ep?i*i*i:ef*(i-ed)}function ev(i){return 255*(i<=.0031308?12.92*i:1.055*Math.pow(i,1/2.4)-.055)}function ex(i){return(i/=255)<=.04045?i/12.92:Math.pow((i+.055)/1.055,2.4)}function eb(i){let r=ex(i.r),n=ex(i.g),o=ex(i.b),a=e_((.4124564*r+.3575761*n+.1804375*o)/.95047),s=e_((.2126729*r+.7151522*n+.072175*o)/1);return{l:116*s-16,a:500*(a-s),b:200*(s-e_((.0193339*r+.119192*n+.9503041*o)/1.08883)),alpha:i.a}}function ew(i){let r=(i.l+16)/116,n=isNaN(i.a)?r:r+i.a/500,o=isNaN(i.b)?r:r-i.b/200;return r=1*ey(r),n=.95047*ey(n),o=1.08883*ey(o),new tB(ev(3.2404542*n-1.5371385*r-.4985314*o),ev(-.969266*n+1.8760108*r+.041556*o),ev(.0556434*n-.2040259*r+1.0572252*o),i.alpha)}let eT={forward:eb,reverse:ew,interpolate:function(i,r,n){return{l:eh(i.l,r.l,n),a:eh(i.a,r.a,n),b:eh(i.b,r.b,n),alpha:eh(i.alpha,r.alpha,n)}}},eE={forward:function(i){let{l:r,a:n,b:o}=eb(i),a=Math.atan2(o,n)*eg;return{h:a<0?a+360:a,c:Math.sqrt(n*n+o*o),l:r,alpha:i.a}},reverse:function(i){let r=i.h*em,n=i.c;return ew({l:i.l,a:Math.cos(r)*n,b:Math.sin(r)*n,alpha:i.alpha})},interpolate:function(i,r,n){return{h:function(i,r,n){let o=r-i;return i+n*(o>180||o<-180?o-360*Math.round(o/360):o)}(i.h,r.h,n),c:eh(i.c,r.c,n),l:eh(i.l,r.l,n),alpha:eh(i.alpha,r.alpha,n)}}};var eS=Object.freeze({__proto__:null,lab:eT,hcl:eE});class eC{constructor(i,r,n,o,a){for(let[s,l]of(this.type=i,this.operator=r,this.interpolation=n,this.input=o,this.labels=[],this.outputs=[],a))this.labels.push(s),this.outputs.push(l)}static interpolationFactor(i,r,n,a){let s=0;if("exponential"===i.name)s=eI(r,i.base,n,a);else if("linear"===i.name)s=eI(r,1,n,a);else if("cubic-bezier"===i.name){let l=i.controlPoints;s=new o(l[0],l[1],l[2],l[3]).solve(eI(r,1,n,a))}return s}static parse(i,r){let[n,o,a,...s]=i;if(!Array.isArray(o)||0===o.length)return r.error("Expected an interpolation type expression.",1);if("linear"===o[0])o={name:"linear"};else if("exponential"===o[0]){let i=o[1];if("number"!=typeof i)return r.error("Exponential interpolation requires a numeric base.",1,1);o={name:"exponential",base:i}}else{if("cubic-bezier"!==o[0])return r.error(`Unknown interpolation type ${String(o[0])}`,1,0);{let i=o.slice(1);if(4!==i.length||i.some(i=>"number"!=typeof i||i<0||i>1))return r.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);o={name:"cubic-bezier",controlPoints:i}}}if(i.length-1<4)return r.error(`Expected at least 4 arguments, but found only ${i.length-1}.`);if((i.length-1)%2!=0)return r.error("Expected an even number of arguments.");if(!(a=r.parse(a,2,tp)))return null;let l=[],u=null;"interpolate-hcl"===n||"interpolate-lab"===n?u=tg:r.expectedType&&"value"!==r.expectedType.kind&&(u=r.expectedType);for(let i=0;i<s.length;i+=2){let n=s[i],o=s[i+1],a=i+3,h=i+4;if("number"!=typeof n)return r.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',a);if(l.length&&l[l.length-1][0]>=n)return r.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',a);let c=r.parse(o,h,u);if(!c)return null;u=u||c.type,l.push([n,c])}return"number"===u.kind||"color"===u.kind||"padding"===u.kind||"array"===u.kind&&"number"===u.itemType.kind&&"number"==typeof u.N?new eC(u,n,o,a,l):r.error(`Type ${tE(u)} is not interpolatable.`)}evaluate(i){let r=this.labels,n=this.outputs;if(1===r.length)return n[0].evaluate(i);let o=this.input.evaluate(i);if(o<=r[0])return n[0].evaluate(i);let a=r.length;if(o>=r[a-1])return n[a-1].evaluate(i);let s=el(r,o),l=eC.interpolationFactor(this.interpolation,o,r[s],r[s+1]),u=n[s].evaluate(i),h=n[s+1].evaluate(i);return"interpolate"===this.operator?ec[this.type.kind.toLowerCase()](u,h,l):"interpolate-hcl"===this.operator?eE.reverse(eE.interpolate(eE.forward(u),eE.forward(h),l)):eT.reverse(eT.interpolate(eT.forward(u),eT.forward(h),l))}eachChild(i){for(let r of(i(this.input),this.outputs))i(r)}outputDefined(){return this.outputs.every(i=>i.outputDefined())}}function eI(i,r,n,o){let a=o-n,s=i-n;return 0===a?0:1===r?s/a:(Math.pow(r,s)-1)/(Math.pow(r,a)-1)}class eA{constructor(i,r){this.type=i,this.args=r}static parse(i,r){if(i.length<2)return r.error("Expectected at least one argument.");let n=null,o=r.expectedType;o&&"value"!==o.kind&&(n=o);let a=[];for(let o of i.slice(1)){let i=r.parse(o,1+a.length,n,void 0,{typeAnnotation:"omit"});if(!i)return null;n=n||i.type,a.push(i)}if(!n)throw Error("No output type");let s=o&&a.some(i=>tC(o,i.type));return new eA(s?ty:n,a)}evaluate(i){let r,n=null,o=0;for(let a of this.args)if(o++,(n=a.evaluate(i))&&n instanceof tj&&!n.available&&(r||(r=n.name),n=null,o===this.args.length&&(n=r)),null!==n)break;return n}eachChild(i){this.args.forEach(i)}outputDefined(){return this.args.every(i=>i.outputDefined())}}class eP{constructor(i,r){this.type=r.type,this.bindings=[].concat(i),this.result=r}evaluate(i){return this.result.evaluate(i)}eachChild(i){for(let r of this.bindings)i(r[1]);i(this.result)}static parse(i,r){if(i.length<4)return r.error(`Expected at least 3 arguments, but found ${i.length-1} instead.`);let n=[];for(let o=1;o<i.length-1;o+=2){let a=i[o];if("string"!=typeof a)return r.error(`Expected string, but found ${typeof a} instead.`,o);if(/[^a-zA-Z0-9_]/.test(a))return r.error("Variable names must contain only alphanumeric characters or '_'.",o);let s=r.parse(i[o+1],o+1);if(!s)return null;n.push([a,s])}let o=r.parse(i[i.length-1],i.length-1,r.expectedType,n);return o?new eP(n,o):null}outputDefined(){return this.result.outputDefined()}}class ek{constructor(i,r,n){this.type=i,this.index=r,this.input=n}static parse(i,r){if(3!==i.length)return r.error(`Expected 2 arguments, but found ${i.length-1} instead.`);let n=r.parse(i[1],1,tp),o=r.parse(i[2],2,tT(r.expectedType||ty));return n&&o?new ek(o.type.itemType,n,o):null}evaluate(i){let r=this.index.evaluate(i),n=this.input.evaluate(i);if(r<0)throw new tW(`Array index out of bounds: ${r} < 0.`);if(r>=n.length)throw new tW(`Array index out of bounds: ${r} > ${n.length-1}.`);if(r!==Math.floor(r))throw new tW(`Array index must be an integer, but found ${r} instead.`);return n[r]}eachChild(i){i(this.index),i(this.input)}outputDefined(){return!1}}class eL{constructor(i,r){this.type=tm,this.needle=i,this.haystack=r}static parse(i,r){if(3!==i.length)return r.error(`Expected 2 arguments, but found ${i.length-1} instead.`);let n=r.parse(i[1],1,ty),o=r.parse(i[2],2,ty);return n&&o?tI(n.type,[tm,tf,tp,td,ty])?new eL(n,o):r.error(`Expected first argument to be of type boolean, string, number or null, but found ${tE(n.type)} instead`):null}evaluate(i){let r=this.needle.evaluate(i),n=this.haystack.evaluate(i);if(!n)return!1;if(!tA(r,["boolean","string","number","null"]))throw new tW(`Expected first argument to be of type boolean, string, number or null, but found ${tE(tq(r))} instead.`);if(!tA(n,["string","array"]))throw new tW(`Expected second argument to be of type array or string, but found ${tE(tq(n))} instead.`);return n.indexOf(r)>=0}eachChild(i){i(this.needle),i(this.haystack)}outputDefined(){return!0}}class eM{constructor(i,r,n){this.type=tp,this.needle=i,this.haystack=r,this.fromIndex=n}static parse(i,r){if(i.length<=2||i.length>=5)return r.error(`Expected 3 or 4 arguments, but found ${i.length-1} instead.`);let n=r.parse(i[1],1,ty),o=r.parse(i[2],2,ty);if(!n||!o)return null;if(!tI(n.type,[tm,tf,tp,td,ty]))return r.error(`Expected first argument to be of type boolean, string, number or null, but found ${tE(n.type)} instead`);if(4===i.length){let a=r.parse(i[3],3,tp);return a?new eM(n,o,a):null}return new eM(n,o)}evaluate(i){let r=this.needle.evaluate(i),n=this.haystack.evaluate(i);if(!tA(r,["boolean","string","number","null"]))throw new tW(`Expected first argument to be of type boolean, string, number or null, but found ${tE(tq(r))} instead.`);if(!tA(n,["string","array"]))throw new tW(`Expected second argument to be of type array or string, but found ${tE(tq(n))} instead.`);if(this.fromIndex){let o=this.fromIndex.evaluate(i);return n.indexOf(r,o)}return n.indexOf(r)}eachChild(i){i(this.needle),i(this.haystack),this.fromIndex&&i(this.fromIndex)}outputDefined(){return!1}}class ez{constructor(i,r,n,o,a,s){this.inputType=i,this.type=r,this.input=n,this.cases=o,this.outputs=a,this.otherwise=s}static parse(i,r){let n,o;if(i.length<5)return r.error(`Expected at least 4 arguments, but found only ${i.length-1}.`);if(i.length%2!=1)return r.error("Expected an even number of arguments.");r.expectedType&&"value"!==r.expectedType.kind&&(o=r.expectedType);let a={},s=[];for(let l=2;l<i.length-1;l+=2){let u=i[l],h=i[l+1];Array.isArray(u)||(u=[u]);let c=r.concat(l);if(0===u.length)return c.error("Expected at least one branch label.");for(let i of u){if("number"!=typeof i&&"string"!=typeof i)return c.error("Branch labels must be numbers or strings.");if("number"==typeof i&&Math.abs(i)>Number.MAX_SAFE_INTEGER)return c.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if("number"==typeof i&&Math.floor(i)!==i)return c.error("Numeric branch labels must be integer values.");if(n){if(c.checkSubtype(n,tq(i)))return null}else n=tq(i);if(void 0!==a[String(i)])return c.error("Branch labels must be unique.");a[String(i)]=s.length}let d=r.parse(h,l,o);if(!d)return null;o=o||d.type,s.push(d)}let l=r.parse(i[1],1,ty);if(!l)return null;let u=r.parse(i[i.length-1],i.length-1,o);return u?"value"!==l.type.kind&&r.concat(1).checkSubtype(n,l.type)?null:new ez(n,o,l,a,s,u):null}evaluate(i){let r=this.input.evaluate(i);return(tq(r)===this.inputType&&this.outputs[this.cases[r]]||this.otherwise).evaluate(i)}eachChild(i){i(this.input),this.outputs.forEach(i),i(this.otherwise)}outputDefined(){return this.outputs.every(i=>i.outputDefined())&&this.otherwise.outputDefined()}}class eD{constructor(i,r,n){this.type=i,this.branches=r,this.otherwise=n}static parse(i,r){let n;if(i.length<4)return r.error(`Expected at least 3 arguments, but found only ${i.length-1}.`);if(i.length%2!=0)return r.error("Expected an odd number of arguments.");r.expectedType&&"value"!==r.expectedType.kind&&(n=r.expectedType);let o=[];for(let a=1;a<i.length-1;a+=2){let s=r.parse(i[a],a,tm);if(!s)return null;let l=r.parse(i[a+1],a+1,n);if(!l)return null;o.push([s,l]),n=n||l.type}let a=r.parse(i[i.length-1],i.length-1,n);if(!a)return null;if(!n)throw Error("Can't infer output type");return new eD(n,o,a)}evaluate(i){for(let[r,n]of this.branches)if(r.evaluate(i))return n.evaluate(i);return this.otherwise.evaluate(i)}eachChild(i){for(let[r,n]of this.branches)i(r),i(n);i(this.otherwise)}outputDefined(){return this.branches.every(([i,r])=>r.outputDefined())&&this.otherwise.outputDefined()}}class eR{constructor(i,r,n,o){this.type=i,this.input=r,this.beginIndex=n,this.endIndex=o}static parse(i,r){if(i.length<=2||i.length>=5)return r.error(`Expected 3 or 4 arguments, but found ${i.length-1} instead.`);let n=r.parse(i[1],1,ty),o=r.parse(i[2],2,tp);if(!n||!o)return null;if(!tI(n.type,[tT(ty),tf,ty]))return r.error(`Expected first argument to be of type array or string, but found ${tE(n.type)} instead`);if(4===i.length){let a=r.parse(i[3],3,tp);return a?new eR(n.type,n,o,a):null}return new eR(n.type,n,o)}evaluate(i){let r=this.input.evaluate(i),n=this.beginIndex.evaluate(i);if(!tA(r,["string","array"]))throw new tW(`Expected first argument to be of type array or string, but found ${tE(tq(r))} instead.`);if(this.endIndex){let o=this.endIndex.evaluate(i);return r.slice(n,o)}return r.slice(n)}eachChild(i){i(this.input),i(this.beginIndex),this.endIndex&&i(this.endIndex)}outputDefined(){return!1}}function eB(i,r){return"=="===i||"!="===i?"boolean"===r.kind||"string"===r.kind||"number"===r.kind||"null"===r.kind||"value"===r.kind:"string"===r.kind||"number"===r.kind||"value"===r.kind}function eO(i,r,n,o){return 0===o.compare(r,n)}function eF(i,r,n){let o="=="!==i&&"!="!==i;return class a{constructor(i,r,n){this.type=tm,this.lhs=i,this.rhs=r,this.collator=n,this.hasUntypedArgument="value"===i.type.kind||"value"===r.type.kind}static parse(i,r){if(3!==i.length&&4!==i.length)return r.error("Expected two or three arguments.");let n=i[0],s=r.parse(i[1],1,ty);if(!s)return null;if(!eB(n,s.type))return r.concat(1).error(`"${n}" comparisons are not supported for type '${tE(s.type)}'.`);let l=r.parse(i[2],2,ty);if(!l)return null;if(!eB(n,l.type))return r.concat(2).error(`"${n}" comparisons are not supported for type '${tE(l.type)}'.`);if(s.type.kind!==l.type.kind&&"value"!==s.type.kind&&"value"!==l.type.kind)return r.error(`Cannot compare types '${tE(s.type)}' and '${tE(l.type)}'.`);o&&("value"===s.type.kind&&"value"!==l.type.kind?s=new tX(l.type,[s]):"value"!==s.type.kind&&"value"===l.type.kind&&(l=new tX(s.type,[l])));let u=null;if(4===i.length){if("string"!==s.type.kind&&"string"!==l.type.kind&&"value"!==s.type.kind&&"value"!==l.type.kind)return r.error("Cannot use collator to compare non-string types.");if(!(u=r.parse(i[3],3,tv)))return null}return new a(s,l,u)}evaluate(a){let s=this.lhs.evaluate(a),l=this.rhs.evaluate(a);if(o&&this.hasUntypedArgument){let r=tq(s),n=tq(l);if(r.kind!==n.kind||"string"!==r.kind&&"number"!==r.kind)throw new tW(`Expected arguments for "${i}" to be (string, string) or (number, number), but found (${r.kind}, ${n.kind}) instead.`)}if(this.collator&&!o&&this.hasUntypedArgument){let i=tq(s),n=tq(l);if("string"!==i.kind||"string"!==n.kind)return r(a,s,l)}return this.collator?n(a,s,l,this.collator.evaluate(a)):r(a,s,l)}eachChild(i){i(this.lhs),i(this.rhs),this.collator&&i(this.collator)}outputDefined(){return!0}}}let eN=eF("==",function(i,r,n){return r===n},eO),eU=eF("!=",function(i,r,n){return r!==n},function(i,r,n,o){return!eO(0,r,n,o)}),ej=eF("<",function(i,r,n){return r<n},function(i,r,n,o){return 0>o.compare(r,n)}),eZ=eF(">",function(i,r,n){return r>n},function(i,r,n,o){return o.compare(r,n)>0}),eV=eF("<=",function(i,r,n){return r<=n},function(i,r,n,o){return 0>=o.compare(r,n)}),eq=eF(">=",function(i,r,n){return r>=n},function(i,r,n,o){return o.compare(r,n)>=0});class eG{constructor(i,r,n,o,a){this.type=tf,this.number=i,this.locale=r,this.currency=n,this.minFractionDigits=o,this.maxFractionDigits=a}static parse(i,r){if(3!==i.length)return r.error("Expected two arguments.");let n=r.parse(i[1],1,tp);if(!n)return null;let o=i[2];if("object"!=typeof o||Array.isArray(o))return r.error("NumberFormat options argument must be an object.");let a=null;if(o.locale&&!(a=r.parse(o.locale,1,tf)))return null;let s=null;if(o.currency&&!(s=r.parse(o.currency,1,tf)))return null;let l=null;if(o["min-fraction-digits"]&&!(l=r.parse(o["min-fraction-digits"],1,tp)))return null;let u=null;return!o["max-fraction-digits"]||(u=r.parse(o["max-fraction-digits"],1,tp))?new eG(n,a,s,l,u):null}evaluate(i){return new Intl.NumberFormat(this.locale?this.locale.evaluate(i):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(i):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(i):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(i):void 0}).format(this.number.evaluate(i))}eachChild(i){i(this.number),this.locale&&i(this.locale),this.currency&&i(this.currency),this.minFractionDigits&&i(this.minFractionDigits),this.maxFractionDigits&&i(this.maxFractionDigits)}outputDefined(){return!1}}class e${constructor(i){this.type=tx,this.sections=i}static parse(i,r){if(i.length<2)return r.error("Expected at least one argument.");let n=i[1];if(!Array.isArray(n)&&"object"==typeof n)return r.error("First argument must be an image or text section.");let o=[],a=!1;for(let n=1;n<=i.length-1;++n){let s=i[n];if(a&&"object"==typeof s&&!Array.isArray(s)){a=!1;let i=null;if(s["font-scale"]&&!(i=r.parse(s["font-scale"],1,tp)))return null;let n=null;if(s["text-font"]&&!(n=r.parse(s["text-font"],1,tT(tf))))return null;let l=null;if(s["text-color"]&&!(l=r.parse(s["text-color"],1,tg)))return null;let u=o[o.length-1];u.scale=i,u.font=n,u.textColor=l}else{let s=r.parse(i[n],1,ty);if(!s)return null;let l=s.type.kind;if("string"!==l&&"value"!==l&&"null"!==l&&"resolvedImage"!==l)return r.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");a=!0,o.push({content:s,scale:null,font:null,textColor:null})}}return new e$(o)}evaluate(i){return new tN(this.sections.map(r=>{let n=r.content.evaluate(i);return tq(n)===tw?new tF("",n,null,null,null):new tF(tG(n),null,r.scale?r.scale.evaluate(i):null,r.font?r.font.evaluate(i).join(","):null,r.textColor?r.textColor.evaluate(i):null)}))}eachChild(i){for(let r of this.sections)i(r.content),r.scale&&i(r.scale),r.font&&i(r.font),r.textColor&&i(r.textColor)}outputDefined(){return!1}}class eW{constructor(i){this.type=tw,this.input=i}static parse(i,r){if(2!==i.length)return r.error("Expected two arguments.");let n=r.parse(i[1],1,tf);return n?new eW(n):r.error("No image name provided.")}evaluate(i){let r=this.input.evaluate(i),n=tj.fromString(r);return n&&i.availableImages&&(n.available=i.availableImages.indexOf(r)>-1),n}eachChild(i){i(this.input)}outputDefined(){return!1}}class eH{constructor(i){this.type=tp,this.input=i}static parse(i,r){if(2!==i.length)return r.error(`Expected 1 argument, but found ${i.length-1} instead.`);let n=r.parse(i[1],1);return n?"array"!==n.type.kind&&"string"!==n.type.kind&&"value"!==n.type.kind?r.error(`Expected argument of type string or array, but found ${tE(n.type)} instead.`):new eH(n):null}evaluate(i){let r=this.input.evaluate(i);if("string"==typeof r||Array.isArray(r))return r.length;throw new tW(`Expected value to be of type string or array, but found ${tE(tq(r))} instead.`)}eachChild(i){i(this.input)}outputDefined(){return!1}}let eX={"==":eN,"!=":eU,">":eZ,"<":ej,">=":eq,"<=":eV,array:tX,at:ek,boolean:tX,case:eD,coalesce:eA,collator:t1,format:e$,image:eW,in:eL,"index-of":eM,interpolate:eC,"interpolate-hcl":eC,"interpolate-lab":eC,length:eH,let:eP,literal:t$,match:ez,number:tX,"number-format":eG,object:tX,slice:eR,step:eu,string:tX,"to-boolean":tJ,"to-color":tJ,"to-number":tJ,"to-string":tJ,var:ea,within:ei};function eK(i,[r,n,o,a]){r=r.evaluate(i),n=n.evaluate(i),o=o.evaluate(i);let s=a?a.evaluate(i):1,l=tZ(r,n,o,s);if(l)throw new tW(l);return new tB(r/255*s,n/255*s,o/255*s,s)}function eJ(i,r){let n=r[i];return void 0===n?null:n}function eY(i){return{type:i}}function eQ(i){return{result:"success",value:i}}function e0(i){return{result:"error",value:i}}function e1(i){return"data-driven"===i["property-type"]||"cross-faded-data-driven"===i["property-type"]}function e2(i){return!!i.expression&&i.expression.parameters.indexOf("zoom")>-1}function e3(i){return!!i.expression&&i.expression.interpolated}function e5(i){return i instanceof Number?"number":i instanceof String?"string":i instanceof Boolean?"boolean":Array.isArray(i)?"array":null===i?"null":typeof i}function e4(i){return"object"==typeof i&&null!==i&&!Array.isArray(i)}function e6(i){return i}function e8(i,r,n){return void 0!==i?i:void 0!==r?r:void 0!==n?n:void 0}function e9(i,r,n,o,a){return e8(typeof n===a?o[n]:void 0,i.default,r.default)}function e7(i,r,n){if("number"!==e5(n))return e8(i.default,r.default);let o=i.stops.length;if(1===o||n<=i.stops[0][0])return i.stops[0][1];if(n>=i.stops[o-1][0])return i.stops[o-1][1];let a=el(i.stops.map(i=>i[0]),n);return i.stops[a][1]}function it(i,r,n){let o=void 0!==i.base?i.base:1;if("number"!==e5(n))return e8(i.default,r.default);let a=i.stops.length;if(1===a||n<=i.stops[0][0])return i.stops[0][1];if(n>=i.stops[a-1][0])return i.stops[a-1][1];let s=el(i.stops.map(i=>i[0]),n),l=function(i,r,n,o){let a=o-n,s=i-n;return 0===a?0:1===r?s/a:(Math.pow(r,s)-1)/(Math.pow(r,a)-1)}(n,o,i.stops[s][0],i.stops[s+1][0]),u=i.stops[s][1],h=i.stops[s+1][1],c=ec[r.type]||e6;if(i.colorSpace&&"rgb"!==i.colorSpace){let r=eS[i.colorSpace];c=(i,n)=>r.reverse(r.interpolate(r.forward(i),r.forward(n),l))}return"function"==typeof u.evaluate?{evaluate(...i){let r=u.evaluate.apply(void 0,i),n=h.evaluate.apply(void 0,i);if(void 0!==r&&void 0!==n)return c(r,n,l)}}:c(u,h,l)}function ie(i,r,n){switch(r.type){case"color":n=tB.parse(n);break;case"formatted":n=tN.fromString(n.toString());break;case"resolvedImage":n=tj.fromString(n.toString());break;case"padding":n=tU.parse(n);break;default:e5(n)===r.type||"enum"===r.type&&r.values[n]||(n=void 0)}return e8(n,i.default,r.default)}t0.register(eX,{error:[{kind:"error"},[tf],(i,[r])=>{throw new tW(r.evaluate(i))}],typeof:[tf,[ty],(i,[r])=>tE(tq(r.evaluate(i)))],"to-rgba":[tT(tp,4),[tg],(i,[r])=>r.evaluate(i).toArray()],rgb:[tg,[tp,tp,tp],eK],rgba:[tg,[tp,tp,tp,tp],eK],has:{type:tm,overloads:[[[tf],(i,[r])=>r.evaluate(i) in i.properties()],[[tf,t_],(i,[r,n])=>r.evaluate(i) in n.evaluate(i)]]},get:{type:ty,overloads:[[[tf],(i,[r])=>eJ(r.evaluate(i),i.properties())],[[tf,t_],(i,[r,n])=>eJ(r.evaluate(i),n.evaluate(i))]]},"feature-state":[ty,[tf],(i,[r])=>eJ(r.evaluate(i),i.featureState||{})],properties:[t_,[],i=>i.properties()],"geometry-type":[tf,[],i=>i.geometryType()],id:[ty,[],i=>i.id()],zoom:[tp,[],i=>i.globals.zoom],"heatmap-density":[tp,[],i=>i.globals.heatmapDensity||0],"line-progress":[tp,[],i=>i.globals.lineProgress||0],accumulated:[ty,[],i=>void 0===i.globals.accumulated?null:i.globals.accumulated],"+":[tp,eY(tp),(i,r)=>{let n=0;for(let o of r)n+=o.evaluate(i);return n}],"*":[tp,eY(tp),(i,r)=>{let n=1;for(let o of r)n*=o.evaluate(i);return n}],"-":{type:tp,overloads:[[[tp,tp],(i,[r,n])=>r.evaluate(i)-n.evaluate(i)],[[tp],(i,[r])=>-r.evaluate(i)]]},"/":[tp,[tp,tp],(i,[r,n])=>r.evaluate(i)/n.evaluate(i)],"%":[tp,[tp,tp],(i,[r,n])=>r.evaluate(i)%n.evaluate(i)],ln2:[tp,[],()=>Math.LN2],pi:[tp,[],()=>Math.PI],e:[tp,[],()=>Math.E],"^":[tp,[tp,tp],(i,[r,n])=>Math.pow(r.evaluate(i),n.evaluate(i))],sqrt:[tp,[tp],(i,[r])=>Math.sqrt(r.evaluate(i))],log10:[tp,[tp],(i,[r])=>Math.log(r.evaluate(i))/Math.LN10],ln:[tp,[tp],(i,[r])=>Math.log(r.evaluate(i))],log2:[tp,[tp],(i,[r])=>Math.log(r.evaluate(i))/Math.LN2],sin:[tp,[tp],(i,[r])=>Math.sin(r.evaluate(i))],cos:[tp,[tp],(i,[r])=>Math.cos(r.evaluate(i))],tan:[tp,[tp],(i,[r])=>Math.tan(r.evaluate(i))],asin:[tp,[tp],(i,[r])=>Math.asin(r.evaluate(i))],acos:[tp,[tp],(i,[r])=>Math.acos(r.evaluate(i))],atan:[tp,[tp],(i,[r])=>Math.atan(r.evaluate(i))],min:[tp,eY(tp),(i,r)=>Math.min(...r.map(r=>r.evaluate(i)))],max:[tp,eY(tp),(i,r)=>Math.max(...r.map(r=>r.evaluate(i)))],abs:[tp,[tp],(i,[r])=>Math.abs(r.evaluate(i))],round:[tp,[tp],(i,[r])=>{let n=r.evaluate(i);return n<0?-Math.round(-n):Math.round(n)}],floor:[tp,[tp],(i,[r])=>Math.floor(r.evaluate(i))],ceil:[tp,[tp],(i,[r])=>Math.ceil(r.evaluate(i))],"filter-==":[tm,[tf,ty],(i,[r,n])=>i.properties()[r.value]===n.value],"filter-id-==":[tm,[ty],(i,[r])=>i.id()===r.value],"filter-type-==":[tm,[tf],(i,[r])=>i.geometryType()===r.value],"filter-<":[tm,[tf,ty],(i,[r,n])=>{let o=i.properties()[r.value],a=n.value;return typeof o==typeof a&&o<a}],"filter-id-<":[tm,[ty],(i,[r])=>{let n=i.id(),o=r.value;return typeof n==typeof o&&n<o}],"filter->":[tm,[tf,ty],(i,[r,n])=>{let o=i.properties()[r.value],a=n.value;return typeof o==typeof a&&o>a}],"filter-id->":[tm,[ty],(i,[r])=>{let n=i.id(),o=r.value;return typeof n==typeof o&&n>o}],"filter-<=":[tm,[tf,ty],(i,[r,n])=>{let o=i.properties()[r.value],a=n.value;return typeof o==typeof a&&o<=a}],"filter-id-<=":[tm,[ty],(i,[r])=>{let n=i.id(),o=r.value;return typeof n==typeof o&&n<=o}],"filter->=":[tm,[tf,ty],(i,[r,n])=>{let o=i.properties()[r.value],a=n.value;return typeof o==typeof a&&o>=a}],"filter-id->=":[tm,[ty],(i,[r])=>{let n=i.id(),o=r.value;return typeof n==typeof o&&n>=o}],"filter-has":[tm,[ty],(i,[r])=>r.value in i.properties()],"filter-has-id":[tm,[],i=>null!==i.id()&&void 0!==i.id()],"filter-type-in":[tm,[tT(tf)],(i,[r])=>r.value.indexOf(i.geometryType())>=0],"filter-id-in":[tm,[tT(ty)],(i,[r])=>r.value.indexOf(i.id())>=0],"filter-in-small":[tm,[tf,tT(ty)],(i,[r,n])=>n.value.indexOf(i.properties()[r.value])>=0],"filter-in-large":[tm,[tf,tT(ty)],(i,[r,n])=>(function(i,r,n,o){for(;n<=o;){let a=n+o>>1;if(r[a]===i)return!0;r[a]>i?o=a-1:n=a+1}return!1})(i.properties()[r.value],n.value,0,n.value.length-1)],all:{type:tm,overloads:[[[tm,tm],(i,[r,n])=>r.evaluate(i)&&n.evaluate(i)],[eY(tm),(i,r)=>{for(let n of r)if(!n.evaluate(i))return!1;return!0}]]},any:{type:tm,overloads:[[[tm,tm],(i,[r,n])=>r.evaluate(i)||n.evaluate(i)],[eY(tm),(i,r)=>{for(let n of r)if(n.evaluate(i))return!0;return!1}]]},"!":[tm,[tm],(i,[r])=>!r.evaluate(i)],"is-supported-script":[tm,[tf],(i,[r])=>{let n=i.globals&&i.globals.isSupportedScript;return!n||n(r.evaluate(i))}],upcase:[tf,[tf],(i,[r])=>r.evaluate(i).toUpperCase()],downcase:[tf,[tf],(i,[r])=>r.evaluate(i).toLowerCase()],concat:[tf,eY(ty),(i,r)=>r.map(r=>tG(r.evaluate(i))).join("")],"resolved-locale":[tf,[tv],(i,[r])=>r.evaluate(i).resolvedLocale()]});class ii{constructor(i,r){this.expression=i,this._warningHistory={},this._evaluator=new tQ,this._defaultValue=r?"color"===r.type&&e4(r.default)?new tB(0,0,0,0):"color"===r.type?tB.parse(r.default)||null:"padding"===r.type?tU.parse(r.default)||null:void 0===r.default?null:r.default:null,this._enumValues=r&&"enum"===r.type?r.values:null}evaluateWithoutErrorHandling(i,r,n,o,a,s){return this._evaluator.globals=i,this._evaluator.feature=r,this._evaluator.featureState=n,this._evaluator.canonical=o,this._evaluator.availableImages=a||null,this._evaluator.formattedSection=s,this.expression.evaluate(this._evaluator)}evaluate(i,r,n,o,a,s){this._evaluator.globals=i,this._evaluator.feature=r||null,this._evaluator.featureState=n||null,this._evaluator.canonical=o,this._evaluator.availableImages=a||null,this._evaluator.formattedSection=s||null;try{let i=this.expression.evaluate(this._evaluator);if(null==i||"number"==typeof i&&i!=i)return this._defaultValue;if(this._enumValues&&!(i in this._enumValues))throw new tW(`Expected value to be one of ${Object.keys(this._enumValues).map(i=>JSON.stringify(i)).join(", ")}, but found ${JSON.stringify(i)} instead.`);return i}catch(i){return this._warningHistory[i.message]||(this._warningHistory[i.message]=!0,"undefined"!=typeof console&&console.warn(i.message)),this._defaultValue}}}function ir(i){return Array.isArray(i)&&i.length>0&&"string"==typeof i[0]&&i[0]in eX}function io(i,r){let n=new es(eX,[],r?function(i){let r={color:tg,string:tf,number:tp,enum:tf,boolean:tm,formatted:tx,padding:tb,resolvedImage:tw};return"array"===i.type?tT(r[i.value]||ty,i.length):r[i.type]}(r):void 0),o=n.parse(i,void 0,void 0,void 0,r&&"string"===r.type?{typeAnnotation:"coerce"}:void 0);return o?eQ(new ii(o,r)):e0(n.errors)}class ia{constructor(i,r){this.kind=i,this._styleExpression=r,this.isStateDependent="constant"!==i&&!en(r.expression)}evaluateWithoutErrorHandling(i,r,n,o,a,s){return this._styleExpression.evaluateWithoutErrorHandling(i,r,n,o,a,s)}evaluate(i,r,n,o,a,s){return this._styleExpression.evaluate(i,r,n,o,a,s)}}class is{constructor(i,r,n,o){this.kind=i,this.zoomStops=n,this._styleExpression=r,this.isStateDependent="camera"!==i&&!en(r.expression),this.interpolationType=o}evaluateWithoutErrorHandling(i,r,n,o,a,s){return this._styleExpression.evaluateWithoutErrorHandling(i,r,n,o,a,s)}evaluate(i,r,n,o,a,s){return this._styleExpression.evaluate(i,r,n,o,a,s)}interpolationFactor(i,r,n){return this.interpolationType?eC.interpolationFactor(this.interpolationType,i,r,n):0}}function il(i,r){let n=io(i,r);if("error"===n.result)return n;let o=n.value.expression,a=er(o);if(!a&&!e1(r))return e0([new th("","data expressions not supported")]);let s=eo(o,["zoom"]);if(!s&&!e2(r))return e0([new th("","zoom expressions not supported")]);let l=function i(r){let n=null;if(r instanceof eP)n=i(r.result);else if(r instanceof eA){for(let o of r.args)if(n=i(o))break}else(r instanceof eu||r instanceof eC)&&r.input instanceof t0&&"zoom"===r.input.name&&(n=r);return n instanceof th||r.eachChild(r=>{let o=i(r);o instanceof th?n=o:!n&&o?n=new th("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):n&&o&&n!==o&&(n=new th("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),n}(o);return l||s?l instanceof th?e0([l]):l instanceof eC&&!e3(r)?e0([new th("",'"interpolate" expressions cannot be used with this property')]):eQ(l?new is(a?"camera":"composite",n.value,l.labels,l instanceof eC?l.interpolation:void 0):new ia(a?"constant":"source",n.value)):e0([new th("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class iu{constructor(i,r){this._parameters=i,this._specification=r,ts(this,function i(r,n){let o,a,s;let l="color"===n.type,u=r.stops&&"object"==typeof r.stops[0][0],h=u||!(u||void 0!==r.property),c=r.type||(e3(n)?"exponential":"interval");if(l||"padding"===n.type){let i=l?tB.parse:tU.parse;(r=ts({},r)).stops&&(r.stops=r.stops.map(r=>[r[0],i(r[1])])),r.default=i(r.default?r.default:n.default)}if(r.colorSpace&&"rgb"!==r.colorSpace&&!eS[r.colorSpace])throw Error(`Unknown color space: ${r.colorSpace}`);if("exponential"===c)o=it;else if("interval"===c)o=e7;else if("categorical"===c){for(let i of(o=e9,a=Object.create(null),r.stops))a[i[0]]=i[1];s=typeof r.stops[0][0]}else{if("identity"!==c)throw Error(`Unknown function type "${c}"`);o=ie}if(u){let o={},a=[];for(let i=0;i<r.stops.length;i++){let n=r.stops[i],s=n[0].zoom;void 0===o[s]&&(o[s]={zoom:s,type:r.type,property:r.property,default:r.default,stops:[]},a.push(s)),o[s].stops.push([n[0].value,n[1]])}let s=[];for(let r of a)s.push([o[r].zoom,i(o[r],n)]);let l={name:"linear"};return{kind:"composite",interpolationType:l,interpolationFactor:eC.interpolationFactor.bind(void 0,l),zoomStops:s.map(i=>i[0]),evaluate:({zoom:i},o)=>it({stops:s,base:r.base},n,i).evaluate(i,o)}}if(h){let i="exponential"===c?{name:"exponential",base:void 0!==r.base?r.base:1}:null;return{kind:"camera",interpolationType:i,interpolationFactor:eC.interpolationFactor.bind(void 0,i),zoomStops:r.stops.map(i=>i[0]),evaluate:({zoom:i})=>o(r,n,i,a,s)}}return{kind:"source",evaluate(i,l){let u=l&&l.properties?l.properties[r.property]:void 0;return void 0===u?e8(r.default,n.default):o(r,n,u,a,s)}}}(this._parameters,this._specification))}static deserialize(i){return new iu(i._parameters,i._specification)}static serialize(i){return{_parameters:i._parameters,_specification:i._specification}}}function ih(i){let r=i.key,n=i.value,o=i.valueSpec||{},a=i.objectElementValidators||{},s=i.style,l=i.styleSpec,u=[],h=e5(n);if("object"!==h)return[new to(r,n,`object expected, ${h} found`)];for(let i in n){let h;let c=i.split(".")[0],d=o[c]||o["*"];if(a[c])h=a[c];else if(o[c])h=iB;else if(a["*"])h=a["*"];else{if(!o["*"]){u.push(new to(r,n[i],`unknown property "${i}"`));continue}h=iB}u=u.concat(h({key:(r?`${r}.`:r)+i,value:n[i],valueSpec:d,style:s,styleSpec:l,object:n,objectKey:i},n))}for(let i in o)a[i]||o[i].required&&void 0===o[i].default&&void 0===n[i]&&u.push(new to(r,n,`missing required property "${i}"`));return u}function ic(i){let r=i.value,n=i.valueSpec,o=i.style,a=i.styleSpec,s=i.key,l=i.arrayElementValidator||iB;if("array"!==e5(r))return[new to(s,r,`array expected, ${e5(r)} found`)];if(n.length&&r.length!==n.length)return[new to(s,r,`array length ${n.length} expected, length ${r.length} found`)];if(n["min-length"]&&r.length<n["min-length"])return[new to(s,r,`array length at least ${n["min-length"]} expected, length ${r.length} found`)];let u={type:n.value,values:n.values};a.$version<7&&(u.function=n.function),"object"===e5(n.value)&&(u=n.value);let h=[];for(let i=0;i<r.length;i++)h=h.concat(l({array:r,arrayIndex:i,value:r[i],valueSpec:u,style:o,styleSpec:a,key:`${s}[${i}]`}));return h}function id(i){let r=i.key,n=i.value,o=i.valueSpec,a=e5(n);return"number"===a&&n!=n&&(a="NaN"),"number"!==a?[new to(r,n,`number expected, ${a} found`)]:"minimum"in o&&n<o.minimum?[new to(r,n,`${n} is less than the minimum value ${o.minimum}`)]:"maximum"in o&&n>o.maximum?[new to(r,n,`${n} is greater than the maximum value ${o.maximum}`)]:[]}function ip(i){let r=i.valueSpec,n=tl(i.value.type),o,a,s,l={},u="categorical"!==n&&void 0===i.value.property,h="array"===e5(i.value.stops)&&"array"===e5(i.value.stops[0])&&"object"===e5(i.value.stops[0][0]),c=ih({key:i.key,value:i.value,valueSpec:i.styleSpec.function,style:i.style,styleSpec:i.styleSpec,objectElementValidators:{stops:function(i){if("identity"===n)return[new to(i.key,i.value,'identity function may not have a "stops" property')];let r=[],o=i.value;return r=r.concat(ic({key:i.key,value:o,valueSpec:i.valueSpec,style:i.style,styleSpec:i.styleSpec,arrayElementValidator:d})),"array"===e5(o)&&0===o.length&&r.push(new to(i.key,o,"array must have at least one stop")),r},default:function(i){return iB({key:i.key,value:i.value,valueSpec:r,style:i.style,styleSpec:i.styleSpec})}}});return"identity"===n&&u&&c.push(new to(i.key,i.value,'missing required property "property"')),"identity"===n||i.value.stops||c.push(new to(i.key,i.value,'missing required property "stops"')),"exponential"===n&&i.valueSpec.expression&&!e3(i.valueSpec)&&c.push(new to(i.key,i.value,"exponential functions not supported")),i.styleSpec.$version>=8&&(u||e1(i.valueSpec)?u&&!e2(i.valueSpec)&&c.push(new to(i.key,i.value,"zoom functions not supported")):c.push(new to(i.key,i.value,"property functions not supported"))),("categorical"===n||h)&&void 0===i.value.property&&c.push(new to(i.key,i.value,'"property" property is required')),c;function d(i){let n=[],o=i.value,u=i.key;if("array"!==e5(o))return[new to(u,o,`array expected, ${e5(o)} found`)];if(2!==o.length)return[new to(u,o,`array length 2 expected, length ${o.length} found`)];if(h){if("object"!==e5(o[0]))return[new to(u,o,`object expected, ${e5(o[0])} found`)];if(void 0===o[0].zoom)return[new to(u,o,"object stop key must have zoom")];if(void 0===o[0].value)return[new to(u,o,"object stop key must have value")];if(s&&s>tl(o[0].zoom))return[new to(u,o[0].zoom,"stop zoom values must appear in ascending order")];tl(o[0].zoom)!==s&&(s=tl(o[0].zoom),a=void 0,l={}),n=n.concat(ih({key:`${u}[0]`,value:o[0],valueSpec:{zoom:{}},style:i.style,styleSpec:i.styleSpec,objectElementValidators:{zoom:id,value:p}}))}else n=n.concat(p({key:`${u}[0]`,value:o[0],valueSpec:{},style:i.style,styleSpec:i.styleSpec},o));return ir(tu(o[1]))?n.concat([new to(`${u}[1]`,o[1],"expressions are not allowed in function stops.")]):n.concat(iB({key:`${u}[1]`,value:o[1],valueSpec:r,style:i.style,styleSpec:i.styleSpec}))}function p(i,s){let u=e5(i.value),h=tl(i.value),c=null!==i.value?i.value:s;if(o){if(u!==o)return[new to(i.key,c,`${u} stop domain type must match previous stop domain type ${o}`)]}else o=u;if("number"!==u&&"string"!==u&&"boolean"!==u)return[new to(i.key,c,"stop domain value must be a number, string, or boolean")];if("number"!==u&&"categorical"!==n){let o=`number expected, ${u} found`;return e1(r)&&void 0===n&&(o+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new to(i.key,c,o)]}return"categorical"!==n||"number"!==u||isFinite(h)&&Math.floor(h)===h?"categorical"!==n&&"number"===u&&void 0!==a&&h<a?[new to(i.key,c,"stop domain values must appear in ascending order")]:(a=h,"categorical"===n&&h in l?[new to(i.key,c,"stop domain values must be unique")]:(l[h]=!0,[])):[new to(i.key,c,`integer expected, found ${h}`)]}}function im(i){let r=("property"===i.expressionContext?il:io)(tu(i.value),i.valueSpec);if("error"===r.result)return r.value.map(r=>new to(`${i.key}${r.key}`,i.value,r.message));let n=r.value.expression||r.value._styleExpression.expression;if("property"===i.expressionContext&&"text-font"===i.propertyKey&&!n.outputDefined())return[new to(i.key,i.value,`Invalid data expression for "${i.propertyKey}". Output values must be contained as literals within the expression.`)];if("property"===i.expressionContext&&"layout"===i.propertyType&&!en(n))return[new to(i.key,i.value,'"feature-state" data expressions are not supported with layout properties.')];if("filter"===i.expressionContext&&!en(n))return[new to(i.key,i.value,'"feature-state" data expressions are not supported with filters.')];if(i.expressionContext&&0===i.expressionContext.indexOf("cluster")){if(!eo(n,["zoom","feature-state"]))return[new to(i.key,i.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if("cluster-initial"===i.expressionContext&&!er(n))return[new to(i.key,i.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function ig(i){let r=i.key,n=i.value,o=i.valueSpec,a=[];return Array.isArray(o.values)?-1===o.values.indexOf(tl(n))&&a.push(new to(r,n,`expected one of [${o.values.join(", ")}], ${JSON.stringify(n)} found`)):-1===Object.keys(o.values).indexOf(tl(n))&&a.push(new to(r,n,`expected one of [${Object.keys(o.values).join(", ")}], ${JSON.stringify(n)} found`)),a}function i_(i){if(!0===i||!1===i)return!0;if(!Array.isArray(i)||0===i.length)return!1;switch(i[0]){case"has":return i.length>=2&&"$id"!==i[1]&&"$type"!==i[1];case"in":return i.length>=3&&("string"!=typeof i[1]||Array.isArray(i[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return 3!==i.length||Array.isArray(i[1])||Array.isArray(i[2]);case"any":case"all":for(let r of i.slice(1))if(!i_(r)&&"boolean"!=typeof r)return!1;return!0;default:return!0}}let iy={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function iv(i){if(null==i)return{filter:()=>!0,needGeometry:!1};i_(i)||(i=function i(r){if(!r)return!0;let n=r[0];return r.length<=1?"any"!==n:"=="===n?ib(r[1],r[2],"=="):"!="===n?iE(ib(r[1],r[2],"==")):"<"===n||">"===n||"<="===n||">="===n?ib(r[1],r[2],n):"any"===n?["any"].concat(r.slice(1).map(i)):"all"===n?["all"].concat(r.slice(1).map(i)):"none"===n?["all"].concat(r.slice(1).map(i).map(iE)):"in"===n?iw(r[1],r.slice(2)):"!in"===n?iE(iw(r[1],r.slice(2))):"has"===n?iT(r[1]):"!has"===n?iE(iT(r[1])):"within"!==n||r}(i));let r=io(i,iy);if("error"===r.result)throw Error(r.value.map(i=>`${i.key}: ${i.message}`).join(", "));return{filter:(i,n,o)=>r.value.evaluate(i,n,{},o),needGeometry:function i(r){if(!Array.isArray(r))return!1;if("within"===r[0])return!0;for(let n=1;n<r.length;n++)if(i(r[n]))return!0;return!1}(i)}}function ix(i,r){return i<r?-1:i>r?1:0}function ib(i,r,n){switch(i){case"$type":return[`filter-type-${n}`,r];case"$id":return[`filter-id-${n}`,r];default:return[`filter-${n}`,i,r]}}function iw(i,r){if(0===r.length)return!1;switch(i){case"$type":return["filter-type-in",["literal",r]];case"$id":return["filter-id-in",["literal",r]];default:return r.length>200&&!r.some(i=>typeof i!=typeof r[0])?["filter-in-large",i,["literal",r.sort(ix)]]:["filter-in-small",i,["literal",r]]}}function iT(i){switch(i){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",i]}}function iE(i){return["!",i]}function iS(i){return i_(tu(i.value))?im(ts({},i,{expressionContext:"filter",valueSpec:{value:"boolean"}})):function i(r){let n=r.value,o=r.key;if("array"!==e5(n))return[new to(o,n,`array expected, ${e5(n)} found`)];let a=r.styleSpec,s,l=[];if(n.length<1)return[new to(o,n,"filter array must have at least 1 element")];switch(l=l.concat(ig({key:`${o}[0]`,value:n[0],valueSpec:a.filter_operator,style:r.style,styleSpec:r.styleSpec})),tl(n[0])){case"<":case"<=":case">":case">=":n.length>=2&&"$type"===tl(n[1])&&l.push(new to(o,n,`"$type" cannot be use with operator "${n[0]}"`));case"==":case"!=":3!==n.length&&l.push(new to(o,n,`filter array for operator "${n[0]}" must have 3 elements`));case"in":case"!in":n.length>=2&&"string"!==(s=e5(n[1]))&&l.push(new to(`${o}[1]`,n[1],`string expected, ${s} found`));for(let i=2;i<n.length;i++)s=e5(n[i]),"$type"===tl(n[1])?l=l.concat(ig({key:`${o}[${i}]`,value:n[i],valueSpec:a.geometry_type,style:r.style,styleSpec:r.styleSpec})):"string"!==s&&"number"!==s&&"boolean"!==s&&l.push(new to(`${o}[${i}]`,n[i],`string, number, or boolean expected, ${s} found`));break;case"any":case"all":case"none":for(let a=1;a<n.length;a++)l=l.concat(i({key:`${o}[${a}]`,value:n[a],style:r.style,styleSpec:r.styleSpec}));break;case"has":case"!has":s=e5(n[1]),2!==n.length?l.push(new to(o,n,`filter array for "${n[0]}" operator must have 2 elements`)):"string"!==s&&l.push(new to(`${o}[1]`,n[1],`string expected, ${s} found`));break;case"within":s=e5(n[1]),2!==n.length?l.push(new to(o,n,`filter array for "${n[0]}" operator must have 2 elements`)):"object"!==s&&l.push(new to(`${o}[1]`,n[1],`object expected, ${s} found`))}return l}(i)}function iC(i,r){let n;let o=i.key,a=i.style,s=i.styleSpec,l=i.value,u=i.objectKey,h=s[`${r}_${i.layerType}`];if(!h)return[];let c=u.match(/^(.*)-transition$/);if("paint"===r&&c&&h[c[1]]&&h[c[1]].transition)return iB({key:o,value:l,valueSpec:s.transition,style:a,styleSpec:s});let d=i.valueSpec||h[u];if(!d)return[new to(o,l,`unknown property "${u}"`)];if("string"===e5(l)&&e1(d)&&!d.tokens&&(n=/^{([^}]+)}$/.exec(l)))return[new to(o,l,`"${u}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(n[1])} }\`.`)];let p=[];return"symbol"===i.layerType&&("text-field"===u&&a&&!a.glyphs&&p.push(new to(o,l,'use of "text-field" requires a style "glyphs" property')),"text-font"===u&&e4(tu(l))&&"identity"===tl(l.type)&&p.push(new to(o,l,'"text-font" does not support identity functions'))),p.concat(iB({key:i.key,value:l,valueSpec:d,style:a,styleSpec:s,expressionContext:"property",propertyType:r,propertyKey:u}))}function iI(i){return iC(i,"paint")}function iA(i){return iC(i,"layout")}function iP(i){let r=[],n=i.value,o=i.key,a=i.style,s=i.styleSpec;n.type||n.ref||r.push(new to(o,n,'either "type" or "ref" is required'));let l=tl(n.type),u=tl(n.ref);if(n.id){let s=tl(n.id);for(let l=0;l<i.arrayIndex;l++){let i=a.layers[l];tl(i.id)===s&&r.push(new to(o,n.id,`duplicate layer id "${n.id}", previously used at line ${i.id.__line__}`))}}if("ref"in n){let i;["type","source","source-layer","filter","layout"].forEach(i=>{i in n&&r.push(new to(o,n[i],`"${i}" is prohibited for ref layers`))}),a.layers.forEach(r=>{tl(r.id)===u&&(i=r)}),i?i.ref?r.push(new to(o,n.ref,"ref cannot reference another ref layer")):l=tl(i.type):r.push(new to(o,n.ref,`ref layer "${u}" not found`))}else if("background"!==l){if(n.source){let i=a.sources&&a.sources[n.source],s=i&&tl(i.type);i?"vector"===s&&"raster"===l?r.push(new to(o,n.source,`layer "${n.id}" requires a raster source`)):"raster"===s&&"raster"!==l?r.push(new to(o,n.source,`layer "${n.id}" requires a vector source`)):"vector"!==s||n["source-layer"]?"raster-dem"===s&&"hillshade"!==l?r.push(new to(o,n.source,"raster-dem source can only be used with layer type 'hillshade'.")):"line"===l&&n.paint&&n.paint["line-gradient"]&&("geojson"!==s||!i.lineMetrics)&&r.push(new to(o,n,`layer "${n.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):r.push(new to(o,n,`layer "${n.id}" must specify a "source-layer"`)):r.push(new to(o,n.source,`source "${n.source}" not found`))}else r.push(new to(o,n,'missing required property "source"'))}return r=r.concat(ih({key:o,value:n,valueSpec:s.layer,style:i.style,styleSpec:i.styleSpec,objectElementValidators:{"*":()=>[],type:()=>iB({key:`${o}.type`,value:n.type,valueSpec:s.layer.type,style:i.style,styleSpec:i.styleSpec,object:n,objectKey:"type"}),filter:iS,layout:i=>ih({layer:n,key:i.key,value:i.value,style:i.style,styleSpec:i.styleSpec,objectElementValidators:{"*":i=>iA(ts({layerType:l},i))}}),paint:i=>ih({layer:n,key:i.key,value:i.value,style:i.style,styleSpec:i.styleSpec,objectElementValidators:{"*":i=>iI(ts({layerType:l},i))}})}}))}function ik(i){let r=i.value,n=i.key,o=e5(r);return"string"!==o?[new to(n,r,`string expected, ${o} found`)]:[]}let iL={promoteId:function({key:i,value:r}){if("string"===e5(r))return ik({key:i,value:r});{let n=[];for(let o in r)n.push(...ik({key:`${i}.${o}`,value:r[o]}));return n}}};function iM(i){let r;let n=i.value,o=i.key,a=i.styleSpec,s=i.style;if(!n.type)return[new to(o,n,'"type" is required')];let l=tl(n.type);switch(l){case"vector":case"raster":case"raster-dem":return ih({key:o,value:n,valueSpec:a[`source_${l.replace("-","_")}`],style:i.style,styleSpec:a,objectElementValidators:iL});case"geojson":if(r=ih({key:o,value:n,valueSpec:a.source_geojson,style:s,styleSpec:a,objectElementValidators:iL}),n.cluster)for(let i in n.clusterProperties){let[a,s]=n.clusterProperties[i],l="string"==typeof a?[a,["accumulated"],["get",i]]:a;r.push(...im({key:`${o}.${i}.map`,value:s,expressionContext:"cluster-map"})),r.push(...im({key:`${o}.${i}.reduce`,value:l,expressionContext:"cluster-reduce"}))}return r;case"video":return ih({key:o,value:n,valueSpec:a.source_video,style:s,styleSpec:a});case"image":return ih({key:o,value:n,valueSpec:a.source_image,style:s,styleSpec:a});case"canvas":return[new to(o,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return ig({key:`${o}.type`,value:n.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:s,styleSpec:a})}}function iz(i){let r=i.value,n=i.styleSpec,o=n.light,a=i.style,s=[],l=e5(r);if(void 0===r)return s;if("object"!==l)return s.concat([new to("light",r,`object expected, ${l} found`)]);for(let i in r){let l=i.match(/^(.*)-transition$/);s=s.concat(l&&o[l[1]]&&o[l[1]].transition?iB({key:i,value:r[i],valueSpec:n.transition,style:a,styleSpec:n}):o[i]?iB({key:i,value:r[i],valueSpec:o[i],style:a,styleSpec:n}):[new to(i,r[i],`unknown property "${i}"`)])}return s}function iD(i){let r=i.value,n=i.styleSpec,o=n.terrain,a=i.style,s=[],l=e5(r);if(void 0===r)return s;if("object"!==l)return s.concat([new to("terrain",r,`object expected, ${l} found`)]);for(let i in r)s=s.concat(o[i]?iB({key:i,value:r[i],valueSpec:o[i],style:a,styleSpec:n}):[new to(i,r[i],`unknown property "${i}"`)]);return s}let iR={"*":()=>[],array:ic,boolean:function(i){let r=i.value,n=i.key,o=e5(r);return"boolean"!==o?[new to(n,r,`boolean expected, ${o} found`)]:[]},number:id,color:function(i){let r=i.key,n=i.value,o=e5(n);return"string"!==o?[new to(r,n,`color expected, ${o} found`)]:null===tk(n)?[new to(r,n,`color expected, "${n}" found`)]:[]},constants:ta,enum:ig,filter:iS,function:ip,layer:iP,object:ih,source:iM,light:iz,terrain:iD,string:ik,formatted:function(i){return 0===ik(i).length?[]:im(i)},resolvedImage:function(i){return 0===ik(i).length?[]:im(i)},padding:function(i){let r=i.key,n=i.value;if("array"===e5(n)){if(n.length<1||n.length>4)return[new to(r,n,`padding requires 1 to 4 values; ${n.length} values found`)];let i={type:"number"},o=[];for(let a=0;a<n.length;a++)o=o.concat(iB({key:`${r}[${a}]`,value:n[a],valueSpec:i}));return o}return id({key:r,value:n,valueSpec:{}})}};function iB(i){let r=i.value,n=i.valueSpec,o=i.styleSpec;return n.expression&&e4(tl(r))?ip(i):n.expression&&ir(tu(r))?im(i):n.type&&iR[n.type]?iR[n.type](i):ih(ts({},i,{valueSpec:n.type?o[n.type]:n}))}function iO(i){let r=i.value,n=i.key,o=ik(i);return o.length||(-1===r.indexOf("{fontstack}")&&o.push(new to(n,r,'"glyphs" url must include a "{fontstack}" token')),-1===r.indexOf("{range}")&&o.push(new to(n,r,'"glyphs" url must include a "{range}" token'))),o}function iF(i,r=tn){let n=[];return n=n.concat(iB({key:"",value:i,valueSpec:r.$root,styleSpec:r,style:i,objectElementValidators:{glyphs:iO,"*":()=>[]}})),i.constants&&(n=n.concat(ta({key:"constants",value:i.constants,style:i,styleSpec:r}))),iN(n)}function iN(i){return[].concat(i).sort((i,r)=>i.line-r.line)}function iU(i){return function(...r){return iN(i.apply(this,r))}}iF.source=iU(iM),iF.light=iU(iz),iF.terrain=iU(iD),iF.layer=iU(iP),iF.filter=iU(iS),iF.paintProperty=iU(iI),iF.layoutProperty=iU(iA);let ij=iF.light,iZ=iF.paintProperty,iV=iF.layoutProperty;function iq(i,r){let n=!1;if(r&&r.length)for(let o of r)i.fire(new ti(Error(o.message))),n=!0;return n}class iG{constructor(i,r,n){let o=this.cells=[];if(i instanceof ArrayBuffer){this.arrayBuffer=i;let a=new Int32Array(this.arrayBuffer);i=a[0],this.d=(r=a[1])+2*(n=a[2]);for(let i=0;i<this.d*this.d;i++){let r=a[3+i],n=a[3+i+1];o.push(r===n?null:a.subarray(r,n))}let s=a[3+o.length+1];this.keys=a.subarray(a[3+o.length],s),this.bboxes=a.subarray(s),this.insert=this._insertReadonly}else{this.d=r+2*n;for(let i=0;i<this.d*this.d;i++)o.push([]);this.keys=[],this.bboxes=[]}this.n=r,this.extent=i,this.padding=n,this.scale=r/i,this.uid=0;let a=n/r*i;this.min=-a,this.max=i+a}insert(i,r,n,o,a){this._forEachCell(r,n,o,a,this._insertCell,this.uid++,void 0,void 0),this.keys.push(i),this.bboxes.push(r),this.bboxes.push(n),this.bboxes.push(o),this.bboxes.push(a)}_insertReadonly(){throw Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(i,r,n,o,a,s){this.cells[a].push(s)}query(i,r,n,o,a){let s=this.min,l=this.max;if(i<=s&&r<=s&&l<=n&&l<=o&&!a)return Array.prototype.slice.call(this.keys);{let s=[];return this._forEachCell(i,r,n,o,this._queryCell,s,{},a),s}}_queryCell(i,r,n,o,a,s,l,u){let h=this.cells[a];if(null!==h){let a=this.keys,c=this.bboxes;for(let d=0;d<h.length;d++){let p=h[d];if(void 0===l[p]){let h=4*p;(u?u(c[h+0],c[h+1],c[h+2],c[h+3]):i<=c[h+2]&&r<=c[h+3]&&n>=c[h+0]&&o>=c[h+1])?(l[p]=!0,s.push(a[p])):l[p]=!1}}}}_forEachCell(i,r,n,o,a,s,l,u){let h=this._convertToCellCoord(i),c=this._convertToCellCoord(r),d=this._convertToCellCoord(n),p=this._convertToCellCoord(o);for(let f=h;f<=d;f++)for(let h=c;h<=p;h++){let c=this.d*h+f;if((!u||u(this._convertFromCellCoord(f),this._convertFromCellCoord(h),this._convertFromCellCoord(f+1),this._convertFromCellCoord(h+1)))&&a.call(this,i,r,n,o,c,s,l,u))return}}_convertFromCellCoord(i){return(i-this.padding)/this.scale}_convertToCellCoord(i){return Math.max(0,Math.min(this.d-1,Math.floor(i*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;let i=this.cells,r=3+this.cells.length+1+1,n=0;for(let i=0;i<this.cells.length;i++)n+=this.cells[i].length;let o=new Int32Array(r+n+this.keys.length+this.bboxes.length);o[0]=this.extent,o[1]=this.n,o[2]=this.padding;let a=r;for(let r=0;r<i.length;r++){let n=i[r];o[3+r]=a,o.set(n,a),a+=n.length}return o[3+i.length]=a,o.set(this.keys,a),a+=this.keys.length,o[3+i.length+1]=a,o.set(this.bboxes,a),a+=this.bboxes.length,o.buffer}static serialize(i,r){let n=i.toArrayBuffer();return r&&r.push(n),{buffer:n}}static deserialize(i){return new iG(i.buffer)}}let i$={};function iW(i,r,n={}){if(i$[i])throw Error(`${i} is already registered.`);Object.defineProperty(r,"_classRegistryKey",{value:i,writeable:!1}),i$[i]={klass:r,omit:n.omit||[],shallow:n.shallow||[]}}for(let i in iW("Object",Object),iW("TransferableGridIndex",iG),iW("Color",tB),iW("Error",Error),iW("AJAXError",G),iW("ResolvedImage",tj),iW("StylePropertyFunction",iu),iW("StyleExpression",ii,{omit:["_evaluator"]}),iW("ZoomDependentExpression",is),iW("ZoomConstantExpression",ia),iW("CompoundExpression",t0,{omit:["_evaluate"]}),eX)eX[i]._classRegistryKey||iW(`Expression_${i}`,eX[i]);function iH(i){return i&&"undefined"!=typeof ArrayBuffer&&(i instanceof ArrayBuffer||i.constructor&&"ArrayBuffer"===i.constructor.name)}function iX(i,r){if(null==i||"boolean"==typeof i||"number"==typeof i||"string"==typeof i||i instanceof Boolean||i instanceof Number||i instanceof String||i instanceof Date||i instanceof RegExp||i instanceof Blob)return i;if(iH(i)||S(i))return r&&r.push(i),i;if(ArrayBuffer.isView(i))return r&&r.push(i.buffer),i;if(i instanceof ImageData)return r&&r.push(i.data.buffer),i;if(Array.isArray(i)){let n=[];for(let o of i)n.push(iX(o,r));return n}if("object"==typeof i){let n=i.constructor,o=n._classRegistryKey;if(!o)throw Error("can't serialize object of unregistered class");if(!i$[o])throw Error(`${o} is not registered.`);let a=n.serialize?n.serialize(i,r):{};if(n.serialize){if(r&&a===r[r.length-1])throw Error("statically serialized object won't survive transfer of $name property")}else{for(let n in i){if(!i.hasOwnProperty(n)||i$[o].omit.indexOf(n)>=0)continue;let s=i[n];a[n]=i$[o].shallow.indexOf(n)>=0?s:iX(s,r)}i instanceof Error&&(a.message=i.message)}if(a.$name)throw Error("$name property is reserved for worker serialization logic.");return"Object"!==o&&(a.$name=o),a}throw Error("can't serialize object of type "+typeof i)}function iK(i){if(null==i||"boolean"==typeof i||"number"==typeof i||"string"==typeof i||i instanceof Boolean||i instanceof Number||i instanceof String||i instanceof Date||i instanceof RegExp||i instanceof Blob||iH(i)||S(i)||ArrayBuffer.isView(i)||i instanceof ImageData)return i;if(Array.isArray(i))return i.map(iK);if("object"==typeof i){let r=i.$name||"Object";if(!i$[r])throw Error(`can't deserialize unregistered class ${r}`);let{klass:n}=i$[r];if(!n)throw Error(`can't deserialize unregistered class ${r}`);if(n.deserialize)return n.deserialize(i);let o=Object.create(n.prototype);for(let n of Object.keys(i)){if("$name"===n)continue;let a=i[n];o[n]=i$[r].shallow.indexOf(n)>=0?a:iK(a)}return o}throw Error("can't deserialize object of type "+typeof i)}class iJ{constructor(){this.first=!0}update(i,r){let n=Math.floor(i);return this.first?(this.first=!1,this.lastIntegerZoom=n,this.lastIntegerZoomTime=0,this.lastZoom=i,this.lastFloorZoom=n,!0):(this.lastFloorZoom>n?(this.lastIntegerZoom=n+1,this.lastIntegerZoomTime=r):this.lastFloorZoom<n&&(this.lastIntegerZoom=n,this.lastIntegerZoomTime=r),i!==this.lastZoom&&(this.lastZoom=i,this.lastFloorZoom=n,!0))}}let iY={"Latin-1 Supplement":i=>i>=128&&i<=255,Arabic:i=>i>=1536&&i<=1791,"Arabic Supplement":i=>i>=1872&&i<=1919,"Arabic Extended-A":i=>i>=2208&&i<=2303,"Hangul Jamo":i=>i>=4352&&i<=4607,"Unified Canadian Aboriginal Syllabics":i=>i>=5120&&i<=5759,Khmer:i=>i>=6016&&i<=6143,"Unified Canadian Aboriginal Syllabics Extended":i=>i>=6320&&i<=6399,"General Punctuation":i=>i>=8192&&i<=8303,"Letterlike Symbols":i=>i>=8448&&i<=8527,"Number Forms":i=>i>=8528&&i<=8591,"Miscellaneous Technical":i=>i>=8960&&i<=9215,"Control Pictures":i=>i>=9216&&i<=9279,"Optical Character Recognition":i=>i>=9280&&i<=9311,"Enclosed Alphanumerics":i=>i>=9312&&i<=9471,"Geometric Shapes":i=>i>=9632&&i<=9727,"Miscellaneous Symbols":i=>i>=9728&&i<=9983,"Miscellaneous Symbols and Arrows":i=>i>=11008&&i<=11263,"CJK Radicals Supplement":i=>i>=11904&&i<=12031,"Kangxi Radicals":i=>i>=12032&&i<=12255,"Ideographic Description Characters":i=>i>=12272&&i<=12287,"CJK Symbols and Punctuation":i=>i>=12288&&i<=12351,Hiragana:i=>i>=12352&&i<=12447,Katakana:i=>i>=12448&&i<=12543,Bopomofo:i=>i>=12544&&i<=12591,"Hangul Compatibility Jamo":i=>i>=12592&&i<=12687,Kanbun:i=>i>=12688&&i<=12703,"Bopomofo Extended":i=>i>=12704&&i<=12735,"CJK Strokes":i=>i>=12736&&i<=12783,"Katakana Phonetic Extensions":i=>i>=12784&&i<=12799,"Enclosed CJK Letters and Months":i=>i>=12800&&i<=13055,"CJK Compatibility":i=>i>=13056&&i<=13311,"CJK Unified Ideographs Extension A":i=>i>=13312&&i<=19903,"Yijing Hexagram Symbols":i=>i>=19904&&i<=19967,"CJK Unified Ideographs":i=>i>=19968&&i<=40959,"Yi Syllables":i=>i>=40960&&i<=42127,"Yi Radicals":i=>i>=42128&&i<=42191,"Hangul Jamo Extended-A":i=>i>=43360&&i<=43391,"Hangul Syllables":i=>i>=44032&&i<=55215,"Hangul Jamo Extended-B":i=>i>=55216&&i<=55295,"Private Use Area":i=>i>=57344&&i<=63743,"CJK Compatibility Ideographs":i=>i>=63744&&i<=64255,"Arabic Presentation Forms-A":i=>i>=64336&&i<=65023,"Vertical Forms":i=>i>=65040&&i<=65055,"CJK Compatibility Forms":i=>i>=65072&&i<=65103,"Small Form Variants":i=>i>=65104&&i<=65135,"Arabic Presentation Forms-B":i=>i>=65136&&i<=65279,"Halfwidth and Fullwidth Forms":i=>i>=65280&&i<=65519};function iQ(i){for(let r of i)if(i0(r.charCodeAt(0)))return!0;return!1}function i0(i){return!(746!==i&&747!==i&&(i<4352||!(iY["Bopomofo Extended"](i)||iY.Bopomofo(i)||iY["CJK Compatibility Forms"](i)&&!(i>=65097&&i<=65103)||iY["CJK Compatibility Ideographs"](i)||iY["CJK Compatibility"](i)||iY["CJK Radicals Supplement"](i)||iY["CJK Strokes"](i)||!(!iY["CJK Symbols and Punctuation"](i)||i>=12296&&i<=12305||i>=12308&&i<=12319||12336===i)||iY["CJK Unified Ideographs Extension A"](i)||iY["CJK Unified Ideographs"](i)||iY["Enclosed CJK Letters and Months"](i)||iY["Hangul Compatibility Jamo"](i)||iY["Hangul Jamo Extended-A"](i)||iY["Hangul Jamo Extended-B"](i)||iY["Hangul Jamo"](i)||iY["Hangul Syllables"](i)||iY.Hiragana(i)||iY["Ideographic Description Characters"](i)||iY.Kanbun(i)||iY["Kangxi Radicals"](i)||iY["Katakana Phonetic Extensions"](i)||iY.Katakana(i)&&12540!==i||!(!iY["Halfwidth and Fullwidth Forms"](i)||65288===i||65289===i||65293===i||i>=65306&&i<=65310||65339===i||65341===i||65343===i||i>=65371&&i<=65503||65507===i||i>=65512&&i<=65519)||!(!iY["Small Form Variants"](i)||i>=65112&&i<=65118||i>=65123&&i<=65126)||iY["Unified Canadian Aboriginal Syllabics"](i)||iY["Unified Canadian Aboriginal Syllabics Extended"](i)||iY["Vertical Forms"](i)||iY["Yijing Hexagram Symbols"](i)||iY["Yi Syllables"](i)||iY["Yi Radicals"](i))))}function i1(i){return!(i0(i)||iY["Latin-1 Supplement"](i)&&(167===i||169===i||174===i||177===i||188===i||189===i||190===i||215===i||247===i)||iY["General Punctuation"](i)&&(8214===i||8224===i||8225===i||8240===i||8241===i||8251===i||8252===i||8258===i||8263===i||8264===i||8265===i||8273===i)||iY["Letterlike Symbols"](i)||iY["Number Forms"](i)||iY["Miscellaneous Technical"](i)&&(i>=8960&&i<=8967||i>=8972&&i<=8991||i>=8996&&i<=9e3||9003===i||i>=9085&&i<=9114||i>=9150&&i<=9165||9167===i||i>=9169&&i<=9179||i>=9186&&i<=9215)||iY["Control Pictures"](i)&&9251!==i||iY["Optical Character Recognition"](i)||iY["Enclosed Alphanumerics"](i)||iY["Geometric Shapes"](i)||iY["Miscellaneous Symbols"](i)&&!(i>=9754&&i<=9759)||iY["Miscellaneous Symbols and Arrows"](i)&&(i>=11026&&i<=11055||i>=11088&&i<=11097||i>=11192&&i<=11243)||iY["CJK Symbols and Punctuation"](i)||iY.Katakana(i)||iY["Private Use Area"](i)||iY["CJK Compatibility Forms"](i)||iY["Small Form Variants"](i)||iY["Halfwidth and Fullwidth Forms"](i)||8734===i||8756===i||8757===i||i>=9984&&i<=10087||i>=10102&&i<=10131||65532===i||65533===i)}function i2(i){return i>=1424&&i<=2303||iY["Arabic Presentation Forms-A"](i)||iY["Arabic Presentation Forms-B"](i)}let i3="deferred",i5="loading",i4="loaded",i6=null,i8="unavailable",i9=null,i7=function(i){i&&"string"==typeof i&&i.indexOf("NetworkError")>-1&&(i8="error"),i6&&i6(i)};function rt(){re.fire(new te("pluginStateChange",{pluginStatus:i8,pluginURL:i9}))}let re=new tr,ri=function(){return i8},rr=function(){if(i8!==i3||!i9)throw Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");i8=i5,rt(),i9&&K({url:i9},i=>{i?i7(i):(i8=i4,rt())})},rn={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>i8===i4||null!=rn.applyArabicShaping,isLoading:()=>i8===i5,setState(i){if(!v())throw Error("Cannot set the state of the rtl-text-plugin when not in the web-worker context");i8=i.pluginStatus,i9=i.pluginURL},isParsed(){if(!v())throw Error("rtl-text-plugin is only parsed on the worker-threads");return null!=rn.applyArabicShaping&&null!=rn.processBidirectionalText&&null!=rn.processStyledBidirectionalText},getPluginURL(){if(!v())throw Error("rtl-text-plugin url can only be queried from the worker threads");return i9}};class ro{constructor(i,r){this.zoom=i,r?(this.now=r.now,this.fadeDuration=r.fadeDuration,this.zoomHistory=r.zoomHistory,this.transition=r.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new iJ,this.transition={})}isSupportedScript(i){return function(i,r){for(let o of i){var n;if(n=o.charCodeAt(0),!r&&i2(n)||n>=2304&&n<=3583||n>=3840&&n<=4255||iY.Khmer(n))return!1}return!0}(i,rn.isLoaded())}crossFadingFactor(){return 0===this.fadeDuration?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){let i=this.zoom,r=i-Math.floor(i),n=this.crossFadingFactor();return i>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:r+(1-r)*n}:{fromScale:.5,toScale:1,t:1-(1-n)*r}}}class ra{constructor(i,r){this.property=i,this.value=r,this.expression=function(i,r){if(e4(i))return new iu(i,r);if(ir(i)){let n=il(i,r);if("error"===n.result)throw Error(n.value.map(i=>`${i.key}: ${i.message}`).join(", "));return n.value}{let n=i;return"color"===r.type&&"string"==typeof i?n=tB.parse(i):"padding"===r.type&&("number"==typeof i||Array.isArray(i))&&(n=tU.parse(i)),{kind:"constant",evaluate:()=>n}}}(void 0===r?i.specification.default:r,i.specification)}isDataDriven(){return"source"===this.expression.kind||"composite"===this.expression.kind}possiblyEvaluate(i,r,n){return this.property.possiblyEvaluate(this,i,r,n)}}class rs{constructor(i){this.property=i,this.value=new ra(i,void 0)}transitioned(i,r){return new ru(this.property,this.value,r,h({},i.transition,this.transition),i.now)}untransitioned(){return new ru(this.property,this.value,null,{},0)}}class rl{constructor(i){this._properties=i,this._values=Object.create(i.defaultTransitionablePropertyValues)}getValue(i){return m(this._values[i].value.value)}setValue(i,r){Object.prototype.hasOwnProperty.call(this._values,i)||(this._values[i]=new rs(this._values[i].property)),this._values[i].value=new ra(this._values[i].property,null===r?void 0:m(r))}getTransition(i){return m(this._values[i].transition)}setTransition(i,r){Object.prototype.hasOwnProperty.call(this._values,i)||(this._values[i]=new rs(this._values[i].property)),this._values[i].transition=m(r)||void 0}serialize(){let i={};for(let r of Object.keys(this._values)){let n=this.getValue(r);void 0!==n&&(i[r]=n);let o=this.getTransition(r);void 0!==o&&(i[`${r}-transition`]=o)}return i}transitioned(i,r){let n=new rh(this._properties);for(let o of Object.keys(this._values))n._values[o]=this._values[o].transitioned(i,r._values[o]);return n}untransitioned(){let i=new rh(this._properties);for(let r of Object.keys(this._values))i._values[r]=this._values[r].untransitioned();return i}}class ru{constructor(i,r,n,o,a){this.property=i,this.value=r,this.begin=a+o.delay||0,this.end=this.begin+o.duration||0,i.specification.transition&&(o.delay||o.duration)&&(this.prior=n)}possiblyEvaluate(i,r,n){let o=i.now||0,a=this.value.possiblyEvaluate(i,r,n),s=this.prior;if(s){if(o>this.end||this.value.isDataDriven())return this.prior=null,a;if(o<this.begin)return s.possiblyEvaluate(i,r,n);{let l=(o-this.begin)/(this.end-this.begin);return this.property.interpolate(s.possiblyEvaluate(i,r,n),a,function(i){if(i<=0)return 0;if(i>=1)return 1;let r=i*i,n=r*i;return 4*(i<.5?n:3*(i-r)+n-.75)}(l))}}return a}}class rh{constructor(i){this._properties=i,this._values=Object.create(i.defaultTransitioningPropertyValues)}possiblyEvaluate(i,r,n){let o=new rp(this._properties);for(let a of Object.keys(this._values))o._values[a]=this._values[a].possiblyEvaluate(i,r,n);return o}hasTransition(){for(let i of Object.keys(this._values))if(this._values[i].prior)return!0;return!1}}class rc{constructor(i){this._properties=i,this._values=Object.create(i.defaultPropertyValues)}getValue(i){return m(this._values[i].value)}setValue(i,r){this._values[i]=new ra(this._values[i].property,null===r?void 0:m(r))}serialize(){let i={};for(let r of Object.keys(this._values)){let n=this.getValue(r);void 0!==n&&(i[r]=n)}return i}possiblyEvaluate(i,r,n){let o=new rp(this._properties);for(let a of Object.keys(this._values))o._values[a]=this._values[a].possiblyEvaluate(i,r,n);return o}}class rd{constructor(i,r,n){this.property=i,this.value=r,this.parameters=n}isConstant(){return"constant"===this.value.kind}constantOr(i){return"constant"===this.value.kind?this.value.value:i}evaluate(i,r,n,o){return this.property.evaluate(this.value,this.parameters,i,r,n,o)}}class rp{constructor(i){this._properties=i,this._values=Object.create(i.defaultPossiblyEvaluatedValues)}get(i){return this._values[i]}}class rf{constructor(i){this.specification=i}possiblyEvaluate(i,r){if(i.isDataDriven())throw Error("Value should not be data driven");return i.expression.evaluate(r)}interpolate(i,r,n){let o=ec[this.specification.type];return o?o(i,r,n):i}}class rm{constructor(i,r){this.specification=i,this.overrides=r}possiblyEvaluate(i,r,n,o){return new rd(this,"constant"===i.expression.kind||"camera"===i.expression.kind?{kind:"constant",value:i.expression.evaluate(r,null,{},n,o)}:i.expression,r)}interpolate(i,r,n){if("constant"!==i.value.kind||"constant"!==r.value.kind)return i;if(void 0===i.value.value||void 0===r.value.value)return new rd(this,{kind:"constant",value:void 0},i.parameters);let o=ec[this.specification.type];return o?new rd(this,{kind:"constant",value:o(i.value.value,r.value.value,n)},i.parameters):i}evaluate(i,r,n,o,a,s){return"constant"===i.kind?i.value:i.evaluate(r,n,o,a,s)}}class rg extends rm{possiblyEvaluate(i,r,n,o){if(void 0===i.value)return new rd(this,{kind:"constant",value:void 0},r);if("constant"===i.expression.kind){let a=i.expression.evaluate(r,null,{},n,o),s="resolvedImage"===i.property.specification.type&&"string"!=typeof a?a.name:a,l=this._calculate(s,s,s,r);return new rd(this,{kind:"constant",value:l},r)}if("camera"===i.expression.kind){let n=this._calculate(i.expression.evaluate({zoom:r.zoom-1}),i.expression.evaluate({zoom:r.zoom}),i.expression.evaluate({zoom:r.zoom+1}),r);return new rd(this,{kind:"constant",value:n},r)}return new rd(this,i.expression,r)}evaluate(i,r,n,o,a,s){if("source"===i.kind){let l=i.evaluate(r,n,o,a,s);return this._calculate(l,l,l,r)}return"composite"===i.kind?this._calculate(i.evaluate({zoom:Math.floor(r.zoom)-1},n,o),i.evaluate({zoom:Math.floor(r.zoom)},n,o),i.evaluate({zoom:Math.floor(r.zoom)+1},n,o),r):i.value}_calculate(i,r,n,o){return o.zoom>o.zoomHistory.lastIntegerZoom?{from:i,to:r}:{from:n,to:r}}interpolate(i){return i}}class r_{constructor(i){this.specification=i}possiblyEvaluate(i,r,n,o){if(void 0!==i.value){if("constant"===i.expression.kind){let a=i.expression.evaluate(r,null,{},n,o);return this._calculate(a,a,a,r)}return this._calculate(i.expression.evaluate(new ro(Math.floor(r.zoom-1),r)),i.expression.evaluate(new ro(Math.floor(r.zoom),r)),i.expression.evaluate(new ro(Math.floor(r.zoom+1),r)),r)}}_calculate(i,r,n,o){return o.zoom>o.zoomHistory.lastIntegerZoom?{from:i,to:r}:{from:n,to:r}}interpolate(i){return i}}class ry{constructor(i){this.specification=i}possiblyEvaluate(i,r,n,o){return!!i.expression.evaluate(r,null,{},n,o)}interpolate(){return!1}}class rv{constructor(i){for(let r in this.properties=i,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[],i){let n=i[r];n.specification.overridable&&this.overridableProperties.push(r);let o=this.defaultPropertyValues[r]=new ra(n,void 0),a=this.defaultTransitionablePropertyValues[r]=new rs(n);this.defaultTransitioningPropertyValues[r]=a.untransitioned(),this.defaultPossiblyEvaluatedValues[r]=o.possiblyEvaluate({})}}}iW("DataDrivenProperty",rm),iW("DataConstantProperty",rf),iW("CrossFadedDataDrivenProperty",rg),iW("CrossFadedProperty",r_),iW("ColorRampProperty",ry);let rx="-transition";class rb extends tr{constructor(i,r){if(super(),this.id=i.id,this.type=i.type,this._featureFilter={filter:()=>!0,needGeometry:!1},"custom"!==i.type&&(this.metadata=i.metadata,this.minzoom=i.minzoom,this.maxzoom=i.maxzoom,"background"!==i.type&&(this.source=i.source,this.sourceLayer=i["source-layer"],this.filter=i.filter),r.layout&&(this._unevaluatedLayout=new rc(r.layout)),r.paint)){for(let n in this._transitionablePaint=new rl(r.paint),i.paint)this.setPaintProperty(n,i.paint[n],{validate:!1});for(let r in i.layout)this.setLayoutProperty(r,i.layout[r],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new rp(r.paint)}}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(i){return"visibility"===i?this.visibility:this._unevaluatedLayout.getValue(i)}setLayoutProperty(i,r,n={}){null!=r&&this._validate(iV,`layers.${this.id}.layout.${i}`,i,r,n)||("visibility"!==i?this._unevaluatedLayout.setValue(i,r):this.visibility=r)}getPaintProperty(i){return i.endsWith(rx)?this._transitionablePaint.getTransition(i.slice(0,-rx.length)):this._transitionablePaint.getValue(i)}setPaintProperty(i,r,n={}){if(null!=r&&this._validate(iZ,`layers.${this.id}.paint.${i}`,i,r,n))return!1;if(i.endsWith(rx))return this._transitionablePaint.setTransition(i.slice(0,-rx.length),r||void 0),!1;{let n=this._transitionablePaint._values[i],o="cross-faded-data-driven"===n.property.specification["property-type"],a=n.value.isDataDriven(),s=n.value;this._transitionablePaint.setValue(i,r),this._handleSpecialPaintPropertyUpdate(i);let l=this._transitionablePaint._values[i].value;return l.isDataDriven()||a||o||this._handleOverridablePaintPropertyUpdate(i,s,l)}}_handleSpecialPaintPropertyUpdate(i){}_handleOverridablePaintPropertyUpdate(i,r,n){return!1}isHidden(i){return!!(this.minzoom&&i<this.minzoom)||!!(this.maxzoom&&i>=this.maxzoom)||"none"===this.visibility}updateTransitions(i){this._transitioningPaint=this._transitionablePaint.transitioned(i,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(i,r){i.getCrossfadeParameters&&(this._crossfadeParameters=i.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(i,void 0,r)),this.paint=this._transitioningPaint.possiblyEvaluate(i,void 0,r)}serialize(){let i={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(i.layout=i.layout||{},i.layout.visibility=this.visibility),f(i,(i,r)=>!(void 0===i||"layout"===r&&!Object.keys(i).length||"paint"===r&&!Object.keys(i).length))}_validate(i,r,n,o,a={}){return(!a||!1!==a.validate)&&iq(this,i.call(iF,{key:r,layerType:this.type,objectKey:n,value:o,styleSpec:tn,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(let i in this.paint._values){let r=this.paint.get(i);if(r instanceof rd&&e1(r.property.specification)&&("source"===r.value.kind||"composite"===r.value.kind)&&r.value.isStateDependent)return!0}return!1}}let rw={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class rT{constructor(i,r){this._structArray=i,this._pos1=r*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class rE{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(i,r){return i._trim(),r&&(i.isTransferred=!0,r.push(i.arrayBuffer)),{length:i.length,arrayBuffer:i.arrayBuffer}}static deserialize(i){let r=Object.create(this.prototype);return r.arrayBuffer=i.arrayBuffer,r.length=i.length,r.capacity=i.arrayBuffer.byteLength/r.bytesPerElement,r._refreshViews(),r}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(i){this.reserve(i),this.length=i}reserve(i){if(i>this.capacity){this.capacity=Math.max(i,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);let r=this.uint8;this._refreshViews(),r&&this.uint8.set(r)}}_refreshViews(){throw Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function rS(i,r=1){let n=0,o=0;return{members:i.map(i=>{let a=rw[i.type].BYTES_PER_ELEMENT,s=n=rC(n,Math.max(r,a)),l=i.components||1;return o=Math.max(o,a),n+=a*l,{name:i.name,type:i.type,components:l,offset:s}}),size:rC(n,Math.max(o,r)),alignment:r}}function rC(i,r){return Math.ceil(i/r)*r}class rI extends rE{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,r){let n=this.length;return this.resize(n+1),this.emplace(n,i,r)}emplace(i,r,n){let o=2*i;return this.int16[o+0]=r,this.int16[o+1]=n,i}}rI.prototype.bytesPerElement=4,iW("StructArrayLayout2i4",rI);class rA extends rE{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,r,n,o){let a=this.length;return this.resize(a+1),this.emplace(a,i,r,n,o)}emplace(i,r,n,o,a){let s=4*i;return this.int16[s+0]=r,this.int16[s+1]=n,this.int16[s+2]=o,this.int16[s+3]=a,i}}rA.prototype.bytesPerElement=8,iW("StructArrayLayout4i8",rA);class rP extends rE{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,r,n,o,a,s){let l=this.length;return this.resize(l+1),this.emplace(l,i,r,n,o,a,s)}emplace(i,r,n,o,a,s,l){let u=6*i;return this.int16[u+0]=r,this.int16[u+1]=n,this.int16[u+2]=o,this.int16[u+3]=a,this.int16[u+4]=s,this.int16[u+5]=l,i}}rP.prototype.bytesPerElement=12,iW("StructArrayLayout2i4i12",rP);class rk extends rE{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,r,n,o,a,s){let l=this.length;return this.resize(l+1),this.emplace(l,i,r,n,o,a,s)}emplace(i,r,n,o,a,s,l){let u=4*i,h=8*i;return this.int16[u+0]=r,this.int16[u+1]=n,this.uint8[h+4]=o,this.uint8[h+5]=a,this.uint8[h+6]=s,this.uint8[h+7]=l,i}}rk.prototype.bytesPerElement=8,iW("StructArrayLayout2i4ub8",rk);class rL extends rE{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,r){let n=this.length;return this.resize(n+1),this.emplace(n,i,r)}emplace(i,r,n){let o=2*i;return this.float32[o+0]=r,this.float32[o+1]=n,i}}rL.prototype.bytesPerElement=8,iW("StructArrayLayout2f8",rL);class rM extends rE{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i,r,n,o,a,s,l,u,h,c){let d=this.length;return this.resize(d+1),this.emplace(d,i,r,n,o,a,s,l,u,h,c)}emplace(i,r,n,o,a,s,l,u,h,c,d){let p=10*i;return this.uint16[p+0]=r,this.uint16[p+1]=n,this.uint16[p+2]=o,this.uint16[p+3]=a,this.uint16[p+4]=s,this.uint16[p+5]=l,this.uint16[p+6]=u,this.uint16[p+7]=h,this.uint16[p+8]=c,this.uint16[p+9]=d,i}}rM.prototype.bytesPerElement=20,iW("StructArrayLayout10ui20",rM);class rz extends rE{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i,r,n,o,a,s,l,u,h,c,d,p){let f=this.length;return this.resize(f+1),this.emplace(f,i,r,n,o,a,s,l,u,h,c,d,p)}emplace(i,r,n,o,a,s,l,u,h,c,d,p,f){let m=12*i;return this.int16[m+0]=r,this.int16[m+1]=n,this.int16[m+2]=o,this.int16[m+3]=a,this.uint16[m+4]=s,this.uint16[m+5]=l,this.uint16[m+6]=u,this.uint16[m+7]=h,this.int16[m+8]=c,this.int16[m+9]=d,this.int16[m+10]=p,this.int16[m+11]=f,i}}rz.prototype.bytesPerElement=24,iW("StructArrayLayout4i4ui4i24",rz);class rD extends rE{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,r,n){let o=this.length;return this.resize(o+1),this.emplace(o,i,r,n)}emplace(i,r,n,o){let a=3*i;return this.float32[a+0]=r,this.float32[a+1]=n,this.float32[a+2]=o,i}}rD.prototype.bytesPerElement=12,iW("StructArrayLayout3f12",rD);class rR extends rE{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(i){let r=this.length;return this.resize(r+1),this.emplace(r,i)}emplace(i,r){return this.uint32[1*i+0]=r,i}}rR.prototype.bytesPerElement=4,iW("StructArrayLayout1ul4",rR);class rB extends rE{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i,r,n,o,a,s,l,u,h){let c=this.length;return this.resize(c+1),this.emplace(c,i,r,n,o,a,s,l,u,h)}emplace(i,r,n,o,a,s,l,u,h,c){let d=10*i;return this.int16[d+0]=r,this.int16[d+1]=n,this.int16[d+2]=o,this.int16[d+3]=a,this.int16[d+4]=s,this.int16[d+5]=l,this.uint32[5*i+3]=u,this.uint16[d+8]=h,this.uint16[d+9]=c,i}}rB.prototype.bytesPerElement=20,iW("StructArrayLayout6i1ul2ui20",rB);class rO extends rE{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,r,n,o,a,s){let l=this.length;return this.resize(l+1),this.emplace(l,i,r,n,o,a,s)}emplace(i,r,n,o,a,s,l){let u=6*i;return this.int16[u+0]=r,this.int16[u+1]=n,this.int16[u+2]=o,this.int16[u+3]=a,this.int16[u+4]=s,this.int16[u+5]=l,i}}rO.prototype.bytesPerElement=12,iW("StructArrayLayout2i2i2i12",rO);class rF extends rE{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,r,n,o,a){let s=this.length;return this.resize(s+1),this.emplace(s,i,r,n,o,a)}emplace(i,r,n,o,a,s){let l=4*i,u=8*i;return this.float32[l+0]=r,this.float32[l+1]=n,this.float32[l+2]=o,this.int16[u+6]=a,this.int16[u+7]=s,i}}rF.prototype.bytesPerElement=16,iW("StructArrayLayout2f1f2i16",rF);class rN extends rE{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,r,n,o){let a=this.length;return this.resize(a+1),this.emplace(a,i,r,n,o)}emplace(i,r,n,o,a){let s=12*i,l=3*i;return this.uint8[s+0]=r,this.uint8[s+1]=n,this.float32[l+1]=o,this.float32[l+2]=a,i}}rN.prototype.bytesPerElement=12,iW("StructArrayLayout2ub2f12",rN);class rU extends rE{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i,r,n){let o=this.length;return this.resize(o+1),this.emplace(o,i,r,n)}emplace(i,r,n,o){let a=3*i;return this.uint16[a+0]=r,this.uint16[a+1]=n,this.uint16[a+2]=o,i}}rU.prototype.bytesPerElement=6,iW("StructArrayLayout3ui6",rU);class rj extends rE{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,r,n,o,a,s,l,u,h,c,d,p,f,m,g,_,y){let v=this.length;return this.resize(v+1),this.emplace(v,i,r,n,o,a,s,l,u,h,c,d,p,f,m,g,_,y)}emplace(i,r,n,o,a,s,l,u,h,c,d,p,f,m,g,_,y,v){let x=24*i,b=12*i,w=48*i;return this.int16[x+0]=r,this.int16[x+1]=n,this.uint16[x+2]=o,this.uint16[x+3]=a,this.uint32[b+2]=s,this.uint32[b+3]=l,this.uint32[b+4]=u,this.uint16[x+10]=h,this.uint16[x+11]=c,this.uint16[x+12]=d,this.float32[b+7]=p,this.float32[b+8]=f,this.uint8[w+36]=m,this.uint8[w+37]=g,this.uint8[w+38]=_,this.uint32[b+10]=y,this.int16[x+22]=v,i}}rj.prototype.bytesPerElement=48,iW("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",rj);class rZ extends rE{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,r,n,o,a,s,l,u,h,c,d,p,f,m,g,_,y,v,x,b,w,T,E,S,C,I,A,P){let k=this.length;return this.resize(k+1),this.emplace(k,i,r,n,o,a,s,l,u,h,c,d,p,f,m,g,_,y,v,x,b,w,T,E,S,C,I,A,P)}emplace(i,r,n,o,a,s,l,u,h,c,d,p,f,m,g,_,y,v,x,b,w,T,E,S,C,I,A,P,k){let M=34*i,z=17*i;return this.int16[M+0]=r,this.int16[M+1]=n,this.int16[M+2]=o,this.int16[M+3]=a,this.int16[M+4]=s,this.int16[M+5]=l,this.int16[M+6]=u,this.int16[M+7]=h,this.uint16[M+8]=c,this.uint16[M+9]=d,this.uint16[M+10]=p,this.uint16[M+11]=f,this.uint16[M+12]=m,this.uint16[M+13]=g,this.uint16[M+14]=_,this.uint16[M+15]=y,this.uint16[M+16]=v,this.uint16[M+17]=x,this.uint16[M+18]=b,this.uint16[M+19]=w,this.uint16[M+20]=T,this.uint16[M+21]=E,this.uint16[M+22]=S,this.uint32[z+12]=C,this.float32[z+13]=I,this.float32[z+14]=A,this.float32[z+15]=P,this.float32[z+16]=k,i}}rZ.prototype.bytesPerElement=68,iW("StructArrayLayout8i15ui1ul4f68",rZ);class rV extends rE{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i){let r=this.length;return this.resize(r+1),this.emplace(r,i)}emplace(i,r){return this.float32[1*i+0]=r,i}}rV.prototype.bytesPerElement=4,iW("StructArrayLayout1f4",rV);class rq extends rE{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,r,n){let o=this.length;return this.resize(o+1),this.emplace(o,i,r,n)}emplace(i,r,n,o){let a=3*i;return this.int16[a+0]=r,this.int16[a+1]=n,this.int16[a+2]=o,i}}rq.prototype.bytesPerElement=6,iW("StructArrayLayout3i6",rq);class rG extends rE{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i,r,n){let o=this.length;return this.resize(o+1),this.emplace(o,i,r,n)}emplace(i,r,n,o){let a=4*i;return this.uint32[2*i+0]=r,this.uint16[a+2]=n,this.uint16[a+3]=o,i}}rG.prototype.bytesPerElement=8,iW("StructArrayLayout1ul2ui8",rG);class r$ extends rE{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i,r){let n=this.length;return this.resize(n+1),this.emplace(n,i,r)}emplace(i,r,n){let o=2*i;return this.uint16[o+0]=r,this.uint16[o+1]=n,i}}r$.prototype.bytesPerElement=4,iW("StructArrayLayout2ui4",r$);class rW extends rE{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i){let r=this.length;return this.resize(r+1),this.emplace(r,i)}emplace(i,r){return this.uint16[1*i+0]=r,i}}rW.prototype.bytesPerElement=2,iW("StructArrayLayout1ui2",rW);class rH extends rE{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,r,n,o){let a=this.length;return this.resize(a+1),this.emplace(a,i,r,n,o)}emplace(i,r,n,o,a){let s=4*i;return this.float32[s+0]=r,this.float32[s+1]=n,this.float32[s+2]=o,this.float32[s+3]=a,i}}rH.prototype.bytesPerElement=16,iW("StructArrayLayout4f16",rH);class rX extends rT{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new I(this.anchorPointX,this.anchorPointY)}}rX.prototype.size=20;class rK extends rB{get(i){return new rX(this,i)}}iW("CollisionBoxArray",rK);class rJ extends rT{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(i){this._structArray.uint8[this._pos1+37]=i}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(i){this._structArray.uint8[this._pos1+38]=i}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(i){this._structArray.uint32[this._pos4+10]=i}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}rJ.prototype.size=48;class rY extends rj{get(i){return new rJ(this,i)}}iW("PlacedSymbolArray",rY);class rQ extends rT{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(i){this._structArray.uint32[this._pos4+12]=i}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get textOffset0(){return this._structArray.float32[this._pos4+14]}get textOffset1(){return this._structArray.float32[this._pos4+15]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+16]}}rQ.prototype.size=68;class r0 extends rZ{get(i){return new rQ(this,i)}}iW("SymbolInstanceArray",r0);class r1 extends rV{getoffsetX(i){return this.float32[1*i+0]}}iW("GlyphOffsetArray",r1);class r2 extends rq{getx(i){return this.int16[3*i+0]}gety(i){return this.int16[3*i+1]}gettileUnitDistanceFromAnchor(i){return this.int16[3*i+2]}}iW("SymbolLineVertexArray",r2);class r3 extends rT{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}r3.prototype.size=8;class r5 extends rG{get(i){return new r3(this,i)}}iW("FeatureIndexArray",r5);class r4 extends rI{}class r6 extends rI{}class r8 extends rI{}class r9 extends rP{}class r7 extends rk{}class nt extends rL{}class ne extends rM{}class ni extends rz{}class nr extends rD{}class nn extends rR{}class no extends rO{}class na extends rN{}class ns extends rU{}class nl extends r${}let nu=rS([{name:"a_pos",components:2,type:"Int16"}],4),{members:nh}=nu;class nc{constructor(i=[]){this.segments=i}prepareSegment(i,r,n,o){let a=this.segments[this.segments.length-1];return i>nc.MAX_VERTEX_ARRAY_LENGTH&&_(`Max vertices per segment is ${nc.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${i}`),(!a||a.vertexLength+i>nc.MAX_VERTEX_ARRAY_LENGTH||a.sortKey!==o)&&(a={vertexOffset:r.length,primitiveOffset:n.length,vertexLength:0,primitiveLength:0},void 0!==o&&(a.sortKey=o),this.segments.push(a)),a}get(){return this.segments}destroy(){for(let i of this.segments)for(let r in i.vaos)i.vaos[r].destroy()}static simpleSegment(i,r,n,o){return new nc([{vertexOffset:i,primitiveOffset:r,vertexLength:n,primitiveLength:o,vaos:{},sortKey:0}])}}function nd(i,r){return 256*(i=l(Math.floor(i),0,255))+l(Math.floor(r),0,255)}nc.MAX_VERTEX_ARRAY_LENGTH=65535,iW("SegmentVector",nc);let np=rS([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]);var nf={exports:{}},nm={exports:{}};nm.exports=function(i,r){var n,o,a,s,l,u;for(o=i.length-(n=3&i.length),a=r,u=0;u<o;)l=255&i.charCodeAt(u)|(255&i.charCodeAt(++u))<<8|(255&i.charCodeAt(++u))<<16|(255&i.charCodeAt(++u))<<24,++u,a=27492+(65535&(s=5*(65535&(a=(a^=l=(65535&(l=(l=(65535&l)*3432918353+(((l>>>16)*3432918353&65535)<<16)&4294967295)<<15|l>>>17))*461845907+(((l>>>16)*461845907&65535)<<16)&4294967295)<<13|a>>>19))+((5*(a>>>16)&65535)<<16)&4294967295))+((58964+(s>>>16)&65535)<<16);switch(l=0,n){case 3:l^=(255&i.charCodeAt(u+2))<<16;case 2:l^=(255&i.charCodeAt(u+1))<<8;case 1:a^=l=(65535&(l=(l=(65535&(l^=255&i.charCodeAt(u)))*3432918353+(((l>>>16)*3432918353&65535)<<16)&4294967295)<<15|l>>>17))*461845907+(((l>>>16)*461845907&65535)<<16)&4294967295}return a^=i.length,a=2246822507*(65535&(a^=a>>>16))+((2246822507*(a>>>16)&65535)<<16)&4294967295,a=3266489909*(65535&(a^=a>>>13))+((3266489909*(a>>>16)&65535)<<16)&4294967295,(a^=a>>>16)>>>0};var ng={exports:{}};ng.exports=function(i,r){for(var n,o=i.length,a=r^o,s=0;o>=4;)n=1540483477*(65535&(n=255&i.charCodeAt(s)|(255&i.charCodeAt(++s))<<8|(255&i.charCodeAt(++s))<<16|(255&i.charCodeAt(++s))<<24))+((1540483477*(n>>>16)&65535)<<16),a=1540483477*(65535&a)+((1540483477*(a>>>16)&65535)<<16)^(n=1540483477*(65535&(n^=n>>>24))+((1540483477*(n>>>16)&65535)<<16)),o-=4,++s;switch(o){case 3:a^=(255&i.charCodeAt(s+2))<<16;case 2:a^=(255&i.charCodeAt(s+1))<<8;case 1:a=1540483477*(65535&(a^=255&i.charCodeAt(s)))+((1540483477*(a>>>16)&65535)<<16)}return a=1540483477*(65535&(a^=a>>>13))+((1540483477*(a>>>16)&65535)<<16),(a^=a>>>15)>>>0};var n_=nm.exports,ny=ng.exports;nf.exports=n_,nf.exports.murmur3=n_,nf.exports.murmur2=ny;class nv{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(i,r,n,o){this.ids.push(nx(i)),this.positions.push(r,n,o)}getPositions(i){if(!this.indexed)throw Error("Trying to get index, but feature positions are not indexed");let r=nx(i),n=0,o=this.ids.length-1;for(;n<o;){let i=n+o>>1;this.ids[i]>=r?o=i:n=i+1}let a=[];for(;this.ids[n]===r;)a.push({index:this.positions[3*n],start:this.positions[3*n+1],end:this.positions[3*n+2]}),n++;return a}static serialize(i,r){let n=new Float64Array(i.ids),o=new Uint32Array(i.positions);return function i(r,n,o,a){for(;o<a;){let s=r[o+a>>1],l=o-1,u=a+1;for(;;){do l++;while(r[l]<s)do u--;while(r[u]>s)if(l>=u)break;nb(r,l,u),nb(n,3*l,3*u),nb(n,3*l+1,3*u+1),nb(n,3*l+2,3*u+2)}u-o<a-u?(i(r,n,o,u),o=u+1):(i(r,n,u+1,a),a=u)}}(n,o,0,n.length-1),r&&r.push(n.buffer,o.buffer),{ids:n,positions:o}}static deserialize(i){let r=new nv;return r.ids=i.ids,r.positions=i.positions,r.indexed=!0,r}}function nx(i){let r=+i;return!isNaN(r)&&r<=Number.MAX_SAFE_INTEGER?r:nf.exports(String(i))}function nb(i,r,n){let o=i[r];i[r]=i[n],i[n]=o}iW("FeaturePositionMap",nv);class nw{constructor(i,r){this.gl=i.gl,this.location=r}}class nT extends nw{constructor(i,r){super(i,r),this.current=0}set(i){this.current!==i&&(this.current=i,this.gl.uniform1f(this.location,i))}}class nE extends nw{constructor(i,r){super(i,r),this.current=[0,0,0,0]}set(i){i[0]===this.current[0]&&i[1]===this.current[1]&&i[2]===this.current[2]&&i[3]===this.current[3]||(this.current=i,this.gl.uniform4f(this.location,i[0],i[1],i[2],i[3]))}}class nS extends nw{constructor(i,r){super(i,r),this.current=tB.transparent}set(i){i.r===this.current.r&&i.g===this.current.g&&i.b===this.current.b&&i.a===this.current.a||(this.current=i,this.gl.uniform4f(this.location,i.r,i.g,i.b,i.a))}}let nC=new Float32Array(16);function nI(i){return[nd(255*i.r,255*i.g),nd(255*i.b,255*i.a)]}class nA{constructor(i,r,n){this.value=i,this.uniformNames=r.map(i=>`u_${i}`),this.type=n}setUniform(i,r,n){i.set(n.constantOr(this.value))}getBinding(i,r,n){return"color"===this.type?new nS(i,r):new nT(i,r)}}class nP{constructor(i,r){this.uniformNames=r.map(i=>`u_${i}`),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(i,r){this.pixelRatioFrom=r.pixelRatio,this.pixelRatioTo=i.pixelRatio,this.patternFrom=r.tlbr,this.patternTo=i.tlbr}setUniform(i,r,n,o){let a="u_pattern_to"===o?this.patternTo:"u_pattern_from"===o?this.patternFrom:"u_pixel_ratio_to"===o?this.pixelRatioTo:"u_pixel_ratio_from"===o?this.pixelRatioFrom:null;a&&i.set(a)}getBinding(i,r,n){return"u_pattern"===n.substr(0,9)?new nE(i,r):new nT(i,r)}}class nk{constructor(i,r,n,o){this.expression=i,this.type=n,this.maxValue=0,this.paintVertexAttributes=r.map(i=>({name:`a_${i}`,type:"Float32",components:"color"===n?2:1,offset:0})),this.paintVertexArray=new o}populatePaintArray(i,r,n,o,a){let s=this.paintVertexArray.length,l=this.expression.evaluate(new ro(0),r,{},o,[],a);this.paintVertexArray.resize(i),this._setPaintValue(s,i,l)}updatePaintArray(i,r,n,o){let a=this.expression.evaluate({zoom:0},n,o);this._setPaintValue(i,r,a)}_setPaintValue(i,r,n){if("color"===this.type){let o=nI(n);for(let n=i;n<r;n++)this.paintVertexArray.emplace(n,o[0],o[1])}else{for(let o=i;o<r;o++)this.paintVertexArray.emplace(o,n);this.maxValue=Math.max(this.maxValue,Math.abs(n))}}upload(i){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=i.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class nL{constructor(i,r,n,o,a,s){this.expression=i,this.uniformNames=r.map(i=>`u_${i}_t`),this.type=n,this.useIntegerZoom=o,this.zoom=a,this.maxValue=0,this.paintVertexAttributes=r.map(i=>({name:`a_${i}`,type:"Float32",components:"color"===n?4:2,offset:0})),this.paintVertexArray=new s}populatePaintArray(i,r,n,o,a){let s=this.expression.evaluate(new ro(this.zoom),r,{},o,[],a),l=this.expression.evaluate(new ro(this.zoom+1),r,{},o,[],a),u=this.paintVertexArray.length;this.paintVertexArray.resize(i),this._setPaintValue(u,i,s,l)}updatePaintArray(i,r,n,o){let a=this.expression.evaluate({zoom:this.zoom},n,o),s=this.expression.evaluate({zoom:this.zoom+1},n,o);this._setPaintValue(i,r,a,s)}_setPaintValue(i,r,n,o){if("color"===this.type){let a=nI(n),s=nI(o);for(let n=i;n<r;n++)this.paintVertexArray.emplace(n,a[0],a[1],s[0],s[1])}else{for(let a=i;a<r;a++)this.paintVertexArray.emplace(a,n,o);this.maxValue=Math.max(this.maxValue,Math.abs(n),Math.abs(o))}}upload(i){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=i.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(i,r){let n=this.useIntegerZoom?Math.floor(r.zoom):r.zoom,o=l(this.expression.interpolationFactor(n,this.zoom,this.zoom+1),0,1);i.set(o)}getBinding(i,r,n){return new nT(i,r)}}class nM{constructor(i,r,n,o,a,s){this.expression=i,this.type=r,this.useIntegerZoom=n,this.zoom=o,this.layerId=s,this.zoomInPaintVertexArray=new a,this.zoomOutPaintVertexArray=new a}populatePaintArray(i,r,n){let o=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(i),this.zoomOutPaintVertexArray.resize(i),this._setPaintValues(o,i,r.patterns&&r.patterns[this.layerId],n)}updatePaintArray(i,r,n,o,a){this._setPaintValues(i,r,n.patterns&&n.patterns[this.layerId],a)}_setPaintValues(i,r,n,o){if(!o||!n)return;let{min:a,mid:s,max:l}=n,u=o[a],h=o[s],c=o[l];if(u&&h&&c)for(let n=i;n<r;n++)this.zoomInPaintVertexArray.emplace(n,h.tl[0],h.tl[1],h.br[0],h.br[1],u.tl[0],u.tl[1],u.br[0],u.br[1],h.pixelRatio,u.pixelRatio),this.zoomOutPaintVertexArray.emplace(n,h.tl[0],h.tl[1],h.br[0],h.br[1],c.tl[0],c.tl[1],c.br[0],c.br[1],h.pixelRatio,c.pixelRatio)}upload(i){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=i.createVertexBuffer(this.zoomInPaintVertexArray,np.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=i.createVertexBuffer(this.zoomOutPaintVertexArray,np.members,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class nz{constructor(i,r,n){this.binders={},this._buffers=[];let o=[];for(let s in i.paint._values){var a;if(!n(s))continue;let l=i.paint.get(s);if(!(l instanceof rd&&e1(l.property.specification)))continue;let u=(a=i.type,({"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]})[s]||[s.replace(`${a}-`,"").replace(/-/g,"_")]),h=l.value,c=l.property.specification.type,d=l.property.useIntegerZoom,p=l.property.specification["property-type"],f="cross-faded"===p||"cross-faded-data-driven"===p;if("constant"===h.kind)this.binders[s]=f?new nP(h.value,u):new nA(h.value,u,c),o.push(`/u_${s}`);else if("source"===h.kind||f){let n=nR(s,c,"source");this.binders[s]=f?new nM(h,c,d,r,n,i.id):new nk(h,u,c,n),o.push(`/a_${s}`)}else{let i=nR(s,c,"composite");this.binders[s]=new nL(h,u,c,d,r,i),o.push(`/z_${s}`)}}this.cacheKey=o.sort().join("")}getMaxValue(i){let r=this.binders[i];return r instanceof nk||r instanceof nL?r.maxValue:0}populatePaintArrays(i,r,n,o,a){for(let s in this.binders){let l=this.binders[s];(l instanceof nk||l instanceof nL||l instanceof nM)&&l.populatePaintArray(i,r,n,o,a)}}setConstantPatternPositions(i,r){for(let n in this.binders){let o=this.binders[n];o instanceof nP&&o.setConstantPatternPositions(i,r)}}updatePaintArrays(i,r,n,o,a){let s=!1;for(let l in i){let u=r.getPositions(l);for(let r of u){let u=n.feature(r.index);for(let n in this.binders){let h=this.binders[n];if((h instanceof nk||h instanceof nL||h instanceof nM)&&!0===h.expression.isStateDependent){let c=o.paint.get(n);h.expression=c.value,h.updatePaintArray(r.start,r.end,u,i[l],a),s=!0}}}}return s}defines(){let i=[];for(let r in this.binders){let n=this.binders[r];(n instanceof nA||n instanceof nP)&&i.push(...n.uniformNames.map(i=>`#define HAS_UNIFORM_${i}`))}return i}getBinderAttributes(){let i=[];for(let r in this.binders){let n=this.binders[r];if(n instanceof nk||n instanceof nL)for(let r=0;r<n.paintVertexAttributes.length;r++)i.push(n.paintVertexAttributes[r].name);else if(n instanceof nM)for(let r=0;r<np.members.length;r++)i.push(np.members[r].name)}return i}getBinderUniforms(){let i=[];for(let r in this.binders){let n=this.binders[r];if(n instanceof nA||n instanceof nP||n instanceof nL)for(let r of n.uniformNames)i.push(r)}return i}getPaintVertexBuffers(){return this._buffers}getUniforms(i,r){let n=[];for(let o in this.binders){let a=this.binders[o];if(a instanceof nA||a instanceof nP||a instanceof nL){for(let s of a.uniformNames)if(r[s]){let l=a.getBinding(i,r[s],s);n.push({name:s,property:o,binding:l})}}}return n}setUniforms(i,r,n,o){for(let{name:i,property:a,binding:s}of r)this.binders[a].setUniform(s,o,n.get(a),i)}updatePaintBuffers(i){for(let r in this._buffers=[],this.binders){let n=this.binders[r];if(i&&n instanceof nM){let r=2===i.fromScale?n.zoomInPaintVertexBuffer:n.zoomOutPaintVertexBuffer;r&&this._buffers.push(r)}else(n instanceof nk||n instanceof nL)&&n.paintVertexBuffer&&this._buffers.push(n.paintVertexBuffer)}}upload(i){for(let r in this.binders){let n=this.binders[r];(n instanceof nk||n instanceof nL||n instanceof nM)&&n.upload(i)}this.updatePaintBuffers()}destroy(){for(let i in this.binders){let r=this.binders[i];(r instanceof nk||r instanceof nL||r instanceof nM)&&r.destroy()}}}class nD{constructor(i,r,n=()=>!0){for(let o of(this.programConfigurations={},i))this.programConfigurations[o.id]=new nz(o,r,n);this.needsUpload=!1,this._featureMap=new nv,this._bufferOffset=0}populatePaintArrays(i,r,n,o,a,s){for(let n in this.programConfigurations)this.programConfigurations[n].populatePaintArrays(i,r,o,a,s);void 0!==r.id&&this._featureMap.add(r.id,n,this._bufferOffset,i),this._bufferOffset=i,this.needsUpload=!0}updatePaintArrays(i,r,n,o){for(let a of n)this.needsUpload=this.programConfigurations[a.id].updatePaintArrays(i,this._featureMap,r,a,o)||this.needsUpload}get(i){return this.programConfigurations[i]}upload(i){if(this.needsUpload){for(let r in this.programConfigurations)this.programConfigurations[r].upload(i);this.needsUpload=!1}}destroy(){for(let i in this.programConfigurations)this.programConfigurations[i].destroy()}}function nR(i,r,n){let o={"line-pattern":{source:ne,composite:ne},"fill-pattern":{source:ne,composite:ne},"fill-extrusion-pattern":{source:ne,composite:ne}}[i];return o&&o[n]||({color:{source:rL,composite:rH},number:{source:rV,composite:rL}})[r][n]}iW("ConstantBinder",nA),iW("CrossFadedConstantBinder",nP),iW("SourceExpressionBinder",nk),iW("CrossFadedCompositeBinder",nM),iW("CompositeExpressionBinder",nL),iW("ProgramConfiguration",nz,{omit:["_buffers"]}),iW("ProgramConfigurationSet",nD);let nB=-16383-1;function nO(i){let r=8192/i.extent,n=i.loadGeometry();for(let i=0;i<n.length;i++){let o=n[i];for(let i=0;i<o.length;i++){let n=o[i],a=Math.round(n.x*r),s=Math.round(n.y*r);n.x=l(a,nB,16383),n.y=l(s,nB,16383),(a<n.x||a>n.x+1||s<n.y||s>n.y+1)&&_("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return n}function nF(i,r){return{type:i.type,id:i.id,properties:i.properties,geometry:r?nO(i):[]}}function nN(i,r,n,o,a){i.emplaceBack(2*r+(o+1)/2,2*n+(a+1)/2)}class nU{constructor(i){this.zoom=i.zoom,this.overscaling=i.overscaling,this.layers=i.layers,this.layerIds=this.layers.map(i=>i.id),this.index=i.index,this.hasPattern=!1,this.layoutVertexArray=new r6,this.indexArray=new ns,this.segments=new nc,this.programConfigurations=new nD(i.layers,i.zoom),this.stateDependentLayerIds=this.layers.filter(i=>i.isStateDependent()).map(i=>i.id)}populate(i,r,n){let o=this.layers[0],a=[],s=null,l=!1;for(let{feature:r,id:u,index:h,sourceLayerIndex:c}of("circle"===o.type&&(l=!(s=o.layout.get("circle-sort-key")).isConstant()),i)){let i=this.layers[0]._featureFilter.needGeometry,o=nF(r,i);if(!this.layers[0]._featureFilter.filter(new ro(this.zoom),o,n))continue;let d=l?s.evaluate(o,{},n):void 0,p={id:u,properties:r.properties,type:r.type,sourceLayerIndex:c,index:h,geometry:i?o.geometry:nO(r),patterns:{},sortKey:d};a.push(p)}for(let o of(l&&a.sort((i,r)=>i.sortKey-r.sortKey),a)){let{geometry:a,index:s,sourceLayerIndex:l}=o,u=i[s].feature;this.addFeature(o,a,s,n),r.featureIndex.insert(u,a,s,l,this.index)}}update(i,r,n){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(i,r,this.stateDependentLayers,n)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(i){this.uploaded||(this.layoutVertexBuffer=i.createVertexBuffer(this.layoutVertexArray,nh),this.indexBuffer=i.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(i),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(i,r,n,o){for(let n of r)for(let r of n){let n=r.x,o=r.y;if(n<0||n>=8192||o<0||o>=8192)continue;let a=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,i.sortKey),s=a.vertexLength;nN(this.layoutVertexArray,n,o,-1,-1),nN(this.layoutVertexArray,n,o,1,-1),nN(this.layoutVertexArray,n,o,1,1),nN(this.layoutVertexArray,n,o,-1,1),this.indexArray.emplaceBack(s,s+1,s+2),this.indexArray.emplaceBack(s,s+3,s+2),a.vertexLength+=4,a.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,i,n,{},o)}}function nj(i,r){for(let n=0;n<i.length;n++)if(nW(r,i[n]))return!0;for(let n=0;n<r.length;n++)if(nW(i,r[n]))return!0;return!!nV(i,r)}function nZ(i,r){if(1===i.length)return n$(r,i[0]);for(let n=0;n<r.length;n++){let o=r[n];for(let r=0;r<o.length;r++)if(nW(i,o[r]))return!0}for(let n=0;n<i.length;n++)if(n$(r,i[n]))return!0;for(let n=0;n<r.length;n++)if(nV(i,r[n]))return!0;return!1}function nV(i,r){if(0===i.length||0===r.length)return!1;for(let a=0;a<i.length-1;a++){let s=i[a],l=i[a+1];for(let i=0;i<r.length-1;i++){var n,o;if(y(s,n=r[i],o=r[i+1])!==y(l,n,o)&&y(s,l,n)!==y(s,l,o))return!0}}return!1}function nq(i,r,n){let o=n*n;if(1===r.length)return i.distSqr(r[0])<o;for(let n=1;n<r.length;n++)if(nG(i,r[n-1],r[n])<o)return!0;return!1}function nG(i,r,n){let o=r.distSqr(n);if(0===o)return i.distSqr(r);let a=((i.x-r.x)*(n.x-r.x)+(i.y-r.y)*(n.y-r.y))/o;return i.distSqr(a<0?r:a>1?n:n.sub(r)._mult(a)._add(r))}function n$(i,r){let n,o,a,s=!1;for(let l=0;l<i.length;l++){n=i[l];for(let i=0,l=n.length-1;i<n.length;l=i++)o=n[i],a=n[l],o.y>r.y!=a.y>r.y&&r.x<(a.x-o.x)*(r.y-o.y)/(a.y-o.y)+o.x&&(s=!s)}return s}function nW(i,r){let n=!1;for(let o=0,a=i.length-1;o<i.length;a=o++){let s=i[o],l=i[a];s.y>r.y!=l.y>r.y&&r.x<(l.x-s.x)*(r.y-s.y)/(l.y-s.y)+s.x&&(n=!n)}return n}function nH(i,r,n){let o=r.paint.get(i).value;return"constant"===o.kind?o.value:n.programConfigurations.get(r.id).getMaxValue(i)}function nX(i){return Math.sqrt(i[0]*i[0]+i[1]*i[1])}function nK(i,r,n,o,a){if(!r[0]&&!r[1])return i;let s=I.convert(r)._mult(a);"viewport"===n&&s._rotate(-o);let l=[];for(let r=0;r<i.length;r++)l.push(i[r].sub(s));return l}iW("CircleBucket",nU,{omit:["layers"]});let nJ=new rv({"circle-sort-key":new rm(tn.layout_circle["circle-sort-key"])});var nY={paint:new rv({"circle-radius":new rm(tn.paint_circle["circle-radius"]),"circle-color":new rm(tn.paint_circle["circle-color"]),"circle-blur":new rm(tn.paint_circle["circle-blur"]),"circle-opacity":new rm(tn.paint_circle["circle-opacity"]),"circle-translate":new rf(tn.paint_circle["circle-translate"]),"circle-translate-anchor":new rf(tn.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new rf(tn.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new rf(tn.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new rm(tn.paint_circle["circle-stroke-width"]),"circle-stroke-color":new rm(tn.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new rm(tn.paint_circle["circle-stroke-opacity"])}),layout:nJ},nQ="undefined"!=typeof Float32Array?Float32Array:Array;function n0(){var i=new nQ(9);return nQ!=Float32Array&&(i[1]=0,i[2]=0,i[3]=0,i[5]=0,i[6]=0,i[7]=0),i[0]=1,i[4]=1,i[8]=1,i}function n1(i){return i[0]=1,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=1,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=1,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,i}function n2(i,r,n){var o=r[0],a=r[1],s=r[2],l=r[3],u=r[4],h=r[5],c=r[6],d=r[7],p=r[8],f=r[9],m=r[10],g=r[11],_=r[12],y=r[13],v=r[14],x=r[15],b=n[0],w=n[1],T=n[2],E=n[3];return i[0]=b*o+w*u+T*p+E*_,i[1]=b*a+w*h+T*f+E*y,i[2]=b*s+w*c+T*m+E*v,i[3]=b*l+w*d+T*g+E*x,i[4]=(b=n[4])*o+(w=n[5])*u+(T=n[6])*p+(E=n[7])*_,i[5]=b*a+w*h+T*f+E*y,i[6]=b*s+w*c+T*m+E*v,i[7]=b*l+w*d+T*g+E*x,i[8]=(b=n[8])*o+(w=n[9])*u+(T=n[10])*p+(E=n[11])*_,i[9]=b*a+w*h+T*f+E*y,i[10]=b*s+w*c+T*m+E*v,i[11]=b*l+w*d+T*g+E*x,i[12]=(b=n[12])*o+(w=n[13])*u+(T=n[14])*p+(E=n[15])*_,i[13]=b*a+w*h+T*f+E*y,i[14]=b*s+w*c+T*m+E*v,i[15]=b*l+w*d+T*g+E*x,i}function n3(){var i=new nQ(3);return nQ!=Float32Array&&(i[0]=0,i[1]=0,i[2]=0),i}function n5(i,r,n){var o=new nQ(3);return o[0]=i,o[1]=r,o[2]=n,o}function n4(i,r,n){var o=r[0],a=r[1],s=r[2],l=r[3];return i[0]=n[0]*o+n[4]*a+n[8]*s+n[12]*l,i[1]=n[1]*o+n[5]*a+n[9]*s+n[13]*l,i[2]=n[2]*o+n[6]*a+n[10]*s+n[14]*l,i[3]=n[3]*o+n[7]*a+n[11]*s+n[15]*l,i}function n6(){var i=new nQ(4);return nQ!=Float32Array&&(i[0]=0,i[1]=0,i[2]=0),i[3]=1,i}function n8(i,r){let n=n4([],[i.x,i.y,0,1],r);return new I(n[0]/n[3],n[1]/n[3])}Math.hypot||(Math.hypot=function(){for(var i=0,r=arguments.length;r--;)i+=arguments[r]*arguments[r];return Math.sqrt(i)}),n3(),aa=new nQ(4),nQ!=Float32Array&&(aa[0]=0,aa[1]=0,aa[2]=0,aa[3]=0),n3(),n5(1,0,0),n5(0,1,0),n6(),n6(),n0(),as=new nQ(2),nQ!=Float32Array&&(as[0]=0,as[1]=0);class n9 extends nU{}iW("HeatmapBucket",n9,{omit:["layers"]});var n7={paint:new rv({"heatmap-radius":new rm(tn.paint_heatmap["heatmap-radius"]),"heatmap-weight":new rm(tn.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new rf(tn.paint_heatmap["heatmap-intensity"]),"heatmap-color":new ry(tn.paint_heatmap["heatmap-color"]),"heatmap-opacity":new rf(tn.paint_heatmap["heatmap-opacity"])})};function ot(i,{width:r,height:n},o,a){if(a){if(a instanceof Uint8ClampedArray)a=new Uint8Array(a.buffer);else if(a.length!==r*n*o)throw RangeError(`mismatched image size. expected: ${a.length} but got: ${r*n*o}`)}else a=new Uint8Array(r*n*o);return i.width=r,i.height=n,i.data=a,i}function oe(i,{width:r,height:n},o){if(r===i.width&&n===i.height)return;let a=ot({},{width:r,height:n},o);oi(i,a,{x:0,y:0},{x:0,y:0},{width:Math.min(i.width,r),height:Math.min(i.height,n)},o),i.width=r,i.height=n,i.data=a.data}function oi(i,r,n,o,a,s){if(0===a.width||0===a.height)return r;if(a.width>i.width||a.height>i.height||n.x>i.width-a.width||n.y>i.height-a.height)throw RangeError("out of range source coordinates for image copy");if(a.width>r.width||a.height>r.height||o.x>r.width-a.width||o.y>r.height-a.height)throw RangeError("out of range destination coordinates for image copy");let l=i.data,u=r.data;if(l===u)throw Error("srcData equals dstData, so image is already copied");for(let h=0;h<a.height;h++){let c=((n.y+h)*i.width+n.x)*s,d=((o.y+h)*r.width+o.x)*s;for(let i=0;i<a.width*s;i++)u[d+i]=l[c+i]}return r}class or{constructor(i,r){ot(this,i,1,r)}resize(i){oe(this,i,1)}clone(){return new or({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(i,r,n,o,a){oi(i,r,n,o,a,1)}}class on{constructor(i,r){ot(this,i,4,r)}resize(i){oe(this,i,4)}replace(i,r){r?this.data.set(i):this.data=i instanceof Uint8ClampedArray?new Uint8Array(i.buffer):i}clone(){return new on({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(i,r,n,o,a){oi(i,r,n,o,a,4)}}function oo(i){let r={},n=i.resolution||256,o=i.clips?i.clips.length:1,a=i.image||new on({width:n,height:o});if(Math.log(n)/Math.LN2%1!=0)throw Error(`width is not a power of 2 - ${n}`);let s=(n,o,s)=>{r[i.evaluationKey]=s;let l=i.expression.evaluate(r);a.data[n+o+0]=Math.floor(255*l.r/l.a),a.data[n+o+1]=Math.floor(255*l.g/l.a),a.data[n+o+2]=Math.floor(255*l.b/l.a),a.data[n+o+3]=Math.floor(255*l.a)};if(i.clips)for(let r=0,a=0;r<o;++r,a+=4*n)for(let o=0,l=0;o<n;o++,l+=4){let u=o/(n-1),{start:h,end:c}=i.clips[r];s(a,l,h*(1-u)+c*u)}else for(let i=0,r=0;i<n;i++,r+=4)s(0,r,i/(n-1));return a}iW("AlphaImage",or),iW("RGBAImage",on);var oa={paint:new rv({"hillshade-illumination-direction":new rf(tn.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new rf(tn.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new rf(tn.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new rf(tn.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new rf(tn.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new rf(tn.paint_hillshade["hillshade-accent-color"])})};let os=rS([{name:"a_pos",components:2,type:"Int16"}],4),{members:ol}=os;var ou={exports:{}};function oh(i,r,n){n=n||2;var o,a,s,l,u,h,c,d=r&&r.length,p=d?r[0]*n:i.length,f=oc(i,0,p,n,!0),m=[];if(!f||f.next===f.prev)return m;if(d&&(f=function(i,r,n,o){var a,s,l,u=[];for(a=0,s=r.length;a<s;a++)(l=oc(i,r[a]*o,a<s-1?r[a+1]*o:i.length,o,!1))===l.next&&(l.steiner=!0),u.push(function(i){var r=i,n=i;do(r.x<n.x||r.x===n.x&&r.y<n.y)&&(n=r),r=r.next;while(r!==i)return n}(l));for(u.sort(op),a=0;a<u.length;a++)n=function(i,r){var n=function(i,r){var n,o,a,s=r,l=i.x,u=i.y,h=-1/0;do{if(u<=s.y&&u>=s.next.y&&s.next.y!==s.y){var c=s.x+(u-s.y)*(s.next.x-s.x)/(s.next.y-s.y);if(c<=l&&c>h&&(h=c,a=s.x<s.next.x?s:s.next,c===l))return a}s=s.next}while(s!==r)if(!a)return null;var d,p=a,f=a.x,m=a.y,g=1/0;s=a;do l>=s.x&&s.x>=f&&l!==s.x&&om(u<m?l:h,u,f,m,u<m?h:l,u,s.x,s.y)&&(d=Math.abs(u-s.y)/(l-s.x),ob(s,i)&&(d<g||d===g&&(s.x>a.x||s.x===a.x&&(n=a,o=s,0>og(n.prev,n,o.prev)&&0>og(o.next,n,n.next))))&&(a=s,g=d)),s=s.next;while(s!==p)return a}(i,r);if(!n)return r;var o=ow(n,i);return od(o,o.next),od(n,n.next)}(u[a],n);return n}(i,r,f,n)),i.length>80*n){o=s=i[0],a=l=i[1];for(var g=n;g<p;g+=n)(u=i[g])<o&&(o=u),(h=i[g+1])<a&&(a=h),u>s&&(s=u),h>l&&(l=h);c=0!==(c=Math.max(s-o,l-a))?32767/c:0}return function i(r,n,o,a,s,l,u){if(r){!u&&l&&function(i,r,n,o){var a=i;do 0===a.z&&(a.z=of(a.x,a.y,r,n,o)),a.prevZ=a.prev,a.nextZ=a.next,a=a.next;while(a!==i)a.prevZ.nextZ=null,a.prevZ=null,function(i){var r,n,o,a,s,l,u,h,c=1;do{for(n=i,i=null,s=null,l=0;n;){for(l++,o=n,u=0,r=0;r<c&&(u++,o=o.nextZ);r++);for(h=c;u>0||h>0&&o;)0!==u&&(0===h||!o||n.z<=o.z)?(a=n,n=n.nextZ,u--):(a=o,o=o.nextZ,h--),s?s.nextZ=a:i=a,a.prevZ=s,s=a;n=o}s.nextZ=null,c*=2}while(l>1)}(a)}(r,a,s,l);for(var h,c,d=r;r.prev!==r.next;)if(h=r.prev,c=r.next,l?function(i,r,n,o){var a=i.prev,s=i.next;if(og(a,i,s)>=0)return!1;for(var l=a.x,u=i.x,h=s.x,c=a.y,d=i.y,p=s.y,f=l<u?l<h?l:h:u<h?u:h,m=c<d?c<p?c:p:d<p?d:p,g=l>u?l>h?l:h:u>h?u:h,_=c>d?c>p?c:p:d>p?d:p,y=of(f,m,r,n,o),v=of(g,_,r,n,o),x=i.prevZ,b=i.nextZ;x&&x.z>=y&&b&&b.z<=v;){if(x.x>=f&&x.x<=g&&x.y>=m&&x.y<=_&&x!==a&&x!==s&&om(l,c,u,d,h,p,x.x,x.y)&&og(x.prev,x,x.next)>=0||(x=x.prevZ,b.x>=f&&b.x<=g&&b.y>=m&&b.y<=_&&b!==a&&b!==s&&om(l,c,u,d,h,p,b.x,b.y)&&og(b.prev,b,b.next)>=0))return!1;b=b.nextZ}for(;x&&x.z>=y;){if(x.x>=f&&x.x<=g&&x.y>=m&&x.y<=_&&x!==a&&x!==s&&om(l,c,u,d,h,p,x.x,x.y)&&og(x.prev,x,x.next)>=0)return!1;x=x.prevZ}for(;b&&b.z<=v;){if(b.x>=f&&b.x<=g&&b.y>=m&&b.y<=_&&b!==a&&b!==s&&om(l,c,u,d,h,p,b.x,b.y)&&og(b.prev,b,b.next)>=0)return!1;b=b.nextZ}return!0}(r,a,s,l):function(i){var r=i.prev,n=i.next;if(og(r,i,n)>=0)return!1;for(var o=r.x,a=i.x,s=n.x,l=r.y,u=i.y,h=n.y,c=o<a?o<s?o:s:a<s?a:s,d=l<u?l<h?l:h:u<h?u:h,p=o>a?o>s?o:s:a>s?a:s,f=l>u?l>h?l:h:u>h?u:h,m=n.next;m!==r;){if(m.x>=c&&m.x<=p&&m.y>=d&&m.y<=f&&om(o,l,a,u,s,h,m.x,m.y)&&og(m.prev,m,m.next)>=0)return!1;m=m.next}return!0}(r))n.push(h.i/o|0),n.push(r.i/o|0),n.push(c.i/o|0),oE(r),r=c.next,d=c.next;else if((r=c)===d){u?1===u?i(r=function(i,r,n){var o=i;do{var a=o.prev,s=o.next.next;!o_(a,s)&&oy(a,o,o.next,s)&&ob(a,s)&&ob(s,a)&&(r.push(a.i/n|0),r.push(o.i/n|0),r.push(s.i/n|0),oE(o),oE(o.next),o=i=s),o=o.next}while(o!==i)return od(o)}(od(r),n,o),n,o,a,s,l,2):2===u&&function(r,n,o,a,s,l){var u=r;do{for(var h,c,d=u.next.next;d!==u.prev;){if(u.i!==d.i&&(h=u,c=d,h.next.i!==c.i&&h.prev.i!==c.i&&!function(i,r){var n=i;do{if(n.i!==i.i&&n.next.i!==i.i&&n.i!==r.i&&n.next.i!==r.i&&oy(n,n.next,i,r))return!0;n=n.next}while(n!==i)return!1}(h,c)&&(ob(h,c)&&ob(c,h)&&function(i,r){var n=i,o=!1,a=(i.x+r.x)/2,s=(i.y+r.y)/2;do n.y>s!=n.next.y>s&&n.next.y!==n.y&&a<(n.next.x-n.x)*(s-n.y)/(n.next.y-n.y)+n.x&&(o=!o),n=n.next;while(n!==i)return o}(h,c)&&(og(h.prev,h,c.prev)||og(h,c.prev,c))||o_(h,c)&&og(h.prev,h,h.next)>0&&og(c.prev,c,c.next)>0))){var p=ow(u,d);return u=od(u,u.next),p=od(p,p.next),i(u,n,o,a,s,l,0),void i(p,n,o,a,s,l,0)}d=d.next}u=u.next}while(u!==r)}(r,n,o,a,s,l):i(od(r),n,o,a,s,l,1);break}}}(f,m,n,o,a,c,0),m}function oc(i,r,n,o,a){var s,l;if(a===oC(i,r,n,o)>0)for(s=r;s<n;s+=o)l=oT(s,i[s],i[s+1],l);else for(s=n-o;s>=r;s-=o)l=oT(s,i[s],i[s+1],l);return l&&o_(l,l.next)&&(oE(l),l=l.next),l}function od(i,r){if(!i)return i;r||(r=i);var n,o=i;do if(n=!1,o.steiner||!o_(o,o.next)&&0!==og(o.prev,o,o.next))o=o.next;else{if(oE(o),(o=r=o.prev)===o.next)break;n=!0}while(n||o!==r)return r}function op(i,r){return i.x-r.x}function of(i,r,n,o,a){return(i=1431655765&((i=858993459&((i=252645135&((i=16711935&((i=(i-n)*a|0)|i<<8))|i<<4))|i<<2))|i<<1))|(r=1431655765&((r=858993459&((r=252645135&((r=16711935&((r=(r-o)*a|0)|r<<8))|r<<4))|r<<2))|r<<1))<<1}function om(i,r,n,o,a,s,l,u){return(a-l)*(r-u)>=(i-l)*(s-u)&&(i-l)*(o-u)>=(n-l)*(r-u)&&(n-l)*(s-u)>=(a-l)*(o-u)}function og(i,r,n){return(r.y-i.y)*(n.x-r.x)-(r.x-i.x)*(n.y-r.y)}function o_(i,r){return i.x===r.x&&i.y===r.y}function oy(i,r,n,o){var a=ox(og(i,r,n)),s=ox(og(i,r,o)),l=ox(og(n,o,i)),u=ox(og(n,o,r));return a!==s&&l!==u||!(0!==a||!ov(i,n,r))||!(0!==s||!ov(i,o,r))||!(0!==l||!ov(n,i,o))||!(0!==u||!ov(n,r,o))}function ov(i,r,n){return r.x<=Math.max(i.x,n.x)&&r.x>=Math.min(i.x,n.x)&&r.y<=Math.max(i.y,n.y)&&r.y>=Math.min(i.y,n.y)}function ox(i){return i>0?1:i<0?-1:0}function ob(i,r){return 0>og(i.prev,i,i.next)?og(i,r,i.next)>=0&&og(i,i.prev,r)>=0:0>og(i,r,i.prev)||0>og(i,i.next,r)}function ow(i,r){var n=new oS(i.i,i.x,i.y),o=new oS(r.i,r.x,r.y),a=i.next,s=r.prev;return i.next=r,r.prev=i,n.next=a,a.prev=n,o.next=n,n.prev=o,s.next=o,o.prev=s,o}function oT(i,r,n,o){var a=new oS(i,r,n);return o?(a.next=o.next,a.prev=o,o.next.prev=a,o.next=a):(a.prev=a,a.next=a),a}function oE(i){i.next.prev=i.prev,i.prev.next=i.next,i.prevZ&&(i.prevZ.nextZ=i.nextZ),i.nextZ&&(i.nextZ.prevZ=i.prevZ)}function oS(i,r,n){this.i=i,this.x=r,this.y=n,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function oC(i,r,n,o){for(var a=0,s=r,l=n-o;s<n;s+=o)a+=(i[l]-i[s])*(i[s+1]+i[l+1]),l=s;return a}function oI(i,r,n){var o=i[r];i[r]=i[n],i[n]=o}function oA(i,r){return i<r?-1:i>r?1:0}function oP(i,r){let n,o;let a=i.length;if(a<=1)return[i];let s=[];for(let r=0;r<a;r++){let a=function(i){let r=0;for(let n,o,a=0,s=i.length,l=s-1;a<s;l=a++)n=i[a],r+=((o=i[l]).x-n.x)*(n.y+o.y);return r}(i[r]);0!==a&&(i[r].area=Math.abs(a),void 0===o&&(o=a<0),o===a<0?(n&&s.push(n),n=[i[r]]):n.push(i[r]))}if(n&&s.push(n),r>1)for(let i=0;i<s.length;i++){var l,u;s[i].length<=r||(l=s[i],u=s[i].length-1,function i(r,n,o,a,s){for(;a>o;){if(a-o>600){var l=a-o+1,u=n-o+1,h=Math.log(l),c=.5*Math.exp(2*h/3),d=.5*Math.sqrt(h*c*(l-c)/l)*(u-l/2<0?-1:1);i(r,n,Math.max(o,Math.floor(n-u*c/l+d)),Math.min(a,Math.floor(n+(l-u)*c/l+d)),s)}var p=r[n],f=o,m=a;for(oI(r,o,n),s(r[a],p)>0&&oI(r,o,a);f<m;){for(oI(r,f,m),f++,m--;0>s(r[f],p);)f++;for(;s(r[m],p)>0;)m--}0===s(r[o],p)?oI(r,o,m):oI(r,++m,a),m<=n&&(o=m+1),n<=m&&(a=m-1)}}(l,r,1,u||l.length-1,ok||oA),s[i]=s[i].slice(0,r))}return s}function ok(i,r){return r.area-i.area}function oL(i,r,n){let o=n.patternDependencies,a=!1;for(let n of r){let r=n.paint.get(`${i}-pattern`);r.isConstant()||(a=!0);let s=r.constantOr(null);s&&(a=!0,o[s.to]=!0,o[s.from]=!0)}return a}function oM(i,r,n,o,a){let s=a.patternDependencies;for(let l of r){let r=l.paint.get(`${i}-pattern`).value;if("constant"!==r.kind){let i=r.evaluate({zoom:o-1},n,{},a.availableImages),u=r.evaluate({zoom:o},n,{},a.availableImages),h=r.evaluate({zoom:o+1},n,{},a.availableImages);i=i&&i.name?i.name:i,u=u&&u.name?u.name:u,h=h&&h.name?h.name:h,s[i]=!0,s[u]=!0,s[h]=!0,n.patterns[l.id]={min:i,mid:u,max:h}}}return n}ou.exports=oh,ou.exports.default=oh,oh.deviation=function(i,r,n,o){var a=r&&r.length,s=Math.abs(oC(i,0,a?r[0]*n:i.length,n));if(a)for(var l=0,u=r.length;l<u;l++)s-=Math.abs(oC(i,r[l]*n,l<u-1?r[l+1]*n:i.length,n));var h=0;for(l=0;l<o.length;l+=3){var c=o[l]*n,d=o[l+1]*n,p=o[l+2]*n;h+=Math.abs((i[c]-i[p])*(i[d+1]-i[c+1])-(i[c]-i[d])*(i[p+1]-i[c+1]))}return 0===s&&0===h?0:Math.abs((h-s)/s)},oh.flatten=function(i){for(var r=i[0][0].length,n={vertices:[],holes:[],dimensions:r},o=0,a=0;a<i.length;a++){for(var s=0;s<i[a].length;s++)for(var l=0;l<r;l++)n.vertices.push(i[a][s][l]);a>0&&n.holes.push(o+=i[a-1].length)}return n};class oz{constructor(i){this.zoom=i.zoom,this.overscaling=i.overscaling,this.layers=i.layers,this.layerIds=this.layers.map(i=>i.id),this.index=i.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new r8,this.indexArray=new ns,this.indexArray2=new nl,this.programConfigurations=new nD(i.layers,i.zoom),this.segments=new nc,this.segments2=new nc,this.stateDependentLayerIds=this.layers.filter(i=>i.isStateDependent()).map(i=>i.id)}populate(i,r,n){this.hasPattern=oL("fill",this.layers,r);let o=this.layers[0].layout.get("fill-sort-key"),a=!o.isConstant(),s=[];for(let{feature:l,id:u,index:h,sourceLayerIndex:c}of i){let i=this.layers[0]._featureFilter.needGeometry,d=nF(l,i);if(!this.layers[0]._featureFilter.filter(new ro(this.zoom),d,n))continue;let p=a?o.evaluate(d,{},n,r.availableImages):void 0,f={id:u,properties:l.properties,type:l.type,sourceLayerIndex:c,index:h,geometry:i?d.geometry:nO(l),patterns:{},sortKey:p};s.push(f)}for(let o of(a&&s.sort((i,r)=>i.sortKey-r.sortKey),s)){let{geometry:a,index:s,sourceLayerIndex:l}=o;if(this.hasPattern){let i=oM("fill",this.layers,o,this.zoom,r);this.patternFeatures.push(i)}else this.addFeature(o,a,s,n,{});r.featureIndex.insert(i[s].feature,a,s,l,this.index)}}update(i,r,n){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(i,r,this.stateDependentLayers,n)}addFeatures(i,r,n){for(let i of this.patternFeatures)this.addFeature(i,i.geometry,i.index,r,n)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(i){this.uploaded||(this.layoutVertexBuffer=i.createVertexBuffer(this.layoutVertexArray,ol),this.indexBuffer=i.createIndexBuffer(this.indexArray),this.indexBuffer2=i.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(i),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(i,r,n,o,a){for(let i of oP(r,500)){let r=0;for(let n of i)r+=n.length;let n=this.segments.prepareSegment(r,this.layoutVertexArray,this.indexArray),o=n.vertexLength,a=[],s=[];for(let r of i){if(0===r.length)continue;r!==i[0]&&s.push(a.length/2);let n=this.segments2.prepareSegment(r.length,this.layoutVertexArray,this.indexArray2),o=n.vertexLength;this.layoutVertexArray.emplaceBack(r[0].x,r[0].y),this.indexArray2.emplaceBack(o+r.length-1,o),a.push(r[0].x),a.push(r[0].y);for(let i=1;i<r.length;i++)this.layoutVertexArray.emplaceBack(r[i].x,r[i].y),this.indexArray2.emplaceBack(o+i-1,o+i),a.push(r[i].x),a.push(r[i].y);n.vertexLength+=r.length,n.primitiveLength+=r.length}let l=ou.exports(a,s);for(let i=0;i<l.length;i+=3)this.indexArray.emplaceBack(o+l[i],o+l[i+1],o+l[i+2]);n.vertexLength+=r,n.primitiveLength+=l.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,i,n,a,o)}}iW("FillBucket",oz,{omit:["layers","patternFeatures"]});let oD=new rv({"fill-sort-key":new rm(tn.layout_fill["fill-sort-key"])});var oR={paint:new rv({"fill-antialias":new rf(tn.paint_fill["fill-antialias"]),"fill-opacity":new rm(tn.paint_fill["fill-opacity"]),"fill-color":new rm(tn.paint_fill["fill-color"]),"fill-outline-color":new rm(tn.paint_fill["fill-outline-color"]),"fill-translate":new rf(tn.paint_fill["fill-translate"]),"fill-translate-anchor":new rf(tn.paint_fill["fill-translate-anchor"]),"fill-pattern":new rg(tn.paint_fill["fill-pattern"])}),layout:oD};let oB=rS([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),oO=rS([{name:"a_centroid",components:2,type:"Int16"}],4),{members:oF}=oB;var oN={};function oU(i,r,n,o,a){this.properties={},this.extent=n,this.type=0,this._pbf=i,this._geometry=-1,this._keys=o,this._values=a,i.readFields(oj,this,r)}function oj(i,r,n){1==i?r.id=n.readVarint():2==i?function(i,r){for(var n=i.readVarint()+i.pos;i.pos<n;){var o=r._keys[i.readVarint()],a=r._values[i.readVarint()];r.properties[o]=a}}(n,r):3==i?r.type=n.readVarint():4==i&&(r._geometry=n.pos)}function oZ(i,r){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=i,this._keys=[],this._values=[],this._features=[],i.readFields(oV,this,r),this.length=this._features.length}function oV(i,r,n){15===i?r.version=n.readVarint():1===i?r.name=n.readString():5===i?r.extent=n.readVarint():2===i?r._features.push(n.pos):3===i?r._keys.push(n.readString()):4===i&&r._values.push(function(i){for(var r=null,n=i.readVarint()+i.pos;i.pos<n;){var o=i.readVarint()>>3;r=1===o?i.readString():2===o?i.readFloat():3===o?i.readDouble():4===o?i.readVarint64():5===o?i.readVarint():6===o?i.readSVarint():7===o?i.readBoolean():null}return r}(n))}function oq(i,r,n){if(3===i){var o=new oZ(n,n.readVarint()+n.pos);o.length&&(r[o.name]=o)}}oU.types=["Unknown","Point","LineString","Polygon"],oU.prototype.loadGeometry=function(){var i=this._pbf;i.pos=this._geometry;for(var r,n=i.readVarint()+i.pos,o=1,a=0,s=0,l=0,u=[];i.pos<n;){if(a<=0){var h=i.readVarint();o=7&h,a=h>>3}if(a--,1===o||2===o)s+=i.readSVarint(),l+=i.readSVarint(),1===o&&(r&&u.push(r),r=[]),r.push(new I(s,l));else{if(7!==o)throw Error("unknown command "+o);r&&r.push(r[0].clone())}}return r&&u.push(r),u},oU.prototype.bbox=function(){var i=this._pbf;i.pos=this._geometry;for(var r=i.readVarint()+i.pos,n=1,o=0,a=0,s=0,l=1/0,u=-1/0,h=1/0,c=-1/0;i.pos<r;){if(o<=0){var d=i.readVarint();n=7&d,o=d>>3}if(o--,1===n||2===n)(a+=i.readSVarint())<l&&(l=a),a>u&&(u=a),(s+=i.readSVarint())<h&&(h=s),s>c&&(c=s);else if(7!==n)throw Error("unknown command "+n)}return[l,h,u,c]},oU.prototype.toGeoJSON=function(i,r,n){var o,a,s=this.extent*Math.pow(2,n),l=this.extent*i,u=this.extent*r,h=this.loadGeometry(),c=oU.types[this.type];function d(i){for(var r=0;r<i.length;r++){var n=i[r];i[r]=[360*(n.x+l)/s-180,360/Math.PI*Math.atan(Math.exp((180-360*(n.y+u)/s)*Math.PI/180))-90]}}switch(this.type){case 1:var p=[];for(o=0;o<h.length;o++)p[o]=h[o][0];d(h=p);break;case 2:for(o=0;o<h.length;o++)d(h[o]);break;case 3:for(h=function(i){var r=i.length;if(r<=1)return[i];for(var n,o,a=[],s=0;s<r;s++){var l=function(i){for(var r,n,o=0,a=0,s=i.length,l=s-1;a<s;l=a++)o+=((n=i[l]).x-(r=i[a]).x)*(r.y+n.y);return o}(i[s]);0!==l&&(void 0===o&&(o=l<0),o===l<0?(n&&a.push(n),n=[i[s]]):n.push(i[s]))}return n&&a.push(n),a}(h),o=0;o<h.length;o++)for(a=0;a<h[o].length;a++)d(h[o][a])}1===h.length?h=h[0]:c="Multi"+c;var f={type:"Feature",geometry:{type:c,coordinates:h},properties:this.properties};return"id"in this&&(f.id=this.id),f},oZ.prototype.feature=function(i){if(i<0||i>=this._features.length)throw Error("feature index out of bounds");this._pbf.pos=this._features[i];var r=this._pbf.readVarint()+this._pbf.pos;return new oU(this._pbf,r,this.extent,this._keys,this._values)},oN.VectorTile=function(i,r){this.layers=i.readFields(oq,{},r)},oN.VectorTileFeature=oU,oN.VectorTileLayer=oZ;let oG=oN.VectorTileFeature.types;function o$(i,r,n,o,a,s,l,u){i.emplaceBack(r,n,2*Math.floor(8192*o)+l,16384*a,16384*s,Math.round(u))}class oW{constructor(i){this.zoom=i.zoom,this.overscaling=i.overscaling,this.layers=i.layers,this.layerIds=this.layers.map(i=>i.id),this.index=i.index,this.hasPattern=!1,this.layoutVertexArray=new r9,this.centroidVertexArray=new r4,this.indexArray=new ns,this.programConfigurations=new nD(i.layers,i.zoom),this.segments=new nc,this.stateDependentLayerIds=this.layers.filter(i=>i.isStateDependent()).map(i=>i.id)}populate(i,r,n){for(let{feature:o,id:a,index:s,sourceLayerIndex:l}of(this.features=[],this.hasPattern=oL("fill-extrusion",this.layers,r),i)){let i=this.layers[0]._featureFilter.needGeometry,u=nF(o,i);if(!this.layers[0]._featureFilter.filter(new ro(this.zoom),u,n))continue;let h={id:a,sourceLayerIndex:l,index:s,geometry:i?u.geometry:nO(o),properties:o.properties,type:o.type,patterns:{}};this.hasPattern?this.features.push(oM("fill-extrusion",this.layers,h,this.zoom,r)):this.addFeature(h,h.geometry,s,n,{}),r.featureIndex.insert(o,h.geometry,s,l,this.index,!0)}}addFeatures(i,r,n){for(let i of this.features){let{geometry:o}=i;this.addFeature(i,o,i.index,r,n)}}update(i,r,n){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(i,r,this.stateDependentLayers,n)}isEmpty(){return 0===this.layoutVertexArray.length&&0===this.centroidVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(i){this.uploaded||(this.layoutVertexBuffer=i.createVertexBuffer(this.layoutVertexArray,oF),this.centroidVertexBuffer=i.createVertexBuffer(this.centroidVertexArray,oO.members,!0),this.indexBuffer=i.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(i),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(i,r,n,o,a){let s={x:0,y:0,vertexCount:0};for(let n of oP(r,500)){let r=0;for(let i of n)r+=i.length;let o=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray);for(let i of n){var l;if(0===i.length||(l=i).every(i=>i.x<0)||l.every(i=>i.x>8192)||l.every(i=>i.y<0)||l.every(i=>i.y>8192))continue;let r=0;for(let n=0;n<i.length;n++){let a=i[n];if(n>=1){let l=i[n-1];if((a.x!==l.x||!(a.x<0)&&!(a.x>8192))&&(a.y!==l.y||!(a.y<0)&&!(a.y>8192))){o.vertexLength+4>nc.MAX_VERTEX_ARRAY_LENGTH&&(o=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));let i=a.sub(l)._perp()._unit(),n=l.dist(a);r+n>32768&&(r=0),o$(this.layoutVertexArray,a.x,a.y,i.x,i.y,0,0,r),o$(this.layoutVertexArray,a.x,a.y,i.x,i.y,0,1,r),s.x+=2*a.x,s.y+=2*a.y,s.vertexCount+=2,r+=n,o$(this.layoutVertexArray,l.x,l.y,i.x,i.y,0,0,r),o$(this.layoutVertexArray,l.x,l.y,i.x,i.y,0,1,r),s.x+=2*l.x,s.y+=2*l.y,s.vertexCount+=2;let u=o.vertexLength;this.indexArray.emplaceBack(u,u+2,u+1),this.indexArray.emplaceBack(u+1,u+2,u+3),o.vertexLength+=4,o.primitiveLength+=2}}}}if(o.vertexLength+r>nc.MAX_VERTEX_ARRAY_LENGTH&&(o=this.segments.prepareSegment(r,this.layoutVertexArray,this.indexArray)),"Polygon"!==oG[i.type])continue;let a=[],u=[],h=o.vertexLength;for(let i of n)if(0!==i.length){i!==n[0]&&u.push(a.length/2);for(let r=0;r<i.length;r++){let n=i[r];o$(this.layoutVertexArray,n.x,n.y,0,0,1,1,0),s.x+=n.x,s.y+=n.y,s.vertexCount+=1,a.push(n.x),a.push(n.y)}}let c=ou.exports(a,u);for(let i=0;i<c.length;i+=3)this.indexArray.emplaceBack(h+c[i],h+c[i+2],h+c[i+1]);o.primitiveLength+=c.length/3,o.vertexLength+=r}for(let i=0;i<s.vertexCount;i++)this.centroidVertexArray.emplaceBack(Math.floor(s.x/s.vertexCount),Math.floor(s.y/s.vertexCount));this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,i,n,a,o)}}iW("FillExtrusionBucket",oW,{omit:["layers","features"]});var oH={paint:new rv({"fill-extrusion-opacity":new rf(tn["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new rm(tn["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new rf(tn["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new rf(tn["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new rg(tn["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new rm(tn["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new rm(tn["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new rf(tn["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})};function oX(i,r){return i.x*r.x+i.y*r.y}function oK(i,r){if(1===i.length){let n,o=0,a=r[o++];for(;!n||a.equals(n);)if(!(n=r[o++]))return 1/0;for(;o<r.length;o++){let s=r[o],l=i[0],u=n.sub(a),h=s.sub(a),c=l.sub(a),d=oX(u,u),p=oX(u,h),f=oX(h,h),m=oX(c,u),g=oX(c,h),_=d*f-p*p,y=(f*m-p*g)/_,v=(d*g-p*m)/_,x=a.z*(1-y-v)+n.z*y+s.z*v;if(isFinite(x))return x}return 1/0}{let i=1/0;for(let n of r)i=Math.min(i,n.z);return i}}let oJ=rS([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:oY}=oJ,oQ=rS([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:o0}=oQ,o1=oN.VectorTileFeature.types,o2=Math.cos(Math.PI/180*37.5);class o3{constructor(i){this.zoom=i.zoom,this.overscaling=i.overscaling,this.layers=i.layers,this.layerIds=this.layers.map(i=>i.id),this.index=i.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(i=>{this.gradients[i.id]={}}),this.layoutVertexArray=new r7,this.layoutVertexArray2=new nt,this.indexArray=new ns,this.programConfigurations=new nD(i.layers,i.zoom),this.segments=new nc,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(i=>i.isStateDependent()).map(i=>i.id)}populate(i,r,n){this.hasPattern=oL("line",this.layers,r);let o=this.layers[0].layout.get("line-sort-key"),a=!o.isConstant(),s=[];for(let{feature:r,id:l,index:u,sourceLayerIndex:h}of i){let i=this.layers[0]._featureFilter.needGeometry,c=nF(r,i);if(!this.layers[0]._featureFilter.filter(new ro(this.zoom),c,n))continue;let d=a?o.evaluate(c,{},n):void 0,p={id:l,properties:r.properties,type:r.type,sourceLayerIndex:h,index:u,geometry:i?c.geometry:nO(r),patterns:{},sortKey:d};s.push(p)}for(let o of(a&&s.sort((i,r)=>i.sortKey-r.sortKey),s)){let{geometry:a,index:s,sourceLayerIndex:l}=o;if(this.hasPattern){let i=oM("line",this.layers,o,this.zoom,r);this.patternFeatures.push(i)}else this.addFeature(o,a,s,n,{});r.featureIndex.insert(i[s].feature,a,s,l,this.index)}}update(i,r,n){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(i,r,this.stateDependentLayers,n)}addFeatures(i,r,n){for(let i of this.patternFeatures)this.addFeature(i,i.geometry,i.index,r,n)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(i){this.uploaded||(0!==this.layoutVertexArray2.length&&(this.layoutVertexBuffer2=i.createVertexBuffer(this.layoutVertexArray2,o0)),this.layoutVertexBuffer=i.createVertexBuffer(this.layoutVertexArray,oY),this.indexBuffer=i.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(i),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(i){if(i.properties&&Object.prototype.hasOwnProperty.call(i.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(i.properties,"mapbox_clip_end"))return{start:+i.properties.mapbox_clip_start,end:+i.properties.mapbox_clip_end}}addFeature(i,r,n,o,a){let s=this.layers[0].layout,l=s.get("line-join").evaluate(i,{}),u=s.get("line-cap"),h=s.get("line-miter-limit"),c=s.get("line-round-limit");for(let n of(this.lineClips=this.lineFeatureClips(i),r))this.addLine(n,i,l,u,h,c);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,i,n,a,o)}addLine(i,r,n,o,a,s){let l,u,h,c,d;if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let r=0;r<i.length-1;r++)this.totalDistance+=i[r].dist(i[r+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}let p="Polygon"===o1[r.type],f=i.length;for(;f>=2&&i[f-1].equals(i[f-2]);)f--;let m=0;for(;m<f-1&&i[m].equals(i[m+1]);)m++;if(f<(p?3:2))return;"bevel"===n&&(a=1.05);let g=this.overscaling<=16?122880/(512*this.overscaling):0,_=this.segments.prepareSegment(10*f,this.layoutVertexArray,this.indexArray);this.e1=this.e2=-1,p&&(l=i[f-2],d=i[m].sub(l)._unit()._perp());for(let r=m;r<f;r++){if((h=r===f-1?p?i[m+1]:void 0:i[r+1])&&i[r].equals(h))continue;d&&(c=d),l&&(u=l),l=i[r],d=h?h.sub(l)._unit()._perp():c;let y=(c=c||d).add(d);0===y.x&&0===y.y||y._unit();let v=c.x*d.x+c.y*d.y,x=y.x*d.x+y.y*d.y,b=0!==x?1/x:1/0,w=2*Math.sqrt(2-2*x),T=x<o2&&u&&h,E=c.x*d.y-c.y*d.x>0;if(T&&r>m){let i=l.dist(u);if(i>2*g){let r=l.sub(l.sub(u)._mult(g/i)._round());this.updateDistance(u,r),this.addCurrentVertex(r,c,0,0,_),u=r}}let S=u&&h,C=S?n:p?"butt":o;if(S&&"round"===C&&(b<s?C="miter":b<=2&&(C="fakeround")),"miter"===C&&b>a&&(C="bevel"),"bevel"===C&&(b>2&&(C="flipbevel"),b<a&&(C="miter")),u&&this.updateDistance(u,l),"miter"===C)y._mult(b),this.addCurrentVertex(l,y,0,0,_);else if("flipbevel"===C){if(b>100)y=d.mult(-1);else{let i=b*c.add(d).mag()/c.sub(d).mag();y._perp()._mult(i*(E?-1:1))}this.addCurrentVertex(l,y,0,0,_),this.addCurrentVertex(l,y.mult(-1),0,0,_)}else if("bevel"===C||"fakeround"===C){let i=-Math.sqrt(b*b-1),r=E?i:0,n=E?0:i;if(u&&this.addCurrentVertex(l,c,r,n,_),"fakeround"===C){let i=Math.round(180*w/Math.PI/20);for(let r=1;r<i;r++){let n=r/i;if(.5!==n){let i=n-.5;n+=n*i*(n-1)*((1.0904+v*(v*(3.55645-1.43519*v)-3.2452))*i*i+(.848013+v*(.215638*v-1.06021)))}let o=d.sub(c)._mult(n)._add(c)._unit()._mult(E?-1:1);this.addHalfVertex(l,o.x,o.y,!1,E,0,_)}}h&&this.addCurrentVertex(l,d,-r,-n,_)}else if("butt"===C)this.addCurrentVertex(l,y,0,0,_);else if("square"===C){let i=u?1:-1;this.addCurrentVertex(l,y,i,i,_)}else"round"===C&&(u&&(this.addCurrentVertex(l,c,0,0,_),this.addCurrentVertex(l,c,1,1,_,!0)),h&&(this.addCurrentVertex(l,d,-1,-1,_,!0),this.addCurrentVertex(l,d,0,0,_)));if(T&&r<f-1){let i=l.dist(h);if(i>2*g){let r=l.add(h.sub(l)._mult(g/i)._round());this.updateDistance(l,r),this.addCurrentVertex(r,d,0,0,_),l=r}}}}addCurrentVertex(i,r,n,o,a,s=!1){let l=r.y*o-r.x,u=-r.y-r.x*o;this.addHalfVertex(i,r.x+r.y*n,r.y-r.x*n,s,!1,n,a),this.addHalfVertex(i,l,u,s,!0,-o,a),this.distance>16384&&0===this.totalDistance&&(this.distance=0,this.addCurrentVertex(i,r,n,o,a,s))}addHalfVertex({x:i,y:r},n,o,a,s,l,u){let h=.5*(this.lineClips?32767*this.scaledDistance:this.scaledDistance);this.layoutVertexArray.emplaceBack((i<<1)+(a?1:0),(r<<1)+(s?1:0),Math.round(63*n)+128,Math.round(63*o)+128,1+(0===l?0:l<0?-1:1)|(63&h)<<2,h>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);let c=u.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,c),u.primitiveLength++),s?this.e2=c:this.e1=c}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(i,r){this.distance+=i.dist(r),this.updateScaledDistance()}}iW("LineBucket",o3,{omit:["layers","patternFeatures"]});let o5=new rv({"line-cap":new rf(tn.layout_line["line-cap"]),"line-join":new rm(tn.layout_line["line-join"]),"line-miter-limit":new rf(tn.layout_line["line-miter-limit"]),"line-round-limit":new rf(tn.layout_line["line-round-limit"]),"line-sort-key":new rm(tn.layout_line["line-sort-key"])});var o4={paint:new rv({"line-opacity":new rm(tn.paint_line["line-opacity"]),"line-color":new rm(tn.paint_line["line-color"]),"line-translate":new rf(tn.paint_line["line-translate"]),"line-translate-anchor":new rf(tn.paint_line["line-translate-anchor"]),"line-width":new rm(tn.paint_line["line-width"]),"line-gap-width":new rm(tn.paint_line["line-gap-width"]),"line-offset":new rm(tn.paint_line["line-offset"]),"line-blur":new rm(tn.paint_line["line-blur"]),"line-dasharray":new r_(tn.paint_line["line-dasharray"]),"line-pattern":new rg(tn.paint_line["line-pattern"]),"line-gradient":new ry(tn.paint_line["line-gradient"])}),layout:o5};let o6=new class extends rm{possiblyEvaluate(i,r){return r=new ro(Math.floor(r.zoom),{now:r.now,fadeDuration:r.fadeDuration,zoomHistory:r.zoomHistory,transition:r.transition}),super.possiblyEvaluate(i,r)}evaluate(i,r,n,o){return r=h({},r,{zoom:Math.floor(r.zoom)}),super.evaluate(i,r,n,o)}}(o4.paint.properties["line-width"].specification);o6.useIntegerZoom=!0;let o8=rS([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),o9=rS([{name:"a_projected_pos",components:3,type:"Float32"}],4);rS([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);let o7=rS([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]);rS([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);let at=rS([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),ae=rS([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);rS([{name:"triangle",components:3,type:"Uint16"}]),rS([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),rS([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),rS([{type:"Float32",name:"offsetX"}]),rS([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]);let ai={"!":"ï¸","#":"ï¼",$:"ï¼","%":"ï¼","&":"ï¼","(":"ï¸µ",")":"ï¸¶","*":"ï¼","+":"ï¼",",":"ï¸","-":"ï¸²",".":"ã»","/":"ï¼",":":"ï¸",";":"ï¸","<":"ï¸¿","=":"ï¼",">":"ï¹","?":"ï¸","@":"ï¼ ","[":"ï¹","\\":"ï¼¼","]":"ï¹","^":"ï¼¾",_:"ï¸³","`":"ï½","{":"ï¸·","|":"â","}":"ï¸¸","~":"ï½","\xa2":"ï¿ ","\xa3":"ï¿¡","\xa5":"ï¿¥","\xa6":"ï¿¤","\xac":"ï¿¢","\xaf":"ï¿£","â":"ï¸²","â":"ï¸±","â":"ï¹","â":"ï¹","â":"ï¹","â":"ï¹","â¦":"ï¸","â§":"ã»","â©":"ï¿¦","ã":"ï¸","ã":"ï¸","ã":"ï¸¿","ã":"ï¹","ã":"ï¸½","ã":"ï¸¾","ã":"ï¹","ã":"ï¹","ã":"ï¹","ã":"ï¹","ã":"ï¸»","ã":"ï¸¼","ã":"ï¸¹","ã":"ï¸º","ã":"ï¸","ã":"ï¸","ï¼":"ï¸","ï¼":"ï¸µ","ï¼":"ï¸¶","ï¼":"ï¸","ï¼":"ï¸²","ï¼":"ã»","ï¼":"ï¸","ï¼":"ï¸","ï¼":"ï¸¿","ï¼":"ï¹","ï¼":"ï¸","ï¼»":"ï¹","ï¼½":"ï¹","ï¼¿":"ï¸³","ï½":"ï¸·","ï½":"â","ï½":"ï¸¸","ï½":"ï¸µ","ï½ ":"ï¸¶","ï½¡":"ï¸","ï½¢":"ï¹","ï½£":"ï¹"};var ar=function(i,r,n,o,a){var s,l,u=8*a-o-1,h=(1<<u)-1,c=h>>1,d=-7,p=n?a-1:0,f=n?-1:1,m=i[r+p];for(p+=f,s=m&(1<<-d)-1,m>>=-d,d+=u;d>0;s=256*s+i[r+p],p+=f,d-=8);for(l=s&(1<<-d)-1,s>>=-d,d+=o;d>0;l=256*l+i[r+p],p+=f,d-=8);if(0===s)s=1-c;else{if(s===h)return l?NaN:1/0*(m?-1:1);l+=Math.pow(2,o),s-=c}return(m?-1:1)*l*Math.pow(2,s-o)},an=function(i,r,n,o,a,s){var l,u,h,c=8*s-a-1,d=(1<<c)-1,p=d>>1,f=23===a?5960464477539062e-23:0,m=o?0:s-1,g=o?1:-1,_=r<0||0===r&&1/r<0?1:0;for(isNaN(r=Math.abs(r))||r===1/0?(u=isNaN(r)?1:0,l=d):(l=Math.floor(Math.log(r)/Math.LN2),r*(h=Math.pow(2,-l))<1&&(l--,h*=2),(r+=l+p>=1?f/h:f*Math.pow(2,1-p))*h>=2&&(l++,h/=2),l+p>=d?(u=0,l=d):l+p>=1?(u=(r*h-1)*Math.pow(2,a),l+=p):(u=r*Math.pow(2,p-1)*Math.pow(2,a),l=0));a>=8;i[n+m]=255&u,m+=g,u/=256,a-=8);for(l=l<<a|u,c+=a;c>0;i[n+m]=255&l,m+=g,l/=256,c-=8);i[n+m-g]|=128*_};function ao(i){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(i)?i:new Uint8Array(i||0),this.pos=0,this.type=0,this.length=this.buf.length}ao.Varint=0,ao.Fixed64=1,ao.Bytes=2,ao.Fixed32=5;var aa,as,al,au="undefined"==typeof TextDecoder?null:new TextDecoder("utf8");function ah(i){return i.type===ao.Bytes?i.readVarint()+i.pos:i.pos+1}function ac(i,r,n){var o=r<=16383?1:r<=2097151?2:r<=268435455?3:Math.floor(Math.log(r)/(7*Math.LN2));n.realloc(o);for(var a=n.pos-1;a>=i;a--)n.buf[a+o]=n.buf[a]}function ad(i,r){for(var n=0;n<i.length;n++)r.writeVarint(i[n])}function ap(i,r){for(var n=0;n<i.length;n++)r.writeSVarint(i[n])}function af(i,r){for(var n=0;n<i.length;n++)r.writeFloat(i[n])}function am(i,r){for(var n=0;n<i.length;n++)r.writeDouble(i[n])}function ag(i,r){for(var n=0;n<i.length;n++)r.writeBoolean(i[n])}function a_(i,r){for(var n=0;n<i.length;n++)r.writeFixed32(i[n])}function ay(i,r){for(var n=0;n<i.length;n++)r.writeSFixed32(i[n])}function av(i,r){for(var n=0;n<i.length;n++)r.writeFixed64(i[n])}function ax(i,r){for(var n=0;n<i.length;n++)r.writeSFixed64(i[n])}function ab(i,r){return(i[r]|i[r+1]<<8|i[r+2]<<16)+16777216*i[r+3]}function aw(i,r,n){i[n]=r,i[n+1]=r>>>8,i[n+2]=r>>>16,i[n+3]=r>>>24}function aT(i,r){return(i[r]|i[r+1]<<8|i[r+2]<<16)+(i[r+3]<<24)}function aE(i,r,n){1===i&&n.readMessage(aS,r)}function aS(i,r,n){if(3===i){let{id:i,bitmap:o,width:a,height:s,left:l,top:u,advance:h}=n.readMessage(aC,{});r.push({id:i,bitmap:new or({width:a+6,height:s+6},o),metrics:{width:a,height:s,left:l,top:u,advance:h}})}}function aC(i,r,n){1===i?r.id=n.readVarint():2===i?r.bitmap=n.readBytes():3===i?r.width=n.readVarint():4===i?r.height=n.readVarint():5===i?r.left=n.readSVarint():6===i?r.top=n.readSVarint():7===i&&(r.advance=n.readVarint())}function aI(i){let r=0,n=0;for(let o of i)r+=o.w*o.h,n=Math.max(n,o.w);i.sort((i,r)=>r.h-i.h);let o=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(r/.95)),n),h:1/0}],a=0,s=0;for(let r of i)for(let i=o.length-1;i>=0;i--){let n=o[i];if(!(r.w>n.w||r.h>n.h)){if(r.x=n.x,r.y=n.y,s=Math.max(s,r.y+r.h),a=Math.max(a,r.x+r.w),r.w===n.w&&r.h===n.h){let r=o.pop();i<o.length&&(o[i]=r)}else r.h===n.h?(n.x+=r.w,n.w-=r.w):(r.w===n.w||o.push({x:n.x+r.w,y:n.y,w:n.w-r.w,h:r.h}),n.y+=r.h,n.h-=r.h);break}}return{w:a,h:s,fill:r/(a*s)||0}}ao.prototype={destroy:function(){this.buf=null},readFields:function(i,r,n){for(n=n||this.length;this.pos<n;){var o=this.readVarint(),a=o>>3,s=this.pos;this.type=7&o,i(a,r,this),this.pos===s&&this.skip(o)}return r},readMessage:function(i,r){return this.readFields(i,r,this.readVarint()+this.pos)},readFixed32:function(){var i=ab(this.buf,this.pos);return this.pos+=4,i},readSFixed32:function(){var i=aT(this.buf,this.pos);return this.pos+=4,i},readFixed64:function(){var i=ab(this.buf,this.pos)+4294967296*ab(this.buf,this.pos+4);return this.pos+=8,i},readSFixed64:function(){var i=ab(this.buf,this.pos)+4294967296*aT(this.buf,this.pos+4);return this.pos+=8,i},readFloat:function(){var i=ar(this.buf,this.pos,!0,23,4);return this.pos+=4,i},readDouble:function(){var i=ar(this.buf,this.pos,!0,52,8);return this.pos+=8,i},readVarint:function(i){var r,n,o=this.buf;return r=127&(n=o[this.pos++]),n<128?r:(r|=(127&(n=o[this.pos++]))<<7,n<128?r:(r|=(127&(n=o[this.pos++]))<<14,n<128?r:(r|=(127&(n=o[this.pos++]))<<21,n<128?r:function(i,r,n){var o,a,s,l=n.buf;if(a=(112&(s=l[n.pos++]))>>4,s<128||(a|=(127&(s=l[n.pos++]))<<3,s<128)||(a|=(127&(s=l[n.pos++]))<<10,s<128)||(a|=(127&(s=l[n.pos++]))<<17,s<128)||(a|=(127&(s=l[n.pos++]))<<24,s<128)||(a|=(1&(s=l[n.pos++]))<<31,s<128))return o=a,r?4294967296*o+(i>>>0):4294967296*(o>>>0)+(i>>>0);throw Error("Expected varint not more than 10 bytes")}(r|=(15&(n=o[this.pos]))<<28,i,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var i=this.readVarint();return i%2==1?-((i+1)/2):i/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var i,r=this.readVarint()+this.pos,n=this.pos;return this.pos=r,r-n>=12&&au?(i=this.buf,au.decode(i.subarray(n,r))):function(i,r,n){for(var o="",a=r;a<n;){var s,l,u,h=i[a],c=null,d=h>239?4:h>223?3:h>191?2:1;if(a+d>n)break;1===d?h<128&&(c=h):2===d?128==(192&(s=i[a+1]))&&(c=(31&h)<<6|63&s)<=127&&(c=null):3===d?(l=i[a+2],128==(192&(s=i[a+1]))&&128==(192&l)&&((c=(15&h)<<12|(63&s)<<6|63&l)<=2047||c>=55296&&c<=57343)&&(c=null)):4===d&&(l=i[a+2],u=i[a+3],128==(192&(s=i[a+1]))&&128==(192&l)&&128==(192&u)&&((c=(15&h)<<18|(63&s)<<12|(63&l)<<6|63&u)<=65535||c>=1114112)&&(c=null)),null===c?(c=65533,d=1):c>65535&&(c-=65536,o+=String.fromCharCode(c>>>10&1023|55296),c=56320|1023&c),o+=String.fromCharCode(c),a+=d}return o}(this.buf,n,r)},readBytes:function(){var i=this.readVarint()+this.pos,r=this.buf.subarray(this.pos,i);return this.pos=i,r},readPackedVarint:function(i,r){if(this.type!==ao.Bytes)return i.push(this.readVarint(r));var n=ah(this);for(i=i||[];this.pos<n;)i.push(this.readVarint(r));return i},readPackedSVarint:function(i){if(this.type!==ao.Bytes)return i.push(this.readSVarint());var r=ah(this);for(i=i||[];this.pos<r;)i.push(this.readSVarint());return i},readPackedBoolean:function(i){if(this.type!==ao.Bytes)return i.push(this.readBoolean());var r=ah(this);for(i=i||[];this.pos<r;)i.push(this.readBoolean());return i},readPackedFloat:function(i){if(this.type!==ao.Bytes)return i.push(this.readFloat());var r=ah(this);for(i=i||[];this.pos<r;)i.push(this.readFloat());return i},readPackedDouble:function(i){if(this.type!==ao.Bytes)return i.push(this.readDouble());var r=ah(this);for(i=i||[];this.pos<r;)i.push(this.readDouble());return i},readPackedFixed32:function(i){if(this.type!==ao.Bytes)return i.push(this.readFixed32());var r=ah(this);for(i=i||[];this.pos<r;)i.push(this.readFixed32());return i},readPackedSFixed32:function(i){if(this.type!==ao.Bytes)return i.push(this.readSFixed32());var r=ah(this);for(i=i||[];this.pos<r;)i.push(this.readSFixed32());return i},readPackedFixed64:function(i){if(this.type!==ao.Bytes)return i.push(this.readFixed64());var r=ah(this);for(i=i||[];this.pos<r;)i.push(this.readFixed64());return i},readPackedSFixed64:function(i){if(this.type!==ao.Bytes)return i.push(this.readSFixed64());var r=ah(this);for(i=i||[];this.pos<r;)i.push(this.readSFixed64());return i},skip:function(i){var r=7&i;if(r===ao.Varint)for(;this.buf[this.pos++]>127;);else if(r===ao.Bytes)this.pos=this.readVarint()+this.pos;else if(r===ao.Fixed32)this.pos+=4;else{if(r!==ao.Fixed64)throw Error("Unimplemented type: "+r);this.pos+=8}},writeTag:function(i,r){this.writeVarint(i<<3|r)},realloc:function(i){for(var r=this.length||16;r<this.pos+i;)r*=2;if(r!==this.length){var n=new Uint8Array(r);n.set(this.buf),this.buf=n,this.length=r}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(i){this.realloc(4),aw(this.buf,i,this.pos),this.pos+=4},writeSFixed32:function(i){this.realloc(4),aw(this.buf,i,this.pos),this.pos+=4},writeFixed64:function(i){this.realloc(8),aw(this.buf,-1&i,this.pos),aw(this.buf,Math.floor(23283064365386963e-26*i),this.pos+4),this.pos+=8},writeSFixed64:function(i){this.realloc(8),aw(this.buf,-1&i,this.pos),aw(this.buf,Math.floor(23283064365386963e-26*i),this.pos+4),this.pos+=8},writeVarint:function(i){(i=+i||0)>268435455||i<0?function(i,r){var n,o,a,s,l;if(i>=0?(n=i%4294967296|0,o=i/4294967296|0):(o=~(-i/4294967296),4294967295^(n=~(-i%4294967296))?n=n+1|0:(n=0,o=o+1|0)),i>=18446744073709552e3||i<-18446744073709552e3)throw Error("Given varint doesn't fit into 10 bytes");r.realloc(10),a=n,r.buf[r.pos++]=127&a|128,a>>>=7,r.buf[r.pos++]=127&a|128,a>>>=7,r.buf[r.pos++]=127&a|128,a>>>=7,r.buf[r.pos++]=127&a|128,r.buf[r.pos]=127&(a>>>=7),l=(7&(s=o))<<4,r.buf[r.pos++]|=l|((s>>>=3)?128:0),s&&(r.buf[r.pos++]=127&s|((s>>>=7)?128:0),s&&(r.buf[r.pos++]=127&s|((s>>>=7)?128:0),s&&(r.buf[r.pos++]=127&s|((s>>>=7)?128:0),s&&(r.buf[r.pos++]=127&s|((s>>>=7)?128:0),s&&(r.buf[r.pos++]=127&s)))))}(i,this):(this.realloc(4),this.buf[this.pos++]=127&i|(i>127?128:0),i<=127||(this.buf[this.pos++]=127&(i>>>=7)|(i>127?128:0),i<=127||(this.buf[this.pos++]=127&(i>>>=7)|(i>127?128:0),i<=127||(this.buf[this.pos++]=i>>>7&127))))},writeSVarint:function(i){this.writeVarint(i<0?-(2*i)-1:2*i)},writeBoolean:function(i){this.writeVarint(!!i)},writeString:function(i){i=String(i),this.realloc(4*i.length),this.pos++;var r=this.pos;this.pos=function(i,r,n){for(var o,a,s=0;s<r.length;s++){if((o=r.charCodeAt(s))>55295&&o<57344){if(!a){o>56319||s+1===r.length?(i[n++]=239,i[n++]=191,i[n++]=189):a=o;continue}if(o<56320){i[n++]=239,i[n++]=191,i[n++]=189,a=o;continue}o=a-55296<<10|o-56320|65536,a=null}else a&&(i[n++]=239,i[n++]=191,i[n++]=189,a=null);o<128?i[n++]=o:(o<2048?i[n++]=o>>6|192:(o<65536?i[n++]=o>>12|224:(i[n++]=o>>18|240,i[n++]=o>>12&63|128),i[n++]=o>>6&63|128),i[n++]=63&o|128)}return n}(this.buf,i,this.pos);var n=this.pos-r;n>=128&&ac(r,n,this),this.pos=r-1,this.writeVarint(n),this.pos+=n},writeFloat:function(i){this.realloc(4),an(this.buf,i,this.pos,!0,23,4),this.pos+=4},writeDouble:function(i){this.realloc(8),an(this.buf,i,this.pos,!0,52,8),this.pos+=8},writeBytes:function(i){var r=i.length;this.writeVarint(r),this.realloc(r);for(var n=0;n<r;n++)this.buf[this.pos++]=i[n]},writeRawMessage:function(i,r){this.pos++;var n=this.pos;i(r,this);var o=this.pos-n;o>=128&&ac(n,o,this),this.pos=n-1,this.writeVarint(o),this.pos+=o},writeMessage:function(i,r,n){this.writeTag(i,ao.Bytes),this.writeRawMessage(r,n)},writePackedVarint:function(i,r){r.length&&this.writeMessage(i,ad,r)},writePackedSVarint:function(i,r){r.length&&this.writeMessage(i,ap,r)},writePackedBoolean:function(i,r){r.length&&this.writeMessage(i,ag,r)},writePackedFloat:function(i,r){r.length&&this.writeMessage(i,af,r)},writePackedDouble:function(i,r){r.length&&this.writeMessage(i,am,r)},writePackedFixed32:function(i,r){r.length&&this.writeMessage(i,a_,r)},writePackedSFixed32:function(i,r){r.length&&this.writeMessage(i,ay,r)},writePackedFixed64:function(i,r){r.length&&this.writeMessage(i,av,r)},writePackedSFixed64:function(i,r){r.length&&this.writeMessage(i,ax,r)},writeBytesField:function(i,r){this.writeTag(i,ao.Bytes),this.writeBytes(r)},writeFixed32Field:function(i,r){this.writeTag(i,ao.Fixed32),this.writeFixed32(r)},writeSFixed32Field:function(i,r){this.writeTag(i,ao.Fixed32),this.writeSFixed32(r)},writeFixed64Field:function(i,r){this.writeTag(i,ao.Fixed64),this.writeFixed64(r)},writeSFixed64Field:function(i,r){this.writeTag(i,ao.Fixed64),this.writeSFixed64(r)},writeVarintField:function(i,r){this.writeTag(i,ao.Varint),this.writeVarint(r)},writeSVarintField:function(i,r){this.writeTag(i,ao.Varint),this.writeSVarint(r)},writeStringField:function(i,r){this.writeTag(i,ao.Bytes),this.writeString(r)},writeFloatField:function(i,r){this.writeTag(i,ao.Fixed32),this.writeFloat(r)},writeDoubleField:function(i,r){this.writeTag(i,ao.Fixed64),this.writeDouble(r)},writeBooleanField:function(i,r){this.writeVarintField(i,!!r)}};class aA{constructor(i,{pixelRatio:r,version:n,stretchX:o,stretchY:a,content:s}){this.paddedRect=i,this.pixelRatio=r,this.stretchX=o,this.stretchY=a,this.content=s,this.version=n}get tl(){return[this.paddedRect.x+1,this.paddedRect.y+1]}get br(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]}}class aP{constructor(i,r){let n={},o={};this.haveRenderCallbacks=[];let a=[];this.addImages(i,n,a),this.addImages(r,o,a);let{w:s,h:l}=aI(a),u=new on({width:s||1,height:l||1});for(let r in i){let o=i[r],a=n[r].paddedRect;on.copy(o.data,u,{x:0,y:0},{x:a.x+1,y:a.y+1},o.data)}for(let i in r){let n=r[i],a=o[i].paddedRect,s=a.x+1,l=a.y+1,h=n.data.width,c=n.data.height;on.copy(n.data,u,{x:0,y:0},{x:s,y:l},n.data),on.copy(n.data,u,{x:0,y:c-1},{x:s,y:l-1},{width:h,height:1}),on.copy(n.data,u,{x:0,y:0},{x:s,y:l+c},{width:h,height:1}),on.copy(n.data,u,{x:h-1,y:0},{x:s-1,y:l},{width:1,height:c}),on.copy(n.data,u,{x:0,y:0},{x:s+h,y:l},{width:1,height:c})}this.image=u,this.iconPositions=n,this.patternPositions=o}addImages(i,r,n){for(let o in i){let a=i[o],s={x:0,y:0,w:a.data.width+2,h:a.data.height+2};n.push(s),r[o]=new aA(s,a),a.hasRenderCallback&&this.haveRenderCallbacks.push(o)}}patchUpdatedImages(i,r){for(let n in i.dispatchRenderCallbacks(this.haveRenderCallbacks),i.updatedImages)this.patchUpdatedImage(this.iconPositions[n],i.getImage(n),r),this.patchUpdatedImage(this.patternPositions[n],i.getImage(n),r)}patchUpdatedImage(i,r,n){if(!i||!r||i.version===r.version)return;i.version=r.version;let[o,a]=i.tl;n.update(r.data,void 0,{x:o,y:a})}}iW("ImagePosition",aA),iW("ImageAtlas",aP),i.WritingMode=void 0,(al=i.WritingMode||(i.WritingMode={}))[al.none=0]="none",al[al.horizontal=1]="horizontal",al[al.vertical=2]="vertical",al[al.horizontalOnly=3]="horizontalOnly";class ak{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(i,r){let n=new ak;return n.scale=i||1,n.fontStack=r,n}static forImage(i){let r=new ak;return r.imageName=i,r}}class aL{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(i,r){let n=new aL;for(let o=0;o<i.sections.length;o++){let a=i.sections[o];a.image?n.addImageSection(a):n.addTextSection(a,r)}return n}length(){return this.text.length}getSection(i){return this.sections[this.sectionIndex[i]]}getSectionIndex(i){return this.sectionIndex[i]}getCharCode(i){return this.text.charCodeAt(i)}verticalizePunctuation(){this.text=function(i){let r="";for(let n=0;n<i.length;n++){let o=i.charCodeAt(n+1)||null,a=i.charCodeAt(n-1)||null;r+=o&&i1(o)&&!ai[i[n+1]]||a&&i1(a)&&!ai[i[n-1]]||!ai[i[n]]?i[n]:ai[i[n]]}return r}(this.text)}trim(){let i=0;for(let r=0;r<this.text.length&&az[this.text.charCodeAt(r)];r++)i++;let r=this.text.length;for(let n=this.text.length-1;n>=0&&n>=i&&az[this.text.charCodeAt(n)];n--)r--;this.text=this.text.substring(i,r),this.sectionIndex=this.sectionIndex.slice(i,r)}substring(i,r){let n=new aL;return n.text=this.text.substring(i,r),n.sectionIndex=this.sectionIndex.slice(i,r),n.sections=this.sections,n}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((i,r)=>Math.max(i,this.sections[r].scale),0)}addTextSection(i,r){this.text+=i.text,this.sections.push(ak.forText(i.scale,i.fontStack||r));let n=this.sections.length-1;for(let r=0;r<i.text.length;++r)this.sectionIndex.push(n)}addImageSection(i){let r=i.image?i.image.name:"";if(0===r.length)return void _("Can't add FormattedSection with an empty image.");let n=this.getNextImageSectionCharCode();n?(this.text+=String.fromCharCode(n),this.sections.push(ak.forImage(r)),this.sectionIndex.push(this.sections.length-1)):_("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function aM(r,n,o,a,s,l,u,h,c,d,p,f,m,g,_,y){let v;let x=aL.fromFeature(r,s);f===i.WritingMode.vertical&&x.verticalizePunctuation();let{processBidirectionalText:b,processStyledBidirectionalText:w}=rn;if(b&&1===x.sections.length){v=[];let i=b(x.toString(),aF(x,d,l,n,a,g,_));for(let r of i){let i=new aL;i.text=r,i.sections=x.sections;for(let n=0;n<r.length;n++)i.sectionIndex.push(0);v.push(i)}}else if(w){v=[];let i=w(x.text,x.sectionIndex,aF(x,d,l,n,a,g,_));for(let r of i){let i=new aL;i.text=r[0],i.sectionIndex=r[1],i.sections=x.sections,v.push(i)}}else v=function(i,r){let n=[],o=i.text,a=0;for(let o of r)n.push(i.substring(a,o)),a=o;return a<o.length&&n.push(i.substring(a,o.length)),n}(x,aF(x,d,l,n,a,g,_));let T=[],E={positionedLines:T,text:x.toString(),top:p[1],bottom:p[1],left:p[0],right:p[0],writingMode:f,iconsInText:!1,verticalizable:!1};return function(r,n,o,a,s,l,u,h,c,d,p,f){let m=0,g=-17,_=0,y=0,v="right"===h?1:"left"===h?0:.5,x=0;for(let u of s){u.trim();let s=u.getMaxScale(),h=(s-1)*24,b={positionedGlyphs:[],lineOffset:0};r.positionedLines[x]=b;let w=b.positionedGlyphs,T=0;if(!u.length()){g+=l,++x;continue}for(let l=0;l<u.length();l++){let _=u.getSection(l),y=u.getSectionIndex(l),v=u.getCharCode(l),x=0,b=null,E=null,S=null,C=24,I=!(c===i.WritingMode.horizontal||!p&&!i0(v)||p&&(az[v]||iY.Arabic(v)||iY["Arabic Supplement"](v)||iY["Arabic Extended-A"](v)||iY["Arabic Presentation Forms-A"](v)||iY["Arabic Presentation Forms-B"](v)));if(_.imageName){let i=a[_.imageName];if(!i)continue;S=_.imageName,r.iconsInText=r.iconsInText||!0,E=i.paddedRect;let n=i.displaySize;_.scale=24*_.scale/f,b={width:n[0],height:n[1],left:1,top:-3,advance:I?n[1]:n[0]},x=h+(24-n[1]*_.scale),C=b.advance;let o=I?n[0]*_.scale-24*s:n[1]*_.scale-24*s;o>0&&o>T&&(T=o)}else{let i=o[_.fontStack],r=i&&i[v];if(r&&r.rect)E=r.rect,b=r.metrics;else{let i=n[_.fontStack],r=i&&i[v];if(!r)continue;b=r.metrics}x=(s-_.scale)*24}I?(r.verticalizable=!0,w.push({glyph:v,imageName:S,x:m,y:g+x,vertical:I,scale:_.scale,fontStack:_.fontStack,sectionIndex:y,metrics:b,rect:E}),m+=C*_.scale+d):(w.push({glyph:v,imageName:S,x:m,y:g+x,vertical:I,scale:_.scale,fontStack:_.fontStack,sectionIndex:y,metrics:b,rect:E}),m+=b.advance*_.scale+d)}0!==w.length&&(_=Math.max(m-d,_),function(i,r,n,o,a){if(!o&&!a)return;let s=i[n],l=(i[n].x+s.metrics.advance*s.scale)*o;for(let r=0;r<=n;r++)i[r].x-=l,i[r].y+=a}(w,0,w.length-1,v,T)),m=0;let E=l*s+T;b.lineOffset=Math.max(T,h),g+=E,y=Math.max(E,y),++x}let b=g- -17,{horizontalAlign:w,verticalAlign:T}=aN(u);(function(i,r,n,o,a,s,l,u,h){let c=(r-n)*a,d=0;for(let r of(d=s!==l?-u*o- -17:(-o*h+.5)*l,i))for(let i of r.positionedGlyphs)i.x+=c,i.y+=d})(r.positionedLines,v,w,T,_,y,l,b,s.length),r.top+=-T*b,r.bottom=r.top+b,r.left+=-w*_,r.right=r.left+_}(E,n,o,a,v,u,h,c,f,d,m,y),!function(i){for(let r of i)if(0!==r.positionedGlyphs.length)return!1;return!0}(T)&&E}let az={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},aD={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function aR(i,r,n,o,a,s){if(r.imageName){let i=o[r.imageName];return i?i.displaySize[0]*r.scale*24/s+a:0}{let o=n[r.fontStack],s=o&&o[i];return s?s.metrics.advance*r.scale+a:0}}function aB(i,r,n,o){let a=Math.pow(i-r,2);return o?i<r?a/2:2*a:a+Math.abs(n)*n}function aO(i,r,n,o,a,s){let l=null,u=aB(r,n,a,s);for(let i of o){let o=aB(r-i.x,n,a,s)+i.badness;o<=u&&(l=i,u=o)}return{index:i,x:r,priorBreak:l,badness:u}}function aF(i,r,n,o,a,s,l){if("point"!==s||!i)return[];let u=[],h=function(i,r,n,o,a,s){let l=0;for(let n=0;n<i.length();n++){let u=i.getSection(n);l+=aR(i.getCharCode(n),u,o,a,r,s)}return l/Math.max(1,Math.ceil(l/n))}(i,r,n,o,a,l),c=i.text.indexOf("â")>=0,d=0;for(let n=0;n<i.length();n++){let s=i.getSection(n),p=i.getCharCode(n);if(az[p]||(d+=aR(p,s,o,a,r,l)),n<i.length()-1){let r=!(p<11904||!(iY["Bopomofo Extended"](p)||iY.Bopomofo(p)||iY["CJK Compatibility Forms"](p)||iY["CJK Compatibility Ideographs"](p)||iY["CJK Compatibility"](p)||iY["CJK Radicals Supplement"](p)||iY["CJK Strokes"](p)||iY["CJK Symbols and Punctuation"](p)||iY["CJK Unified Ideographs Extension A"](p)||iY["CJK Unified Ideographs"](p)||iY["Enclosed CJK Letters and Months"](p)||iY["Halfwidth and Fullwidth Forms"](p)||iY.Hiragana(p)||iY["Ideographic Description Characters"](p)||iY["Kangxi Radicals"](p)||iY["Katakana Phonetic Extensions"](p)||iY.Katakana(p)||iY["Vertical Forms"](p)||iY["Yi Radicals"](p)||iY["Yi Syllables"](p)));(aD[p]||r||s.imageName)&&u.push(aO(n+1,d,h,u,function(i,r,n){let o=0;return 10===i&&(o-=1e4),n&&(o+=150),40!==i&&65288!==i||(o+=50),41!==r&&65289!==r||(o+=50),o}(p,i.getCharCode(n+1),r&&c),!1))}}return function i(r){return r?i(r.priorBreak).concat(r.index):[]}(aO(i.length(),d,h,u,0,!0))}function aN(i){let r=.5,n=.5;switch(i){case"right":case"top-right":case"bottom-right":r=1;break;case"left":case"top-left":case"bottom-left":r=0}switch(i){case"bottom":case"bottom-right":case"bottom-left":n=1;break;case"top":case"top-right":case"top-left":n=0}return{horizontalAlign:r,verticalAlign:n}}function aU(i,r,n,o,a,s){let l,u,h,c,d;let p=i.image;if(p.content){let i=p.content,r=p.pixelRatio||1;l=[i[0]/r,i[1]/r,p.displaySize[0]-i[2]/r,p.displaySize[1]-i[3]/r]}let f=r.left*s,m=r.right*s;"width"===n||"both"===n?(d=a[0]+f-o[3],h=a[0]+m+o[1]):h=(d=a[0]+(f+m-p.displaySize[0])/2)+p.displaySize[0];let g=r.top*s,_=r.bottom*s;return"height"===n||"both"===n?(u=a[1]+g-o[0],c=a[1]+_+o[2]):c=(u=a[1]+(g+_-p.displaySize[1])/2)+p.displaySize[1],{image:p,top:u,right:h,bottom:c,left:d,collisionPadding:l}}function aj(i,r){let{expression:n}=r;if("constant"===n.kind)return{kind:"constant",layoutSize:n.evaluate(new ro(i+1))};if("source"===n.kind)return{kind:"source"};{let{zoomStops:r,interpolationType:o}=n,a=0;for(;a<r.length&&r[a]<=i;)a++;let s=a=Math.max(0,a-1);for(;s<r.length&&r[s]<i+1;)s++;s=Math.min(r.length-1,s);let l=r[a],u=r[s];return"composite"===n.kind?{kind:"composite",minZoom:l,maxZoom:u,interpolationType:o}:{kind:"camera",minZoom:l,maxZoom:u,minSize:n.evaluate(new ro(l)),maxSize:n.evaluate(new ro(u)),interpolationType:o}}}class aZ extends I{constructor(i,r,n,o){super(i,r),this.angle=n,void 0!==o&&(this.segment=o)}clone(){return new aZ(this.x,this.y,this.angle,this.segment)}}function aV(i,r,n,o,a){if(void 0===r.segment)return!0;let s=r,l=r.segment+1,u=0;for(;u>-n/2;){if(--l<0)return!1;u-=i[l].dist(s),s=i[l]}u+=i[l].dist(i[l+1]),l++;let h=[],c=0;for(;u<n/2;){let r=i[l],n=i[l+1];if(!n)return!1;let s=i[l-1].angleTo(r)-r.angleTo(n);for(s=Math.abs((s+3*Math.PI)%(2*Math.PI)-Math.PI),h.push({distance:u,angleDelta:s}),c+=s;u-h[0].distance>o;)c-=h.shift().angleDelta;if(c>a)return!1;l++,u+=r.dist(n)}return!0}function aq(i){let r=0;for(let n=0;n<i.length-1;n++)r+=i[n].dist(i[n+1]);return r}function aG(i,r){return Math.max(i?i.right-i.left:0,r?r.right-r.left:0)}function a$(i,r,n,o,a){let s=[];for(let l=0;l<i.length;l++){let u;let h=i[l];for(let i=0;i<h.length-1;i++){let l=h[i],c=h[i+1];l.x<r&&c.x<r||(l.x<r?l=new I(r,l.y+(r-l.x)/(c.x-l.x)*(c.y-l.y))._round():c.x<r&&(c=new I(r,l.y+(r-l.x)/(c.x-l.x)*(c.y-l.y))._round()),l.y<n&&c.y<n||(l.y<n?l=new I(l.x+(n-l.y)/(c.y-l.y)*(c.x-l.x),n)._round():c.y<n&&(c=new I(l.x+(n-l.y)/(c.y-l.y)*(c.x-l.x),n)._round()),l.x>=o&&c.x>=o||(l.x>=o?l=new I(o,l.y+(o-l.x)/(c.x-l.x)*(c.y-l.y))._round():c.x>=o&&(c=new I(o,l.y+(o-l.x)/(c.x-l.x)*(c.y-l.y))._round()),l.y>=a&&c.y>=a||(l.y>=a?l=new I(l.x+(a-l.y)/(c.y-l.y)*(c.x-l.x),a)._round():c.y>=a&&(c=new I(l.x+(a-l.y)/(c.y-l.y)*(c.x-l.x),a)._round()),u&&l.equals(u[u.length-1])||(u=[l],s.push(u)),u.push(c)))))}}return s}function aW(i,r,n,o){let a=[],s=i.image,l=s.pixelRatio,u=s.paddedRect.w-2,h=s.paddedRect.h-2,c=i.right-i.left,d=i.bottom-i.top,p=s.stretchX||[[0,u]],f=s.stretchY||[[0,h]],m=(i,r)=>i+r[1]-r[0],g=p.reduce(m,0),_=f.reduce(m,0),y=u-g,v=h-_,x=0,b=g,w=0,T=_,E=0,S=y,C=0,A=v;if(s.content&&o){let i=s.content;x=aH(p,0,i[0]),w=aH(f,0,i[1]),b=aH(p,i[0],i[2]),T=aH(f,i[1],i[3]),E=i[0]-x,C=i[1]-w,S=i[2]-i[0]-b,A=i[3]-i[1]-T}let P=(o,a,u,h)=>{var p,f,m,y,v,P,k,M,z,D,R,B;let O=(o.stretch-x)/b*c+i.left,F=(m=o.fixed-E,m-S*o.stretch/g),N=(a.stretch-w)/T*d+i.top,U=(P=a.fixed-C,P-A*a.stretch/_),j=(u.stretch-x)/b*c+i.left,Z=(z=u.fixed-E,z-S*u.stretch/g),V=(h.stretch-w)/T*d+i.top,q=(B=h.fixed-C,B-A*h.stretch/_),G=new I(O,N),W=new I(j,N),H=new I(j,V),X=new I(O,V),K=new I(F/l,U/l),J=new I(Z/l,q/l),Y=r*Math.PI/180;if(Y){let i=Math.sin(Y),r=Math.cos(Y),n=[r,-i,i,r];G._matMult(n),W._matMult(n),X._matMult(n),H._matMult(n)}let Q=o.stretch+o.fixed,tt=a.stretch+a.fixed;return{tl:G,tr:W,bl:X,br:H,tex:{x:s.paddedRect.x+1+Q,y:s.paddedRect.y+1+tt,w:u.stretch+u.fixed-Q,h:h.stretch+h.fixed-tt},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:K,pixelOffsetBR:J,minFontScaleX:S/l/c,minFontScaleY:A/l/d,isSDF:n}};if(o&&(s.stretchX||s.stretchY)){let i=aX(p,y,g),r=aX(f,v,_);for(let n=0;n<i.length-1;n++){let o=i[n],s=i[n+1];for(let i=0;i<r.length-1;i++)a.push(P(o,r[i],s,r[i+1]))}}else a.push(P({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:u+1},{fixed:0,stretch:h+1}));return a}function aH(i,r,n){let o=0;for(let a of i)o+=Math.max(r,Math.min(n,a[1]))-Math.max(r,Math.min(n,a[0]));return o}function aX(i,r,n){let o=[{fixed:-1,stretch:0}];for(let[r,n]of i){let i=o[o.length-1];o.push({fixed:r-i.stretch,stretch:i.stretch}),o.push({fixed:r-i.stretch,stretch:i.stretch+(n-r)})}return o.push({fixed:r+1,stretch:n}),o}iW("Anchor",aZ);class aK{constructor(i,r,n,o,a,s,l,u,h,c){if(this.boxStartIndex=i.length,h){let i=s.top,r=s.bottom,n=s.collisionPadding;n&&(i-=n[1],r+=n[3]);let o=r-i;o>0&&(o=Math.max(10,o),this.circleDiameter=o)}else{let h=s.top*l-u[0],d=s.bottom*l+u[2],p=s.left*l-u[3],f=s.right*l+u[1],m=s.collisionPadding;if(m&&(p-=m[0]*l,h-=m[1]*l,f+=m[2]*l,d+=m[3]*l),c){let i=new I(p,h),r=new I(f,h),n=new I(p,d),o=new I(f,d),a=c*Math.PI/180;i._rotate(a),r._rotate(a),n._rotate(a),o._rotate(a),p=Math.min(i.x,r.x,n.x,o.x),f=Math.max(i.x,r.x,n.x,o.x),h=Math.min(i.y,r.y,n.y,o.y),d=Math.max(i.y,r.y,n.y,o.y)}i.emplaceBack(r.x,r.y,p,h,f,d,n,o,a)}this.boxEndIndex=i.length}}class aJ{constructor(i=[],r=aY){if(this.data=i,this.length=this.data.length,this.compare=r,this.length>0)for(let i=(this.length>>1)-1;i>=0;i--)this._down(i)}push(i){this.data.push(i),this.length++,this._up(this.length-1)}pop(){if(0===this.length)return;let i=this.data[0],r=this.data.pop();return this.length--,this.length>0&&(this.data[0]=r,this._down(0)),i}peek(){return this.data[0]}_up(i){let{data:r,compare:n}=this,o=r[i];for(;i>0;){let a=i-1>>1,s=r[a];if(n(o,s)>=0)break;r[i]=s,i=a}r[i]=o}_down(i){let{data:r,compare:n}=this,o=this.length>>1,a=r[i];for(;i<o;){let o=1+(i<<1),s=r[o],l=o+1;if(l<this.length&&0>n(r[l],s)&&(o=l,s=r[l]),n(s,a)>=0)break;r[i]=s,i=o}r[i]=a}}function aY(i,r){return i<r?-1:i>r?1:0}function aQ(i,r){return r.max-i.max}function a0(i,r,n,o){this.p=new I(i,r),this.h=n,this.d=function(i,r){let n=!1,o=1/0;for(let a=0;a<r.length;a++){let s=r[a];for(let r=0,a=s.length,l=a-1;r<a;l=r++){let a=s[r],u=s[l];a.y>i.y!=u.y>i.y&&i.x<(u.x-a.x)*(i.y-a.y)/(u.y-a.y)+a.x&&(n=!n),o=Math.min(o,nG(i,a,u))}}return(n?1:-1)*Math.sqrt(o)}(this.p,o),this.max=this.d+this.h*Math.SQRT2}let a1=Number.POSITIVE_INFINITY;function a2(i,r){return r[1]!==a1?function(i,r,n){let o=0,a=0;switch(r=Math.abs(r),n=Math.abs(n),i){case"top-right":case"top-left":case"top":a=n-7;break;case"bottom-right":case"bottom-left":case"bottom":a=7-n}switch(i){case"top-right":case"bottom-right":case"right":o=-r;break;case"top-left":case"bottom-left":case"left":o=r}return[o,a]}(i,r[0],r[1]):function(i,r){let n=0,o=0;r<0&&(r=0);let a=r/Math.sqrt(2);switch(i){case"top-right":case"top-left":o=a-7;break;case"bottom-right":case"bottom-left":o=7-a;break;case"bottom":o=7-r;break;case"top":o=r-7}switch(i){case"top-right":case"bottom-right":n=-a;break;case"top-left":case"bottom-left":n=a;break;case"left":n=r;break;case"right":n=-r}return[n,o]}(i,r[0])}function a3(i){switch(i){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function a5(i,r,n,o,a,s,l,u,h,c,d,p,f,m,g){let y=function(i,r,n,o,a,s,l,u){let h=o.layout.get("text-rotate").evaluate(s,{})*Math.PI/180,c=[];for(let i of r.positionedLines)for(let o of i.positionedGlyphs){if(!o.rect)continue;let s=o.rect||{},d=4,p=!0,f=1,m=0,g=(a||u)&&o.vertical,_=o.metrics.advance*o.scale/2;if(u&&r.verticalizable){let r=(o.scale-1)*24,n=(24-o.metrics.width*o.scale)/2;m=i.lineOffset/2-(o.imageName?-n:r)}if(o.imageName){let i=l[o.imageName];p=i.sdf,d=1/(f=i.pixelRatio)}let y=a?[o.x+_,o.y]:[0,0],v=a?[0,0]:[o.x+_+n[0],o.y+n[1]-m],x=[0,0];g&&(x=v,v=[0,0]);let b=(o.metrics.left-d)*o.scale-_+v[0],w=(-o.metrics.top-d)*o.scale+v[1],T=b+s.w*o.scale/f,E=w+s.h*o.scale/f,S=new I(b,w),C=new I(T,w),A=new I(b,E),P=new I(T,E);if(g){let i=new I(-_,_- -17),r=-Math.PI/2,n=12-_,a=new I(22-n,-(o.imageName?n:0)),s=new I(...x);S._rotateAround(r,i)._add(a)._add(s),C._rotateAround(r,i)._add(a)._add(s),A._rotateAround(r,i)._add(a)._add(s),P._rotateAround(r,i)._add(a)._add(s)}if(h){let i=Math.sin(h),r=Math.cos(h),n=[r,-i,i,r];S._matMult(n),C._matMult(n),A._matMult(n),P._matMult(n)}let k=new I(0,0),M=new I(0,0);c.push({tl:S,tr:C,bl:A,br:P,tex:s,writingMode:r.writingMode,glyphOffset:y,sectionIndex:o.sectionIndex,isSDF:p,pixelOffsetTL:k,pixelOffsetBR:M,minFontScaleX:0,minFontScaleY:0})}return c}(0,n,u,a,s,l,o,i.allowVerticalPlacement),v=i.textSizeData,x=null;for(let n of("source"===v.kind?(x=[128*a.layout.get("text-size").evaluate(l,{})])[0]>32640&&_(`${i.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`):"composite"===v.kind&&((x=[128*m.compositeTextSizes[0].evaluate(l,{},g),128*m.compositeTextSizes[1].evaluate(l,{},g)])[0]>32640||x[1]>32640)&&_(`${i.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`),i.addSymbols(i.text,y,x,u,s,l,c,r,h.lineStartIndex,h.lineLength,f,g),d))p[n]=i.text.placedSymbolArray.length-1;return 4*y.length}function a4(i){for(let r in i)return i[r];return null}let a6=oN.VectorTileFeature.types,a8=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function a9(i,r,n,o,a,s,l,u,h,c,d,p,f){let m=u?Math.min(32640,Math.round(u[0])):0,g=u?Math.min(32640,Math.round(u[1])):0;i.emplaceBack(r,n,Math.round(32*o),Math.round(32*a),s,l,(m<<1)+(h?1:0),g,16*c,16*d,256*p,256*f)}function a7(i,r,n){i.emplaceBack(r.x,r.y,n),i.emplaceBack(r.x,r.y,n),i.emplaceBack(r.x,r.y,n),i.emplaceBack(r.x,r.y,n)}class st{constructor(i){this.layoutVertexArray=new ni,this.indexArray=new ns,this.programConfigurations=i,this.segments=new nc,this.dynamicLayoutVertexArray=new nr,this.opacityVertexArray=new nn,this.placedSymbolArray=new rY}isEmpty(){return 0===this.layoutVertexArray.length&&0===this.indexArray.length&&0===this.dynamicLayoutVertexArray.length&&0===this.opacityVertexArray.length}upload(i,r,n,o){this.isEmpty()||(n&&(this.layoutVertexBuffer=i.createVertexBuffer(this.layoutVertexArray,o8.members),this.indexBuffer=i.createIndexBuffer(this.indexArray,r),this.dynamicLayoutVertexBuffer=i.createVertexBuffer(this.dynamicLayoutVertexArray,o9.members,!0),this.opacityVertexBuffer=i.createVertexBuffer(this.opacityVertexArray,a8,!0),this.opacityVertexBuffer.itemSize=1),(n||o)&&this.programConfigurations.upload(i))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}iW("SymbolBuffers",st);class se{constructor(i,r,n){this.layoutVertexArray=new i,this.layoutAttributes=r,this.indexArray=new n,this.segments=new nc,this.collisionVertexArray=new na}upload(i){this.layoutVertexBuffer=i.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=i.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=i.createVertexBuffer(this.collisionVertexArray,o7.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}iW("CollisionBuffers",se);class si{constructor(r){this.collisionBoxArray=r.collisionBoxArray,this.zoom=r.zoom,this.overscaling=r.overscaling,this.layers=r.layers,this.layerIds=this.layers.map(i=>i.id),this.index=r.index,this.pixelRatio=r.pixelRatio,this.sourceLayerIndex=r.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=n1([]),this.placementViewportMatrix=n1([]);let n=this.layers[0]._unevaluatedLayout._values;this.textSizeData=aj(this.zoom,n["text-size"]),this.iconSizeData=aj(this.zoom,n["icon-size"]);let o=this.layers[0].layout,a=o.get("symbol-sort-key"),s=o.get("symbol-z-order");this.canOverlap="never"!==ss(o,"text-overlap","text-allow-overlap")||"never"!==ss(o,"icon-overlap","icon-allow-overlap")||o.get("text-ignore-placement")||o.get("icon-ignore-placement"),this.sortFeaturesByKey="viewport-y"!==s&&!a.isConstant(),this.sortFeaturesByY=("viewport-y"===s||"auto"===s&&!this.sortFeaturesByKey)&&this.canOverlap,"point"===o.get("symbol-placement")&&(this.writingModes=o.get("text-writing-mode").map(r=>i.WritingMode[r])),this.stateDependentLayerIds=this.layers.filter(i=>i.isStateDependent()).map(i=>i.id),this.sourceID=r.sourceID}createArrays(){this.text=new st(new nD(this.layers,this.zoom,i=>/^text/.test(i))),this.icon=new st(new nD(this.layers,this.zoom,i=>/^icon/.test(i))),this.glyphOffsetArray=new r1,this.lineVertexArray=new r2,this.symbolInstances=new r0}calculateGlyphDependencies(i,r,n,o,a){for(let s=0;s<i.length;s++)if(r[i.charCodeAt(s)]=!0,(n||o)&&a){let n=ai[i.charAt(s)];n&&(r[n.charCodeAt(0)]=!0)}}populate(r,n,o){let a=this.layers[0],s=a.layout,l=s.get("text-font"),u=s.get("text-field"),h=s.get("icon-image"),c=("constant"!==u.value.kind||u.value.value instanceof tN&&!u.value.value.isEmpty()||u.value.value.toString().length>0)&&("constant"!==l.value.kind||l.value.value.length>0),d="constant"!==h.value.kind||!!h.value.value||Object.keys(h.parameters).length>0,p=s.get("symbol-sort-key");if(this.features=[],!c&&!d)return;let f=n.iconDependencies,m=n.glyphDependencies,g=n.availableImages,_=new ro(this.zoom);for(let{feature:n,id:u,index:h,sourceLayerIndex:y}of r){let r,v;let x=a._featureFilter.needGeometry,b=nF(n,x);if(!a._featureFilter.filter(_,b,o))continue;if(x||(b.geometry=nO(n)),c){let i=a.getValueAndResolveTokens("text-field",b,o,g),n=tN.factory(i);(function(i){for(let r of i.sections)if(function(i){for(let r of i)if(i2(r.charCodeAt(0)))return!0;return!1}(r.text))return!0;return!1})(n)&&(this.hasRTLText=!0),(!this.hasRTLText||"unavailable"===ri()||this.hasRTLText&&rn.isParsed())&&(r=function(i,r,n){return i.sections.forEach(i=>{i.text=function(i,r,n){let o=r.layout.get("text-transform").evaluate(n,{});return"uppercase"===o?i=i.toLocaleUpperCase():"lowercase"===o&&(i=i.toLocaleLowerCase()),rn.applyArabicShaping&&(i=rn.applyArabicShaping(i)),i}(i.text,r,n)}),i}(n,a,b))}if(d){let i=a.getValueAndResolveTokens("icon-image",b,o,g);v=i instanceof tj?i:tj.fromString(i)}if(!r&&!v)continue;let w=this.sortFeaturesByKey?p.evaluate(b,{},o):void 0;if(this.features.push({id:u,text:r,icon:v,index:h,sourceLayerIndex:y,geometry:b.geometry,properties:n.properties,type:a6[n.type],sortKey:w}),v&&(f[v.name]=!0),r){let n=l.evaluate(b,{},o).join(","),a="viewport"!==s.get("text-rotation-alignment")&&"point"!==s.get("symbol-placement");for(let o of(this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(i.WritingMode.vertical)>=0,r.sections))if(o.image)f[o.image.name]=!0;else{let i=iQ(r.toString()),s=o.fontStack||n,l=m[s]=m[s]||{};this.calculateGlyphDependencies(o.text,l,a,this.allowVerticalPlacement,i)}}}"line"===s.get("symbol-placement")&&(this.features=function(i){let r={},n={},o=[],a=0;function s(r){o.push(i[r]),a++}function l(i,r,a){let s=n[i];return delete n[i],n[r]=s,o[s].geometry[0].pop(),o[s].geometry[0]=o[s].geometry[0].concat(a[0]),s}function u(i,n,a){let s=r[n];return delete r[n],r[i]=s,o[s].geometry[0].shift(),o[s].geometry[0]=a[0].concat(o[s].geometry[0]),s}function h(i,r,n){let o=n?r[0][r[0].length-1]:r[0][0];return`${i}:${o.x}:${o.y}`}for(let c=0;c<i.length;c++){let d=i[c],p=d.geometry,f=d.text?d.text.toString():null;if(!f){s(c);continue}let m=h(f,p),g=h(f,p,!0);if(m in n&&g in r&&n[m]!==r[g]){let i=u(m,g,p),a=l(m,g,o[i].geometry);delete r[m],delete n[g],n[h(f,o[a].geometry,!0)]=a,o[i].geometry=null}else m in n?l(m,g,p):g in r?u(m,g,p):(s(c),r[m]=a-1,n[g]=a-1)}return o.filter(i=>i.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((i,r)=>i.sortKey-r.sortKey)}update(i,r,n){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(i,r,this.layers,n),this.icon.programConfigurations.updatePaintArrays(i,r,this.layers,n))}isEmpty(){return 0===this.symbolInstances.length&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(i){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(i),this.iconCollisionBox.upload(i)),this.text.upload(i,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(i,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(i,r){let n=this.lineVertexArray.length;if(void 0!==i.segment){let n=i.dist(r[i.segment+1]),o=i.dist(r[i.segment]),a={};for(let o=i.segment+1;o<r.length;o++)a[o]={x:r[o].x,y:r[o].y,tileUnitDistanceFromAnchor:n},o<r.length-1&&(n+=r[o+1].dist(r[o]));for(let n=i.segment||0;n>=0;n--)a[n]={x:r[n].x,y:r[n].y,tileUnitDistanceFromAnchor:o},n>0&&(o+=r[n-1].dist(r[n]));for(let i=0;i<r.length;i++){let r=a[i];this.lineVertexArray.emplaceBack(r.x,r.y,r.tileUnitDistanceFromAnchor)}}return{lineStartIndex:n,lineLength:this.lineVertexArray.length-n}}addSymbols(r,n,o,a,s,l,u,h,c,d,p,f){let m=r.indexArray,g=r.layoutVertexArray,_=r.segments.prepareSegment(4*n.length,g,m,this.canOverlap?l.sortKey:void 0),y=this.glyphOffsetArray.length,v=_.vertexLength,x=this.allowVerticalPlacement&&u===i.WritingMode.vertical?Math.PI/2:0,b=l.text&&l.text.sections;for(let i=0;i<n.length;i++){let{tl:a,tr:s,bl:u,br:c,tex:d,pixelOffsetTL:p,pixelOffsetBR:y,minFontScaleX:v,minFontScaleY:w,glyphOffset:T,isSDF:E,sectionIndex:S}=n[i],C=_.vertexLength,I=T[1];a9(g,h.x,h.y,a.x,I+a.y,d.x,d.y,o,E,p.x,p.y,v,w),a9(g,h.x,h.y,s.x,I+s.y,d.x+d.w,d.y,o,E,y.x,p.y,v,w),a9(g,h.x,h.y,u.x,I+u.y,d.x,d.y+d.h,o,E,p.x,y.y,v,w),a9(g,h.x,h.y,c.x,I+c.y,d.x+d.w,d.y+d.h,o,E,y.x,y.y,v,w),a7(r.dynamicLayoutVertexArray,h,x),m.emplaceBack(C,C+1,C+2),m.emplaceBack(C+1,C+2,C+3),_.vertexLength+=4,_.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(T[0]),i!==n.length-1&&S===n[i+1].sectionIndex||r.programConfigurations.populatePaintArrays(g.length,l,l.index,{},f,b&&b[S])}r.placedSymbolArray.emplaceBack(h.x,h.y,y,this.glyphOffsetArray.length-y,v,c,d,h.segment,o?o[0]:0,o?o[1]:0,a[0],a[1],u,0,!1,0,p)}_addCollisionDebugVertex(i,r,n,o,a,s){return r.emplaceBack(0,0),i.emplaceBack(n.x,n.y,o,a,Math.round(s.x),Math.round(s.y))}addCollisionDebugVertices(i,r,n,o,a,s,l){let u=a.segments.prepareSegment(4,a.layoutVertexArray,a.indexArray),h=u.vertexLength,c=a.layoutVertexArray,d=a.collisionVertexArray,p=l.anchorX,f=l.anchorY;this._addCollisionDebugVertex(c,d,s,p,f,new I(i,r)),this._addCollisionDebugVertex(c,d,s,p,f,new I(n,r)),this._addCollisionDebugVertex(c,d,s,p,f,new I(n,o)),this._addCollisionDebugVertex(c,d,s,p,f,new I(i,o)),u.vertexLength+=4;let m=a.indexArray;m.emplaceBack(h,h+1),m.emplaceBack(h+1,h+2),m.emplaceBack(h+2,h+3),m.emplaceBack(h+3,h),u.primitiveLength+=4}addDebugCollisionBoxes(i,r,n,o){for(let a=i;a<r;a++){let i=this.collisionBoxArray.get(a);this.addCollisionDebugVertices(i.x1,i.y1,i.x2,i.y2,o?this.textCollisionBox:this.iconCollisionBox,i.anchorPoint,n)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new se(no,at.members,nl),this.iconCollisionBox=new se(no,at.members,nl);for(let i=0;i<this.symbolInstances.length;i++){let r=this.symbolInstances.get(i);this.addDebugCollisionBoxes(r.textBoxStartIndex,r.textBoxEndIndex,r,!0),this.addDebugCollisionBoxes(r.verticalTextBoxStartIndex,r.verticalTextBoxEndIndex,r,!0),this.addDebugCollisionBoxes(r.iconBoxStartIndex,r.iconBoxEndIndex,r,!1),this.addDebugCollisionBoxes(r.verticalIconBoxStartIndex,r.verticalIconBoxEndIndex,r,!1)}}_deserializeCollisionBoxesForSymbol(i,r,n,o,a,s,l,u,h){let c={};for(let o=r;o<n;o++){let r=i.get(o);c.textBox={x1:r.x1,y1:r.y1,x2:r.x2,y2:r.y2,anchorPointX:r.anchorPointX,anchorPointY:r.anchorPointY},c.textFeatureIndex=r.featureIndex;break}for(let r=o;r<a;r++){let n=i.get(r);c.verticalTextBox={x1:n.x1,y1:n.y1,x2:n.x2,y2:n.y2,anchorPointX:n.anchorPointX,anchorPointY:n.anchorPointY},c.verticalTextFeatureIndex=n.featureIndex;break}for(let r=s;r<l;r++){let n=i.get(r);c.iconBox={x1:n.x1,y1:n.y1,x2:n.x2,y2:n.y2,anchorPointX:n.anchorPointX,anchorPointY:n.anchorPointY},c.iconFeatureIndex=n.featureIndex;break}for(let r=u;r<h;r++){let n=i.get(r);c.verticalIconBox={x1:n.x1,y1:n.y1,x2:n.x2,y2:n.y2,anchorPointX:n.anchorPointX,anchorPointY:n.anchorPointY},c.verticalIconFeatureIndex=n.featureIndex;break}return c}deserializeCollisionBoxes(i){this.collisionArrays=[];for(let r=0;r<this.symbolInstances.length;r++){let n=this.symbolInstances.get(r);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(i,n.textBoxStartIndex,n.textBoxEndIndex,n.verticalTextBoxStartIndex,n.verticalTextBoxEndIndex,n.iconBoxStartIndex,n.iconBoxEndIndex,n.verticalIconBoxStartIndex,n.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(i,r){let n=i.placedSymbolArray.get(r),o=n.vertexStartIndex+4*n.numGlyphs;for(let r=n.vertexStartIndex;r<o;r+=4)i.indexArray.emplaceBack(r,r+1,r+2),i.indexArray.emplaceBack(r+1,r+2,r+3)}getSortedSymbolIndexes(i){if(this.sortedAngle===i&&void 0!==this.symbolInstanceIndexes)return this.symbolInstanceIndexes;let r=Math.sin(i),n=Math.cos(i),o=[],a=[],s=[];for(let i=0;i<this.symbolInstances.length;++i){s.push(i);let l=this.symbolInstances.get(i);o.push(0|Math.round(r*l.anchorX+n*l.anchorY)),a.push(l.featureIndex)}return s.sort((i,r)=>o[i]-o[r]||a[r]-a[i]),s}addToSortKeyRanges(i,r){let n=this.sortKeyRanges[this.sortKeyRanges.length-1];n&&n.sortKey===r?n.symbolInstanceEnd=i+1:this.sortKeyRanges.push({sortKey:r,symbolInstanceStart:i,symbolInstanceEnd:i+1})}sortFeatures(i){if(this.sortFeaturesByY&&this.sortedAngle!==i&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){for(let r of(this.symbolInstanceIndexes=this.getSortedSymbolIndexes(i),this.sortedAngle=i,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[],this.symbolInstanceIndexes)){let i=this.symbolInstances.get(r);this.featureSortOrder.push(i.featureIndex),[i.rightJustifiedTextSymbolIndex,i.centerJustifiedTextSymbolIndex,i.leftJustifiedTextSymbolIndex].forEach((i,r,n)=>{i>=0&&n.indexOf(i)===r&&this.addIndicesForPlacedSymbol(this.text,i)}),i.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,i.verticalPlacedTextSymbolIndex),i.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,i.placedIconSymbolIndex),i.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,i.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}iW("SymbolBucket",si,{omit:["layers","collisionBoxArray","features","compareText"]}),si.MAX_GLYPHS=65535,si.addDynamicAttributes=a7;let sr=new rv({"symbol-placement":new rf(tn.layout_symbol["symbol-placement"]),"symbol-spacing":new rf(tn.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new rf(tn.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new rm(tn.layout_symbol["symbol-sort-key"]),"symbol-z-order":new rf(tn.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new rf(tn.layout_symbol["icon-allow-overlap"]),"icon-overlap":new rf(tn.layout_symbol["icon-overlap"]),"icon-ignore-placement":new rf(tn.layout_symbol["icon-ignore-placement"]),"icon-optional":new rf(tn.layout_symbol["icon-optional"]),"icon-rotation-alignment":new rf(tn.layout_symbol["icon-rotation-alignment"]),"icon-size":new rm(tn.layout_symbol["icon-size"]),"icon-text-fit":new rf(tn.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new rf(tn.layout_symbol["icon-text-fit-padding"]),"icon-image":new rm(tn.layout_symbol["icon-image"]),"icon-rotate":new rm(tn.layout_symbol["icon-rotate"]),"icon-padding":new rm(tn.layout_symbol["icon-padding"]),"icon-keep-upright":new rf(tn.layout_symbol["icon-keep-upright"]),"icon-offset":new rm(tn.layout_symbol["icon-offset"]),"icon-anchor":new rm(tn.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new rf(tn.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new rf(tn.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new rf(tn.layout_symbol["text-rotation-alignment"]),"text-field":new rm(tn.layout_symbol["text-field"]),"text-font":new rm(tn.layout_symbol["text-font"]),"text-size":new rm(tn.layout_symbol["text-size"]),"text-max-width":new rm(tn.layout_symbol["text-max-width"]),"text-line-height":new rf(tn.layout_symbol["text-line-height"]),"text-letter-spacing":new rm(tn.layout_symbol["text-letter-spacing"]),"text-justify":new rm(tn.layout_symbol["text-justify"]),"text-radial-offset":new rm(tn.layout_symbol["text-radial-offset"]),"text-variable-anchor":new rf(tn.layout_symbol["text-variable-anchor"]),"text-anchor":new rm(tn.layout_symbol["text-anchor"]),"text-max-angle":new rf(tn.layout_symbol["text-max-angle"]),"text-writing-mode":new rf(tn.layout_symbol["text-writing-mode"]),"text-rotate":new rm(tn.layout_symbol["text-rotate"]),"text-padding":new rf(tn.layout_symbol["text-padding"]),"text-keep-upright":new rf(tn.layout_symbol["text-keep-upright"]),"text-transform":new rm(tn.layout_symbol["text-transform"]),"text-offset":new rm(tn.layout_symbol["text-offset"]),"text-allow-overlap":new rf(tn.layout_symbol["text-allow-overlap"]),"text-overlap":new rf(tn.layout_symbol["text-overlap"]),"text-ignore-placement":new rf(tn.layout_symbol["text-ignore-placement"]),"text-optional":new rf(tn.layout_symbol["text-optional"])});var sn={paint:new rv({"icon-opacity":new rm(tn.paint_symbol["icon-opacity"]),"icon-color":new rm(tn.paint_symbol["icon-color"]),"icon-halo-color":new rm(tn.paint_symbol["icon-halo-color"]),"icon-halo-width":new rm(tn.paint_symbol["icon-halo-width"]),"icon-halo-blur":new rm(tn.paint_symbol["icon-halo-blur"]),"icon-translate":new rf(tn.paint_symbol["icon-translate"]),"icon-translate-anchor":new rf(tn.paint_symbol["icon-translate-anchor"]),"text-opacity":new rm(tn.paint_symbol["text-opacity"]),"text-color":new rm(tn.paint_symbol["text-color"],{runtimeType:tg,getOverride:i=>i.textColor,hasOverride:i=>!!i.textColor}),"text-halo-color":new rm(tn.paint_symbol["text-halo-color"]),"text-halo-width":new rm(tn.paint_symbol["text-halo-width"]),"text-halo-blur":new rm(tn.paint_symbol["text-halo-blur"]),"text-translate":new rf(tn.paint_symbol["text-translate"]),"text-translate-anchor":new rf(tn.paint_symbol["text-translate-anchor"])}),layout:sr};class so{constructor(i){if(void 0===i.property.overrides)throw Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=i.property.overrides?i.property.overrides.runtimeType:td,this.defaultValue=i}evaluate(i){if(i.formattedSection){let r=this.defaultValue.property.overrides;if(r&&r.hasOverride(i.formattedSection))return r.getOverride(i.formattedSection)}return i.feature&&i.featureState?this.defaultValue.evaluate(i.feature,i.featureState):this.defaultValue.property.specification.default}eachChild(i){this.defaultValue.isConstant()||i(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}iW("FormatSectionOverride",so,{omit:["defaultValue"]});class sa extends rb{constructor(i){super(i,sn)}recalculate(i,r){if(super.recalculate(i,r),"auto"===this.layout.get("icon-rotation-alignment")&&(this.layout._values["icon-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-rotation-alignment")&&(this.layout._values["text-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-pitch-alignment")&&(this.layout._values["text-pitch-alignment"]="map"===this.layout.get("text-rotation-alignment")?"map":"viewport"),"auto"===this.layout.get("icon-pitch-alignment")&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),"point"===this.layout.get("symbol-placement")){let i=this.layout.get("text-writing-mode");if(i){let r=[];for(let n of i)0>r.indexOf(n)&&r.push(n);this.layout._values["text-writing-mode"]=r}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(i,r,n,o){var a;let s=this.layout.get(i).evaluate(r,{},n,o),l=this._unevaluatedLayout._values[i];return l.isDataDriven()||ir(l.value)||!s?s:(a=r.properties,s.replace(/{([^{}]+)}/g,(i,r)=>r in a?String(a[r]):""))}createBucket(i){return new si(i)}queryRadius(){return 0}queryIntersectsFeature(){throw Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(let i of sn.paint.overridableProperties){if(!sa.hasPaintOverride(this.layout,i))continue;let r=this.paint.get(i),n=new so(r),o=new ii(n,r.property.specification),a=null;a="constant"===r.value.kind||"source"===r.value.kind?new ia("source",o):new is("composite",o,r.value.zoomStops),this.paint._values[i]=new rd(r.property,a,r.parameters)}}_handleOverridablePaintPropertyUpdate(i,r,n){return!(!this.layout||r.isDataDriven()||n.isDataDriven())&&sa.hasPaintOverride(this.layout,i)}static hasPaintOverride(i,r){let n=i.get("text-field"),o=sn.paint.properties[r],a=!1,s=i=>{for(let r of i)if(o.overrides&&o.overrides.hasOverride(r))return void(a=!0)};if("constant"===n.value.kind&&n.value.value instanceof tN)s(n.value.value.sections);else if("source"===n.value.kind){let i=r=>{a||(r instanceof t$&&tq(r.value)===tx?s(r.value.sections):r instanceof e$?s(r.sections):r.eachChild(i))},r=n.value;r._styleExpression&&i(r._styleExpression.expression)}return a}}function ss(i,r,n){let o="never",a=i.get(r);return a?o=a:i.get(n)&&(o="always"),o}var sl={paint:new rv({"background-color":new rf(tn.paint_background["background-color"]),"background-pattern":new r_(tn.paint_background["background-pattern"]),"background-opacity":new rf(tn.paint_background["background-opacity"])})},su={paint:new rv({"raster-opacity":new rf(tn.paint_raster["raster-opacity"]),"raster-hue-rotate":new rf(tn.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new rf(tn.paint_raster["raster-brightness-min"]),"raster-brightness-max":new rf(tn.paint_raster["raster-brightness-max"]),"raster-saturation":new rf(tn.paint_raster["raster-saturation"]),"raster-contrast":new rf(tn.paint_raster["raster-contrast"]),"raster-resampling":new rf(tn.paint_raster["raster-resampling"]),"raster-fade-duration":new rf(tn.paint_raster["raster-fade-duration"])})};class sh extends rb{constructor(i){super(i,{}),this.onAdd=i=>{this.implementation.onAdd&&this.implementation.onAdd(i,i.painter.context.gl)},this.onRemove=i=>{this.implementation.onRemove&&this.implementation.onRemove(i,i.painter.context.gl)},this.implementation=i}is3D(){return"3d"===this.implementation.renderingMode}hasOffscreenPass(){return void 0!==this.implementation.prerender}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw Error("Custom layers cannot be serialized")}}let sc={circle:class extends rb{constructor(i){super(i,nY)}createBucket(i){return new nU(i)}queryRadius(i){return nH("circle-radius",this,i)+nH("circle-stroke-width",this,i)+nX(this.paint.get("circle-translate"))}queryIntersectsFeature(i,r,n,o,a,s,l,u){var h;let c=nK(i,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),s.angle,l),d=this.paint.get("circle-radius").evaluate(r,n)+this.paint.get("circle-stroke-width").evaluate(r,n),p="map"===this.paint.get("circle-pitch-alignment"),f=p?c:c.map(i=>n8(i,u)),m=p?d*l:d;for(let i of o)for(let r of i){let i=p?r:n8(r,u),n=m,o=n4([],[r.x,r.y,0,1],u);if("viewport"===this.paint.get("circle-pitch-scale")&&"map"===this.paint.get("circle-pitch-alignment")?n*=o[3]/s.cameraToCenterDistance:"map"===this.paint.get("circle-pitch-scale")&&"viewport"===this.paint.get("circle-pitch-alignment")&&(n*=s.cameraToCenterDistance/o[3]),h=n,nW(f,i)||nq(i,f,h))return!0}return!1}},heatmap:class extends rb{constructor(i){super(i,n7),this._updateColorRamp()}createBucket(i){return new n9(i)}_handleSpecialPaintPropertyUpdate(i){"heatmap-color"===i&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=oo({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(){return 0}queryIntersectsFeature(){return!1}hasOffscreenPass(){return 0!==this.paint.get("heatmap-opacity")&&"none"!==this.visibility}},hillshade:class extends rb{constructor(i){super(i,oa)}hasOffscreenPass(){return 0!==this.paint.get("hillshade-exaggeration")&&"none"!==this.visibility}},fill:class extends rb{constructor(i){super(i,oR)}recalculate(i,r){super.recalculate(i,r);let n=this.paint._values["fill-outline-color"];"constant"===n.value.kind&&void 0===n.value.value&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(i){return new oz(i)}queryRadius(){return nX(this.paint.get("fill-translate"))}queryIntersectsFeature(i,r,n,o,a,s,l){return nZ(nK(i,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),s.angle,l),o)}isTileClipped(){return!0}},"fill-extrusion":class extends rb{constructor(i){super(i,oH)}createBucket(i){return new oW(i)}queryRadius(){return nX(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature(i,r,n,o,a,s,l,u){let h=nK(i,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),s.angle,l),c=this.paint.get("fill-extrusion-height").evaluate(r,n),d=this.paint.get("fill-extrusion-base").evaluate(r,n),p=function(i,r,n,o){let a=[];for(let n of i){let i=[n.x,n.y,0,1];n4(i,i,r),a.push(new I(i[0]/i[3],i[1]/i[3]))}return a}(h,u),f=function(i,r,n,o){let a=[],s=[],l=o[8]*r,u=o[9]*r,h=o[10]*r,c=o[11]*r,d=o[8]*n,p=o[9]*n,f=o[10]*n,m=o[11]*n;for(let r of i){let i=[],n=[];for(let a of r){let r=a.x,s=a.y,g=o[0]*r+o[4]*s+o[12],_=o[1]*r+o[5]*s+o[13],y=o[2]*r+o[6]*s+o[14],v=o[3]*r+o[7]*s+o[15],x=y+h,b=v+c,w=g+d,T=_+p,E=y+f,S=v+m,C=new I((g+l)/b,(_+u)/b);C.z=x/b,i.push(C);let A=new I(w/S,T/S);A.z=E/S,n.push(A)}a.push(i),s.push(n)}return[a,s]}(o,d,c,u);return function(i,r,n){let o=1/0;nZ(n,r)&&(o=oK(n,r[0]));for(let a=0;a<r.length;a++){let s=r[a],l=i[a];for(let i=0;i<s.length-1;i++){let r=s[i],a=[r,s[i+1],l[i+1],l[i],r];nj(n,a)&&(o=Math.min(o,oK(n,a)))}}return o!==1/0&&o}(f[0],f[1],p)}},line:class extends rb{constructor(i){super(i,o4),this.gradientVersion=0}_handleSpecialPaintPropertyUpdate(i){"line-gradient"===i&&(this.stepInterpolant=this._transitionablePaint._values["line-gradient"].value.expression._styleExpression.expression instanceof eu,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER)}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(i,r){super.recalculate(i,r),this.paint._values["line-floorwidth"]=o6.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,i)}createBucket(i){return new o3(i)}queryRadius(i){var r,n;let o=(r=nH("line-width",this,i),(n=nH("line-gap-width",this,i))>0?n+2*r:r),a=nH("line-offset",this,i);return o/2+Math.abs(a)+nX(this.paint.get("line-translate"))}queryIntersectsFeature(i,r,n,o,a,s,l){var u,h;let c=nK(i,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),s.angle,l),d=l/2*(u=this.paint.get("line-width").evaluate(r,n),(h=this.paint.get("line-gap-width").evaluate(r,n))>0?h+2*u:u),p=this.paint.get("line-offset").evaluate(r,n);return p&&(o=function(i,r){let n=[];for(let o=0;o<i.length;o++){let a=i[o],s=[];for(let i=0;i<a.length;i++){let n=a[i-1],o=a[i],l=a[i+1],u=0===i?new I(0,0):o.sub(n)._unit()._perp(),h=i===a.length-1?new I(0,0):l.sub(o)._unit()._perp(),c=u._add(h)._unit(),d=c.x*h.x+c.y*h.y;0!==d&&c._mult(1/d),s.push(c._mult(r)._add(o))}n.push(s)}return n}(o,p*l)),function(i,r,n){for(let o=0;o<r.length;o++){let a=r[o];if(i.length>=3){for(let r=0;r<a.length;r++)if(nW(i,a[r]))return!0}if(function(i,r,n){if(i.length>1){if(nV(i,r))return!0;for(let o=0;o<r.length;o++)if(nq(r[o],i,n))return!0}for(let o=0;o<i.length;o++)if(nq(i[o],r,n))return!0;return!1}(i,a,n))return!0}return!1}(c,o,d)}isTileClipped(){return!0}},symbol:sa,background:class extends rb{constructor(i){super(i,sl)}},raster:class extends rb{constructor(i){super(i,su)}}};class sd{constructor(i){this._callback=i,this._triggered=!1,"undefined"!=typeof MessageChannel&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){delete this._channel,this._callback=()=>{}}}class sp{constructor(i,r){if(isNaN(i)||isNaN(r))throw Error(`Invalid LngLat object: (${i}, ${r})`);if(this.lng=+i,this.lat=+r,this.lat>90||this.lat<-90)throw Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new sp(u(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(i){let r=Math.PI/180,n=this.lat*r,o=i.lat*r,a=Math.sin(n)*Math.sin(o)+Math.cos(n)*Math.cos(o)*Math.cos((i.lng-this.lng)*r);return 6371008.8*Math.acos(Math.min(a,1))}toBounds(i=0){let r=360*i/40075017,n=r/Math.cos(Math.PI/180*this.lat);return new sf(new sp(this.lng-n,this.lat-r),new sp(this.lng+n,this.lat+r))}static convert(i){if(i instanceof sp)return i;if(Array.isArray(i)&&(2===i.length||3===i.length))return new sp(Number(i[0]),Number(i[1]));if(!Array.isArray(i)&&"object"==typeof i&&null!==i)return new sp(Number("lng"in i?i.lng:i.lon),Number(i.lat));throw Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}class sf{constructor(i,r){i&&(r?this.setSouthWest(i).setNorthEast(r):4===i.length?this.setSouthWest([i[0],i[1]]).setNorthEast([i[2],i[3]]):this.setSouthWest(i[0]).setNorthEast(i[1]))}setNorthEast(i){return this._ne=i instanceof sp?new sp(i.lng,i.lat):sp.convert(i),this}setSouthWest(i){return this._sw=i instanceof sp?new sp(i.lng,i.lat):sp.convert(i),this}extend(i){let r,n;let o=this._sw,a=this._ne;if(i instanceof sp)r=i,n=i;else{if(!(i instanceof sf))return Array.isArray(i)?4===i.length||i.every(Array.isArray)?this.extend(sf.convert(i)):this.extend(sp.convert(i)):this;if(r=i._sw,n=i._ne,!r||!n)return this}return o||a?(o.lng=Math.min(r.lng,o.lng),o.lat=Math.min(r.lat,o.lat),a.lng=Math.max(n.lng,a.lng),a.lat=Math.max(n.lat,a.lat)):(this._sw=new sp(r.lng,r.lat),this._ne=new sp(n.lng,n.lat)),this}getCenter(){return new sp((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new sp(this.getWest(),this.getNorth())}getSouthEast(){return new sp(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(i){let{lng:r,lat:n}=sp.convert(i),o=this._sw.lng<=r&&r<=this._ne.lng;return this._sw.lng>this._ne.lng&&(o=this._sw.lng>=r&&r>=this._ne.lng),this._sw.lat<=n&&n<=this._ne.lat&&o}static convert(i){return i instanceof sf?i:i?new sf(i):i}}let sm=2*Math.PI*6371008.8;function sg(i){return sm*Math.cos(i*Math.PI/180)}function s_(i){return(180+i)/360}function sy(i){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+i*Math.PI/360)))/360}function sv(i){return 360/Math.PI*Math.atan(Math.exp((180-360*i)*Math.PI/180))-90}class sx{constructor(i,r,n=0){this.x=+i,this.y=+r,this.z=+n}static fromLngLat(i,r=0){let n=sp.convert(i);return new sx(s_(n.lng),sy(n.lat),r/sg(n.lat))}toLngLat(){return new sp(360*this.x-180,sv(this.y))}toAltitude(){return this.z*sg(sv(this.y))}meterInMercatorCoordinateUnits(){return 1/sm*(1/Math.cos(sv(this.y)*Math.PI/180))}}function sb(i,r,n){var o=2*Math.PI*6378137/256/Math.pow(2,n);return[i*o-2*Math.PI*6378137/2,r*o-2*Math.PI*6378137/2]}class sw{constructor(i,r,n){if(i<0||i>25||n<0||n>=Math.pow(2,i)||r<0||r>=Math.pow(2,i))throw Error(`x=${r}, y=${n}, z=${i} outside of bounds. 0<=x<${Math.pow(2,i)}, 0<=y<${Math.pow(2,i)} 0<=z<=25 `);this.z=i,this.x=r,this.y=n,this.key=sS(0,i,i,r,n)}equals(i){return this.z===i.z&&this.x===i.x&&this.y===i.y}url(i,r,n){var o,a,s,l,u;let h=(a=this.y,s=this.z,l=sb(256*(o=this.x),256*(a=Math.pow(2,s)-a-1),s),u=sb(256*(o+1),256*(a+1),s),l[0]+","+l[1]+","+u[0]+","+u[1]),c=function(i,r,n){let o,a="";for(let s=i;s>0;s--)a+=(r&(o=1<<s-1)?1:0)+(n&o?2:0);return a}(this.z,this.x,this.y);return i[(this.x+this.y)%i.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String("tms"===n?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,r>1?"@2x":"").replace(/{quadkey}/g,c).replace(/{bbox-epsg-3857}/g,h)}isChildOf(i){let r=this.z-i.z;return r>0&&i.x===this.x>>r&&i.y===this.y>>r}getTilePoint(i){let r=Math.pow(2,this.z);return new I((i.x*r-this.x)*8192,(i.y*r-this.y)*8192)}toString(){return`${this.z}/${this.x}/${this.y}`}}class sT{constructor(i,r){this.wrap=i,this.canonical=r,this.key=sS(i,r.z,r.z,r.x,r.y)}}class sE{constructor(i,r,n,o,a){if(i<n)throw Error(`overscaledZ should be >= z; overscaledZ = ${i}; z = ${n}`);this.overscaledZ=i,this.wrap=r,this.canonical=new sw(n,+o,+a),this.key=sS(r,i,n,o,a)}clone(){return new sE(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(i){return this.overscaledZ===i.overscaledZ&&this.wrap===i.wrap&&this.canonical.equals(i.canonical)}scaledTo(i){if(i>this.overscaledZ)throw Error(`targetZ > this.overscaledZ; targetZ = ${i}; overscaledZ = ${this.overscaledZ}`);let r=this.canonical.z-i;return i>this.canonical.z?new sE(i,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new sE(i,this.wrap,i,this.canonical.x>>r,this.canonical.y>>r)}calculateScaledKey(i,r){if(i>this.overscaledZ)throw Error(`targetZ > this.overscaledZ; targetZ = ${i}; overscaledZ = ${this.overscaledZ}`);let n=this.canonical.z-i;return i>this.canonical.z?sS(this.wrap*+r,i,this.canonical.z,this.canonical.x,this.canonical.y):sS(this.wrap*+r,i,i,this.canonical.x>>n,this.canonical.y>>n)}isChildOf(i){if(i.wrap!==this.wrap)return!1;let r=this.canonical.z-i.canonical.z;return 0===i.overscaledZ||i.overscaledZ<this.overscaledZ&&i.canonical.x===this.canonical.x>>r&&i.canonical.y===this.canonical.y>>r}children(i){if(this.overscaledZ>=i)return[new sE(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];let r=this.canonical.z+1,n=2*this.canonical.x,o=2*this.canonical.y;return[new sE(r,this.wrap,r,n,o),new sE(r,this.wrap,r,n+1,o),new sE(r,this.wrap,r,n,o+1),new sE(r,this.wrap,r,n+1,o+1)]}isLessThan(i){return this.wrap<i.wrap||!(this.wrap>i.wrap)&&(this.overscaledZ<i.overscaledZ||!(this.overscaledZ>i.overscaledZ)&&(this.canonical.x<i.canonical.x||!(this.canonical.x>i.canonical.x)&&this.canonical.y<i.canonical.y))}wrapped(){return new sE(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(i){return new sE(this.overscaledZ,i,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new sT(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(i){return this.canonical.getTilePoint(new sx(i.x-this.wrap,i.y))}}function sS(i,r,n,o,a){(i*=2)<0&&(i=-1*i-1);let s=1<<n;return(s*s*i+s*a+o).toString(36)+n.toString(36)+r.toString(36)}iW("CanonicalTileID",sw),iW("OverscaledTileID",sE,{omit:["posMatrix"]});class sC{constructor(i,r,n){if(this.uid=i,r.height!==r.width)throw RangeError("DEM tiles must be square");if(n&&"mapbox"!==n&&"terrarium"!==n)return void _(`"${n}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=r.height;let o=this.dim=r.height-2;this.data=new Uint32Array(r.data.buffer),this.encoding=n||"mapbox";for(let i=0;i<o;i++)this.data[this._idx(-1,i)]=this.data[this._idx(0,i)],this.data[this._idx(o,i)]=this.data[this._idx(o-1,i)],this.data[this._idx(i,-1)]=this.data[this._idx(i,0)],this.data[this._idx(i,o)]=this.data[this._idx(i,o-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(o,-1)]=this.data[this._idx(o-1,0)],this.data[this._idx(-1,o)]=this.data[this._idx(0,o-1)],this.data[this._idx(o,o)]=this.data[this._idx(o-1,o-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let i=0;i<o;i++)for(let r=0;r<o;r++){let n=this.get(i,r);n>this.max&&(this.max=n),n<this.min&&(this.min=n)}}get(i,r){let n=new Uint8Array(this.data.buffer),o=4*this._idx(i,r);return("terrarium"===this.encoding?this._unpackTerrarium:this._unpackMapbox)(n[o],n[o+1],n[o+2])}getUnpackVector(){return"terrarium"===this.encoding?[256,1,1/256,32768]:[6553.6,25.6,.1,1e4]}_idx(i,r){if(i<-1||i>=this.dim+1||r<-1||r>=this.dim+1)throw RangeError("out of range source coordinates for DEM data");return(r+1)*this.stride+(i+1)}_unpackMapbox(i,r,n){return(256*i*256+256*r+n)/10-1e4}_unpackTerrarium(i,r,n){return 256*i+r+n/256-32768}getPixels(){return new on({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(i,r,n){if(this.dim!==i.dim)throw Error("dem dimension mismatch");let o=r*this.dim,a=r*this.dim+this.dim,s=n*this.dim,l=n*this.dim+this.dim;switch(r){case -1:o=a-1;break;case 1:a=o+1}switch(n){case -1:s=l-1;break;case 1:l=s+1}let u=-r*this.dim,h=-n*this.dim;for(let r=s;r<l;r++)for(let n=o;n<a;n++)this.data[this._idx(n,r)]=i.data[this._idx(n+u,r+h)]}}iW("DEMData",sC);class sI{constructor(i){this._stringToNumber={},this._numberToString=[];for(let r=0;r<i.length;r++){let n=i[r];this._stringToNumber[n]=r,this._numberToString[r]=n}}encode(i){return this._stringToNumber[i]}decode(i){if(i>=this._numberToString.length)throw Error(`Out of bounds. Index requested n=${i} can't be >= this._numberToString.length ${this._numberToString.length}`);return this._numberToString[i]}}class sA{constructor(i,r,n,o,a){this.type="Feature",this._vectorTileFeature=i,i._z=r,i._x=n,i._y=o,this.properties=i.properties,this.id=a}get geometry(){return void 0===this._geometry&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(i){this._geometry=i}toJSON(){let i={geometry:this.geometry};for(let r in this)"_geometry"!==r&&"_vectorTileFeature"!==r&&(i[r]=this[r]);return i}}class sP{constructor(i,r){this.tileID=i,this.x=i.canonical.x,this.y=i.canonical.y,this.z=i.canonical.z,this.grid=new iG(8192,16,0),this.grid3D=new iG(8192,16,0),this.featureIndexArray=new r5,this.promoteId=r}insert(i,r,n,o,a,s){let l=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(n,o,a);let u=s?this.grid3D:this.grid;for(let i=0;i<r.length;i++){let n=r[i],o=[1/0,1/0,-1/0,-1/0];for(let i=0;i<n.length;i++){let r=n[i];o[0]=Math.min(o[0],r.x),o[1]=Math.min(o[1],r.y),o[2]=Math.max(o[2],r.x),o[3]=Math.max(o[3],r.y)}o[0]<8192&&o[1]<8192&&o[2]>=0&&o[3]>=0&&u.insert(l,o[0],o[1],o[2],o[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new oN.VectorTile(new ao(this.rawTileData)).layers,this.sourceLayerCoder=new sI(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(i,r,n,o){let a;this.loadVTLayers();let s=i.params||{},l=8192/i.tileSize/i.scale,u=iv(s.filter),h=i.queryGeometry,c=i.queryPadding*l,d=sL(h),p=this.grid.query(d.minX-c,d.minY-c,d.maxX+c,d.maxY+c),f=sL(i.cameraQueryGeometry),m=this.grid3D.query(f.minX-c,f.minY-c,f.maxX+c,f.maxY+c,(r,n,o,a)=>(function(i,r,n,o,a){for(let s of i)if(r<=s.x&&n<=s.y&&o>=s.x&&a>=s.y)return!0;let s=[new I(r,n),new I(r,a),new I(o,a),new I(o,n)];if(i.length>2){for(let r of s)if(nW(i,r))return!0}for(let r=0;r<i.length-1;r++)if(function(i,r,n){let o=n[0],a=n[2];if(i.x<o.x&&r.x<o.x||i.x>a.x&&r.x>a.x||i.y<o.y&&r.y<o.y||i.y>a.y&&r.y>a.y)return!1;let s=y(i,r,n[0]);return s!==y(i,r,n[1])||s!==y(i,r,n[2])||s!==y(i,r,n[3])}(i[r],i[r+1],s))return!0;return!1})(i.cameraQueryGeometry,r-c,n-c,o+c,a+c));for(let i of m)p.push(i);p.sort(sM);let g={};for(let c=0;c<p.length;c++){let d=p[c];if(d===a)continue;a=d;let f=this.featureIndexArray.get(d),m=null;this.loadMatchingFeature(g,f.bucketIndex,f.sourceLayerIndex,f.featureIndex,u,s.layers,s.availableImages,r,n,o,(r,n,o)=>(m||(m=nO(r)),n.queryIntersectsFeature(h,r,o,m,this.z,i.transform,l,i.pixelPosMatrix)))}return g}loadMatchingFeature(i,r,n,o,a,s,l,u,c,d,p){let f=this.bucketLayerIDs[r];if(s&&!function(i,r){for(let n=0;n<i.length;n++)if(r.indexOf(i[n])>=0)return!0;return!1}(s,f))return;let m=this.sourceLayerCoder.decode(n),g=this.vtLayers[m].feature(o);if(a.needGeometry){let i=nF(g,!0);if(!a.filter(new ro(this.tileID.overscaledZ),i,this.tileID.canonical))return}else if(!a.filter(new ro(this.tileID.overscaledZ),g))return;let _=this.getId(g,m);for(let r=0;r<f.length;r++){let n=f[r];if(s&&0>s.indexOf(n))continue;let a=u[n];if(!a)continue;let m={};_&&d&&(m=d.getState(a.sourceLayer||"_geojsonTileLayer",_));let y=h({},c[n]);y.paint=sk(y.paint,a.paint,g,m,l),y.layout=sk(y.layout,a.layout,g,m,l);let v=!p||p(g,a,m);if(!v)continue;let x=new sA(g,this.z,this.x,this.y,_);x.layer=y;let b=i[n];void 0===b&&(b=i[n]=[]),b.push({featureIndex:o,feature:x,intersectionZ:v})}}lookupSymbolFeatures(i,r,n,o,a,s,l,u){let h={};this.loadVTLayers();let c=iv(a);for(let a of i)this.loadMatchingFeature(h,n,o,a,c,s,l,u,r);return h}hasLayer(i){for(let r of this.bucketLayerIDs)for(let n of r)if(i===n)return!0;return!1}getId(i,r){let n=i.id;return this.promoteId&&"boolean"==typeof(n=i.properties["string"==typeof this.promoteId?this.promoteId:this.promoteId[r]])&&(n=Number(n)),n}}function sk(i,r,n,o,a){return p(i,(i,s)=>{let l=r instanceof rp?r.get(s):null;return l&&l.evaluate?l.evaluate(n,o,a):l})}function sL(i){let r=1/0,n=1/0,o=-1/0,a=-1/0;for(let s of i)r=Math.min(r,s.x),n=Math.min(n,s.y),o=Math.max(o,s.x),a=Math.max(a,s.y);return{minX:r,minY:n,maxX:o,maxY:a}}function sM(i,r){return r-i}iW("FeatureIndex",sP,{omit:["rawTileData","sourceLayerCoder"]}),i.PerformanceMarkers=void 0,(tP=i.PerformanceMarkers||(i.PerformanceMarkers={})).create="create",tP.load="load",tP.fullLoad="fullLoad";let sz=null,sD=[],sR=1e3/30;i.AJAXError=G,i.ARRAY_TYPE=nQ,i.Actor=class{constructor(i,r,n){this.target=i,this.parent=r,this.mapId=n,this.callbacks={},this.tasks={},this.taskQueue=[],this.cancelCallbacks={},d(["receive","process"],this),this.invoker=new sd(this.process),this.target.addEventListener("message",this.receive,!1),this.globalScope=v()?i:window}send(i,r,n,o,a=!1){let s=Math.round(1e18*Math.random()).toString(36).substring(0,10);n&&(this.callbacks[s]=n);let l=E(this.globalScope)?void 0:[];return this.target.postMessage({id:s,type:i,hasCallback:!!n,targetMapId:o,mustQueue:a,sourceMapId:this.mapId,data:iX(r,l)},l),{cancel:()=>{n&&delete this.callbacks[s],this.target.postMessage({id:s,type:"<cancel>",targetMapId:o,sourceMapId:this.mapId})}}}receive(i){let r=i.data,n=r.id;if(n&&(!r.targetMapId||this.mapId===r.targetMapId)){if("<cancel>"===r.type){delete this.tasks[n];let i=this.cancelCallbacks[n];delete this.cancelCallbacks[n],i&&i()}else v()||r.mustQueue?(this.tasks[n]=r,this.taskQueue.push(n),this.invoker.trigger()):this.processTask(n,r)}}process(){if(!this.taskQueue.length)return;let i=this.taskQueue.shift(),r=this.tasks[i];delete this.tasks[i],this.taskQueue.length&&this.invoker.trigger(),r&&this.processTask(i,r)}processTask(i,r){if("<response>"===r.type){let n=this.callbacks[i];delete this.callbacks[i],n&&(r.error?n(iK(r.error)):n(null,iK(r.data)))}else{let n=!1,o=E(this.globalScope)?void 0:[],a=r.hasCallback?(r,a)=>{n=!0,delete this.cancelCallbacks[i],this.target.postMessage({id:i,type:"<response>",sourceMapId:this.mapId,error:r?iX(r):null,data:iX(a,o)},o)}:i=>{n=!0},s=null,l=iK(r.data);if(this.parent[r.type])s=this.parent[r.type](r.sourceMapId,l,a);else if(this.parent.getWorkerSource){let i=r.type.split(".");s=this.parent.getWorkerSource(r.sourceMapId,i[0],l.source)[i[1]](l,a)}else a(Error(`Could not find function ${r.type}`));!n&&s&&s.cancel&&(this.cancelCallbacks[i]=s.cancel)}}remove(){this.invoker.remove(),this.target.removeEventListener("message",this.receive,!1)}},i.AlphaImage=or,i.CanonicalTileID=sw,i.CollisionBoxArray=rK,i.CollisionCircleLayoutArray=class extends rF{},i.Color=tB,i.DEMData=sC,i.DataConstantProperty=rf,i.DictionaryCoder=sI,i.EXTENT=8192,i.ErrorEvent=ti,i.EvaluationParameters=ro,i.Event=te,i.Evented=tr,i.FeatureIndex=sP,i.FillBucket=oz,i.FillExtrusionBucket=oW,i.GeoJSONFeature=sA,i.ImageAtlas=aP,i.ImagePosition=aA,i.LineBucket=o3,i.LineStripIndexArray=class extends rW{},i.LngLat=sp,i.LngLatBounds=sf,i.MercatorCoordinate=sx,i.ONE_EM=24,i.OverscaledTileID=sE,i.PerformanceUtils={mark(i){performance.mark(i)},frame(i){null!=sz&&sD.push(i-sz),sz=i},clearMetrics(){for(let r in sz=null,sD=[],performance.clearMeasures("loadTime"),performance.clearMeasures("fullLoadTime"),i.PerformanceMarkers)performance.clearMarks(i.PerformanceMarkers[r])},getPerformanceMetrics(){performance.measure("loadTime",i.PerformanceMarkers.create,i.PerformanceMarkers.load),performance.measure("fullLoadTime",i.PerformanceMarkers.create,i.PerformanceMarkers.fullLoad);let r=performance.getEntriesByName("loadTime")[0].duration,n=performance.getEntriesByName("fullLoadTime")[0].duration,o=sD.length,a=1/(sD.reduce((i,r)=>i+r,0)/o/1e3),s=sD.filter(i=>i>sR).reduce((i,r)=>i+(r-sR)/sR,0);return{loadTime:r,fullLoadTime:n,fps:a,percentDroppedFrames:s/(o+s)*100}}},i.PosArray=r4,i.Properties=rv,i.QuadTriangleArray=class extends rU{},i.RGBAImage=on,i.RasterBoundsArray=class extends rA{},i.RequestPerformance=class{constructor(i){this._marks={start:[i.url,"start"].join("#"),end:[i.url,"end"].join("#"),measure:i.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let i=performance.getEntriesByName(this._marks.measure);return 0===i.length&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),i=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),i}},i.ResourceType=q,i.SegmentVector=nc,i.SymbolBucket=si,i.Transitionable=rl,i.TriangleIndexArray=ns,i.Uniform1f=nT,i.Uniform1i=class extends nw{constructor(i,r){super(i,r),this.current=0}set(i){this.current!==i&&(this.current=i,this.gl.uniform1i(this.location,i))}},i.Uniform2f=class extends nw{constructor(i,r){super(i,r),this.current=[0,0]}set(i){i[0]===this.current[0]&&i[1]===this.current[1]||(this.current=i,this.gl.uniform2f(this.location,i[0],i[1]))}},i.Uniform3f=class extends nw{constructor(i,r){super(i,r),this.current=[0,0,0]}set(i){i[0]===this.current[0]&&i[1]===this.current[1]&&i[2]===this.current[2]||(this.current=i,this.gl.uniform3f(this.location,i[0],i[1],i[2]))}},i.Uniform4f=nE,i.UniformColor=nS,i.UniformMatrix4f=class extends nw{constructor(i,r){super(i,r),this.current=nC}set(i){if(i[12]!==this.current[12]||i[0]!==this.current[0])return this.current=i,void this.gl.uniformMatrix4fv(this.location,!1,i);for(let r=1;r<16;r++)if(i[r]!==this.current[r]){this.current=i,this.gl.uniformMatrix4fv(this.location,!1,i);break}}},i.UnwrappedTileID=sT,i.ValidationError=to,i.ZoomHistory=iJ,i.add=function(i,r,n){return i[0]=r[0]+n[0],i[1]=r[1]+n[1],i[2]=r[2]+n[2],i},i.addDynamicAttributes=a7,i.asyncAll=function(i,r,n){if(!i.length)return n(null,[]);let o=i.length,a=Array(i.length),s=null;i.forEach((i,l)=>{r(i,(i,r)=>{i&&(s=i),a[l]=r,0==--o&&n(s,a)})})},i.bezier=a,i.bindAll=d,i.cacheEntryPossiblyAdded=function(i){++O>R&&(i.getActor().send("enforceCacheSizeLimit",D),O=0)},i.clamp=l,i.clearTileCache=function(i){let r=caches.delete(k);i&&r.catch(i).then(()=>i())},i.clipLine=a$,i.clone=function(i){var r=new nQ(16);return r[0]=i[0],r[1]=i[1],r[2]=i[2],r[3]=i[3],r[4]=i[4],r[5]=i[5],r[6]=i[6],r[7]=i[7],r[8]=i[8],r[9]=i[9],r[10]=i[10],r[11]=i[11],r[12]=i[12],r[13]=i[13],r[14]=i[14],r[15]=i[15],r},i.clone$1=m,i.clone$2=function(i){var r=new nQ(3);return r[0]=i[0],r[1]=i[1],r[2]=i[2],r},i.collisionCircleLayout=ae,i.config=P,i.copy=function(i,r){return i[0]=r[0],i[1]=r[1],i[2]=r[2],i[3]=r[3],i[4]=r[4],i[5]=r[5],i[6]=r[6],i[7]=r[7],i[8]=r[8],i[9]=r[9],i[10]=r[10],i[11]=r[11],i[12]=r[12],i[13]=r[13],i[14]=r[14],i[15]=r[15],i},i.create=function(){var i=new nQ(16);return nQ!=Float32Array&&(i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[11]=0,i[12]=0,i[13]=0,i[14]=0),i[0]=1,i[5]=1,i[10]=1,i[15]=1,i},i.create$1=n0,i.createExpression=io,i.createFilter=iv,i.createLayout=rS,i.createStyleLayer=function(i){return"custom"===i.type?new sh(i):new sc[i.type](i)},i.cross=function(i,r,n){var o=r[0],a=r[1],s=r[2],l=n[0],u=n[1],h=n[2];return i[0]=a*h-s*u,i[1]=s*l-o*h,i[2]=o*u-a*l,i},i.dot=function(i,r){return i[0]*r[0]+i[1]*r[1]+i[2]*r[2]},i.dot$1=function(i,r){return i[0]*r[0]+i[1]*r[1]+i[2]*r[2]+i[3]*r[3]},i.ease=s,i.emitValidationErrors=iq,i.enforceCacheSizeLimit=function(i){B(),M&&M.then(r=>{r.keys().then(n=>{for(let o=0;o<n.length-i;o++)r.delete(n[o])})})},i.equals=function(i,r){var n=i[0],o=i[1],a=i[2],s=i[3],l=i[4],u=i[5],h=i[6],c=i[7],d=i[8],p=i[9],f=i[10],m=i[11],g=i[12],_=i[13],y=i[14],v=i[15],x=r[0],b=r[1],w=r[2],T=r[3],E=r[4],S=r[5],C=r[6],I=r[7],A=r[8],P=r[9],k=r[10],M=r[11],z=r[12],D=r[13],R=r[14],B=r[15];return Math.abs(n-x)<=1e-6*Math.max(1,Math.abs(n),Math.abs(x))&&Math.abs(o-b)<=1e-6*Math.max(1,Math.abs(o),Math.abs(b))&&Math.abs(a-w)<=1e-6*Math.max(1,Math.abs(a),Math.abs(w))&&Math.abs(s-T)<=1e-6*Math.max(1,Math.abs(s),Math.abs(T))&&Math.abs(l-E)<=1e-6*Math.max(1,Math.abs(l),Math.abs(E))&&Math.abs(u-S)<=1e-6*Math.max(1,Math.abs(u),Math.abs(S))&&Math.abs(h-C)<=1e-6*Math.max(1,Math.abs(h),Math.abs(C))&&Math.abs(c-I)<=1e-6*Math.max(1,Math.abs(c),Math.abs(I))&&Math.abs(d-A)<=1e-6*Math.max(1,Math.abs(d),Math.abs(A))&&Math.abs(p-P)<=1e-6*Math.max(1,Math.abs(p),Math.abs(P))&&Math.abs(f-k)<=1e-6*Math.max(1,Math.abs(f),Math.abs(k))&&Math.abs(m-M)<=1e-6*Math.max(1,Math.abs(m),Math.abs(M))&&Math.abs(g-z)<=1e-6*Math.max(1,Math.abs(g),Math.abs(z))&&Math.abs(_-D)<=1e-6*Math.max(1,Math.abs(_),Math.abs(D))&&Math.abs(y-R)<=1e-6*Math.max(1,Math.abs(y),Math.abs(R))&&Math.abs(v-B)<=1e-6*Math.max(1,Math.abs(v),Math.abs(B))},i.evaluateSizeForFeature=function(i,{uSize:r,uSizeT:n},{lowerSize:o,upperSize:a}){return"source"===i.kind?o/128:"composite"===i.kind?eh(o/128,a/128,n):r},i.evaluateSizeForZoom=function(i,r){let n=0,o=0;if("constant"===i.kind)o=i.layoutSize;else if("source"!==i.kind){let{interpolationType:a,minZoom:s,maxZoom:u}=i,h=a?l(eC.interpolationFactor(a,r,s,u),0,1):0;"camera"===i.kind?o=eh(i.minSize,i.maxSize,h):n=h}return{uSizeT:n,uSize:o}},i.evaluateVariableOffset=a2,i.evented=re,i.exported=C,i.exported$1=F,i.extend=h,i.filterObject=f,i.fromRotation=function(i,r){var n=Math.sin(r),o=Math.cos(r);return i[0]=o,i[1]=n,i[2]=0,i[3]=-n,i[4]=o,i[5]=0,i[6]=0,i[7]=0,i[8]=1,i},i.fromScaling=function(i,r){return i[0]=r[0],i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=r[1],i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=r[2],i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,i},i.getAnchorAlignment=aN,i.getAnchorJustification=a3,i.getArrayBuffer=K,i.getImage=Y,i.getJSON=function(i,r){return X(h(i,{type:"json"}),r)},i.getOverlapMode=ss,i.getRTLTextPluginStatus=ri,i.getReferrer=W,i.getVideo=function(i,r){let n=window.document.createElement("video");n.muted=!0,n.onloadstart=function(){r(null,n)};for(let r=0;r<i.length;r++){let o=window.document.createElement("source");(function(i){let r=window.document.createElement("a");return r.href=i,r.protocol===window.document.location.protocol&&r.host===window.document.location.host})(i[r])||(n.crossOrigin="Anonymous"),o.src=i[r],n.appendChild(o)}return{cancel:()=>{}}},i.identity=n1,i.invert=function(i,r){var n=r[0],o=r[1],a=r[2],s=r[3],l=r[4],u=r[5],h=r[6],c=r[7],d=r[8],p=r[9],f=r[10],m=r[11],g=r[12],_=r[13],y=r[14],v=r[15],x=n*u-o*l,b=n*h-a*l,w=n*c-s*l,T=o*h-a*u,E=o*c-s*u,S=a*c-s*h,C=d*_-p*g,I=d*y-f*g,A=d*v-m*g,P=p*y-f*_,k=p*v-m*_,M=f*v-m*y,z=x*M-b*k+w*P+T*A-E*I+S*C;return z?(i[0]=(u*M-h*k+c*P)*(z=1/z),i[1]=(a*k-o*M-s*P)*z,i[2]=(_*S-y*E+v*T)*z,i[3]=(f*E-p*S-m*T)*z,i[4]=(h*A-l*M-c*I)*z,i[5]=(n*M-a*A+s*I)*z,i[6]=(y*w-g*S-v*b)*z,i[7]=(d*S-f*w+m*b)*z,i[8]=(l*k-u*A+c*C)*z,i[9]=(o*A-n*k-s*C)*z,i[10]=(g*E-_*w+v*x)*z,i[11]=(p*w-d*E-m*x)*z,i[12]=(u*I-l*P-h*C)*z,i[13]=(n*P-o*I+a*C)*z,i[14]=(_*b-g*T-y*x)*z,i[15]=(d*T-p*b+f*x)*z,i):null},i.isImageBitmap=S,i.isSafari=E,i.isWorker=v,i.keysDifference=function(i,r){let n=[];for(let o in i)o in r||n.push(o);return n},i.lazyLoadRTLTextPlugin=function(){rn.isLoading()||rn.isLoaded()||"deferred"!==ri()||rr()},i.makeRequest=X,i.mapObject=p,i.mercatorXfromLng=s_,i.mercatorYfromLat=sy,i.mercatorZfromAltitude=function(i,r){return i/sg(r)},i.mul=n2,i.mul$1=function(i,r,n){return i[0]=r[0]*n[0],i[1]=r[1]*n[1],i[2]=r[2]*n[2],i[3]=r[3]*n[3],i},i.multiply=n2,i.nextPowerOfTwo=function(i){return i<=1?1:Math.pow(2,Math.ceil(Math.log(i)/Math.LN2))},i.normalize=function(i,r){var n=r[0],o=r[1],a=r[2],s=n*n+o*o+a*a;return s>0&&(s=1/Math.sqrt(s)),i[0]=r[0]*s,i[1]=r[1]*s,i[2]=r[2]*s,i},i.number=eh,i.ortho=function(i,r,n,o,a,s,l){var u=1/(r-n),h=1/(o-a),c=1/(s-l);return i[0]=-2*u,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=-2*h,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=2*c,i[11]=0,i[12]=(r+n)*u,i[13]=(a+o)*h,i[14]=(l+s)*c,i[15]=1,i},i.parseCacheControl=x,i.parseGlyphPbf=function(i){return new ao(i).readFields(aE,[])},i.pbf=ao,i.performSymbolLayout=function(r){r.bucket.createArrays(),r.bucket.tilePixelRatio=8192/(512*r.bucket.overscaling),r.bucket.compareText={},r.bucket.iconsNeedLinear=!1;let n=r.bucket.layers[0].layout,o=r.bucket.layers[0]._unevaluatedLayout._values,a={layoutIconSize:o["icon-size"].possiblyEvaluate(new ro(r.bucket.zoom+1),r.canonical),layoutTextSize:o["text-size"].possiblyEvaluate(new ro(r.bucket.zoom+1),r.canonical),textMaxSize:o["text-size"].possiblyEvaluate(new ro(18))};if("composite"===r.bucket.textSizeData.kind){let{minZoom:i,maxZoom:n}=r.bucket.textSizeData;a.compositeTextSizes=[o["text-size"].possiblyEvaluate(new ro(i),r.canonical),o["text-size"].possiblyEvaluate(new ro(n),r.canonical)]}if("composite"===r.bucket.iconSizeData.kind){let{minZoom:i,maxZoom:n}=r.bucket.iconSizeData;a.compositeIconSizes=[o["icon-size"].possiblyEvaluate(new ro(i),r.canonical),o["icon-size"].possiblyEvaluate(new ro(n),r.canonical)]}let s=24*n.get("text-line-height"),l="viewport"!==n.get("text-rotation-alignment")&&"point"!==n.get("symbol-placement"),u=n.get("text-keep-upright"),h=n.get("text-size");for(let o of r.bucket.features){let c=n.get("text-font").evaluate(o,{},r.canonical).join(","),d=h.evaluate(o,{},r.canonical),p=a.layoutTextSize.evaluate(o,{},r.canonical),f=a.layoutIconSize.evaluate(o,{},r.canonical),m={horizontal:{},vertical:void 0},g=o.text,y,v=[0,0];if(g){let a=g.toString(),h=24*n.get("text-letter-spacing").evaluate(o,{},r.canonical),f=!function(i){for(let n of i){var r;if(r=n.charCodeAt(0),iY.Arabic(r)||iY["Arabic Supplement"](r)||iY["Arabic Extended-A"](r)||iY["Arabic Presentation Forms-A"](r)||iY["Arabic Presentation Forms-B"](r))return!1}return!0}(a)?0:h,_=n.get("text-anchor").evaluate(o,{},r.canonical),y=n.get("text-variable-anchor");if(!y){let i=n.get("text-radial-offset").evaluate(o,{},r.canonical);v=i?a2(_,[24*i,a1]):n.get("text-offset").evaluate(o,{},r.canonical).map(i=>24*i)}let x=l?"center":n.get("text-justify").evaluate(o,{},r.canonical),b=n.get("symbol-placement"),w="point"===b?24*n.get("text-max-width").evaluate(o,{},r.canonical):0,T=()=>{r.bucket.allowVerticalPlacement&&iQ(a)&&(m.vertical=aM(g,r.glyphMap,r.glyphPositions,r.imagePositions,c,w,s,_,"left",f,v,i.WritingMode.vertical,!0,b,p,d))};if(!l&&y){let n="auto"===x?y.map(i=>a3(i)):[x],o=!1;for(let a=0;a<n.length;a++){let l=n[a];if(!m.horizontal[l]){if(o)m.horizontal[l]=m.horizontal[0];else{let n=aM(g,r.glyphMap,r.glyphPositions,r.imagePositions,c,w,s,"center",l,f,v,i.WritingMode.horizontal,!1,b,p,d);n&&(m.horizontal[l]=n,o=1===n.positionedLines.length)}}}T()}else{"auto"===x&&(x=a3(_));let n=aM(g,r.glyphMap,r.glyphPositions,r.imagePositions,c,w,s,_,x,f,v,i.WritingMode.horizontal,!1,b,p,d);n&&(m.horizontal[x]=n),T(),iQ(a)&&l&&u&&(m.vertical=aM(g,r.glyphMap,r.glyphPositions,r.imagePositions,c,w,s,_,x,f,v,i.WritingMode.vertical,!1,b,p,d))}}let x=!1;if(o.icon&&o.icon.name){let i=r.imageMap[o.icon.name];i&&(y=function(i,r,n){let{horizontalAlign:o,verticalAlign:a}=aN(n),s=r[0]-i.displaySize[0]*o,l=r[1]-i.displaySize[1]*a;return{image:i,top:l,bottom:l+i.displaySize[1],left:s,right:s+i.displaySize[0]}}(r.imagePositions[o.icon.name],n.get("icon-offset").evaluate(o,{},r.canonical),n.get("icon-anchor").evaluate(o,{},r.canonical)),x=!!i.sdf,void 0===r.bucket.sdfIcons?r.bucket.sdfIcons=x:r.bucket.sdfIcons!==x&&_("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(i.pixelRatio!==r.bucket.pixelRatio||0!==n.get("icon-rotate").constantOr(1))&&(r.bucket.iconsNeedLinear=!0))}let b=a4(m.horizontal)||m.vertical;r.bucket.iconsInText=!!b&&b.iconsInText,(b||y)&&function(r,n,o,a,s,l,u,h,c,d,p){let f,m=l.textMaxSize.evaluate(n,{});void 0===m&&(m=u);let g=r.layers[0].layout,y=g.get("icon-offset").evaluate(n,{},p),v=a4(o.horizontal),x=u/24,b=r.tilePixelRatio*x,w=r.tilePixelRatio*m/24,T=r.tilePixelRatio*h,E=r.tilePixelRatio*g.get("symbol-spacing"),S=g.get("text-padding")*r.tilePixelRatio,C=function(i,r,n,o=1){let a=i.get("icon-padding").evaluate(r,{},n),s=a&&a.values;return[s[0]*o,s[1]*o,s[2]*o,s[3]*o]}(g,n,p,r.tilePixelRatio),A=g.get("text-max-angle")/180*Math.PI,P="viewport"!==g.get("text-rotation-alignment")&&"point"!==g.get("symbol-placement"),k="map"===g.get("icon-rotation-alignment")&&"point"!==g.get("symbol-placement"),M=g.get("symbol-placement"),z=E/2,D=g.get("icon-text-fit");a&&"none"!==D&&(r.allowVerticalPlacement&&o.vertical&&(f=aU(a,o.vertical,D,g.get("icon-text-fit-padding"),y,x)),v&&(a=aU(a,v,D,g.get("icon-text-fit-padding"),y,x)));let R=(h,m)=>{m.x<0||m.x>=8192||m.y<0||m.y>=8192||function(r,n,o,a,s,l,u,h,c,d,p,f,m,g,y,v,x,b,w,T,E,S,C,I,A){let P=r.addToLineVertexArray(n,o),k,M,z,D,R=0,B=0,O=0,F=0,N=-1,U=-1,j={},Z=nf.exports(""),V=0,q=0;if(void 0===h._unevaluatedLayout.getValue("text-radial-offset")?[V,q]=h.layout.get("text-offset").evaluate(E,{},I).map(i=>24*i):(V=24*h.layout.get("text-radial-offset").evaluate(E,{},I),q=a1),r.allowVerticalPlacement&&a.vertical){let i=h.layout.get("text-rotate").evaluate(E,{},I)+90;z=new aK(c,n,d,p,f,a.vertical,m,g,y,i),u&&(D=new aK(c,n,d,p,f,u,x,b,y,i))}if(s){let o=h.layout.get("icon-rotate").evaluate(E,{}),a="none"!==h.layout.get("icon-text-fit"),l=aW(s,o,C,a),m=u?aW(u,o,C,a):void 0;M=new aK(c,n,d,p,f,s,x,b,!1,o),R=4*l.length;let g=r.iconSizeData,y=null;"source"===g.kind?(y=[128*h.layout.get("icon-size").evaluate(E,{})])[0]>32640&&_(`${r.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`):"composite"===g.kind&&((y=[128*S.compositeIconSizes[0].evaluate(E,{},I),128*S.compositeIconSizes[1].evaluate(E,{},I)])[0]>32640||y[1]>32640)&&_(`${r.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`),r.addSymbols(r.icon,l,y,T,w,E,i.WritingMode.none,n,P.lineStartIndex,P.lineLength,-1,I),N=r.icon.placedSymbolArray.length-1,m&&(B=4*m.length,r.addSymbols(r.icon,m,y,T,w,E,i.WritingMode.vertical,n,P.lineStartIndex,P.lineLength,-1,I),U=r.icon.placedSymbolArray.length-1)}let G=Object.keys(a.horizontal);for(let o of G){let s=a.horizontal[o];if(!k){Z=nf.exports(s.text);let i=h.layout.get("text-rotate").evaluate(E,{},I);k=new aK(c,n,d,p,f,s,m,g,y,i)}let u=1===s.positionedLines.length;if(O+=a5(r,n,s,l,h,y,E,v,P,a.vertical?i.WritingMode.horizontal:i.WritingMode.horizontalOnly,u?G:[o],j,N,S,I),u)break}a.vertical&&(F+=a5(r,n,a.vertical,l,h,y,E,v,P,i.WritingMode.vertical,["vertical"],j,U,S,I));let W=k?k.boxStartIndex:r.collisionBoxArray.length,H=k?k.boxEndIndex:r.collisionBoxArray.length,X=z?z.boxStartIndex:r.collisionBoxArray.length,K=z?z.boxEndIndex:r.collisionBoxArray.length,J=M?M.boxStartIndex:r.collisionBoxArray.length,Y=M?M.boxEndIndex:r.collisionBoxArray.length,Q=D?D.boxStartIndex:r.collisionBoxArray.length,tt=D?D.boxEndIndex:r.collisionBoxArray.length,te=-1,ti=(i,r)=>i&&i.circleDiameter?Math.max(i.circleDiameter,r):r;te=ti(k,te),te=ti(z,te),te=ti(M,te),te=ti(D,te);let tr=te>-1?1:0;tr&&(te*=A/24),r.glyphOffsetArray.length>=si.MAX_GLYPHS&&_("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),void 0!==E.sortKey&&r.addToSortKeyRanges(r.symbolInstances.length,E.sortKey),r.symbolInstances.emplaceBack(n.x,n.y,j.right>=0?j.right:-1,j.center>=0?j.center:-1,j.left>=0?j.left:-1,j.vertical||-1,N,U,Z,W,H,X,K,J,Y,Q,tt,d,O,F,R,B,tr,0,m,V,q,te)}(r,m,h,o,a,s,f,r.layers[0],r.collisionBoxArray,n.index,n.sourceLayerIndex,r.index,b,[S,S,S,S],P,c,T,C,k,y,n,l,d,p,u)};if("line"===M)for(let i of a$(n.geometry,0,0,8192,8192)){let n=function(i,r,n,o,a,s,l,u,h){let c=o?.6*s*l:0,d=aG(o,a),p=d*l,f=0===i[0].x||i[0].x===h||0===i[0].y||i[0].y===h;return r-p<r/4&&(r=p+r/4),function i(r,n,o,a,s,l,u,h,c){let d=l/2,p=aq(r),f=0,m=n-o,g=[];for(let i=0;i<r.length-1;i++){let n=r[i],u=r[i+1],h=n.dist(u),_=u.angleTo(n);for(;m+o<f+h;){m+=o;let y=(m-f)/h,v=eh(n.x,u.x,y),x=eh(n.y,u.y,y);if(v>=0&&v<c&&x>=0&&x<c&&m-d>=0&&m+d<=p){let n=new aZ(v,x,_,i);n._round(),a&&!aV(r,n,l,a,s)||g.push(n)}}f+=h}return h||g.length||u||(g=i(r,f/2,o,a,s,l,u,!0,c)),g}(i,f?r/2*u%r:(d/2+2*s)*l*u%r,r,c,n,p,f,!1,h)}(i,E,A,o.vertical||v,a,24,w,r.overscaling,8192);for(let o of n)v&&function(i,r,n,o){let a=i.compareText;if(r in a){let i=a[r];for(let r=i.length-1;r>=0;r--)if(o.dist(i[r])<n)return!0}else a[r]=[];return a[r].push(o),!1}(r,v.text,z,o)||R(i,o)}else if("line-center"===M){for(let i of n.geometry)if(i.length>1){let r=function(i,r,n,o,a,s){let l=n?.6*24*s:0,u=aG(n,o)*s,h=0,c=aq(i)/2;for(let n=0;n<i.length-1;n++){let o=i[n],a=i[n+1],s=o.dist(a);if(h+s>c){let d=(c-h)/s,p=eh(o.x,a.x,d),f=eh(o.y,a.y,d),m=new aZ(p,f,a.angleTo(o),n);return m._round(),!l||aV(i,m,u,l,r)?m:void 0}h+=s}}(i,A,o.vertical||v,a,0,w);r&&R(i,r)}}else if("Polygon"===n.type)for(let i of oP(n.geometry,0)){let r=function(i,r=1,n=!1){let o=1/0,a=1/0,s=-1/0,l=-1/0,u=i[0];for(let i=0;i<u.length;i++){let r=u[i];(!i||r.x<o)&&(o=r.x),(!i||r.y<a)&&(a=r.y),(!i||r.x>s)&&(s=r.x),(!i||r.y>l)&&(l=r.y)}let h=Math.min(s-o,l-a),c=h/2,d=new aJ([],aQ);if(0===h)return new I(o,a);for(let r=o;r<s;r+=h)for(let n=a;n<l;n+=h)d.push(new a0(r+c,n+c,c,i));let p=function(i){let r=0,n=0,o=0,a=i[0];for(let i=0,s=a.length,l=s-1;i<s;l=i++){let s=a[i],u=a[l],h=s.x*u.y-u.x*s.y;n+=(s.x+u.x)*h,o+=(s.y+u.y)*h,r+=3*h}return new a0(n/r,o/r,0,i)}(i),f=d.length;for(;d.length;){let o=d.pop();(o.d>p.d||!p.d)&&(p=o,n&&console.log("found best %d after %d probes",Math.round(1e4*o.d)/1e4,f)),o.max-p.d<=r||(c=o.h/2,d.push(new a0(o.p.x-c,o.p.y-c,c,i)),d.push(new a0(o.p.x+c,o.p.y-c,c,i)),d.push(new a0(o.p.x-c,o.p.y+c,c,i)),d.push(new a0(o.p.x+c,o.p.y+c,c,i)),f+=4)}return n&&(console.log(`num probes: ${f}`),console.log(`best distance: ${p.d}`)),p.p}(i,16);R(i[0],new aZ(r.x,r.y,0))}else if("LineString"===n.type)for(let i of n.geometry)R(i,new aZ(i[0].x,i[0].y,0));else if("Point"===n.type)for(let i of n.geometry)for(let r of i)R([r],new aZ(r.x,r.y,0))}(r.bucket,o,m,y,r.imageMap,a,p,f,v,x,r.canonical)}r.showCollisionBoxes&&r.bucket.generateCollisionDebugBuffers()},i.perspective=function(i,r,n,o,a){var s,l=1/Math.tan(r/2);return i[0]=l/n,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=l,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[11]=-1,i[12]=0,i[13]=0,i[15]=0,null!=a&&a!==1/0?(i[10]=(a+o)*(s=1/(o-a)),i[14]=2*a*o*s):(i[10]=-1,i[14]=-2*o),i},i.pick=function(i,r){let n={};for(let o=0;o<r.length;o++){let a=r[o];a in i&&(n[a]=i[a])}return n},i.plugin=rn,i.pointGeometry=I,i.polygonIntersectsPolygon=nj,i.potpack=aI,i.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],i.register=iW,i.registerForPluginStateChange=function(i){return i({pluginStatus:i8,pluginURL:i9}),re.on("pluginStateChange",i),i},i.renderColorRamp=oo,i.rotateX=function(i,r,n){var o=Math.sin(n),a=Math.cos(n),s=r[4],l=r[5],u=r[6],h=r[7],c=r[8],d=r[9],p=r[10],f=r[11];return r!==i&&(i[0]=r[0],i[1]=r[1],i[2]=r[2],i[3]=r[3],i[12]=r[12],i[13]=r[13],i[14]=r[14],i[15]=r[15]),i[4]=s*a+c*o,i[5]=l*a+d*o,i[6]=u*a+p*o,i[7]=h*a+f*o,i[8]=c*a-s*o,i[9]=d*a-l*o,i[10]=p*a-u*o,i[11]=f*a-h*o,i},i.rotateZ=function(i,r,n){var o=Math.sin(n),a=Math.cos(n),s=r[0],l=r[1],u=r[2],h=r[3],c=r[4],d=r[5],p=r[6],f=r[7];return r!==i&&(i[8]=r[8],i[9]=r[9],i[10]=r[10],i[11]=r[11],i[12]=r[12],i[13]=r[13],i[14]=r[14],i[15]=r[15]),i[0]=s*a+c*o,i[1]=l*a+d*o,i[2]=u*a+p*o,i[3]=h*a+f*o,i[4]=c*a-s*o,i[5]=d*a-l*o,i[6]=p*a-u*o,i[7]=f*a-h*o,i},i.scale=function(i,r,n){var o=n[0],a=n[1],s=n[2];return i[0]=r[0]*o,i[1]=r[1]*o,i[2]=r[2]*o,i[3]=r[3]*o,i[4]=r[4]*a,i[5]=r[5]*a,i[6]=r[6]*a,i[7]=r[7]*a,i[8]=r[8]*s,i[9]=r[9]*s,i[10]=r[10]*s,i[11]=r[11]*s,i[12]=r[12],i[13]=r[13],i[14]=r[14],i[15]=r[15],i},i.scale$1=function(i,r,n){return i[0]=r[0]*n,i[1]=r[1]*n,i[2]=r[2]*n,i},i.setCacheLimits=function(i,r){D=i,R=r},i.setRTLTextPlugin=function(i,r,n=!1){if(i8===i3||i8===i5||i8===i4)throw Error("setRTLTextPlugin cannot be called multiple times.");i9=C.resolveURL(i),i8=i3,i6=r,rt(),n||rr()},i.spec=tn,i.sphericalToCartesian=function([i,r,n]){return r+=90,{x:i*Math.cos(r*=Math.PI/180)*Math.sin(n*=Math.PI/180),y:i*Math.sin(r)*Math.sin(n),z:i*Math.cos(n)}},i.sqrLen=function(i){var r=i[0],n=i[1];return r*r+n*n},i.sub=function(i,r,n){return i[0]=r[0]-n[0],i[1]=r[1]-n[1],i[2]=r[2]-n[2],i},i.toEvaluationFeature=nF,i.transformMat3=function(i,r,n){var o=r[0],a=r[1],s=r[2];return i[0]=o*n[0]+a*n[3]+s*n[6],i[1]=o*n[1]+a*n[4]+s*n[7],i[2]=o*n[2]+a*n[5]+s*n[8],i},i.transformMat4=n4,i.transformMat4$1=function(i,r,n){var o=r[0],a=r[1];return i[0]=n[0]*o+n[4]*a+n[12],i[1]=n[1]*o+n[5]*a+n[13],i},i.translate=function(i,r,n){var o,a,s,l,u,h,c,d,p,f,m,g,_=n[0],y=n[1],v=n[2];return r===i?(i[12]=r[0]*_+r[4]*y+r[8]*v+r[12],i[13]=r[1]*_+r[5]*y+r[9]*v+r[13],i[14]=r[2]*_+r[6]*y+r[10]*v+r[14],i[15]=r[3]*_+r[7]*y+r[11]*v+r[15]):(a=r[1],s=r[2],l=r[3],u=r[4],h=r[5],c=r[6],d=r[7],p=r[8],f=r[9],m=r[10],g=r[11],i[0]=o=r[0],i[1]=a,i[2]=s,i[3]=l,i[4]=u,i[5]=h,i[6]=c,i[7]=d,i[8]=p,i[9]=f,i[10]=m,i[11]=g,i[12]=o*_+u*y+p*v+r[12],i[13]=a*_+h*y+f*v+r[13],i[14]=s*_+c*y+m*v+r[14],i[15]=l*_+d*y+g*v+r[15]),i},i.triggerPluginCompletionEvent=i7,i.unicodeBlockLookup=iY,i.uniqueId=function(){return c++},i.validateCustomStyleLayer=function(i){let r=[],n=i.id;return void 0===n&&r.push({message:`layers.${n}: missing required property "id"`}),void 0===i.render&&r.push({message:`layers.${n}: missing required method "render"`}),i.renderingMode&&"2d"!==i.renderingMode&&"3d"!==i.renderingMode&&r.push({message:`layers.${n}: property "renderingMode" must be either "2d" or "3d"`}),r},i.validateLight=ij,i.validateStyle=iF,i.vectorTile=oN,i.warnOnce=_,i.wrap=u}),o(["./shared"],function(i){class r{constructor(i){this.keyCache={},i&&this.replace(i)}replace(i){this._layerConfigs={},this._layers={},this.update(i,[])}update(r,n){for(let n of r){this._layerConfigs[n.id]=n;let r=this._layers[n.id]=i.createStyleLayer(n);r._featureFilter=i.createFilter(r.filter),this.keyCache[n.id]&&delete this.keyCache[n.id]}for(let i of n)delete this.keyCache[i],delete this._layerConfigs[i],delete this._layers[i];this.familiesBySource={};let o=function(r,n){let o={};for(let a=0;a<r.length;a++){let s=n&&n[r[a].id]||function(r){let n="";for(let o of i.refProperties)n+=`/${function i(r){let n=typeof r;if("number"===n||"boolean"===n||"string"===n||null==r)return JSON.stringify(r);if(Array.isArray(r)){let n="[";for(let o of r)n+=`${i(o)},`;return`${n}]`}let o=Object.keys(r).sort(),a="{";for(let n=0;n<o.length;n++)a+=`${JSON.stringify(o[n])}:${i(r[o[n]])},`;return`${a}}`}(r[o])}`;return n}(r[a]);n&&(n[r[a].id]=s);let l=o[s];l||(l=o[s]=[]),l.push(r[a])}let a=[];for(let i in o)a.push(o[i]);return a}(Object.values(this._layerConfigs),this.keyCache);for(let i of o){let r=i.map(i=>this._layers[i.id]),n=r[0];if("none"===n.visibility)continue;let o=n.source||"",a=this.familiesBySource[o];a||(a=this.familiesBySource[o]={});let s=n.sourceLayer||"_geojsonTileLayer",l=a[s];l||(l=a[s]=[]),l.push(r)}}}class n{constructor(r){let n={},o=[];for(let i in r){let a=r[i],s=n[i]={};for(let i in a){let r=a[+i];if(!r||0===r.bitmap.width||0===r.bitmap.height)continue;let n={x:0,y:0,w:r.bitmap.width+2,h:r.bitmap.height+2};o.push(n),s[i]={rect:n,metrics:r.metrics}}}let{w:a,h:s}=i.potpack(o),l=new i.AlphaImage({width:a||1,height:s||1});for(let o in r){let a=r[o];for(let r in a){let s=a[+r];if(!s||0===s.bitmap.width||0===s.bitmap.height)continue;let u=n[o][r].rect;i.AlphaImage.copy(s.bitmap,l,{x:0,y:0},{x:u.x+1,y:u.y+1},s.bitmap)}}this.image=l,this.positions=n}}i.register("GlyphAtlas",n);class o{constructor(r){this.tileID=new i.OverscaledTileID(r.tileID.overscaledZ,r.tileID.wrap,r.tileID.canonical.z,r.tileID.canonical.x,r.tileID.canonical.y),this.uid=r.uid,this.zoom=r.zoom,this.pixelRatio=r.pixelRatio,this.tileSize=r.tileSize,this.source=r.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=r.showCollisionBoxes,this.collectResourceTiming=!!r.collectResourceTiming,this.returnDependencies=!!r.returnDependencies,this.promoteId=r.promoteId}parse(r,o,s,l,u){let h,c,d,p;this.status="parsing",this.data=r,this.collisionBoxArray=new i.CollisionBoxArray;let f=new i.DictionaryCoder(Object.keys(r.layers).sort()),m=new i.FeatureIndex(this.tileID,this.promoteId);m.bucketLayerIDs=[];let g={},_={featureIndex:m,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:s},y=o.familiesBySource[this.source];for(let n in y){let o=r.layers[n];if(!o)continue;1===o.version&&i.warnOnce(`Vector tile source "${this.source}" layer "${n}" does not use vector tile spec v2 and therefore may have some rendering errors.`);let l=f.encode(n),u=[];for(let i=0;i<o.length;i++){let r=o.feature(i),a=m.getId(r,n);u.push({feature:r,id:a,index:i,sourceLayerIndex:l})}for(let r of y[n]){let n=r[0];n.source!==this.source&&i.warnOnce(`layer.source = ${n.source} does not equal this.source = ${this.source}`),n.minzoom&&this.zoom<Math.floor(n.minzoom)||n.maxzoom&&this.zoom>=n.maxzoom||"none"!==n.visibility&&(a(r,this.zoom,s),(g[n.id]=n.createBucket({index:m.bucketLayerIDs.length,layers:r,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:l,sourceID:this.source})).populate(u,_,this.tileID.canonical),m.bucketLayerIDs.push(r.map(i=>i.id)))}}let v=i.mapObject(_.glyphDependencies,i=>Object.keys(i).map(Number));Object.keys(v).length?l.send("getGlyphs",{uid:this.uid,stacks:v},(i,r)=>{h||(h=i,c=r,w.call(this))}):c={};let x=Object.keys(_.iconDependencies);x.length?l.send("getImages",{icons:x,source:this.source,tileID:this.tileID,type:"icons"},(i,r)=>{h||(h=i,d=r,w.call(this))}):d={};let b=Object.keys(_.patternDependencies);function w(){if(h)return u(h);if(c&&d&&p){let r=new n(c),o=new i.ImageAtlas(d,p);for(let n in g){let l=g[n];l instanceof i.SymbolBucket?(a(l.layers,this.zoom,s),i.performSymbolLayout({bucket:l,glyphMap:c,glyphPositions:r.positions,imageMap:d,imagePositions:o.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical})):l.hasPattern&&(l instanceof i.LineBucket||l instanceof i.FillBucket||l instanceof i.FillExtrusionBucket)&&(a(l.layers,this.zoom,s),l.addFeatures(_,this.tileID.canonical,o.patternPositions))}this.status="done",u(null,{buckets:Object.values(g).filter(i=>!i.isEmpty()),featureIndex:m,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:r.image,imageAtlas:o,glyphMap:this.returnDependencies?c:null,iconMap:this.returnDependencies?d:null,glyphPositions:this.returnDependencies?r.positions:null})}}b.length?l.send("getImages",{icons:b,source:this.source,tileID:this.tileID,type:"patterns"},(i,r)=>{h||(h=i,p=r,w.call(this))}):p={},w.call(this)}}function a(r,n,o){let a=new i.EvaluationParameters(n);for(let i of r)i.recalculate(a,o)}function s(r,n){let o=i.getArrayBuffer(r.request,(r,o,a,s)=>{r?n(r):o&&n(null,{vectorTile:new i.vectorTile.VectorTile(new i.pbf(o)),rawData:o,cacheControl:a,expires:s})});return()=>{o.cancel(),n()}}class l{constructor(i,r,n,o){this.actor=i,this.layerIndex=r,this.availableImages=n,this.loadVectorData=o||s,this.loading={},this.loaded={}}loadTile(r,n){let a=r.uid;this.loading||(this.loading={});let s=!!(r&&r.request&&r.request.collectResourceTiming)&&new i.RequestPerformance(r.request),l=this.loading[a]=new o(r);l.abort=this.loadVectorData(r,(r,o)=>{if(delete this.loading[a],r||!o)return l.status="done",this.loaded[a]=l,n(r);let u=o.rawData,h={};o.expires&&(h.expires=o.expires),o.cacheControl&&(h.cacheControl=o.cacheControl);let c={};if(s){let i=s.finish();i&&(c.resourceTiming=JSON.parse(JSON.stringify(i)))}l.vectorTile=o.vectorTile,l.parse(o.vectorTile,this.layerIndex,this.availableImages,this.actor,(r,o)=>{if(r||!o)return n(r);n(null,i.extend({rawTileData:u.slice(0)},o,h,c))}),this.loaded=this.loaded||{},this.loaded[a]=l})}reloadTile(i,r){let n=this.loaded,o=i.uid,a=this;if(n&&n[o]){let s=n[o];s.showCollisionBoxes=i.showCollisionBoxes;let l=(i,n)=>{let o=s.reloadCallback;o&&(delete s.reloadCallback,s.parse(s.vectorTile,a.layerIndex,this.availableImages,a.actor,o)),r(i,n)};"parsing"===s.status?s.reloadCallback=l:"done"===s.status&&(s.vectorTile?s.parse(s.vectorTile,this.layerIndex,this.availableImages,this.actor,l):l())}}abortTile(i,r){let n=this.loading,o=i.uid;n&&n[o]&&n[o].abort&&(n[o].abort(),delete n[o]),r()}removeTile(i,r){let n=this.loaded,o=i.uid;n&&n[o]&&delete n[o],r()}}class u{constructor(){this.loaded={}}loadTile(r,n){let{uid:o,encoding:a,rawImageData:s}=r,l=i.isImageBitmap(s)?this.getImageData(s):s,u=new i.DEMData(o,l,a);this.loaded=this.loaded||{},this.loaded[o]=u,n(null,u)}getImageData(r){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(r.width,r.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d")),this.offscreenCanvas.width=r.width,this.offscreenCanvas.height=r.height,this.offscreenCanvasContext.drawImage(r,0,0,r.width,r.height);let n=this.offscreenCanvasContext.getImageData(-1,-1,r.width+2,r.height+2);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),new i.RGBAImage({width:n.width,height:n.height},n.data)}removeTile(i){let r=this.loaded,n=i.uid;r&&r[n]&&delete r[n]}}var h,c=function i(r,n){var o,a=r&&r.type;if("FeatureCollection"===a)for(o=0;o<r.features.length;o++)i(r.features[o],n);else if("GeometryCollection"===a)for(o=0;o<r.geometries.length;o++)i(r.geometries[o],n);else if("Feature"===a)i(r.geometry,n);else if("Polygon"===a)d(r.coordinates,n);else if("MultiPolygon"===a)for(o=0;o<r.coordinates.length;o++)d(r.coordinates[o],n);return r};function d(i,r){if(0!==i.length){p(i[0],r);for(var n=1;n<i.length;n++)p(i[n],!r)}}function p(i,r){for(var n=0,o=0,a=0,s=i.length,l=s-1;a<s;l=a++){var u=(i[a][0]-i[l][0])*(i[l][1]+i[a][1]),h=n+u;o+=Math.abs(n)>=Math.abs(u)?n-h+u:u-h+n,n=h}n+o>=0!=!!r&&i.reverse()}let f=i.vectorTile.VectorTileFeature.prototype.toGeoJSON;class m{constructor(r){this._feature=r,this.extent=i.EXTENT,this.type=r.type,this.properties=r.tags,"id"in r&&!isNaN(r.id)&&(this.id=parseInt(r.id,10))}loadGeometry(){if(1===this._feature.type){let r=[];for(let n of this._feature.geometry)r.push([new i.pointGeometry(n[0],n[1])]);return r}{let r=[];for(let n of this._feature.geometry){let o=[];for(let r of n)o.push(new i.pointGeometry(r[0],r[1]));r.push(o)}return r}}toGeoJSON(i,r,n){return f.call(this,i,r,n)}}class g{constructor(r){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=i.EXTENT,this.length=r.length,this._features=r}feature(i){return new m(this._features[i])}}var _={exports:{}},y=i.pointGeometry,v=i.vectorTile.VectorTileFeature;function x(i,r){this.options=r||{},this.features=i,this.length=i.length}function b(i,r){this.id="number"==typeof i.id?i.id:void 0,this.type=i.type,this.rawGeometry=1===i.type?[i.geometry]:i.geometry,this.properties=i.tags,this.extent=r||4096}x.prototype.feature=function(i){return new b(this.features[i],this.options.extent)},b.prototype.loadGeometry=function(){var i=this.rawGeometry;this.geometry=[];for(var r=0;r<i.length;r++){for(var n=i[r],o=[],a=0;a<n.length;a++)o.push(new y(n[a][0],n[a][1]));this.geometry.push(o)}return this.geometry},b.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var i=this.geometry,r=1/0,n=-1/0,o=1/0,a=-1/0,s=0;s<i.length;s++)for(var l=i[s],u=0;u<l.length;u++){var h=l[u];r=Math.min(r,h.x),n=Math.max(n,h.x),o=Math.min(o,h.y),a=Math.max(a,h.y)}return[r,o,n,a]},b.prototype.toGeoJSON=v.prototype.toGeoJSON;var w=i.pbf;function T(i){var r=new w;return function(i,r){for(var n in i.layers)r.writeMessage(3,E,i.layers[n])}(i,r),r.finish()}function E(i,r){r.writeVarintField(15,i.version||1),r.writeStringField(1,i.name||""),r.writeVarintField(5,i.extent||4096);var n,o={keys:[],values:[],keycache:{},valuecache:{}};for(n=0;n<i.length;n++)o.feature=i.feature(n),r.writeMessage(2,S,o);var a=o.keys;for(n=0;n<a.length;n++)r.writeStringField(3,a[n]);var s=o.values;for(n=0;n<s.length;n++)r.writeMessage(4,A,s[n])}function S(i,r){var n=i.feature;void 0!==n.id&&r.writeVarintField(1,n.id),r.writeMessage(2,C,i),r.writeVarintField(3,n.type),r.writeMessage(4,I,n)}function C(i,r){var n=i.feature,o=i.keys,a=i.values,s=i.keycache,l=i.valuecache;for(var u in n.properties){var h=n.properties[u],c=s[u];if(null!==h){void 0===c&&(o.push(u),s[u]=c=o.length-1),r.writeVarint(c);var d=typeof h;"string"!==d&&"boolean"!==d&&"number"!==d&&(h=JSON.stringify(h));var p=d+":"+h,f=l[p];void 0===f&&(a.push(h),l[p]=f=a.length-1),r.writeVarint(f)}}}function I(i,r){for(var n=i.loadGeometry(),o=i.type,a=0,s=0,l=n.length,u=0;u<l;u++){var h=n[u],c=1;1===o&&(c=h.length),r.writeVarint((c<<3)+1);for(var d=3===o?h.length-1:h.length,p=0;p<d;p++){1===p&&1!==o&&r.writeVarint((d-1<<3)+2);var f=h[p].x-a,m=h[p].y-s;r.writeVarint(f<<1^f>>31),r.writeVarint(m<<1^m>>31),a+=f,s+=m}3===o&&r.writeVarint(15)}}function A(i,r){var n=typeof i;"string"===n?r.writeStringField(1,i):"boolean"===n?r.writeBooleanField(7,i):"number"===n&&(i%1!=0?r.writeDoubleField(3,i):i<0?r.writeSVarintField(6,i):r.writeVarintField(5,i))}function P(i,r,n,o){k(i,n,o),k(r,2*n,2*o),k(r,2*n+1,2*o+1)}function k(i,r,n){let o=i[r];i[r]=i[n],i[n]=o}function M(i,r,n,o){let a=i-n,s=r-o;return a*a+s*s}_.exports=T,_.exports.fromVectorTileJs=T,_.exports.fromGeojsonVt=function(i,r){r=r||{};var n={};for(var o in i)n[o]=new x(i[o].features,r),n[o].name=o,n[o].version=r.version,n[o].extent=r.extent;return T({layers:n})},_.exports.GeoJSONWrapper=x;let z=i=>i[0],D=i=>i[1];class R{constructor(i,r=z,n=D,o=64,a=Float64Array){this.nodeSize=o,this.points=i;let s=i.length<65536?Uint16Array:Uint32Array,l=this.ids=new s(i.length),u=this.coords=new a(2*i.length);for(let o=0;o<i.length;o++)l[o]=o,u[2*o]=r(i[o]),u[2*o+1]=n(i[o]);!function i(r,n,o,a,s,l){if(s-a<=o)return;let u=a+s>>1;(function i(r,n,o,a,s,l){for(;s>a;){if(s-a>600){let u=s-a+1,h=o-a+1,c=Math.log(u),d=.5*Math.exp(2*c/3),p=.5*Math.sqrt(c*d*(u-d)/u)*(h-u/2<0?-1:1);i(r,n,o,Math.max(a,Math.floor(o-h*d/u+p)),Math.min(s,Math.floor(o+(u-h)*d/u+p)),l)}let u=n[2*o+l],h=a,c=s;for(P(r,n,a,o),n[2*s+l]>u&&P(r,n,a,s);h<c;){for(P(r,n,h,c),h++,c--;n[2*h+l]<u;)h++;for(;n[2*c+l]>u;)c--}n[2*a+l]===u?P(r,n,a,c):P(r,n,++c,s),c<=o&&(a=c+1),o<=c&&(s=c-1)}})(r,n,u,a,s,l%2),i(r,n,o,a,u-1,l+1),i(r,n,o,u+1,s,l+1)}(l,u,o,0,l.length-1,0)}range(i,r,n,o){return function(i,r,n,o,a,s,l){let u,h;let c=[0,i.length-1,0],d=[];for(;c.length;){let p=c.pop(),f=c.pop(),m=c.pop();if(f-m<=l){for(let l=m;l<=f;l++)u=r[2*l],h=r[2*l+1],u>=n&&u<=a&&h>=o&&h<=s&&d.push(i[l]);continue}let g=Math.floor((m+f)/2);u=r[2*g],h=r[2*g+1],u>=n&&u<=a&&h>=o&&h<=s&&d.push(i[g]);let _=(p+1)%2;(0===p?n<=u:o<=h)&&(c.push(m),c.push(g-1),c.push(_)),(0===p?a>=u:s>=h)&&(c.push(g+1),c.push(f),c.push(_))}return d}(this.ids,this.coords,i,r,n,o,this.nodeSize)}within(i,r,n){return function(i,r,n,o,a,s){let l=[0,i.length-1,0],u=[],h=a*a;for(;l.length;){let c=l.pop(),d=l.pop(),p=l.pop();if(d-p<=s){for(let a=p;a<=d;a++)M(r[2*a],r[2*a+1],n,o)<=h&&u.push(i[a]);continue}let f=Math.floor((p+d)/2),m=r[2*f],g=r[2*f+1];M(m,g,n,o)<=h&&u.push(i[f]);let _=(c+1)%2;(0===c?n-a<=m:o-a<=g)&&(l.push(p),l.push(f-1),l.push(_)),(0===c?n+a>=m:o+a>=g)&&(l.push(f+1),l.push(d),l.push(_))}return u}(this.ids,this.coords,i,r,n,this.nodeSize)}}let B={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:i=>i},O=Math.fround||(h=new Float32Array(1),i=>(h[0]=+i,h[0]));class F{constructor(i){this.options=V(Object.create(B),i),this.trees=Array(this.options.maxZoom+1)}load(i){let{log:r,minZoom:n,maxZoom:o,nodeSize:a}=this.options;r&&console.time("total time");let s=`prepare ${i.length} points`;r&&console.time(s),this.points=i;let l=[];for(let r=0;r<i.length;r++)i[r].geometry&&l.push(function(i,r){let[n,o]=i.geometry.coordinates;return{x:O(j(n)),y:O(Z(o)),zoom:1/0,index:r,parentId:-1}}(i[r],r));this.trees[o+1]=new R(l,q,G,a,Float32Array),r&&console.timeEnd(s);for(let i=o;i>=n;i--){let n=+Date.now();l=this._cluster(l,i),this.trees[i]=new R(l,q,G,a,Float32Array),r&&console.log("z%d: %d clusters in %dms",i,l.length,+Date.now()-n)}return r&&console.timeEnd("total time"),this}getClusters(i,r){let n=((i[0]+180)%360+360)%360-180,o=Math.max(-90,Math.min(90,i[1])),a=180===i[2]?180:((i[2]+180)%360+360)%360-180,s=Math.max(-90,Math.min(90,i[3]));if(i[2]-i[0]>=360)n=-180,a=180;else if(n>a){let i=this.getClusters([n,o,180,s],r),l=this.getClusters([-180,o,a,s],r);return i.concat(l)}let l=this.trees[this._limitZoom(r)],u=l.range(j(n),Z(s),j(a),Z(o)),h=[];for(let i of u){let r=l.points[i];h.push(r.numPoints?N(r):this.points[r.index])}return h}getChildren(i){let r=this._getOriginId(i),n=this._getOriginZoom(i),o="No cluster with the specified id.",a=this.trees[n];if(!a)throw Error(o);let s=a.points[r];if(!s)throw Error(o);let l=this.options.radius/(this.options.extent*Math.pow(2,n-1)),u=a.within(s.x,s.y,l),h=[];for(let r of u){let n=a.points[r];n.parentId===i&&h.push(n.numPoints?N(n):this.points[n.index])}if(0===h.length)throw Error(o);return h}getLeaves(i,r,n){let o=[];return this._appendLeaves(o,i,r=r||10,n=n||0,0),o}getTile(i,r,n){let o=this.trees[this._limitZoom(i)],a=Math.pow(2,i),{extent:s,radius:l}=this.options,u=l/s,h=(n-u)/a,c=(n+1+u)/a,d={features:[]};return this._addTileFeatures(o.range((r-u)/a,h,(r+1+u)/a,c),o.points,r,n,a,d),0===r&&this._addTileFeatures(o.range(1-u/a,h,1,c),o.points,a,n,a,d),r===a-1&&this._addTileFeatures(o.range(0,h,u/a,c),o.points,-1,n,a,d),d.features.length?d:null}getClusterExpansionZoom(i){let r=this._getOriginZoom(i)-1;for(;r<=this.options.maxZoom;){let n=this.getChildren(i);if(r++,1!==n.length)break;i=n[0].properties.cluster_id}return r}_appendLeaves(i,r,n,o,a){let s=this.getChildren(r);for(let r of s){let s=r.properties;if(s&&s.cluster?a+s.point_count<=o?a+=s.point_count:a=this._appendLeaves(i,s.cluster_id,n,o,a):a<o?a++:i.push(r),i.length===n)break}return a}_addTileFeatures(i,r,n,o,a,s){for(let l of i){let i,u,h,c;let d=r[l],p=d.numPoints;if(p)i=U(d),u=d.x,h=d.y;else{let r=this.points[d.index];i=r.properties,u=j(r.geometry.coordinates[0]),h=Z(r.geometry.coordinates[1])}let f={type:1,geometry:[[Math.round(this.options.extent*(u*a-n)),Math.round(this.options.extent*(h*a-o))]],tags:i};p?c=d.id:this.options.generateId?c=d.index:this.points[d.index].id&&(c=this.points[d.index].id),void 0!==c&&(f.id=c),s.features.push(f)}}_limitZoom(i){return Math.max(this.options.minZoom,Math.min(Math.floor(+i),this.options.maxZoom+1))}_cluster(i,r){let n=[],{radius:o,extent:a,reduce:s,minPoints:l}=this.options,u=o/(a*Math.pow(2,r));for(let o=0;o<i.length;o++){let a=i[o];if(a.zoom<=r)continue;a.zoom=r;let f=this.trees[r+1],m=f.within(a.x,a.y,u),g=a.numPoints||1,_=g;for(let i of m){let n=f.points[i];n.zoom>r&&(_+=n.numPoints||1)}if(_>g&&_>=l){var h,c,d,p;let i=a.x*g,l=a.y*g,u=s&&g>1?this._map(a,!0):null,y=(o<<5)+(r+1)+this.points.length;for(let n of m){let o=f.points[n];if(o.zoom<=r)continue;o.zoom=r;let h=o.numPoints||1;i+=o.x*h,l+=o.y*h,o.parentId=y,s&&(u||(u=this._map(a,!0)),s(u,this._map(o)))}a.parentId=y,n.push((h=i/_,c=l/_,d=_,p=u,{x:O(h),y:O(c),zoom:1/0,id:y,parentId:-1,numPoints:d,properties:p}))}else if(n.push(a),_>1)for(let i of m){let o=f.points[i];o.zoom<=r||(o.zoom=r,n.push(o))}}return n}_getOriginId(i){return i-this.points.length>>5}_getOriginZoom(i){return(i-this.points.length)%32}_map(i,r){if(i.numPoints)return r?V({},i.properties):i.properties;let n=this.points[i.index].properties,o=this.options.map(n);return r&&o===n?V({},o):o}}function N(i){return{type:"Feature",id:i.id,properties:U(i),geometry:{type:"Point",coordinates:[360*(i.x-.5),function(i){let r=(180-360*i)*Math.PI/180;return 360*Math.atan(Math.exp(r))/Math.PI-90}(i.y)]}}}function U(i){let r=i.numPoints,n=r>=1e4?`${Math.round(r/1e3)}k`:r>=1e3?Math.round(r/100)/10+"k":r;return V(V({},i.properties),{cluster:!0,cluster_id:i.id,point_count:r,point_count_abbreviated:n})}function j(i){return i/360+.5}function Z(i){let r=Math.sin(i*Math.PI/180),n=.5-.25*Math.log((1+r)/(1-r))/Math.PI;return n<0?0:n>1?1:n}function V(i,r){for(let n in r)i[n]=r[n];return i}function q(i){return i.x}function G(i){return i.y}function W(i,r,n,o){var a={id:void 0===i?null:i,type:r,geometry:n,tags:o,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(i){var r=i.geometry,n=i.type;if("Point"===n||"MultiPoint"===n||"LineString"===n)H(i,r);else if("Polygon"===n||"MultiLineString"===n)for(var o=0;o<r.length;o++)H(i,r[o]);else if("MultiPolygon"===n)for(o=0;o<r.length;o++)for(var a=0;a<r[o].length;a++)H(i,r[o][a])}(a),a}function H(i,r){for(var n=0;n<r.length;n+=3)i.minX=Math.min(i.minX,r[n]),i.minY=Math.min(i.minY,r[n+1]),i.maxX=Math.max(i.maxX,r[n]),i.maxY=Math.max(i.maxY,r[n+1])}function X(i,r,n,o){if(r.geometry){var a=r.geometry.coordinates,s=r.geometry.type,l=Math.pow(n.tolerance/((1<<n.maxZoom)*n.extent),2),u=[],h=r.id;if(n.promoteId?h=r.properties[n.promoteId]:n.generateId&&(h=o||0),"Point"===s)K(a,u);else if("MultiPoint"===s)for(var c=0;c<a.length;c++)K(a[c],u);else if("LineString"===s)J(a,u,l,!1);else if("MultiLineString"===s){if(n.lineMetrics){for(c=0;c<a.length;c++)J(a[c],u=[],l,!1),i.push(W(h,"LineString",u,r.properties));return}Y(a,u,l,!1)}else if("Polygon"===s)Y(a,u,l,!0);else{if("MultiPolygon"!==s){if("GeometryCollection"===s){for(c=0;c<r.geometry.geometries.length;c++)X(i,{id:h,geometry:r.geometry.geometries[c],properties:r.properties},n,o);return}throw Error("Input data is not a valid GeoJSON object.")}for(c=0;c<a.length;c++){var d=[];Y(a[c],d,l,!0),u.push(d)}}i.push(W(h,s,u,r.properties))}}function K(i,r){var n;r.push(i[0]/360+.5),r.push(Q(i[1])),r.push(0)}function J(i,r,n,o){for(var a,s,l=0,u=0;u<i.length;u++){var h,c=i[u][0]/360+.5,d=Q(i[u][1]);r.push(c),r.push(d),r.push(0),u>0&&(l+=o?(a*d-c*s)/2:Math.sqrt(Math.pow(c-a,2)+Math.pow(d-s,2))),a=c,s=d}var p=r.length-3;r[2]=1,function i(r,n,o,a){for(var s,l=a,u=o-n>>1,h=o-n,c=r[n],d=r[n+1],p=r[o],f=r[o+1],m=n+3;m<o;m+=3){var g=function(i,r,n,o,a,s){var l=a-n,u=s-o;if(0!==l||0!==u){var h=((i-n)*l+(r-o)*u)/(l*l+u*u);h>1?(n=a,o=s):h>0&&(n+=l*h,o+=u*h)}return(l=i-n)*l+(u=r-o)*u}(r[m],r[m+1],c,d,p,f);if(g>l)s=m,l=g;else if(g===l){var _=Math.abs(m-u);_<h&&(s=m,h=_)}}l>a&&(s-n>3&&i(r,n,s,a),r[s+2]=l,o-s>3&&i(r,s,o,a))}(r,0,p,n),r[p+2]=1,r.size=Math.abs(l),r.start=0,r.end=r.size}function Y(i,r,n,o){for(var a=0;a<i.length;a++){var s=[];J(i[a],s,n,o),r.push(s)}}function Q(i){var r=Math.sin(i*Math.PI/180),n=.5-.25*Math.log((1+r)/(1-r))/Math.PI;return n<0?0:n>1?1:n}function tt(i,r,n,o,a,s,l,u){if(o/=r,s>=(n/=r)&&l<o)return i;if(l<n||s>=o)return null;for(var h=[],c=0;c<i.length;c++){var d=i[c],p=d.geometry,f=d.type,m=0===a?d.minX:d.minY,g=0===a?d.maxX:d.maxY;if(m>=n&&g<o)h.push(d);else if(!(g<n||m>=o)){var _=[];if("Point"===f||"MultiPoint"===f)(function(i,r,n,o,a){for(var s=0;s<i.length;s+=3){var l=i[s+a];l>=n&&l<=o&&(r.push(i[s]),r.push(i[s+1]),r.push(i[s+2]))}})(p,_,n,o,a);else if("LineString"===f)te(p,_,n,o,a,!1,u.lineMetrics);else if("MultiLineString"===f)tr(p,_,n,o,a,!1);else if("Polygon"===f)tr(p,_,n,o,a,!0);else if("MultiPolygon"===f)for(var y=0;y<p.length;y++){var v=[];tr(p[y],v,n,o,a,!0),v.length&&_.push(v)}if(_.length){if(u.lineMetrics&&"LineString"===f){for(y=0;y<_.length;y++)h.push(W(d.id,f,_[y],d.tags));continue}"LineString"!==f&&"MultiLineString"!==f||(1===_.length?(f="LineString",_=_[0]):f="MultiLineString"),"Point"!==f&&"MultiPoint"!==f||(f=3===_.length?"Point":"MultiPoint"),h.push(W(d.id,f,_,d.tags))}}}return h.length?h:null}function te(i,r,n,o,a,s,l){for(var u,h,c=ti(i),d=0===a?to:ta,p=i.start,f=0;f<i.length-3;f+=3){var m=i[f],g=i[f+1],_=i[f+2],y=i[f+3],v=i[f+4],x=0===a?m:g,b=0===a?y:v,w=!1;l&&(u=Math.sqrt(Math.pow(m-y,2)+Math.pow(g-v,2))),x<n?b>n&&(h=d(c,m,g,y,v,n),l&&(c.start=p+u*h)):x>o?b<o&&(h=d(c,m,g,y,v,o),l&&(c.start=p+u*h)):tn(c,m,g,_),b<n&&x>=n&&(h=d(c,m,g,y,v,n),w=!0),b>o&&x<=o&&(h=d(c,m,g,y,v,o),w=!0),!s&&w&&(l&&(c.end=p+u*h),r.push(c),c=ti(i)),l&&(p+=u)}var T=i.length-3;m=i[T],g=i[T+1],_=i[T+2],(x=0===a?m:g)>=n&&x<=o&&tn(c,m,g,_),T=c.length-3,s&&T>=3&&(c[T]!==c[0]||c[T+1]!==c[1])&&tn(c,c[0],c[1],c[2]),c.length&&r.push(c)}function ti(i){var r=[];return r.size=i.size,r.start=i.start,r.end=i.end,r}function tr(i,r,n,o,a,s){for(var l=0;l<i.length;l++)te(i[l],r,n,o,a,s,!1)}function tn(i,r,n,o){i.push(r),i.push(n),i.push(o)}function to(i,r,n,o,a,s){var l=(s-r)/(o-r);return i.push(s),i.push(n+(a-n)*l),i.push(1),l}function ta(i,r,n,o,a,s){var l=(s-n)/(a-n);return i.push(r+(o-r)*l),i.push(s),i.push(1),l}function ts(i,r){for(var n=[],o=0;o<i.length;o++){var a,s=i[o],l=s.type;if("Point"===l||"MultiPoint"===l||"LineString"===l)a=tl(s.geometry,r);else if("MultiLineString"===l||"Polygon"===l){a=[];for(var u=0;u<s.geometry.length;u++)a.push(tl(s.geometry[u],r))}else if("MultiPolygon"===l)for(a=[],u=0;u<s.geometry.length;u++){for(var h=[],c=0;c<s.geometry[u].length;c++)h.push(tl(s.geometry[u][c],r));a.push(h)}n.push(W(s.id,l,a,s.tags))}return n}function tl(i,r){var n=[];n.size=i.size,void 0!==i.start&&(n.start=i.start,n.end=i.end);for(var o=0;o<i.length;o+=3)n.push(i[o]+r,i[o+1],i[o+2]);return n}function tu(i,r){if(i.transformed)return i;var n,o,a,s=1<<i.z,l=i.x,u=i.y;for(n=0;n<i.features.length;n++){var h=i.features[n],c=h.geometry,d=h.type;if(h.geometry=[],1===d)for(o=0;o<c.length;o+=2)h.geometry.push(th(c[o],c[o+1],r,s,l,u));else for(o=0;o<c.length;o++){var p=[];for(a=0;a<c[o].length;a+=2)p.push(th(c[o][a],c[o][a+1],r,s,l,u));h.geometry.push(p)}}return i.transformed=!0,i}function th(i,r,n,o,a,s){return[Math.round(n*(i*o-a)),Math.round(n*(r*o-s))]}function tc(i,r,n,o,a,s){var l=o*o;if(o>0&&r.size<(a?l:o))n.numPoints+=r.length/3;else{for(var u=[],h=0;h<r.length;h+=3)(0===o||r[h+2]>l)&&(n.numSimplified++,u.push(r[h]),u.push(r[h+1])),n.numPoints++;a&&function(i,r){for(var n=0,o=0,a=i.length,s=a-2;o<a;s=o,o+=2)n+=(i[o]-i[s])*(i[o+1]+i[s+1]);if(n>0===r)for(o=0,a=i.length;o<a/2;o+=2){var l=i[o],u=i[o+1];i[o]=i[a-2-o],i[o+1]=i[a-1-o],i[a-2-o]=l,i[a-1-o]=u}}(u,s),i.push(u)}}function td(i,r){var n,o,a,s,l,u,h=(r=this.options=function(i,r){for(var n in r)i[n]=r[n];return i}(Object.create(this.options),r)).debug;if(h&&console.time("preprocess data"),r.maxZoom<0||r.maxZoom>24)throw Error("maxZoom should be in the 0-24 range");if(r.promoteId&&r.generateId)throw Error("promoteId and generateId cannot be used together.");var c=function(i,r){var n=[];if("FeatureCollection"===i.type)for(var o=0;o<i.features.length;o++)X(n,i.features[o],r,o);else X(n,"Feature"===i.type?i:{geometry:i},r);return n}(i,r);this.tiles={},this.tileCoords=[],h&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",r.indexMaxZoom,r.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),n=c,a=(o=r).buffer/o.extent,s=n,l=tt(n,1,-1-a,a,0,-1,2,o),u=tt(n,1,1-a,2+a,0,-1,2,o),(l||u)&&(s=tt(n,1,-a,1+a,0,-1,2,o)||[],l&&(s=ts(l,1).concat(s)),u&&(s=s.concat(ts(u,-1)))),(c=s).length&&this.splitTile(c,0,0,0),h&&(c.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function tp(i,r,n){return 32*((1<<i)*n+r)+i}function tf(i,r){let n=i.tileID.canonical;if(!this._geoJSONIndex)return r(null,null);let o=this._geoJSONIndex.getTile(n.z,n.x,n.y);if(!o)return r(null,null);let a=new g(o.features),s=_.exports(a);0===s.byteOffset&&s.byteLength===s.buffer.byteLength||(s=new Uint8Array(s)),r(null,{vectorTile:a,rawData:s.buffer})}td.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},td.prototype.splitTile=function(i,r,n,o,a,s,l){for(var u=[i,r,n,o],h=this.options,c=h.debug;u.length;){o=u.pop(),n=u.pop(),r=u.pop(),i=u.pop();var d=1<<r,p=tp(r,n,o),f=this.tiles[p];if(!f&&(c>1&&console.time("creation"),f=this.tiles[p]=function(i,r,n,o,a){for(var s=r===a.maxZoom?0:a.tolerance/((1<<r)*a.extent),l={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:n,y:o,z:r,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},u=0;u<i.length;u++){l.numFeatures++,function(i,r,n,o){var a=r.geometry,s=r.type,l=[];if("Point"===s||"MultiPoint"===s)for(var u=0;u<a.length;u+=3)l.push(a[u]),l.push(a[u+1]),i.numPoints++,i.numSimplified++;else if("LineString"===s)tc(l,a,i,n,!1,!1);else if("MultiLineString"===s||"Polygon"===s)for(u=0;u<a.length;u++)tc(l,a[u],i,n,"Polygon"===s,0===u);else if("MultiPolygon"===s)for(var h=0;h<a.length;h++){var c=a[h];for(u=0;u<c.length;u++)tc(l,c[u],i,n,!0,0===u)}if(l.length){var d=r.tags||null;if("LineString"===s&&o.lineMetrics){for(var p in d={},r.tags)d[p]=r.tags[p];d.mapbox_clip_start=a.start/a.size,d.mapbox_clip_end=a.end/a.size}var f={geometry:l,type:"Polygon"===s||"MultiPolygon"===s?3:"LineString"===s||"MultiLineString"===s?2:1,tags:d};null!==r.id&&(f.id=r.id),i.features.push(f)}}(l,i[u],s,a);var h=i[u].minX,c=i[u].minY,d=i[u].maxX,p=i[u].maxY;h<l.minX&&(l.minX=h),c<l.minY&&(l.minY=c),d>l.maxX&&(l.maxX=d),p>l.maxY&&(l.maxY=p)}return l}(i,r,n,o,h),this.tileCoords.push({z:r,x:n,y:o}),c)){c>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",r,n,o,f.numFeatures,f.numPoints,f.numSimplified),console.timeEnd("creation"));var m="z"+r;this.stats[m]=(this.stats[m]||0)+1,this.total++}if(f.source=i,a){if(r===h.maxZoom||r===a)continue;var g=1<<a-r;if(n!==Math.floor(s/g)||o!==Math.floor(l/g))continue}else if(r===h.indexMaxZoom||f.numPoints<=h.indexMaxPoints)continue;if(f.source=null,0!==i.length){c>1&&console.time("clipping");var _,y,v,x,b,w,T=.5*h.buffer/h.extent,E=.5-T,S=.5+T,C=1+T;_=y=v=x=null,b=tt(i,d,n-T,n+S,0,f.minX,f.maxX,h),w=tt(i,d,n+E,n+C,0,f.minX,f.maxX,h),i=null,b&&(_=tt(b,d,o-T,o+S,1,f.minY,f.maxY,h),y=tt(b,d,o+E,o+C,1,f.minY,f.maxY,h),b=null),w&&(v=tt(w,d,o-T,o+S,1,f.minY,f.maxY,h),x=tt(w,d,o+E,o+C,1,f.minY,f.maxY,h),w=null),c>1&&console.timeEnd("clipping"),u.push(_||[],r+1,2*n,2*o),u.push(y||[],r+1,2*n,2*o+1),u.push(v||[],r+1,2*n+1,2*o),u.push(x||[],r+1,2*n+1,2*o+1)}}},td.prototype.getTile=function(i,r,n){var o=this.options,a=o.extent,s=o.debug;if(i<0||i>24)return null;var l=1<<i,u=tp(i,r=(r%l+l)%l,n);if(this.tiles[u])return tu(this.tiles[u],a);s>1&&console.log("drilling down to z%d-%d-%d",i,r,n);for(var h,c=i,d=r,p=n;!h&&c>0;)c--,d=Math.floor(d/2),p=Math.floor(p/2),h=this.tiles[tp(c,d,p)];return h&&h.source?(s>1&&console.log("found parent tile z%d-%d-%d",c,d,p),s>1&&console.time("drilling down"),this.splitTile(h.source,c,d,p,i,r,n),s>1&&console.timeEnd("drilling down"),this.tiles[u]?tu(this.tiles[u],a):null):null};class tm extends l{constructor(i,r,n,o){super(i,r,n,tf),o&&(this.loadGeoJSON=o)}loadData(r,n){var o;null===(o=this._pendingRequest)||void 0===o||o.cancel(),this._pendingCallback&&this._pendingCallback(null,{abandoned:!0});let a=!!(r&&r.request&&r.request.collectResourceTiming)&&new i.RequestPerformance(r.request);this._pendingCallback=n,this._pendingRequest=this.loadGeoJSON(r,(o,s)=>{if(delete this._pendingCallback,delete this._pendingRequest,o||!s)return n(o);if("object"!=typeof s)return n(Error(`Input data given to '${r.source}' is not a valid GeoJSON object.`));{c(s,!0);try{var l,u;if(r.filter){let n=i.createExpression(r.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if("error"===n.result)throw Error(n.value.map(i=>`${i.key}: ${i.message}`).join(", "));let o=s.features.filter(i=>n.value.evaluate({zoom:0},i));s={type:"FeatureCollection",features:o}}this._geoJSONIndex=r.cluster?new F(function({superclusterOptions:r,clusterProperties:n}){if(!n||!r)return r;let o={},a={},s={accumulated:null,zoom:0},l={properties:null},u=Object.keys(n);for(let r of u){let[s,l]=n[r],u=i.createExpression(l),h=i.createExpression("string"==typeof s?[s,["accumulated"],["get",r]]:s);o[r]=u.value,a[r]=h.value}return r.map=i=>{l.properties=i;let r={};for(let i of u)r[i]=o[i].evaluate(s,l);return r},r.reduce=(i,r)=>{for(let n of(l.properties=r,u))s.accumulated=i[n],i[n]=a[n].evaluate(s,l)},r}(r)).load(s.features):(l=s,u=r.geojsonVtOptions,new td(l,u))}catch(i){return n(i)}this.loaded={};let o={};if(a){let i=a.finish();i&&(o.resourceTiming={},o.resourceTiming[r.source]=JSON.parse(JSON.stringify(i)))}n(null,o)}})}reloadTile(i,r){let n=this.loaded;return n&&n[i.uid]?super.reloadTile(i,r):this.loadTile(i,r)}loadGeoJSON(r,n){if(r.request)return i.getJSON(r.request,n);if("string"==typeof r.data)try{n(null,JSON.parse(r.data))}catch(i){n(Error(`Input data given to '${r.source}' is not a valid GeoJSON object.`))}else n(Error(`Input data given to '${r.source}' is not a valid GeoJSON object.`));return{cancel:()=>{}}}removeSource(i,r){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),r()}getClusterExpansionZoom(i,r){try{r(null,this._geoJSONIndex.getClusterExpansionZoom(i.clusterId))}catch(i){r(i)}}getClusterChildren(i,r){try{r(null,this._geoJSONIndex.getChildren(i.clusterId))}catch(i){r(i)}}getClusterLeaves(i,r){try{r(null,this._geoJSONIndex.getLeaves(i.clusterId,i.limit,i.offset))}catch(i){r(i)}}}class tg{constructor(r){this.self=r,this.actor=new i.Actor(r,this),this.layerIndexes={},this.availableImages={},this.workerSourceTypes={vector:l,geojson:tm},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(i,r)=>{if(this.workerSourceTypes[i])throw Error(`Worker source with name "${i}" already registered.`);this.workerSourceTypes[i]=r},this.self.registerRTLTextPlugin=r=>{if(i.plugin.isParsed())throw Error("RTL text plugin already registered.");i.plugin.applyArabicShaping=r.applyArabicShaping,i.plugin.processBidirectionalText=r.processBidirectionalText,i.plugin.processStyledBidirectionalText=r.processStyledBidirectionalText}}setReferrer(i,r){this.referrer=r}setImages(i,r,n){for(let n in this.availableImages[i]=r,this.workerSources[i]){let o=this.workerSources[i][n];for(let i in o)o[i].availableImages=r}n()}setLayers(i,r,n){this.getLayerIndex(i).replace(r),n()}updateLayers(i,r,n){this.getLayerIndex(i).update(r.layers,r.removedIds),n()}loadTile(i,r,n){this.getWorkerSource(i,r.type,r.source).loadTile(r,n)}loadDEMTile(i,r,n){this.getDEMWorkerSource(i,r.source).loadTile(r,n)}reloadTile(i,r,n){this.getWorkerSource(i,r.type,r.source).reloadTile(r,n)}abortTile(i,r,n){this.getWorkerSource(i,r.type,r.source).abortTile(r,n)}removeTile(i,r,n){this.getWorkerSource(i,r.type,r.source).removeTile(r,n)}removeDEMTile(i,r){this.getDEMWorkerSource(i,r.source).removeTile(r)}removeSource(i,r,n){if(!this.workerSources[i]||!this.workerSources[i][r.type]||!this.workerSources[i][r.type][r.source])return;let o=this.workerSources[i][r.type][r.source];delete this.workerSources[i][r.type][r.source],void 0!==o.removeSource?o.removeSource(r,n):n()}loadWorkerSource(i,r,n){try{this.self.importScripts(r.url),n()}catch(i){n(i.toString())}}syncRTLPluginState(r,n,o){try{i.plugin.setState(n);let r=i.plugin.getPluginURL();if(i.plugin.isLoaded()&&!i.plugin.isParsed()&&null!=r){this.self.importScripts(r);let n=i.plugin.isParsed();o(n?void 0:Error(`RTL Text Plugin failed to import scripts from ${r}`),n)}}catch(i){o(i.toString())}}getAvailableImages(i){let r=this.availableImages[i];return r||(r=[]),r}getLayerIndex(i){let n=this.layerIndexes[i];return n||(n=this.layerIndexes[i]=new r),n}getWorkerSource(i,r,n){return this.workerSources[i]||(this.workerSources[i]={}),this.workerSources[i][r]||(this.workerSources[i][r]={}),this.workerSources[i][r][n]||(this.workerSources[i][r][n]=new this.workerSourceTypes[r]({send:(r,n,o)=>{this.actor.send(r,n,o,i)}},this.getLayerIndex(i),this.getAvailableImages(i))),this.workerSources[i][r][n]}getDEMWorkerSource(i,r){return this.demWorkerSources[i]||(this.demWorkerSources[i]={}),this.demWorkerSources[i][r]||(this.demWorkerSources[i][r]=new u),this.demWorkerSources[i][r]}enforceCacheSizeLimit(r,n){i.enforceCacheSizeLimit(n)}}return i.isWorker()&&(self.worker=new tg(self)),tg}),o(["./shared"],function(i){let r,n,o;function a(i){var r;return"undefined"!=typeof window&&"undefined"!=typeof document&&!!Array.prototype&&!!Array.prototype.every&&!!Array.prototype.filter&&!!Array.prototype.forEach&&!!Array.prototype.indexOf&&!!Array.prototype.lastIndexOf&&!!Array.prototype.map&&!!Array.prototype.some&&!!Array.prototype.reduce&&!!Array.prototype.reduceRight&&!!Array.isArray&&!!Function.prototype&&!!Function.prototype.bind&&!!Object.keys&&!!Object.create&&!!Object.getPrototypeOf&&!!Object.getOwnPropertyNames&&!!Object.isSealed&&!!Object.isFrozen&&!!Object.isExtensible&&!!Object.getOwnPropertyDescriptor&&!!Object.defineProperty&&!!Object.defineProperties&&!!Object.seal&&!!Object.freeze&&!!Object.preventExtensions&&!!("JSON"in window&&"parse"in JSON&&"stringify"in JSON)&&!!function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var i,r,n=new Blob([""],{type:"text/javascript"}),o=URL.createObjectURL(n);try{r=new Worker(o),i=!0}catch(r){i=!1}return r&&r.terminate(),URL.revokeObjectURL(o),i}()&&"Uint8ClampedArray"in window&&!!ArrayBuffer.isView&&!!function(){var i=document.createElement("canvas");i.width=i.height=1;var r=i.getContext("2d");if(!r)return!1;var n=r.getImageData(0,0,1,1);return n&&n.width===i.width}()&&(void 0===s[r=i&&i.failIfMajorPerformanceCaveat]&&(s[r]=function(i){var r,n,o,s=(r=document.createElement("canvas"),(n=Object.create(a.webGLContextAttributes)).failIfMajorPerformanceCaveat=i,r.getContext("webgl",n)||r.getContext("experimental-webgl",n));if(!s)return!1;try{o=s.createShader(s.VERTEX_SHADER)}catch(i){return!1}return!(!o||s.isContextLost())&&(s.shaderSource(o,"void main() {}"),s.compileShader(o),!0===s.getShaderParameter(o,s.COMPILE_STATUS))}(r)),!!s[r]&&!document.documentMode)}var s={};function l(i,r){if(Array.isArray(i)){if(!Array.isArray(r)||i.length!==r.length)return!1;for(let n=0;n<i.length;n++)if(!l(i[n],r[n]))return!1;return!0}if("object"==typeof i&&null!==i&&null!==r){if("object"!=typeof r||Object.keys(i).length!==Object.keys(r).length)return!1;for(let n in i)if(!l(i[n],r[n]))return!1;return!0}return i===r}a.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0};class u{static testProp(i){if(!u.docStyle)return i[0];for(let r=0;r<i.length;r++)if(i[r]in u.docStyle)return i[r];return i[0]}static create(i,r,n){let o=window.document.createElement(i);return void 0!==r&&(o.className=r),n&&n.appendChild(o),o}static createNS(i,r){return window.document.createElementNS(i,r)}static disableDrag(){u.docStyle&&u.selectProp&&(u.userSelect=u.docStyle[u.selectProp],u.docStyle[u.selectProp]="none")}static enableDrag(){u.docStyle&&u.selectProp&&(u.docStyle[u.selectProp]=u.userSelect)}static setTransform(i,r){i.style[u.transformProp]=r}static addEventListener(i,r,n,o={}){i.addEventListener(r,n,"passive"in o?o:o.capture)}static removeEventListener(i,r,n,o={}){i.removeEventListener(r,n,"passive"in o?o:o.capture)}static suppressClickInternal(i){i.preventDefault(),i.stopPropagation(),window.removeEventListener("click",u.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",u.suppressClickInternal,!0),window.setTimeout(()=>{window.removeEventListener("click",u.suppressClickInternal,!0)},0)}static mousePos(r,n){let o=r.getBoundingClientRect();return new i.pointGeometry(n.clientX-o.left-r.clientLeft,n.clientY-o.top-r.clientTop)}static touchPos(r,n){let o=r.getBoundingClientRect(),a=[];for(let s=0;s<n.length;s++)a.push(new i.pointGeometry(n[s].clientX-o.left-r.clientLeft,n[s].clientY-o.top-r.clientTop));return a}static mouseButton(i){return i.button}static remove(i){i.parentNode&&i.parentNode.removeChild(i)}}u.docStyle="undefined"!=typeof window&&window.document&&window.document.documentElement.style,u.selectProp=u.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),u.transformProp=u.testProp(["transform","WebkitTransform"]);class h{constructor(i){this._transformRequestFn=i}transformRequest(i,r){return this._transformRequestFn&&this._transformRequestFn(i,r)||{url:i}}normalizeSpriteURL(i,r,n){let o=function(i){let r=i.match(c);if(!r)throw Error(`Unable to parse URL "${i}"`);return{protocol:r[1],authority:r[2],path:r[3]||"/",params:r[4]?r[4].split("&"):[]}}(i);return o.path+=`${r}${n}`,function(i){let r=i.params.length?`?${i.params.join("&")}`:"";return`${i.protocol}://${i.authority}${i.path}${r}`}(o)}setTransformRequest(i){this._transformRequestFn=i}}let c=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;class d{constructor(i,r,n,o){this.context=i,this.format=n,this.texture=i.gl.createTexture(),this.update(r,o)}update(r,n,o){let{width:a,height:s}=r,l=!(this.size&&this.size[0]===a&&this.size[1]===s||o),{context:u}=this,{gl:h}=u;if(this.useMipmap=!!(n&&n.useMipmap),h.bindTexture(h.TEXTURE_2D,this.texture),u.pixelStoreUnpackFlipY.set(!1),u.pixelStoreUnpack.set(1),u.pixelStoreUnpackPremultiplyAlpha.set(this.format===h.RGBA&&(!n||!1!==n.premultiply)),l)this.size=[a,s],r instanceof HTMLImageElement||r instanceof HTMLCanvasElement||r instanceof HTMLVideoElement||r instanceof ImageData||i.isImageBitmap(r)?h.texImage2D(h.TEXTURE_2D,0,this.format,this.format,h.UNSIGNED_BYTE,r):h.texImage2D(h.TEXTURE_2D,0,this.format,a,s,0,this.format,h.UNSIGNED_BYTE,r.data);else{let{x:n,y:l}=o||{x:0,y:0};r instanceof HTMLImageElement||r instanceof HTMLCanvasElement||r instanceof HTMLVideoElement||r instanceof ImageData||i.isImageBitmap(r)?h.texSubImage2D(h.TEXTURE_2D,0,n,l,h.RGBA,h.UNSIGNED_BYTE,r):h.texSubImage2D(h.TEXTURE_2D,0,n,l,a,s,h.RGBA,h.UNSIGNED_BYTE,r.data)}this.useMipmap&&this.isSizePowerOfTwo()&&h.generateMipmap(h.TEXTURE_2D)}bind(i,r,n){let{context:o}=this,{gl:a}=o;a.bindTexture(a.TEXTURE_2D,this.texture),n!==a.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(n=a.LINEAR),i!==this.filter&&(a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,i),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,n||i),this.filter=i),r!==this.wrap&&(a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,r),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,r),this.wrap=r)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){let{gl:i}=this.context;i.deleteTexture(this.texture),this.texture=null}}class p extends i.Evented{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new i.RGBAImage({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(i){if(this.loaded!==i&&(this.loaded=i,i)){for(let{ids:i,callback:r}of this.requestors)this._notify(i,r);this.requestors=[]}}getImage(i){return this.images[i]}addImage(i,r){if(this.images[i])throw Error(`Image id ${i} already exist, use updateImage instead`);this._validate(i,r)&&(this.images[i]=r)}_validate(r,n){let o=!0;return this._validateStretch(n.stretchX,n.data&&n.data.width)||(this.fire(new i.ErrorEvent(Error(`Image "${r}" has invalid "stretchX" value`))),o=!1),this._validateStretch(n.stretchY,n.data&&n.data.height)||(this.fire(new i.ErrorEvent(Error(`Image "${r}" has invalid "stretchY" value`))),o=!1),this._validateContent(n.content,n)||(this.fire(new i.ErrorEvent(Error(`Image "${r}" has invalid "content" value`))),o=!1),o}_validateStretch(i,r){if(!i)return!0;let n=0;for(let o of i){if(o[0]<n||o[1]<o[0]||r<o[1])return!1;n=o[1]}return!0}_validateContent(i,r){return!(i&&(4!==i.length||i[0]<0||r.data.width<i[0]||i[1]<0||r.data.height<i[1]||i[2]<0||r.data.width<i[2]||i[3]<0||r.data.height<i[3]||i[2]<i[0]||i[3]<i[1]))}updateImage(i,r){let n=this.images[i];if(n.data.width!==r.data.width||n.data.height!==r.data.height)throw Error(`size mismatch between old image (${n.data.width}x${n.data.height}) and new image (${r.data.width}x${r.data.height}).`);r.version=n.version+1,this.images[i]=r,this.updatedImages[i]=!0}removeImage(i){let r=this.images[i];delete this.images[i],delete this.patterns[i],r.userImage&&r.userImage.onRemove&&r.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(i,r){let n=!0;if(!this.isLoaded())for(let r of i)this.images[r]||(n=!1);this.isLoaded()||n?this._notify(i,r):this.requestors.push({ids:i,callback:r})}_notify(r,n){let o={};for(let n of r){this.images[n]||this.fire(new i.Event("styleimagemissing",{id:n}));let r=this.images[n];r?o[n]={data:r.data.clone(),pixelRatio:r.pixelRatio,sdf:r.sdf,version:r.version,stretchX:r.stretchX,stretchY:r.stretchY,content:r.content,hasRenderCallback:!!(r.userImage&&r.userImage.render)}:i.warnOnce(`Image "${n}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}n(null,o)}getPixelSize(){let{width:i,height:r}=this.atlasImage;return{width:i,height:r}}getPattern(r){let n=this.patterns[r],o=this.getImage(r);if(!o)return null;if(n&&n.position.version===o.version)return n.position;if(n)n.position.version=o.version;else{let n={w:o.data.width+2,h:o.data.height+2,x:0,y:0},a=new i.ImagePosition(n,o);this.patterns[r]={bin:n,position:a}}return this._updatePatternAtlas(),this.patterns[r].position}bind(i){let r=i.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new d(i,this.atlasImage,r.RGBA),this.atlasTexture.bind(r.LINEAR,r.CLAMP_TO_EDGE)}_updatePatternAtlas(){let r=[];for(let i in this.patterns)r.push(this.patterns[i].bin);let{w:n,h:o}=i.potpack(r),a=this.atlasImage;for(let r in a.resize({width:n||1,height:o||1}),this.patterns){let{bin:n}=this.patterns[r],o=n.x+1,s=n.y+1,l=this.images[r].data,u=l.width,h=l.height;i.RGBAImage.copy(l,a,{x:0,y:0},{x:o,y:s},{width:u,height:h}),i.RGBAImage.copy(l,a,{x:0,y:h-1},{x:o,y:s-1},{width:u,height:1}),i.RGBAImage.copy(l,a,{x:0,y:0},{x:o,y:s+h},{width:u,height:1}),i.RGBAImage.copy(l,a,{x:u-1,y:0},{x:o-1,y:s},{width:1,height:h}),i.RGBAImage.copy(l,a,{x:0,y:0},{x:o+u,y:s},{width:1,height:h})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(r){for(let n of r){if(this.callbackDispatchedThisFrame[n])continue;this.callbackDispatchedThisFrame[n]=!0;let r=this.images[n];r||i.warnOnce(`Image with ID: "${n}" was not found`),function(i){let{userImage:r}=i;return!!(r&&r.render&&r.render())&&(i.data.replace(new Uint8Array(r.data.buffer)),!0)}(r)&&this.updateImage(n,r)}}}function f(i,r,n,o,a,s,l,u,h){for(let c=r;c<r+o;c++)m(i,n*s+c,s,a,l,u,h);for(let c=n;c<n+a;c++)m(i,c*s+r,1,o,l,u,h)}function m(i,r,n,o,a,s,l){s[0]=0,l[0]=-1e20,l[1]=1e20,a[0]=i[r];for(let u=1,h=0,c=0;u<o;u++){a[u]=i[r+u*n];let o=u*u;do{let i=s[h];c=(a[u]-a[i]+o-i*i)/(u-i)/2}while(c<=l[h]&&--h>-1)s[++h]=u,l[h]=c,l[h+1]=1e20}for(let u=0,h=0;u<o;u++){for(;l[h+1]<u;)h++;let o=s[h],c=u-o;i[r+u*n]=a[o]+c*c}}class g{constructor(i,r){this.requestManager=i,this.localIdeographFontFamily=r,this.entries={}}setURL(i){this.url=i}getGlyphs(r,n){let o=[];for(let i in r)for(let n of r[i])o.push({stack:i,id:n});i.asyncAll(o,({stack:i,id:r},n)=>{let o=this.entries[i];o||(o=this.entries[i]={glyphs:{},requests:{},ranges:{}});let a=o.glyphs[r];if(void 0!==a)return void n(null,{stack:i,id:r,glyph:a});if(a=this._tinySDF(o,i,r))return o.glyphs[r]=a,void n(null,{stack:i,id:r,glyph:a});let s=Math.floor(r/256);if(256*s>65535)return void n(Error("glyphs > 65535 not supported"));if(o.ranges[s])return void n(null,{stack:i,id:r,glyph:a});let l=o.requests[s];l||(l=o.requests[s]=[],g.loadGlyphRange(i,s,this.url,this.requestManager,(i,r)=>{if(r){for(let i in r)this._doesCharSupportLocalGlyph(+i)||(o.glyphs[+i]=r[+i]);o.ranges[s]=!0}for(let n of l)n(i,r);delete o.requests[s]})),l.push((o,a)=>{o?n(o):a&&n(null,{stack:i,id:r,glyph:a[r]||null})})},(i,r)=>{if(i)n(i);else if(r){let i={};for(let{stack:n,id:o,glyph:a}of r)(i[n]||(i[n]={}))[o]=a&&{id:a.id,bitmap:a.bitmap.clone(),metrics:a.metrics};n(null,i)}})}_doesCharSupportLocalGlyph(r){return!!this.localIdeographFontFamily&&(i.unicodeBlockLookup["CJK Unified Ideographs"](r)||i.unicodeBlockLookup["Hangul Syllables"](r)||i.unicodeBlockLookup.Hiragana(r)||i.unicodeBlockLookup.Katakana(r))}_tinySDF(r,n,o){let a=this.localIdeographFontFamily;if(!a||!this._doesCharSupportLocalGlyph(o))return;let s=r.tinySDF;if(!s){let i="400";/bold/i.test(n)?i="900":/medium/i.test(n)?i="500":/light/i.test(n)&&(i="200"),s=r.tinySDF=new g.TinySDF({fontSize:24,buffer:3,radius:8,cutoff:.25,fontFamily:a,fontWeight:i})}let l=s.draw(String.fromCharCode(o));return{id:o,bitmap:new i.AlphaImage({width:l.width||30,height:l.height||30},l.data),metrics:{width:l.glyphWidth||24,height:l.glyphHeight||24,left:l.glyphLeft||0,top:l.glyphTop-27||-8,advance:l.glyphAdvance||24}}}}g.loadGlyphRange=function(r,n,o,a,s){let l=256*n,u=l+255,h=a.transformRequest(o.replace("{fontstack}",r).replace("{range}",`${l}-${u}`),i.ResourceType.Glyphs);i.getArrayBuffer(h,(r,n)=>{if(r)s(r);else if(n){let r={};for(let o of i.parseGlyphPbf(n))r[o.id]=o;s(null,r)}})},g.TinySDF=class{constructor({fontSize:i=24,buffer:r=3,radius:n=8,cutoff:o=.25,fontFamily:a="sans-serif",fontWeight:s="normal",fontStyle:l="normal"}={}){this.buffer=r,this.cutoff=o,this.radius=n;let u=this.size=i+4*r,h=this._createCanvas(u),c=this.ctx=h.getContext("2d",{willReadFrequently:!0});c.font=`${l} ${s} ${i}px ${a}`,c.textBaseline="alphabetic",c.textAlign="left",c.fillStyle="black",this.gridOuter=new Float64Array(u*u),this.gridInner=new Float64Array(u*u),this.f=new Float64Array(u),this.z=new Float64Array(u+1),this.v=new Uint16Array(u)}_createCanvas(i){let r=document.createElement("canvas");return r.width=r.height=i,r}draw(i){let{width:r,actualBoundingBoxAscent:n,actualBoundingBoxDescent:o,actualBoundingBoxLeft:a,actualBoundingBoxRight:s}=this.ctx.measureText(i),l=Math.ceil(n),u=Math.min(this.size-this.buffer,Math.ceil(s-a)),h=Math.min(this.size-this.buffer,l+Math.ceil(o)),c=u+2*this.buffer,d=h+2*this.buffer,p=Math.max(c*d,0),m=new Uint8ClampedArray(p),g={data:m,width:c,height:d,glyphWidth:u,glyphHeight:h,glyphTop:l,glyphLeft:0,glyphAdvance:r};if(0===u||0===h)return g;let{ctx:_,buffer:y,gridInner:v,gridOuter:x}=this;_.clearRect(y,y,u,h),_.fillText(i,y,y+l);let b=_.getImageData(y,y,u,h);x.fill(1e20,0,p),v.fill(0,0,p);for(let i=0;i<h;i++)for(let r=0;r<u;r++){let n=b.data[4*(i*u+r)+3]/255;if(0===n)continue;let o=(i+y)*c+r+y;if(1===n)x[o]=0,v[o]=1e20;else{let i=.5-n;x[o]=i>0?i*i:0,v[o]=i<0?i*i:0}}f(x,0,0,c,d,c,this.f,this.v,this.z),f(v,y,y,u,h,c,this.f,this.v,this.z);for(let i=0;i<p;i++){let r=Math.sqrt(x[i])-Math.sqrt(v[i]);m[i]=Math.round(255-255*(r/this.radius+this.cutoff))}return g}};let _=new i.Properties({anchor:new i.DataConstantProperty(i.spec.light.anchor),position:new class{constructor(){this.specification=i.spec.light.position}possiblyEvaluate(r,n){return i.sphericalToCartesian(r.expression.evaluate(n))}interpolate(r,n,o){return{x:i.number(r.x,n.x,o),y:i.number(r.y,n.y,o),z:i.number(r.z,n.z,o)}}},color:new i.DataConstantProperty(i.spec.light.color),intensity:new i.DataConstantProperty(i.spec.light.intensity)}),y="-transition";class v extends i.Evented{constructor(r){super(),this._transitionable=new i.Transitionable(_),this.setLight(r),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(r,n={}){if(!this._validate(i.validateLight,r,n))for(let i in r){let n=r[i];i.endsWith(y)?this._transitionable.setTransition(i.slice(0,-y.length),n):this._transitionable.setValue(i,n)}}updateTransitions(i){this._transitioning=this._transitionable.transitioned(i,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(i){this.properties=this._transitioning.possiblyEvaluate(i)}_validate(r,n,o){return(!o||!1!==o.validate)&&i.emitValidationErrors(this,r.call(i.validateStyle,i.extend({value:n,style:{glyphs:!0,sprite:!0},styleSpec:i.spec})))}}class x{constructor(i,r){this.width=i,this.height=r,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(i,r){let n=i.join(",")+String(r);return this.dashEntry[n]||(this.dashEntry[n]=this.addDash(i,r)),this.dashEntry[n]}getDashRanges(i,r,n){let o=[],a=i.length%2==1?-i[i.length-1]*n:0,s=i[0]*n,l=!0;o.push({left:a,right:s,isDash:l,zeroLength:0===i[0]});let u=i[0];for(let r=1;r<i.length;r++){l=!l;let h=i[r];a=u*n,u+=h,s=u*n,o.push({left:a,right:s,isDash:l,zeroLength:0===h})}return o}addRoundDash(i,r,n){let o=r/2;for(let r=-n;r<=n;r++){let a=this.width*(this.nextRow+n+r),s=0,l=i[0];for(let u=0;u<this.width;u++){let h;u/l.right>1&&(l=i[++s]);let c=Math.abs(u-l.left),d=Math.abs(u-l.right),p=Math.min(c,d),f=r/n*(o+1);if(l.isDash){let i=o-Math.abs(f);h=Math.sqrt(p*p+i*i)}else h=o-Math.sqrt(p*p+f*f);this.data[a+u]=Math.max(0,Math.min(255,h+128))}}}addRegularDash(i){for(let r=i.length-1;r>=0;--r){let n=i[r],o=i[r+1];n.zeroLength?i.splice(r,1):o&&o.isDash===n.isDash&&(o.left=n.left,i.splice(r,1))}let r=i[0],n=i[i.length-1];r.isDash===n.isDash&&(r.left=n.left-this.width,n.right=r.right+this.width);let o=this.width*this.nextRow,a=0,s=i[0];for(let r=0;r<this.width;r++){r/s.right>1&&(s=i[++a]);let n=Math.abs(r-s.left),l=Math.abs(r-s.right),u=Math.min(n,l);this.data[o+r]=Math.max(0,Math.min(255,(s.isDash?u:-u)+128))}}addDash(r,n){let o=n?7:0,a=2*o+1;if(this.nextRow+a>this.height)return i.warnOnce("LineAtlas out of space"),null;let s=0;for(let i=0;i<r.length;i++)s+=r[i];if(0!==s){let i=this.width/s,a=this.getDashRanges(r,this.width,i);n?this.addRoundDash(a,i,o):this.addRegularDash(a)}let l={y:(this.nextRow+o+.5)/this.height,height:2*o/this.height,width:s};return this.nextRow+=a,this.dirty=!0,l}bind(i){let r=i.gl;this.texture?(r.bindTexture(r.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,r.texSubImage2D(r.TEXTURE_2D,0,0,0,this.width,this.height,r.ALPHA,r.UNSIGNED_BYTE,this.data))):(this.texture=r.createTexture(),r.bindTexture(r.TEXTURE_2D,this.texture),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,r.REPEAT),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,r.REPEAT),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.LINEAR),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,r.LINEAR),r.texImage2D(r.TEXTURE_2D,0,r.ALPHA,this.width,this.height,0,r.ALPHA,r.UNSIGNED_BYTE,this.data))}}class b{constructor(r,n){this.workerPool=r,this.actors=[],this.currentActor=0,this.id=i.uniqueId();let o=this.workerPool.acquire(this.id);for(let i=0;i<o.length;i++){let r=new b.Actor(o[i],n,this.id);r.name=`Worker ${i}`,this.actors.push(r)}if(!this.actors.length)throw Error("No actors found")}broadcast(r,n,o){i.asyncAll(this.actors,(i,o)=>{i.send(r,n,o)},o=o||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach(i=>{i.remove()}),this.actors=[],this.workerPool.release(this.id)}}function w(r,n,o){let a=function(n,a){if(n)return o(n);if(a){let n=i.pick(i.extend(a,r),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);a.vector_layers&&(n.vectorLayers=a.vector_layers,n.vectorLayerIds=n.vectorLayers.map(i=>i.id)),o(null,n)}};return r.url?i.getJSON(n.transformRequest(r.url,i.ResourceType.Source),a):i.exported.frame(()=>a(null,r))}b.Actor=i.Actor;class T{constructor(r,n,o){this.bounds=i.LngLatBounds.convert(this.validateBounds(r)),this.minzoom=n||0,this.maxzoom=o||24}validateBounds(i){return Array.isArray(i)&&4===i.length?[Math.max(-180,i[0]),Math.max(-90,i[1]),Math.min(180,i[2]),Math.min(90,i[3])]:[-180,-90,180,90]}contains(r){let n=Math.pow(2,r.z),o=Math.floor(i.mercatorXfromLng(this.bounds.getWest())*n),a=Math.floor(i.mercatorYfromLat(this.bounds.getNorth())*n),s=Math.ceil(i.mercatorXfromLng(this.bounds.getEast())*n),l=Math.ceil(i.mercatorYfromLat(this.bounds.getSouth())*n);return r.x>=o&&r.x<s&&r.y>=a&&r.y<l}}class E extends i.Evented{constructor(r,n,o,a){if(super(),this.id=r,this.dispatcher=o,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,i.extend(this,i.pick(n,["url","scheme","tileSize","promoteId"])),this._options=i.extend({type:"vector"},n),this._collectResourceTiming=n.collectResourceTiming,512!==this.tileSize)throw Error("vector tile sources must have a tileSize of 512");this.setEventedParent(a)}load(){this._loaded=!1,this.fire(new i.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=w(this._options,this.map._requestManager,(r,n)=>{this._tileJSONRequest=null,this._loaded=!0,this.map.style.sourceCaches[this.id].clearTiles(),r?this.fire(new i.ErrorEvent(r)):n&&(i.extend(this,n),n.bounds&&(this.tileBounds=new T(n.bounds,this.minzoom,this.maxzoom)),this.fire(new i.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new i.Event("data",{dataType:"source",sourceDataType:"content"})))})}loaded(){return this._loaded}hasTile(i){return!this.tileBounds||this.tileBounds.contains(i.canonical)}onAdd(i){this.map=i,this.load()}setSourceProperty(i){this._tileJSONRequest&&this._tileJSONRequest.cancel(),i(),this.load()}setTiles(i){return this.setSourceProperty(()=>{this._options.tiles=i}),this}setUrl(i){return this.setSourceProperty(()=>{this.url=i,this._options.url=i}),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}serialize(){return i.extend({},this._options)}loadTile(r,n){let o=r.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),a={request:this.map._requestManager.transformRequest(o,i.ResourceType.Tile),uid:r.uid,tileID:r.tileID,zoom:r.tileID.overscaledZ,tileSize:this.tileSize*r.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};function s(o,a){return delete r.request,r.aborted?n(null):o&&404!==o.status?n(o):(a&&a.resourceTiming&&(r.resourceTiming=a.resourceTiming),this.map._refreshExpiredTiles&&a&&r.setExpiryData(a),r.loadVectorData(a,this.map.painter),i.cacheEntryPossiblyAdded(this.dispatcher),n(null),void(r.reloadCallback&&(this.loadTile(r,r.reloadCallback),r.reloadCallback=null)))}a.request.collectResourceTiming=this._collectResourceTiming,r.actor&&"expired"!==r.state?"loading"===r.state?r.reloadCallback=n:r.request=r.actor.send("reloadTile",a,s.bind(this)):(r.actor=this.dispatcher.getActor(),r.request=r.actor.send("loadTile",a,s.bind(this)))}abortTile(i){i.request&&(i.request.cancel(),delete i.request),i.actor&&i.actor.send("abortTile",{uid:i.uid,type:this.type,source:this.id},void 0)}unloadTile(i){i.unloadVectorData(),i.actor&&i.actor.send("removeTile",{uid:i.uid,type:this.type,source:this.id},void 0)}hasTransition(){return!1}}class S extends i.Evented{constructor(r,n,o,a){super(),this.id=r,this.dispatcher=o,this.setEventedParent(a),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=i.extend({type:"raster"},n),i.extend(this,i.pick(n,["url","scheme","tileSize"]))}load(){this._loaded=!1,this.fire(new i.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=w(this._options,this.map._requestManager,(r,n)=>{this._tileJSONRequest=null,this._loaded=!0,r?this.fire(new i.ErrorEvent(r)):n&&(i.extend(this,n),n.bounds&&(this.tileBounds=new T(n.bounds,this.minzoom,this.maxzoom)),this.fire(new i.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new i.Event("data",{dataType:"source",sourceDataType:"content"})))})}loaded(){return this._loaded}onAdd(i){this.map=i,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}serialize(){return i.extend({},this._options)}hasTile(i){return!this.tileBounds||this.tileBounds.contains(i.canonical)}loadTile(r,n){let o=r.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);r.request=i.getImage(this.map._requestManager.transformRequest(o,i.ResourceType.Tile),(o,a,s)=>{if(delete r.request,r.aborted)r.state="unloaded",n(null);else if(o)r.state="errored",n(o);else if(a){this.map._refreshExpiredTiles&&r.setExpiryData(s);let o=this.map.painter.context,l=o.gl;r.texture=this.map.painter.getTileTexture(a.width),r.texture?r.texture.update(a,{useMipmap:!0}):(r.texture=new d(o,a,l.RGBA,{useMipmap:!0}),r.texture.bind(l.LINEAR,l.CLAMP_TO_EDGE,l.LINEAR_MIPMAP_NEAREST),o.extTextureFilterAnisotropic&&l.texParameterf(l.TEXTURE_2D,o.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,o.extTextureFilterAnisotropicMax)),r.state="loaded",i.cacheEntryPossiblyAdded(this.dispatcher),n(null)}})}abortTile(i,r){i.request&&(i.request.cancel(),delete i.request),r()}unloadTile(i,r){i.texture&&this.map.painter.saveTileTexture(i.texture),r()}hasTransition(){return!1}}class C extends S{constructor(r,n,o,a){super(r,n,o,a),this.type="raster-dem",this.maxzoom=22,this._options=i.extend({type:"raster-dem"},n),this.encoding=n.encoding||"mapbox"}serialize(){return{type:"raster-dem",url:this.url,tileSize:this.tileSize,tiles:this.tiles,bounds:this.bounds,encoding:this.encoding}}loadTile(n,o){let a=n.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);function s(i,r){i&&(n.state="errored",o(i)),r&&(n.dem=r,n.needsHillshadePrepare=!0,n.needsTerrainPrepare=!0,n.state="loaded",o(null))}n.request=i.getImage(this.map._requestManager.transformRequest(a,i.ResourceType.Tile),(function(a,l){if(delete n.request,n.aborted)n.state="unloaded",o(null);else if(a)n.state="errored",o(a);else if(l){this.map._refreshExpiredTiles&&n.setExpiryData(l),delete l.cacheControl,delete l.expires;let o=i.isImageBitmap(l)&&(null==r&&(r="undefined"!=typeof OffscreenCanvas&&new OffscreenCanvas(1,1).getContext("2d")&&"function"==typeof createImageBitmap),r)?l:i.exported.getImageData(l,1),a={uid:n.uid,coord:n.tileID,source:this.id,rawImageData:o,encoding:this.encoding};n.actor&&"expired"!==n.state||(n.actor=this.dispatcher.getActor(),n.actor.send("loadDEMTile",a,s.bind(this)))}}).bind(this)),n.neighboringTiles=this._getNeighboringTiles(n.tileID)}_getNeighboringTiles(r){let n=r.canonical,o=Math.pow(2,n.z),a=(n.x-1+o)%o,s=0===n.x?r.wrap-1:r.wrap,l=(n.x+1+o)%o,u=n.x+1===o?r.wrap+1:r.wrap,h={};return h[new i.OverscaledTileID(r.overscaledZ,s,n.z,a,n.y).key]={backfilled:!1},h[new i.OverscaledTileID(r.overscaledZ,u,n.z,l,n.y).key]={backfilled:!1},n.y>0&&(h[new i.OverscaledTileID(r.overscaledZ,s,n.z,a,n.y-1).key]={backfilled:!1},h[new i.OverscaledTileID(r.overscaledZ,r.wrap,n.z,n.x,n.y-1).key]={backfilled:!1},h[new i.OverscaledTileID(r.overscaledZ,u,n.z,l,n.y-1).key]={backfilled:!1}),n.y+1<o&&(h[new i.OverscaledTileID(r.overscaledZ,s,n.z,a,n.y+1).key]={backfilled:!1},h[new i.OverscaledTileID(r.overscaledZ,r.wrap,n.z,n.x,n.y+1).key]={backfilled:!1},h[new i.OverscaledTileID(r.overscaledZ,u,n.z,l,n.y+1).key]={backfilled:!1}),h}unloadTile(i){i.demTexture&&this.map.painter.saveTileTexture(i.demTexture),i.fbo&&(i.fbo.destroy(),delete i.fbo),i.dem&&delete i.dem,delete i.neighboringTiles,i.state="unloaded",i.actor&&i.actor.send("removeDEMTile",{uid:i.uid,source:this.id})}}class I extends i.Evented{constructor(r,n,o,a){super(),this.id=r,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._pendingLoads=0,this.actor=o.getActor(),this.setEventedParent(a),this._data=n.data,this._options=i.extend({},n),this._collectResourceTiming=n.collectResourceTiming,void 0!==n.maxzoom&&(this.maxzoom=n.maxzoom),n.type&&(this.type=n.type),n.attribution&&(this.attribution=n.attribution),this.promoteId=n.promoteId;let s=i.EXTENT/this.tileSize;this.workerOptions=i.extend({source:this.id,cluster:n.cluster||!1,geojsonVtOptions:{buffer:(void 0!==n.buffer?n.buffer:128)*s,tolerance:(void 0!==n.tolerance?n.tolerance:.375)*s,extent:i.EXTENT,maxZoom:this.maxzoom,lineMetrics:n.lineMetrics||!1,generateId:n.generateId||!1},superclusterOptions:{maxZoom:void 0!==n.clusterMaxZoom?n.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,n.clusterMinPoints||2),extent:i.EXTENT,radius:(n.clusterRadius||50)*s,log:!1,generateId:n.generateId||!1},clusterProperties:n.clusterProperties,filter:n.filter},n.workerOptions)}load(){this._updateWorkerData("metadata")}onAdd(i){this.map=i,this.load()}setData(i){return this._data=i,this._updateWorkerData("content"),this}getClusterExpansionZoom(i,r){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:i,source:this.id},r),this}getClusterChildren(i,r){return this.actor.send("geojson.getClusterChildren",{clusterId:i,source:this.id},r),this}getClusterLeaves(i,r,n,o){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:i,limit:r,offset:n},o),this}_updateWorkerData(r){let n=i.extend({},this.workerOptions),o=this._data;"string"==typeof o?(n.request=this.map._requestManager.transformRequest(i.exported.resolveURL(o),i.ResourceType.Source),n.request.collectResourceTiming=this._collectResourceTiming):n.data=JSON.stringify(o),this._pendingLoads++,this.fire(new i.Event("dataloading",{dataType:"source"})),this.actor.send(`${this.type}.loadData`,n,(n,o)=>{if(this._pendingLoads--,this._removed||o&&o.abandoned)return void this.fire(new i.Event("dataabort",{dataType:"source",sourceDataType:r}));let a=null;if(o&&o.resourceTiming&&o.resourceTiming[this.id]&&(a=o.resourceTiming[this.id].slice(0)),n)return void this.fire(new i.ErrorEvent(n));let s={dataType:"source",sourceDataType:r};this._collectResourceTiming&&a&&a.length>0&&i.extend(s,{resourceTiming:a}),this.fire(new i.Event("data",s))})}loaded(){return 0===this._pendingLoads}loadTile(i,r){let n=i.actor?"reloadTile":"loadTile";i.actor=this.actor;let o={type:this.type,uid:i.uid,tileID:i.tileID,zoom:i.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};i.request=this.actor.send(n,o,(o,a)=>(delete i.request,i.unloadVectorData(),i.aborted?r(null):o?r(o):(i.loadVectorData(a,this.map.painter,"reloadTile"===n),r(null))))}abortTile(i){i.request&&(i.request.cancel(),delete i.request),i.aborted=!0}unloadTile(i){i.unloadVectorData(),this.actor.send("removeTile",{uid:i.uid,type:this.type,source:this.id})}onRemove(){this._removed=!0,this.actor.send("removeSource",{type:this.type,source:this.id})}serialize(){return i.extend({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}}var A=i.createLayout([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class P extends i.Evented{constructor(i,r,n,o){super(),this.id=i,this.dispatcher=n,this.coordinates=r.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(o),this.options=r}load(r,n){this._loaded=!1,this.fire(new i.Event("dataloading",{dataType:"source"})),this.url=this.options.url,i.getImage(this.map._requestManager.transformRequest(this.url,i.ResourceType.Image),(o,a)=>{this._loaded=!0,o?this.fire(new i.ErrorEvent(o)):a&&(this.image=a,r&&(this.coordinates=r),n&&n(),this._finishLoading())})}loaded(){return this._loaded}updateImage(i){return this.image&&i.url&&(this.options.url=i.url,this.load(i.coordinates,()=>{this.texture=null})),this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new i.Event("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(i){this.map=i,this.load()}setCoordinates(r){this.coordinates=r;let n=r.map(i.MercatorCoordinate.fromLngLat);this.tileID=function(r){let n=1/0,o=1/0,a=-1/0,s=-1/0;for(let i of r)n=Math.min(n,i.x),o=Math.min(o,i.y),a=Math.max(a,i.x),s=Math.max(s,i.y);let l=Math.max(a-n,s-o),u=Math.max(0,Math.floor(-Math.log(l)/Math.LN2)),h=Math.pow(2,u);return new i.CanonicalTileID(u,Math.floor((n+a)/2*h),Math.floor((o+s)/2*h))}(n),this.minzoom=this.maxzoom=this.tileID.z;let o=n.map(i=>this.tileID.getTilePoint(i)._round());return this._boundsArray=new i.RasterBoundsArray,this._boundsArray.emplaceBack(o[0].x,o[0].y,0,0),this._boundsArray.emplaceBack(o[1].x,o[1].y,i.EXTENT,0),this._boundsArray.emplaceBack(o[3].x,o[3].y,0,i.EXTENT),this._boundsArray.emplaceBack(o[2].x,o[2].y,i.EXTENT,i.EXTENT),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new i.Event("data",{dataType:"source",sourceDataType:"content"})),this}prepare(){if(0===Object.keys(this.tiles).length||!this.image)return;let r=this.map.painter.context,n=r.gl;for(let o in this.boundsBuffer||(this.boundsBuffer=r.createVertexBuffer(this._boundsArray,A.members)),this.boundsSegments||(this.boundsSegments=i.SegmentVector.simpleSegment(0,0,4,2)),this.texture||(this.texture=new d(r,this.image,n.RGBA),this.texture.bind(n.LINEAR,n.CLAMP_TO_EDGE)),this.tiles){let i=this.tiles[o];"loaded"!==i.state&&(i.state="loaded",i.texture=this.texture)}}loadTile(i,r){this.tileID&&this.tileID.equals(i.tileID.canonical)?(this.tiles[String(i.tileID.wrap)]=i,i.buckets={}):i.state="errored",r(null)}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}class k extends P{constructor(i,r,n,o){super(i,r,n,o),this.roundZoom=!0,this.type="video",this.options=r}load(){this._loaded=!1;let r=this.options;for(let n of(this.urls=[],r.urls))this.urls.push(this.map._requestManager.transformRequest(n,i.ResourceType.Source).url);i.getVideo(this.urls,(r,n)=>{this._loaded=!0,r?this.fire(new i.ErrorEvent(r)):n&&(this.video=n,this.video.loop=!0,this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(r){if(this.video){let n=this.video.seekable;r<n.start(0)||r>n.end(0)?this.fire(new i.ErrorEvent(new i.ValidationError(`sources.${this.id}`,null,`Playback for this video can be set only between the ${n.start(0)} and ${n.end(0)}-second mark.`))):this.video.currentTime=r}}getVideo(){return this.video}onAdd(i){this.map||(this.map=i,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(0===Object.keys(this.tiles).length||this.video.readyState<2)return;let r=this.map.painter.context,n=r.gl;for(let o in this.boundsBuffer||(this.boundsBuffer=r.createVertexBuffer(this._boundsArray,A.members)),this.boundsSegments||(this.boundsSegments=i.SegmentVector.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(n.LINEAR,n.CLAMP_TO_EDGE),n.texSubImage2D(n.TEXTURE_2D,0,0,0,n.RGBA,n.UNSIGNED_BYTE,this.video)):(this.texture=new d(r,this.video,n.RGBA),this.texture.bind(n.LINEAR,n.CLAMP_TO_EDGE)),this.tiles){let i=this.tiles[o];"loaded"!==i.state&&(i.state="loaded",i.texture=this.texture)}}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}}class M extends P{constructor(r,n,o,a){super(r,n,o,a),n.coordinates?Array.isArray(n.coordinates)&&4===n.coordinates.length&&!n.coordinates.some(i=>!Array.isArray(i)||2!==i.length||i.some(i=>"number"!=typeof i))||this.fire(new i.ErrorEvent(new i.ValidationError(`sources.${r}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new i.ErrorEvent(new i.ValidationError(`sources.${r}`,null,'missing required property "coordinates"'))),n.animate&&"boolean"!=typeof n.animate&&this.fire(new i.ErrorEvent(new i.ValidationError(`sources.${r}`,null,'optional "animate" property must be a boolean value'))),n.canvas?"string"==typeof n.canvas||n.canvas instanceof HTMLCanvasElement||this.fire(new i.ErrorEvent(new i.ValidationError(`sources.${r}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new i.ErrorEvent(new i.ValidationError(`sources.${r}`,null,'missing required property "canvas"'))),this.options=n,this.animate=void 0===n.animate||n.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new i.ErrorEvent(Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(i){this.map=i,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let r=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,r=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,r=!0),this._hasInvalidDimensions()||0===Object.keys(this.tiles).length)return;let n=this.map.painter.context,o=n.gl;for(let a in this.boundsBuffer||(this.boundsBuffer=n.createVertexBuffer(this._boundsArray,A.members)),this.boundsSegments||(this.boundsSegments=i.SegmentVector.simpleSegment(0,0,4,2)),this.texture?(r||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new d(n,this.canvas,o.RGBA,{premultiply:!0}),this.tiles){let i=this.tiles[a];"loaded"!==i.state&&(i.state="loaded",i.texture=this.texture)}}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(let i of[this.canvas.width,this.canvas.height])if(isNaN(i)||i<=0)return!0;return!1}}let z={vector:E,raster:S,"raster-dem":C,geojson:I,video:k,image:P,canvas:M};function D(i,r){let n=i.tileID,o=r.tileID;return n.overscaledZ-o.overscaledZ||n.canonical.y-o.canonical.y||n.wrap-o.wrap||n.canonical.x-o.canonical.x}class R{constructor(r,n){this.tileID=r,this.uid=i.uniqueId(),this.uses=0,this.tileSize=n,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.textures=[],this.textureCoords={},this.expiredRequestCount=0,this.state="loading"}registerFadeDuration(r){let n=r+this.timeAdded;n<i.exported.now()||this.fadeEndTime&&n<this.fadeEndTime||(this.fadeEndTime=n)}wasRequested(){return"errored"===this.state||"loaded"===this.state||"reloading"===this.state}clearTextures(i){this.demTexture&&i.saveTileTexture(this.demTexture),this.textures.forEach(r=>i.saveTileTexture(r)),this.demTexture=null,this.textures=[],this.textureCoords={}}loadVectorData(r,n,o){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",r){for(let a in r.featureIndex&&(this.latestFeatureIndex=r.featureIndex,r.rawTileData?(this.latestRawTileData=r.rawTileData,this.latestFeatureIndex.rawTileData=r.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=r.collisionBoxArray,this.buckets=function(i,r){let n={};if(!r)return n;for(let o of i){let i=o.layerIds.map(i=>r.getLayer(i)).filter(Boolean);if(0!==i.length)for(let r of(o.layers=i,o.stateDependentLayerIds&&(o.stateDependentLayers=o.stateDependentLayerIds.map(r=>i.filter(i=>i.id===r)[0])),i))n[r.id]=o}return n}(r.buckets,n.style),this.hasSymbolBuckets=!1,this.buckets){let r=this.buckets[a];if(r instanceof i.SymbolBucket){if(this.hasSymbolBuckets=!0,!o)break;r.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(let r in this.buckets){let n=this.buckets[r];if(n instanceof i.SymbolBucket&&n.hasRTLText){this.hasRTLText=!0,i.lazyLoadRTLTextPlugin();break}}for(let i in this.queryPadding=0,this.buckets){let r=this.buckets[i];this.queryPadding=Math.max(this.queryPadding,n.style.getLayer(i).queryRadius(r))}r.imageAtlas&&(this.imageAtlas=r.imageAtlas),r.glyphAtlasImage&&(this.glyphAtlasImage=r.glyphAtlasImage)}else this.collisionBoxArray=new i.CollisionBoxArray}unloadVectorData(){for(let i in this.buckets)this.buckets[i].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(i){return this.buckets[i.id]}upload(i){for(let r in this.buckets){let n=this.buckets[r];n.uploadPending()&&n.upload(i)}let r=i.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new d(i,this.imageAtlas.image,r.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new d(i,this.glyphAtlasImage,r.ALPHA),this.glyphAtlasImage=null)}prepare(i){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(i,this.imageAtlasTexture)}queryRenderedFeatures(i,r,n,o,a,s,l,u,h,c){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:o,cameraQueryGeometry:a,scale:s,tileSize:this.tileSize,pixelPosMatrix:c,transform:u,params:l,queryPadding:this.queryPadding*h},i,r,n):{}}querySourceFeatures(r,n){let o=this.latestFeatureIndex;if(!o||!o.rawTileData)return;let a=o.loadVTLayers(),s=n?n.sourceLayer:"",l=a._geojsonTileLayer||a[s];if(!l)return;let u=i.createFilter(n&&n.filter),{z:h,x:c,y:d}=this.tileID.canonical,p={z:h,x:c,y:d};for(let n=0;n<l.length;n++){let a=l.feature(n);if(u.needGeometry){let r=i.toEvaluationFeature(a,!0);if(!u.filter(new i.EvaluationParameters(this.tileID.overscaledZ),r,this.tileID.canonical))continue}else if(!u.filter(new i.EvaluationParameters(this.tileID.overscaledZ),a))continue;let f=o.getId(a,s),m=new i.GeoJSONFeature(a,h,c,d,f);m.tile=p,r.push(m)}}hasData(){return"loaded"===this.state||"reloading"===this.state||"expired"===this.state}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(r){let n=this.expirationTime;if(r.cacheControl){let n=i.parseCacheControl(r.cacheControl);n["max-age"]&&(this.expirationTime=Date.now()+1e3*n["max-age"])}else r.expires&&(this.expirationTime=new Date(r.expires).getTime());if(this.expirationTime){let i=Date.now(),r=!1;if(this.expirationTime>i)r=!1;else if(n){if(this.expirationTime<n)r=!0;else{let o=this.expirationTime-n;o?this.expirationTime=i+Math.max(o,3e4):r=!0}}else r=!0;r?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-(new Date).getTime(),2147483647)}setFeatureState(i,r){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||0===Object.keys(i).length)return;let n=this.latestFeatureIndex.loadVTLayers();for(let o in this.buckets){if(!r.style.hasLayer(o))continue;let a=this.buckets[o],s=a.layers[0].sourceLayer||"_geojsonTileLayer",l=n[s],u=i[s];if(!l||!u||0===Object.keys(u).length)continue;a.update(u,l,this.imageAtlas&&this.imageAtlas.patternPositions||{});let h=r&&r.style&&r.style.getLayer(o);h&&(this.queryPadding=Math.max(this.queryPadding,h.queryRadius(a)))}}holdingForFade(){return void 0!==this.symbolFadeHoldUntil}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<i.exported.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(r){this.symbolFadeHoldUntil=i.exported.now()+r}setDependencies(i,r){let n={};for(let i of r)n[i]=!0;this.dependencies[i]=n}hasDependency(i,r){for(let n of i){let i=this.dependencies[n];if(i){for(let n of r)if(i[n])return!0}}return!1}}class B{constructor(i,r){this.max=i,this.onRemove=r,this.reset()}reset(){for(let i in this.data)for(let r of this.data[i])r.timeout&&clearTimeout(r.timeout),this.onRemove(r.value);return this.data={},this.order=[],this}add(i,r,n){let o=i.wrapped().key;void 0===this.data[o]&&(this.data[o]=[]);let a={value:r,timeout:void 0};if(void 0!==n&&(a.timeout=setTimeout(()=>{this.remove(i,a)},n)),this.data[o].push(a),this.order.push(o),this.order.length>this.max){let i=this._getAndRemoveByKey(this.order[0]);i&&this.onRemove(i)}return this}has(i){return i.wrapped().key in this.data}getAndRemove(i){return this.has(i)?this._getAndRemoveByKey(i.wrapped().key):null}_getAndRemoveByKey(i){let r=this.data[i].shift();return r.timeout&&clearTimeout(r.timeout),0===this.data[i].length&&delete this.data[i],this.order.splice(this.order.indexOf(i),1),r.value}getByKey(i){let r=this.data[i];return r?r[0].value:null}get(i){return this.has(i)?this.data[i.wrapped().key][0].value:null}remove(i,r){if(!this.has(i))return this;let n=i.wrapped().key,o=void 0===r?0:this.data[n].indexOf(r),a=this.data[n][o];return this.data[n].splice(o,1),a.timeout&&clearTimeout(a.timeout),0===this.data[n].length&&delete this.data[n],this.onRemove(a.value),this.order.splice(this.order.indexOf(n),1),this}setMaxSize(i){for(this.max=i;this.order.length>this.max;){let i=this._getAndRemoveByKey(this.order[0]);i&&this.onRemove(i)}return this}filter(i){let r=[];for(let n in this.data)for(let o of this.data[n])i(o.value)||r.push(o);for(let i of r)this.remove(i.value.tileID,i)}}class O{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(r,n,o){let a=String(n);if(this.stateChanges[r]=this.stateChanges[r]||{},this.stateChanges[r][a]=this.stateChanges[r][a]||{},i.extend(this.stateChanges[r][a],o),null===this.deletedStates[r])for(let i in this.deletedStates[r]={},this.state[r])i!==a&&(this.deletedStates[r][i]=null);else if(this.deletedStates[r]&&null===this.deletedStates[r][a])for(let i in this.deletedStates[r][a]={},this.state[r][a])o[i]||(this.deletedStates[r][a][i]=null);else for(let i in o)this.deletedStates[r]&&this.deletedStates[r][a]&&null===this.deletedStates[r][a][i]&&delete this.deletedStates[r][a][i]}removeFeatureState(i,r,n){if(null===this.deletedStates[i])return;let o=String(r);if(this.deletedStates[i]=this.deletedStates[i]||{},n&&void 0!==r)null!==this.deletedStates[i][o]&&(this.deletedStates[i][o]=this.deletedStates[i][o]||{},this.deletedStates[i][o][n]=null);else if(void 0!==r){if(this.stateChanges[i]&&this.stateChanges[i][o])for(n in this.deletedStates[i][o]={},this.stateChanges[i][o])this.deletedStates[i][o][n]=null;else this.deletedStates[i][o]=null}else this.deletedStates[i]=null}getState(r,n){let o=String(n),a=i.extend({},(this.state[r]||{})[o],(this.stateChanges[r]||{})[o]);if(null===this.deletedStates[r])return{};if(this.deletedStates[r]){let i=this.deletedStates[r][n];if(null===i)return{};for(let r in i)delete a[r]}return a}initializeTileState(i,r){i.setFeatureState(this.state,r)}coalesceChanges(r,n){let o={};for(let r in this.stateChanges){this.state[r]=this.state[r]||{};let n={};for(let o in this.stateChanges[r])this.state[r][o]||(this.state[r][o]={}),i.extend(this.state[r][o],this.stateChanges[r][o]),n[o]=this.state[r][o];o[r]=n}for(let r in this.deletedStates){this.state[r]=this.state[r]||{};let n={};if(null===this.deletedStates[r])for(let i in this.state[r])n[i]={},this.state[r][i]={};else for(let i in this.deletedStates[r]){if(null===this.deletedStates[r][i])this.state[r][i]={};else for(let n of Object.keys(this.deletedStates[r][i]))delete this.state[r][i][n];n[i]=this.state[r][i]}o[r]=o[r]||{},i.extend(o[r],n)}if(this.stateChanges={},this.deletedStates={},0!==Object.keys(o).length)for(let i in r)r[i].setFeatureState(o,n)}}class F extends i.Evented{constructor(r,n,o){super(),this.id=r,this.dispatcher=o,this.on("data",i=>{"source"===i.dataType&&"metadata"===i.sourceDataType&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&"source"===i.dataType&&"content"===i.sourceDataType&&(this.reload(),this.transform&&this.update(this.transform,this.terrain))}),this.on("dataloading",()=>{this._sourceErrored=!1}),this.on("error",()=>{this._sourceErrored=this._source.loaded()}),this._source=function(r,n,o,a){let s=new z[n.type](r,n,o,a);if(s.id!==r)throw Error(`Expected Source id to be ${r} instead of ${s.id}`);return i.bindAll(["load","abort","unload","serialize","prepare"],s),s}(r,n,o,this),this._tiles={},this._cache=new B(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new O}onAdd(i){this.map=i,this._maxTileCacheSize=i?i._maxTileCacheSize:null,this._source&&this._source.onAdd&&this._source.onAdd(i)}onRemove(i){this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(i)}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(let i in this._tiles){let r=this._tiles[i];if("loaded"!==r.state&&"errored"!==r.state)return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;let i=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,i&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}_loadTile(i,r){return this._source.loadTile(i,r)}_unloadTile(i){if(this._source.unloadTile)return this._source.unloadTile(i,()=>{})}_abortTile(r){this._source.abortTile&&this._source.abortTile(r,()=>{}),this._source.fire(new i.Event("dataabort",{tile:r,coord:r.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(i){for(let r in this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null),this._tiles){let n=this._tiles[r];n.upload(i),n.prepare(this.map.style.imageManager)}}getIds(){return Object.values(this._tiles).map(i=>i.tileID).sort(N).map(i=>i.key)}getRenderableIds(r){let n=[];for(let i in this._tiles)this._isIdRenderable(i,r)&&n.push(this._tiles[i]);return r?n.sort((r,n)=>{let o=r.tileID,a=n.tileID,s=new i.pointGeometry(o.canonical.x,o.canonical.y)._rotate(this.transform.angle),l=new i.pointGeometry(a.canonical.x,a.canonical.y)._rotate(this.transform.angle);return o.overscaledZ-a.overscaledZ||l.y-s.y||l.x-s.x}).map(i=>i.tileID.key):n.map(i=>i.tileID).sort(N).map(i=>i.key)}hasRenderableParent(i){let r=this.findLoadedParent(i,0);return!!r&&this._isIdRenderable(r.tileID.key)}_isIdRenderable(i,r){return this._tiles[i]&&this._tiles[i].hasData()&&!this._coveredTiles[i]&&(r||!this._tiles[i].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else for(let i in this._cache.reset(),this._tiles)"errored"!==this._tiles[i].state&&this._reloadTile(i,"reloading")}_reloadTile(i,r){let n=this._tiles[i];n&&("loading"!==n.state&&(n.state=r),this._loadTile(n,this._tileLoaded.bind(this,n,i,r)))}_tileLoaded(r,n,o,a){if(a)return r.state="errored",void(404!==a.status?this._source.fire(new i.ErrorEvent(a,{tile:r})):this.update(this.transform,this.terrain));r.timeAdded=i.exported.now(),"expired"===o&&(r.refreshedUponExpiration=!0),this._setTileReloadTimer(n,r),"raster-dem"===this.getSource().type&&r.dem&&this._backfillDEM(r),this._state.initializeTileState(r,this.map?this.map.painter:null),r.aborted||this._source.fire(new i.Event("data",{dataType:"source",tile:r,coord:r.tileID}))}_backfillDEM(i){let r=this.getRenderableIds();for(let o=0;o<r.length;o++){let a=r[o];if(i.neighboringTiles&&i.neighboringTiles[a]){let r=this.getTileByID(a);n(i,r),n(r,i)}}function n(i,r){i.needsHillshadePrepare=!0,i.needsTerrainPrepare=!0;let n=r.tileID.canonical.x-i.tileID.canonical.x,o=r.tileID.canonical.y-i.tileID.canonical.y,a=Math.pow(2,i.tileID.canonical.z),s=r.tileID.key;0===n&&0===o||Math.abs(o)>1||(Math.abs(n)>1&&(1===Math.abs(n+a)?n+=a:1===Math.abs(n-a)&&(n-=a)),r.dem&&i.dem&&(i.dem.backfillBorder(r.dem,n,o),i.neighboringTiles&&i.neighboringTiles[s]&&(i.neighboringTiles[s].backfilled=!0)))}}getTile(i){return this.getTileByID(i.key)}getTileByID(i){return this._tiles[i]}_retainLoadedChildren(i,r,n,o){for(let a in this._tiles){let s=this._tiles[a];if(o[a]||!s.hasData()||s.tileID.overscaledZ<=r||s.tileID.overscaledZ>n)continue;let l=s.tileID;for(;s&&s.tileID.overscaledZ>r+1;){let i=s.tileID.scaledTo(s.tileID.overscaledZ-1);(s=this._tiles[i.key])&&s.hasData()&&(l=i)}let u=l;for(;u.overscaledZ>r;)if(i[(u=u.scaledTo(u.overscaledZ-1)).key]){o[l.key]=l;break}}}findLoadedParent(i,r){if(i.key in this._loadedParentTiles){let n=this._loadedParentTiles[i.key];return n&&n.tileID.overscaledZ>=r?n:null}for(let n=i.overscaledZ-1;n>=r;n--){let r=i.scaledTo(n),o=this._getLoadedTile(r);if(o)return o}}_getLoadedTile(i){let r=this._tiles[i.key];return r&&r.hasData()?r:this._cache.getByKey(i.wrapped().key)}updateCacheSize(i){let r=Math.ceil(i.width/this._source.tileSize)+1,n=Math.ceil(i.height/this._source.tileSize)+1,o=Math.floor(r*n*5),a="number"==typeof this._maxTileCacheSize?Math.min(this._maxTileCacheSize,o):o;this._cache.setMaxSize(a)}handleWrapJump(i){let r=Math.round((i-(void 0===this._prevLng?i:this._prevLng))/360);if(this._prevLng=i,r){let i={};for(let n in this._tiles){let o=this._tiles[n];o.tileID=o.tileID.unwrapTo(o.tileID.wrap+r),i[o.tileID.key]=o}for(let r in this._tiles=i,this._timers)clearTimeout(this._timers[r]),delete this._timers[r];for(let i in this._tiles)this._setTileReloadTimer(i,this._tiles[i])}}update(r,n){let o;if(this.transform=r,this.terrain=n,!this._sourceLoaded||this._paused)return;this.updateCacheSize(r),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?o=r.getVisibleUnwrappedCoordinates(this._source.tileID).map(r=>new i.OverscaledTileID(r.canonical.z,r.wrap,r.canonical.z,r.canonical.x,r.canonical.y)):(o=r.coveringTiles({tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:n}),this._source.hasTile&&(o=o.filter(i=>this._source.hasTile(i)))):o=[];let a=r.coveringZoomLevel(this._source),s=Math.max(a-F.maxOverzooming,this._source.minzoom),l=Math.max(a+F.maxUnderzooming,this._source.minzoom);if(this.usedForTerrain){let i={};for(let r of o)if(r.canonical.z>this._source.minzoom){let n=r.scaledTo(r.canonical.z-1);i[n.key]=n;let o=r.scaledTo(Math.max(this._source.minzoom,Math.min(r.canonical.z,5)));i[o.key]=o}o=o.concat(Object.values(i))}let u=this._updateRetainedTiles(o,a);if(U(this._source.type)){let r={},h={},c=Object.keys(u);for(let n of c){let o=u[n],a=this._tiles[n];if(!a||a.fadeEndTime&&a.fadeEndTime<=i.exported.now())continue;let l=this.findLoadedParent(o,s);l&&(this._addTile(l.tileID),r[l.tileID.key]=l.tileID),h[n]=o}for(let i in this._retainLoadedChildren(h,a,l,u),r)u[i]||(this._coveredTiles[i]=!0,u[i]=r[i]);if(n){let i={},r={};for(let n of o)this._tiles[n.key].hasData()?i[n.key]=n:r[n.key]=n;for(let n in r){let o=r[n].children(this._source.maxzoom);this._tiles[o[0].key]&&this._tiles[o[1].key]&&this._tiles[o[2].key]&&this._tiles[o[3].key]&&(i[o[0].key]=u[o[0].key]=o[0],i[o[1].key]=u[o[1].key]=o[1],i[o[2].key]=u[o[2].key]=o[2],i[o[3].key]=u[o[3].key]=o[3],delete r[n])}for(let n in r){let o=this.findLoadedParent(r[n],this._source.minzoom);if(o)for(let r in i[o.tileID.key]=u[o.tileID.key]=o.tileID,i)i[r].isChildOf(o.tileID)&&delete i[r]}for(let r in this._tiles)i[r]||(this._coveredTiles[r]=!0)}}for(let i in u)this._tiles[i].clearFadeHold();let h=i.keysDifference(this._tiles,u);for(let i of h){let r=this._tiles[i];r.hasSymbolBuckets&&!r.holdingForFade()?r.setHoldDuration(this.map._fadeDuration):r.hasSymbolBuckets&&!r.symbolFadeFinished()||this._removeTile(i)}this._updateLoadedParentTileCache()}releaseSymbolFadeTiles(){for(let i in this._tiles)this._tiles[i].holdingForFade()&&this._removeTile(i)}_updateRetainedTiles(i,r){let n={},o={},a=Math.max(r-F.maxOverzooming,this._source.minzoom),s=Math.max(r+F.maxUnderzooming,this._source.minzoom),l={};for(let o of i){let i=this._addTile(o);n[o.key]=o,i.hasData()||r<this._source.maxzoom&&(l[o.key]=o)}for(let u of(this._retainLoadedChildren(l,r,s,n),i)){let i=this._tiles[u.key];if(i.hasData())continue;if(r+1>this._source.maxzoom){let i=u.children(this._source.maxzoom)[0],r=this.getTile(i);if(r&&r.hasData()){n[i.key]=i;continue}}else{let i=u.children(this._source.maxzoom);if(n[i[0].key]&&n[i[1].key]&&n[i[2].key]&&n[i[3].key])continue}let s=i.wasRequested();for(let r=u.overscaledZ-1;r>=a;--r){let a=u.scaledTo(r);if(o[a.key]||(o[a.key]=!0,(i=this.getTile(a))||!s||(i=this._addTile(a)),i&&(n[a.key]=a,s=i.wasRequested(),i.hasData())))break}}return n}_updateLoadedParentTileCache(){for(let i in this._loadedParentTiles={},this._tiles){let r=[],n,o=this._tiles[i].tileID;for(;o.overscaledZ>0;){if(o.key in this._loadedParentTiles){n=this._loadedParentTiles[o.key];break}r.push(o.key);let i=o.scaledTo(o.overscaledZ-1);if(n=this._getLoadedTile(i))break;o=i}for(let i of r)this._loadedParentTiles[i]=n}}_addTile(r){let n=this._tiles[r.key];if(n)return n;(n=this._cache.getAndRemove(r))&&(this._setTileReloadTimer(r.key,n),n.tileID=r,this._state.initializeTileState(n,this.map?this.map.painter:null),this._cacheTimers[r.key]&&(clearTimeout(this._cacheTimers[r.key]),delete this._cacheTimers[r.key],this._setTileReloadTimer(r.key,n)));let o=n;return n||(n=new R(r,this._source.tileSize*r.overscaleFactor()),this._loadTile(n,this._tileLoaded.bind(this,n,r.key,n.state))),n.uses++,this._tiles[r.key]=n,o||this._source.fire(new i.Event("dataloading",{tile:n,coord:n.tileID,dataType:"source"})),n}_setTileReloadTimer(i,r){i in this._timers&&(clearTimeout(this._timers[i]),delete this._timers[i]);let n=r.getExpiryTimeout();n&&(this._timers[i]=setTimeout(()=>{this._reloadTile(i,"expired"),delete this._timers[i]},n))}_removeTile(i){let r=this._tiles[i];r&&(r.uses--,delete this._tiles[i],this._timers[i]&&(clearTimeout(this._timers[i]),delete this._timers[i]),r.uses>0||(r.hasData()&&"reloading"!==r.state?this._cache.add(r.tileID,r,r.getExpiryTimeout()):(r.aborted=!0,this._abortTile(r),this._unloadTile(r))))}clearTiles(){for(let i in this._shouldReloadOnResume=!1,this._paused=!1,this._tiles)this._removeTile(i);this._cache.reset()}tilesIn(r,n,o){let a=[],s=this.transform;if(!s)return a;let l=o?s.getCameraQueryGeometry(r):r,u=r.map(i=>s.pointCoordinate(i,this.terrain)),h=l.map(i=>s.pointCoordinate(i,this.terrain)),c=this.getIds(),d=1/0,p=1/0,f=-1/0,m=-1/0;for(let i of h)d=Math.min(d,i.x),p=Math.min(p,i.y),f=Math.max(f,i.x),m=Math.max(m,i.y);for(let r=0;r<c.length;r++){let o=this._tiles[c[r]];if(o.holdingForFade())continue;let l=o.tileID,g=Math.pow(2,s.zoom-o.tileID.overscaledZ),_=n*o.queryPadding*i.EXTENT/o.tileSize/g,y=[l.getTilePoint(new i.MercatorCoordinate(d,p)),l.getTilePoint(new i.MercatorCoordinate(f,m))];if(y[0].x-_<i.EXTENT&&y[0].y-_<i.EXTENT&&y[1].x+_>=0&&y[1].y+_>=0){let i=u.map(i=>l.getTilePoint(i)),r=h.map(i=>l.getTilePoint(i));a.push({tile:o,tileID:l,queryGeometry:i,cameraQueryGeometry:r,scale:g})}}return a}getVisibleCoordinates(i){let r=this.getRenderableIds(i).map(i=>this._tiles[i].tileID);for(let i of r)i.posMatrix=this.transform.calculatePosMatrix(i.toUnwrapped());return r}hasTransition(){if(this._source.hasTransition())return!0;if(U(this._source.type))for(let r in this._tiles){let n=this._tiles[r];if(void 0!==n.fadeEndTime&&n.fadeEndTime>=i.exported.now())return!0}return!1}setFeatureState(i,r,n){this._state.updateState(i=i||"_geojsonTileLayer",r,n)}removeFeatureState(i,r,n){this._state.removeFeatureState(i=i||"_geojsonTileLayer",r,n)}getFeatureState(i,r){return this._state.getState(i=i||"_geojsonTileLayer",r)}setDependencies(i,r,n){let o=this._tiles[i];o&&o.setDependencies(r,n)}reloadTilesForDependencies(i,r){for(let n in this._tiles)this._tiles[n].hasDependency(i,r)&&this._reloadTile(n,"reloading");this._cache.filter(n=>!n.hasDependency(i,r))}}function N(i,r){let n=Math.abs(2*i.wrap)-+(i.wrap<0),o=Math.abs(2*r.wrap)-+(r.wrap<0);return i.overscaledZ-r.overscaledZ||o-n||r.canonical.y-i.canonical.y||r.canonical.x-i.canonical.x}function U(i){return"raster"===i||"image"===i||"video"===i}F.maxOverzooming=10,F.maxUnderzooming=3;let j="mapboxgl_preloaded_worker_pool";class Z{constructor(){this.active={}}acquire(i){if(!this.workers)for(this.workers=[];this.workers.length<Z.workerCount;)this.workers.push(new Worker(r_.workerUrl));return this.active[i]=!0,this.workers.slice()}release(i){delete this.active[i],0===this.numActive()&&(this.workers.forEach(i=>{i.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[j]}numActive(){return Object.keys(this.active).length}}let V=Math.floor(i.exported.hardwareConcurrency/2);function q(){return n||(n=new Z),n}function G(r){r=r.slice();let n=Object.create(null);for(let i=0;i<r.length;i++)n[r[i].id]=r[i];for(let o=0;o<r.length;o++)"ref"in r[o]&&(r[o]=function(r,n){let o={};for(let i in r)"ref"!==i&&(o[i]=r[i]);return i.refProperties.forEach(i=>{i in n&&(o[i]=n[i])}),o}(r[o],n[r[o].ref]));return r}Z.workerCount=Math.max(Math.min(V,6),1);let W={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight"};function H(i,r,n){n.push({command:W.addSource,args:[i,r[i]]})}function X(i,r,n){r.push({command:W.removeSource,args:[i]}),n[i]=!0}function K(i,r,n,o,a,s){let u;for(u in r=r||{},i=i||{})Object.prototype.hasOwnProperty.call(i,u)&&(l(i[u],r[u])||n.push({command:s,args:[o,u,r[u],a]}));for(u in r)Object.prototype.hasOwnProperty.call(r,u)&&!Object.prototype.hasOwnProperty.call(i,u)&&(l(i[u],r[u])||n.push({command:s,args:[o,u,r[u],a]}))}function J(i){return i.id}function Y(i,r){return i[r.id]=r,i}class Q{constructor(i,r){this.reset(i,r)}reset(i,r){this.points=i||[],this._distances=[0];for(let i=1;i<this.points.length;i++)this._distances[i]=this._distances[i-1]+this.points[i].dist(this.points[i-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(r||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(r){if(1===this.points.length)return this.points[0];r=i.clamp(r,0,1);let n=1,o=this._distances[n],a=r*this.paddedLength+this.padding;for(;o<a&&n<this._distances.length;)o=this._distances[++n];let s=n-1,l=this._distances[s],u=o-l,h=u>0?(a-l)/u:0;return this.points[s].mult(1-h).add(this.points[n].mult(h))}}function tt(i,r){let n=!0;return"always"===i||"never"!==i&&"never"!==r||(n=!1),n}class te{constructor(i,r,n){let o=this.boxCells=[],a=this.circleCells=[];this.xCellCount=Math.ceil(i/n),this.yCellCount=Math.ceil(r/n);for(let i=0;i<this.xCellCount*this.yCellCount;i++)o.push([]),a.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=i,this.height=r,this.xScale=this.xCellCount/i,this.yScale=this.yCellCount/r,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(i,r,n,o,a){this._forEachCell(r,n,o,a,this._insertBoxCell,this.boxUid++),this.boxKeys.push(i),this.bboxes.push(r),this.bboxes.push(n),this.bboxes.push(o),this.bboxes.push(a)}insertCircle(i,r,n,o){this._forEachCell(r-o,n-o,r+o,n+o,this._insertCircleCell,this.circleUid++),this.circleKeys.push(i),this.circles.push(r),this.circles.push(n),this.circles.push(o)}_insertBoxCell(i,r,n,o,a,s){this.boxCells[a].push(s)}_insertCircleCell(i,r,n,o,a,s){this.circleCells[a].push(s)}_query(i,r,n,o,a,s,l){if(n<0||i>this.width||o<0||r>this.height)return[];let u=[];if(i<=0&&r<=0&&this.width<=n&&this.height<=o){if(a)return[{key:null,x1:i,y1:r,x2:n,y2:o}];for(let i=0;i<this.boxKeys.length;i++)u.push({key:this.boxKeys[i],x1:this.bboxes[4*i],y1:this.bboxes[4*i+1],x2:this.bboxes[4*i+2],y2:this.bboxes[4*i+3]});for(let i=0;i<this.circleKeys.length;i++){let r=this.circles[3*i],n=this.circles[3*i+1],o=this.circles[3*i+2];u.push({key:this.circleKeys[i],x1:r-o,y1:n-o,x2:r+o,y2:n+o})}}else this._forEachCell(i,r,n,o,this._queryCell,u,{hitTest:a,overlapMode:s,seenUids:{box:{},circle:{}}},l);return u}query(i,r,n,o){return this._query(i,r,n,o,!1,null)}hitTest(i,r,n,o,a,s){return this._query(i,r,n,o,!0,a,s).length>0}hitTestCircle(i,r,n,o,a){let s=i-n,l=i+n,u=r-n,h=r+n;if(l<0||s>this.width||h<0||u>this.height)return!1;let c=[];return this._forEachCell(s,u,l,h,this._queryCellCircle,c,{hitTest:!0,overlapMode:o,circle:{x:i,y:r,radius:n},seenUids:{box:{},circle:{}}},a),c.length>0}_queryCell(i,r,n,o,a,s,l,u){let{seenUids:h,hitTest:c,overlapMode:d}=l,p=this.boxCells[a];if(null!==p){let a=this.bboxes;for(let l of p)if(!h.box[l]){h.box[l]=!0;let p=4*l,f=this.boxKeys[l];if(i<=a[p+2]&&r<=a[p+3]&&n>=a[p+0]&&o>=a[p+1]&&(!u||u(f))&&(!c||!tt(d,f.overlapMode))&&(s.push({key:f,x1:a[p],y1:a[p+1],x2:a[p+2],y2:a[p+3]}),c))return!0}}let f=this.circleCells[a];if(null!==f){let a=this.circles;for(let l of f)if(!h.circle[l]){h.circle[l]=!0;let p=3*l,f=this.circleKeys[l];if(this._circleAndRectCollide(a[p],a[p+1],a[p+2],i,r,n,o)&&(!u||u(f))&&(!c||!tt(d,f.overlapMode))){let i=a[p],r=a[p+1],n=a[p+2];if(s.push({key:f,x1:i-n,y1:r-n,x2:i+n,y2:r+n}),c)return!0}}}return!1}_queryCellCircle(i,r,n,o,a,s,l,u){let{circle:h,seenUids:c,overlapMode:d}=l,p=this.boxCells[a];if(null!==p){let i=this.bboxes;for(let r of p)if(!c.box[r]){c.box[r]=!0;let n=4*r,o=this.boxKeys[r];if(this._circleAndRectCollide(h.x,h.y,h.radius,i[n+0],i[n+1],i[n+2],i[n+3])&&(!u||u(o))&&!tt(d,o.overlapMode))return s.push(!0),!0}}let f=this.circleCells[a];if(null!==f){let i=this.circles;for(let r of f)if(!c.circle[r]){c.circle[r]=!0;let n=3*r,o=this.circleKeys[r];if(this._circlesCollide(i[n],i[n+1],i[n+2],h.x,h.y,h.radius)&&(!u||u(o))&&!tt(d,o.overlapMode))return s.push(!0),!0}}}_forEachCell(i,r,n,o,a,s,l,u){let h=this._convertToXCellCoord(i),c=this._convertToYCellCoord(r),d=this._convertToXCellCoord(n),p=this._convertToYCellCoord(o);for(let f=h;f<=d;f++)for(let h=c;h<=p;h++)if(a.call(this,i,r,n,o,this.xCellCount*h+f,s,l,u))return}_convertToXCellCoord(i){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(i*this.xScale)))}_convertToYCellCoord(i){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(i*this.yScale)))}_circlesCollide(i,r,n,o,a,s){let l=o-i,u=a-r,h=n+s;return h*h>l*l+u*u}_circleAndRectCollide(i,r,n,o,a,s,l){let u=(s-o)/2,h=Math.abs(i-(o+u));if(h>u+n)return!1;let c=(l-a)/2,d=Math.abs(r-(a+c));if(d>c+n)return!1;if(h<=u||d<=c)return!0;let p=h-u,f=d-c;return p*p+f*f<=n*n}}function ti(r,n,o,a,s){let l=i.create();return n?(i.scale(l,l,[1/s,1/s,1]),o||i.rotateZ(l,l,a.angle)):i.multiply(l,a.labelPlaneMatrix,r),l}function tr(r,n,o,a,s){if(n){let n=i.clone(r);return i.scale(n,n,[s,s,1]),o||i.rotateZ(n,n,-a.angle),n}return a.glCoordMatrix}function tn(r,n,o){let a;o?(a=[r.x,r.y,o(r.x,r.y),1],i.transformMat4(a,a,n)):tp(a=[r.x,r.y,0,1],a,n);let s=a[3];return{point:new i.pointGeometry(a[0]/s,a[1]/s),signedDistanceFromCamera:s}}function to(i,r){return .5+i/r*.5}function ta(i,r,n,o,a,s,l,u,h,c,d,p,f){let m=u.glyphStartIndex+u.numGlyphs,g=u.lineStartIndex,_=u.lineStartIndex+u.lineLength,y=r.getoffsetX(u.glyphStartIndex),v=r.getoffsetX(m-1),x=th(i*y,n,o,a,s,l,u.segment,g,_,h,c,d,p,f);if(!x)return null;let b=th(i*v,n,o,a,s,l,u.segment,g,_,h,c,d,p,f);return b?{first:x,last:b}:null}function ts(r,n,o,a){return r===i.WritingMode.horizontal&&Math.abs(o.y-n.y)>Math.abs(o.x-n.x)*a?{useVertical:!0}:(r===i.WritingMode.vertical?n.y<o.y:n.x>o.x)?{needsFlipping:!0}:null}function tl(r,n,o,a,s,l,u,h,c,d,p,f,m,g,_,y){let v;let x=n/24,b=r.lineOffsetX*x,w=r.lineOffsetY*x;if(r.numGlyphs>1){let i=r.glyphStartIndex+r.numGlyphs,n=r.lineStartIndex,s=r.lineStartIndex+r.lineLength,d=ta(x,h,b,w,o,p,f,r,c,l,m,_,y);if(!d)return{notEnoughRoom:!0};let T=tn(d.first.point,u,y).point,E=tn(d.last.point,u,y).point;if(a&&!o){let i=ts(r.writingMode,T,E,g);if(i)return i}v=[d.first];for(let a=r.glyphStartIndex+1;a<i-1;a++)v.push(th(x*h.getoffsetX(a),b,w,o,p,f,r.segment,n,s,c,l,m,_,y));v.push(d.last)}else{if(a&&!o){let n=tn(f,s,y).point,o=r.lineStartIndex+r.segment+1,a=new i.pointGeometry(c.getx(o),c.gety(o)),l=tn(a,s,y),u=l.signedDistanceFromCamera>0?l.point:tu(f,a,n,1,s,y),h=ts(r.writingMode,n,u,g);if(h)return h}let n=th(x*h.getoffsetX(r.glyphStartIndex),b,w,o,p,f,r.segment,r.lineStartIndex,r.lineStartIndex+r.lineLength,c,l,m,_,y);if(!n)return{notEnoughRoom:!0};v=[n]}for(let r of v)i.addDynamicAttributes(d,r.point,r.angle);return{}}function tu(i,r,n,o,a,s){let l=tn(i.add(i.sub(r)._unit()),a,s).point,u=n.sub(l);return n.add(u._mult(o/u.mag()))}function th(r,n,o,a,s,l,u,h,c,d,p,f,m,g){let _=a?r-n:r+n,y=_>0?1:-1,v=0;a&&(y*=-1,v=Math.PI),y<0&&(v+=Math.PI);let x=y>0?h+u:h+u+1,b=s,w=s,T=0,E=0,S=Math.abs(_),C=[];for(;T+E<=S;){if((x+=y)<h||x>=c)return null;if(w=b,C.push(b),void 0===(b=f[x])){let r=new i.pointGeometry(d.getx(x),d.gety(x)),n=tn(r,p,g);if(n.signedDistanceFromCamera>0)b=f[x]=n.point;else{let n=x-y;b=tu(0===T?l:new i.pointGeometry(d.getx(n),d.gety(n)),r,w,S-T+1,p,g)}}T+=E,E=w.dist(b)}let I=(S-T)/E,A=b.sub(w),P=A.mult(I)._add(w);P._add(A._unit()._perp()._mult(o*y));let k=v+Math.atan2(b.y-w.y,b.x-w.x);return C.push(P),{point:P,angle:m?k:0,path:C}}let tc=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function td(i,r){for(let n=0;n<i;n++){let i=r.length;r.resize(i+4),r.float32.set(tc,3*i)}}function tp(i,r,n){let o=r[0],a=r[1];return i[0]=n[0]*o+n[4]*a+n[12],i[1]=n[1]*o+n[5]*a+n[13],i[3]=n[3]*o+n[7]*a+n[15],i}class tf{constructor(i,r=new te(i.width+200,i.height+200,25),n=new te(i.width+200,i.height+200,25)){this.transform=i,this.grid=r,this.ignoredGrid=n,this.pitchfactor=Math.cos(i._pitch)*i.cameraToCenterDistance,this.screenRightBoundary=i.width+100,this.screenBottomBoundary=i.height+100,this.gridRightBoundary=i.width+200,this.gridBottomBoundary=i.height+200,this.perspectiveRatioCutoff=.6}placeCollisionBox(i,r,n,o,a,s){let l=this.projectAndGetPerspectiveRatio(o,i.anchorPointX,i.anchorPointY,s),u=n*l.perspectiveRatio,h=i.x1*u+l.point.x,c=i.y1*u+l.point.y,d=i.x2*u+l.point.x,p=i.y2*u+l.point.y;return!this.isInsideGrid(h,c,d,p)||"always"!==r&&this.grid.hitTest(h,c,d,p,r,a)||l.perspectiveRatio<this.perspectiveRatioCutoff?{box:[],offscreen:!1}:{box:[h,c,d,p],offscreen:this.isOffscreen(h,c,d,p)}}placeCollisionCircles(r,n,o,a,s,l,u,h,c,d,p,f,m,g){let _=[],y=new i.pointGeometry(n.anchorX,n.anchorY),v=tn(y,l,g),x=to(this.transform.cameraToCenterDistance,v.signedDistanceFromCamera),b=(d?s/x:s*x)/i.ONE_EM,w=tn(y,u,g).point,T=ta(b,a,n.lineOffsetX*b,n.lineOffsetY*b,!1,w,y,n,o,u,{},!1,g),E=!1,S=!1,C=!0;if(T){let n=.5*f*x+m,o=new i.pointGeometry(-100,-100),a=new i.pointGeometry(this.screenRightBoundary,this.screenBottomBoundary),s=new Q,l=T.first,u=T.last,d=[];for(let i=l.path.length-1;i>=1;i--)d.push(l.path[i]);for(let i=1;i<u.path.length;i++)d.push(u.path[i]);let y=2.5*n;if(h){let i=d.map(i=>tn(i,h,g));d=i.some(i=>i.signedDistanceFromCamera<=0)?[]:i.map(i=>i.point)}let v=[];if(d.length>0){let r=d[0].clone(),n=d[0].clone();for(let i=1;i<d.length;i++)r.x=Math.min(r.x,d[i].x),r.y=Math.min(r.y,d[i].y),n.x=Math.max(n.x,d[i].x),n.y=Math.max(n.y,d[i].y);v=r.x>=o.x&&n.x<=a.x&&r.y>=o.y&&n.y<=a.y?[d]:n.x<o.x||r.x>a.x||n.y<o.y||r.y>a.y?[]:i.clipLine([d],o.x,o.y,a.x,a.y)}for(let i of v){s.reset(i,.25*n);let o=0;o=s.length<=.5*n?1:Math.ceil(s.paddedLength/y)+1;for(let i=0;i<o;i++){let a=i/Math.max(o-1,1),l=s.lerp(a),u=l.x+100,h=l.y+100;_.push(u,h,n,0);let d=u-n,f=h-n,m=u+n,g=h+n;if(C=C&&this.isOffscreen(d,f,m,g),S=S||this.isInsideGrid(d,f,m,g),"always"!==r&&this.grid.hitTestCircle(u,h,n,r,p)&&(E=!0,!c))return{circles:[],offscreen:!1,collisionDetected:E}}}}return{circles:!c&&E||!S||x<this.perspectiveRatioCutoff?[]:_,offscreen:C,collisionDetected:E}}queryRenderedSymbols(r){if(0===r.length||0===this.grid.keysLength()&&0===this.ignoredGrid.keysLength())return{};let n=[],o=1/0,a=1/0,s=-1/0,l=-1/0;for(let u of r){let r=new i.pointGeometry(u.x+100,u.y+100);o=Math.min(o,r.x),a=Math.min(a,r.y),s=Math.max(s,r.x),l=Math.max(l,r.y),n.push(r)}let u=this.grid.query(o,a,s,l).concat(this.ignoredGrid.query(o,a,s,l)),h={},c={};for(let r of u){let o=r.key;if(void 0===h[o.bucketInstanceId]&&(h[o.bucketInstanceId]={}),h[o.bucketInstanceId][o.featureIndex])continue;let a=[new i.pointGeometry(r.x1,r.y1),new i.pointGeometry(r.x2,r.y1),new i.pointGeometry(r.x2,r.y2),new i.pointGeometry(r.x1,r.y2)];i.polygonIntersectsPolygon(n,a)&&(h[o.bucketInstanceId][o.featureIndex]=!0,void 0===c[o.bucketInstanceId]&&(c[o.bucketInstanceId]=[]),c[o.bucketInstanceId].push(o.featureIndex))}return c}insertCollisionBox(i,r,n,o,a,s){(n?this.ignoredGrid:this.grid).insert({bucketInstanceId:o,featureIndex:a,collisionGroupID:s,overlapMode:r},i[0],i[1],i[2],i[3])}insertCollisionCircles(i,r,n,o,a,s){let l=n?this.ignoredGrid:this.grid,u={bucketInstanceId:o,featureIndex:a,collisionGroupID:s,overlapMode:r};for(let r=0;r<i.length;r+=4)l.insertCircle(u,i[r],i[r+1],i[r+2])}projectAndGetPerspectiveRatio(r,n,o,a){let s;return a?(s=[n,o,a(n,o),1],i.transformMat4(s,s,r)):tp(s=[n,o,0,1],s,r),{point:new i.pointGeometry((s[0]/s[3]+1)/2*this.transform.width+100,(-s[1]/s[3]+1)/2*this.transform.height+100),perspectiveRatio:.5+this.transform.cameraToCenterDistance/s[3]*.5}}isOffscreen(i,r,n,o){return n<100||i>=this.screenRightBoundary||o<100||r>this.screenBottomBoundary}isInsideGrid(i,r,n,o){return n>=0&&i<this.gridRightBoundary&&o>=0&&r<this.gridBottomBoundary}getViewportMatrix(){let r=i.identity([]);return i.translate(r,r,[-100,-100,0]),r}}function tm(r,n,o){return n*(i.EXTENT/(r.tileSize*Math.pow(2,o-r.tileID.overscaledZ)))}class tg{constructor(i,r,n,o){this.opacity=i?Math.max(0,Math.min(1,i.opacity+(i.placed?r:-r))):o&&n?1:0,this.placed=n}isHidden(){return 0===this.opacity&&!this.placed}}class t_{constructor(i,r,n,o,a){this.text=new tg(i?i.text:null,r,n,a),this.icon=new tg(i?i.icon:null,r,o,a)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class ty{constructor(i,r,n){this.text=i,this.icon=r,this.skipFade=n}}class tv{constructor(){this.invProjMatrix=i.create(),this.viewportMatrix=i.create(),this.circles=[]}}class tx{constructor(i,r,n,o,a){this.bucketInstanceId=i,this.featureIndex=r,this.sourceLayerIndex=n,this.bucketIndex=o,this.tileID=a}}class tb{constructor(i){this.crossSourceCollisions=i,this.maxGroupID=0,this.collisionGroups={}}get(i){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[i]){let r=++this.maxGroupID;this.collisionGroups[i]={ID:r,predicate:i=>i.collisionGroupID===r}}return this.collisionGroups[i]}}function tw(r,n,o,a,s){let{horizontalAlign:l,verticalAlign:u}=i.getAnchorAlignment(r),h=i.evaluateVariableOffset(r,a);return new i.pointGeometry(-(l-.5)*n+h[0]*s,-(u-.5)*o+h[1]*s)}function tT(r,n,o,a,s,l){let{x1:u,x2:h,y1:c,y2:d,anchorPointX:p,anchorPointY:f}=r,m=new i.pointGeometry(n,o);return a&&m._rotate(s?l:-l),{x1:u+m.x,y1:c+m.y,x2:h+m.x,y2:d+m.y,anchorPointX:p,anchorPointY:f}}class tE{constructor(i,r,n,o,a){this.transform=i.clone(),this.terrain=r,this.collisionIndex=new tf(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=n,this.retainedQueryData={},this.collisionGroups=new tb(o),this.collisionCircleArrays={},this.prevPlacement=a,a&&(a.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(r,n,o,a){let s=o.getBucket(n),l=o.latestFeatureIndex;if(!s||!l||n.id!==s.layerIds[0])return;let u=o.collisionBoxArray,h=s.layers[0].layout,c=Math.pow(2,this.transform.zoom-o.tileID.overscaledZ),d=o.tileSize/i.EXTENT,p=this.transform.calculatePosMatrix(o.tileID.toUnwrapped()),f="map"===h.get("text-pitch-alignment"),m="map"===h.get("text-rotation-alignment"),g=tm(o,1,this.transform.zoom),_=ti(p,f,m,this.transform,g),y=null;if(f){let r=tr(p,f,m,this.transform,g);y=i.multiply([],this.transform.labelPlaneMatrix,r)}this.retainedQueryData[s.bucketInstanceId]=new tx(s.bucketInstanceId,l,s.sourceLayerIndex,s.index,o.tileID);let v={bucket:s,layout:h,posMatrix:p,textLabelPlaneMatrix:_,labelToScreenMatrix:y,scale:c,textPixelRatio:d,holdingForFade:o.holdingForFade(),collisionBoxArray:u,partiallyEvaluatedTextSize:i.evaluateSizeForZoom(s.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(s.sourceID)};if(a)for(let i of s.sortKeyRanges){let{sortKey:n,symbolInstanceStart:o,symbolInstanceEnd:a}=i;r.push({sortKey:n,symbolInstanceStart:o,symbolInstanceEnd:a,parameters:v})}else r.push({symbolInstanceStart:0,symbolInstanceEnd:s.symbolInstances.length,parameters:v})}attemptAnchorPlacement(i,r,n,o,a,s,l,u,h,c,d,p,f,m,g,_){let y=[p.textOffset0,p.textOffset1],v=tw(i,n,o,y,a),x=this.collisionIndex.placeCollisionBox(tT(r,v.x,v.y,s,l,this.transform.angle),d,u,h,c.predicate,_);if((!g||0!==this.collisionIndex.placeCollisionBox(tT(g,v.x,v.y,s,l,this.transform.angle),d,u,h,c.predicate,_).box.length)&&x.box.length>0){let r;if(this.prevPlacement&&this.prevPlacement.variableOffsets[p.crossTileID]&&this.prevPlacement.placements[p.crossTileID]&&this.prevPlacement.placements[p.crossTileID].text&&(r=this.prevPlacement.variableOffsets[p.crossTileID].anchor),0===p.crossTileID)throw Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[p.crossTileID]={textOffset:y,width:n,height:o,anchor:i,textBoxScale:a,prevAnchor:r},this.markUsedJustification(f,i,p,m),f.allowVerticalPlacement&&(this.markUsedOrientation(f,m,p),this.placedOrientations[p.crossTileID]=m),{shift:v,placedGlyphBoxes:x}}}placeLayerBucketPart(r,n,o){let{bucket:a,layout:s,posMatrix:l,textLabelPlaneMatrix:u,labelToScreenMatrix:h,textPixelRatio:c,holdingForFade:d,collisionBoxArray:p,partiallyEvaluatedTextSize:f,collisionGroup:m}=r.parameters,g=s.get("text-optional"),_=s.get("icon-optional"),y=i.getOverlapMode(s,"text-overlap","text-allow-overlap"),v="always"===y,x=i.getOverlapMode(s,"icon-overlap","icon-allow-overlap"),b="always"===x,w="map"===s.get("text-rotation-alignment"),T="map"===s.get("text-pitch-alignment"),E="none"!==s.get("icon-text-fit"),S="viewport-y"===s.get("symbol-z-order"),C=v&&(b||!a.hasIconData()||_),I=b&&(v||!a.hasTextData()||g);!a.collisionArrays&&p&&a.deserializeCollisionBoxes(p);let A=(r,p)=>{if(n[r.crossTileID])return;if(d)return void(this.placements[r.crossTileID]=new ty(!1,!1,!1));let b=!1,S=!1,A=!0,P=null,k={box:null,offscreen:null},M={box:null,offscreen:null},z=null,D=null,R=null,B=0,O=0,F=0;p.textFeatureIndex?B=p.textFeatureIndex:r.useRuntimeCollisionCircles&&(B=r.featureIndex),p.verticalTextFeatureIndex&&(O=p.verticalTextFeatureIndex);let N=this.retainedQueryData[a.bucketInstanceId].tileID,U=this.terrain?(i,r)=>this.terrain.getElevation(N,i,r):null;for(let i of["textBox","verticalTextBox","iconBox","verticalIconBox"]){let r=p[i];r&&(r.elevation=U?U(r.anchorPointX,r.anchorPointY):0)}let j=p.textBox;if(j){let n=n=>{let o=i.WritingMode.horizontal;if(a.allowVerticalPlacement&&!n&&this.prevPlacement){let i=this.prevPlacement.placedOrientations[r.crossTileID];i&&(this.placedOrientations[r.crossTileID]=i,o=i,this.markUsedOrientation(a,o,r))}return o},o=(n,o)=>{if(a.allowVerticalPlacement&&r.numVerticalGlyphVertices>0&&p.verticalTextBox){for(let r of a.writingModes)if(r===i.WritingMode.vertical?M=k=o():k=n(),k&&k.box&&k.box.length)break}else k=n()};if(s.get("text-variable-anchor")){let u=s.get("text-variable-anchor");if(this.prevPlacement&&this.prevPlacement.variableOffsets[r.crossTileID]){let i=this.prevPlacement.variableOffsets[r.crossTileID];u.indexOf(i.anchor)>0&&(u=u.filter(r=>r!==i.anchor)).unshift(i.anchor)}let h=(i,n,o)=>{let s=i.x2-i.x1,h=i.y2-i.y1,d=r.textBoxScale,p=E&&"never"===x?n:null,f={box:[],offscreen:!1},g="never"!==y?2*u.length:u.length;for(let n=0;n<g;++n){let g=this.attemptAnchorPlacement(u[n%u.length],i,s,h,d,w,T,c,l,m,n>=u.length?y:"never",r,a,o,p,U);if(g&&(f=g.placedGlyphBoxes)&&f.box&&f.box.length){b=!0,P=g.shift;break}}return f};o(()=>h(j,p.iconBox,i.WritingMode.horizontal),()=>{let n=p.verticalTextBox;return a.allowVerticalPlacement&&!(k&&k.box&&k.box.length)&&r.numVerticalGlyphVertices>0&&n?h(n,p.verticalIconBox,i.WritingMode.vertical):{box:null,offscreen:null}}),k&&(b=k.box,A=k.offscreen);let d=n(k&&k.box);if(!b&&this.prevPlacement){let i=this.prevPlacement.variableOffsets[r.crossTileID];i&&(this.variableOffsets[r.crossTileID]=i,this.markUsedJustification(a,i.anchor,r,d))}}else{let s=(i,n)=>{let o=this.collisionIndex.placeCollisionBox(i,y,c,l,m.predicate,U);return o&&o.box&&o.box.length&&(this.markUsedOrientation(a,n,r),this.placedOrientations[r.crossTileID]=n),o};o(()=>s(j,i.WritingMode.horizontal),()=>{let n=p.verticalTextBox;return a.allowVerticalPlacement&&r.numVerticalGlyphVertices>0&&n?s(n,i.WritingMode.vertical):{box:null,offscreen:null}}),n(k&&k.box&&k.box.length)}}if(b=(z=k)&&z.box&&z.box.length>0,A=z&&z.offscreen,r.useRuntimeCollisionCircles){let n=a.text.placedSymbolArray.get(r.centerJustifiedTextSymbolIndex),c=i.evaluateSizeForFeature(a.textSizeData,f,n),d=s.get("text-padding");(D=this.collisionIndex.placeCollisionCircles(y,n,a.lineVertexArray,a.glyphOffsetArray,c,l,u,h,o,T,m.predicate,r.collisionCircleDiameter,d,U)).circles.length&&D.collisionDetected&&!o&&i.warnOnce("Collisions detected, but collision boxes are not shown"),b=v||D.circles.length>0&&!D.collisionDetected,A=A&&D.offscreen}if(p.iconFeatureIndex&&(F=p.iconFeatureIndex),p.iconBox){let i=i=>{let r=E&&P?tT(i,P.x,P.y,w,T,this.transform.angle):i;return this.collisionIndex.placeCollisionBox(r,x,c,l,m.predicate,U)};S=M&&M.box&&M.box.length&&p.verticalIconBox?(R=i(p.verticalIconBox)).box.length>0:(R=i(p.iconBox)).box.length>0,A=A&&R.offscreen}let Z=g||0===r.numHorizontalGlyphVertices&&0===r.numVerticalGlyphVertices,V=_||0===r.numIconVertices;if(Z||V?V?Z||(S=S&&b):b=S&&b:S=b=S&&b,b&&z&&z.box&&this.collisionIndex.insertCollisionBox(z.box,y,s.get("text-ignore-placement"),a.bucketInstanceId,M&&M.box&&O?O:B,m.ID),S&&R&&this.collisionIndex.insertCollisionBox(R.box,x,s.get("icon-ignore-placement"),a.bucketInstanceId,F,m.ID),D&&(b&&this.collisionIndex.insertCollisionCircles(D.circles,y,s.get("text-ignore-placement"),a.bucketInstanceId,B,m.ID),o)){let i=a.bucketInstanceId,r=this.collisionCircleArrays[i];void 0===r&&(r=this.collisionCircleArrays[i]=new tv);for(let i=0;i<D.circles.length;i+=4)r.circles.push(D.circles[i+0]),r.circles.push(D.circles[i+1]),r.circles.push(D.circles[i+2]),r.circles.push(D.collisionDetected?1:0)}if(0===r.crossTileID)throw Error("symbolInstance.crossTileID can't be 0");if(0===a.bucketInstanceId)throw Error("bucket.bucketInstanceId can't be 0");this.placements[r.crossTileID]=new ty(b||C,S||I,A||a.justReloaded),n[r.crossTileID]=!0};if(S){if(0!==r.symbolInstanceStart)throw Error("bucket.bucketInstanceId should be 0");let i=a.getSortedSymbolIndexes(this.transform.angle);for(let r=i.length-1;r>=0;--r){let n=i[r];A(a.symbolInstances.get(n),a.collisionArrays[n])}}else for(let i=r.symbolInstanceStart;i<r.symbolInstanceEnd;i++)A(a.symbolInstances.get(i),a.collisionArrays[i]);if(o&&a.bucketInstanceId in this.collisionCircleArrays){let r=this.collisionCircleArrays[a.bucketInstanceId];i.invert(r.invProjMatrix,l),r.viewportMatrix=this.collisionIndex.getViewportMatrix()}a.justReloaded=!1}markUsedJustification(r,n,o,a){let s;s=a===i.WritingMode.vertical?o.verticalPlacedTextSymbolIndex:({left:o.leftJustifiedTextSymbolIndex,center:o.centerJustifiedTextSymbolIndex,right:o.rightJustifiedTextSymbolIndex})[i.getAnchorJustification(n)];let l=[o.leftJustifiedTextSymbolIndex,o.centerJustifiedTextSymbolIndex,o.rightJustifiedTextSymbolIndex,o.verticalPlacedTextSymbolIndex];for(let i of l)i>=0&&(r.text.placedSymbolArray.get(i).crossTileID=s>=0&&i!==s?0:o.crossTileID)}markUsedOrientation(r,n,o){let a=n===i.WritingMode.horizontal||n===i.WritingMode.horizontalOnly?n:0,s=n===i.WritingMode.vertical?n:0,l=[o.leftJustifiedTextSymbolIndex,o.centerJustifiedTextSymbolIndex,o.rightJustifiedTextSymbolIndex];for(let i of l)r.text.placedSymbolArray.get(i).placedOrientation=a;o.verticalPlacedTextSymbolIndex&&(r.text.placedSymbolArray.get(o.verticalPlacedTextSymbolIndex).placedOrientation=s)}commit(i){this.commitTime=i,this.zoomAtLastRecencyCheck=this.transform.zoom;let r=this.prevPlacement,n=!1;this.prevZoomAdjustment=r?r.zoomAdjustment(this.transform.zoom):0;let o=r?r.symbolFadeChange(i):1,a=r?r.opacities:{},s=r?r.variableOffsets:{},l=r?r.placedOrientations:{};for(let i in this.placements){let r=this.placements[i],s=a[i];s?(this.opacities[i]=new t_(s,o,r.text,r.icon),n=n||r.text!==s.text.placed||r.icon!==s.icon.placed):(this.opacities[i]=new t_(null,o,r.text,r.icon,r.skipFade),n=n||r.text||r.icon)}for(let i in a){let r=a[i];if(!this.opacities[i]){let a=new t_(r,o,!1,!1);a.isHidden()||(this.opacities[i]=a,n=n||r.text.placed||r.icon.placed)}}for(let i in s)this.variableOffsets[i]||!this.opacities[i]||this.opacities[i].isHidden()||(this.variableOffsets[i]=s[i]);for(let i in l)this.placedOrientations[i]||!this.opacities[i]||this.opacities[i].isHidden()||(this.placedOrientations[i]=l[i]);if(r&&void 0===r.lastPlacementChangeTime)throw Error("Last placement time for previous placement is not defined");n?this.lastPlacementChangeTime=i:"number"!=typeof this.lastPlacementChangeTime&&(this.lastPlacementChangeTime=r?r.lastPlacementChangeTime:i)}updateLayerOpacities(i,r){let n={};for(let o of r){let r=o.getBucket(i);r&&o.latestFeatureIndex&&i.id===r.layerIds[0]&&this.updateBucketOpacities(r,n,o.collisionBoxArray)}}updateBucketOpacities(r,n,o){r.hasTextData()&&r.text.opacityVertexArray.clear(),r.hasIconData()&&r.icon.opacityVertexArray.clear(),r.hasIconCollisionBoxData()&&r.iconCollisionBox.collisionVertexArray.clear(),r.hasTextCollisionBoxData()&&r.textCollisionBox.collisionVertexArray.clear();let a=r.layers[0].layout,s=new t_(null,0,!1,!1,!0),l=a.get("text-allow-overlap"),u=a.get("icon-allow-overlap"),h=a.get("text-variable-anchor"),c="map"===a.get("text-rotation-alignment"),d="map"===a.get("text-pitch-alignment"),p="none"!==a.get("icon-text-fit"),f=new t_(null,0,l&&(u||!r.hasIconData()||a.get("icon-optional")),u&&(l||!r.hasTextData()||a.get("text-optional")),!0);!r.collisionArrays&&o&&(r.hasIconCollisionBoxData()||r.hasTextCollisionBoxData())&&r.deserializeCollisionBoxes(o);let m=(i,r,n)=>{for(let o=0;o<r/4;o++)i.opacityVertexArray.emplaceBack(n)};for(let o=0;o<r.symbolInstances.length;o++){let a=r.symbolInstances.get(o),{numHorizontalGlyphVertices:l,numVerticalGlyphVertices:u,crossTileID:g}=a,_=this.opacities[g];n[g]?_=s:_||(_=f,this.opacities[g]=_),n[g]=!0;let y=a.numIconVertices>0,v=this.placedOrientations[a.crossTileID],x=v===i.WritingMode.vertical,b=v===i.WritingMode.horizontal||v===i.WritingMode.horizontalOnly;if(l>0||u>0){let i=tC(_.text);m(r.text,l,x?tI:i),m(r.text,u,b?tI:i);let n=_.text.isHidden();[a.rightJustifiedTextSymbolIndex,a.centerJustifiedTextSymbolIndex,a.leftJustifiedTextSymbolIndex].forEach(i=>{i>=0&&(r.text.placedSymbolArray.get(i).hidden=n||x?1:0)}),a.verticalPlacedTextSymbolIndex>=0&&(r.text.placedSymbolArray.get(a.verticalPlacedTextSymbolIndex).hidden=n||b?1:0);let o=this.variableOffsets[a.crossTileID];o&&this.markUsedJustification(r,o.anchor,a,v);let s=this.placedOrientations[a.crossTileID];s&&(this.markUsedJustification(r,"left",a,s),this.markUsedOrientation(r,s,a))}if(y){let i=tC(_.icon),n=!(p&&a.verticalPlacedIconSymbolIndex&&x);a.placedIconSymbolIndex>=0&&(m(r.icon,a.numIconVertices,n?i:tI),r.icon.placedSymbolArray.get(a.placedIconSymbolIndex).hidden=_.icon.isHidden()),a.verticalPlacedIconSymbolIndex>=0&&(m(r.icon,a.numVerticalIconVertices,n?tI:i),r.icon.placedSymbolArray.get(a.verticalPlacedIconSymbolIndex).hidden=_.icon.isHidden())}if(r.hasIconCollisionBoxData()||r.hasTextCollisionBoxData()){let n=r.collisionArrays[o];if(n){let o=new i.pointGeometry(0,0);if(n.textBox||n.verticalTextBox){let i=!0;if(h){let r=this.variableOffsets[g];r?(o=tw(r.anchor,r.width,r.height,r.textOffset,r.textBoxScale),c&&o._rotate(d?this.transform.angle:-this.transform.angle)):i=!1}n.textBox&&tS(r.textCollisionBox.collisionVertexArray,_.text.placed,!i||x,o.x,o.y),n.verticalTextBox&&tS(r.textCollisionBox.collisionVertexArray,_.text.placed,!i||b,o.x,o.y)}let a=!!(!b&&n.verticalIconBox);n.iconBox&&tS(r.iconCollisionBox.collisionVertexArray,_.icon.placed,a,p?o.x:0,p?o.y:0),n.verticalIconBox&&tS(r.iconCollisionBox.collisionVertexArray,_.icon.placed,!a,p?o.x:0,p?o.y:0)}}}if(r.sortFeatures(this.transform.angle),this.retainedQueryData[r.bucketInstanceId]&&(this.retainedQueryData[r.bucketInstanceId].featureSortOrder=r.featureSortOrder),r.hasTextData()&&r.text.opacityVertexBuffer&&r.text.opacityVertexBuffer.updateData(r.text.opacityVertexArray),r.hasIconData()&&r.icon.opacityVertexBuffer&&r.icon.opacityVertexBuffer.updateData(r.icon.opacityVertexArray),r.hasIconCollisionBoxData()&&r.iconCollisionBox.collisionVertexBuffer&&r.iconCollisionBox.collisionVertexBuffer.updateData(r.iconCollisionBox.collisionVertexArray),r.hasTextCollisionBoxData()&&r.textCollisionBox.collisionVertexBuffer&&r.textCollisionBox.collisionVertexBuffer.updateData(r.textCollisionBox.collisionVertexArray),r.text.opacityVertexArray.length!==r.text.layoutVertexArray.length/4)throw Error(`bucket.text.opacityVertexArray.length (= ${r.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${r.text.layoutVertexArray.length}) / 4`);if(r.icon.opacityVertexArray.length!==r.icon.layoutVertexArray.length/4)throw Error(`bucket.icon.opacityVertexArray.length (= ${r.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${r.icon.layoutVertexArray.length}) / 4`);if(r.bucketInstanceId in this.collisionCircleArrays){let i=this.collisionCircleArrays[r.bucketInstanceId];r.placementInvProjMatrix=i.invProjMatrix,r.placementViewportMatrix=i.viewportMatrix,r.collisionCircleArray=i.circles,delete this.collisionCircleArrays[r.bucketInstanceId]}}symbolFadeChange(i){return 0===this.fadeDuration?1:(i-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(i){return Math.max(0,(this.transform.zoom-i)/1.5)}hasTransitions(i){return this.stale||i-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(i,r){let n=this.zoomAtLastRecencyCheck===r?1-this.zoomAdjustment(r):1;return this.zoomAtLastRecencyCheck=r,this.commitTime+this.fadeDuration*n>i}setStale(){this.stale=!0}}function tS(i,r,n,o,a){i.emplaceBack(r?1:0,n?1:0,o||0,a||0),i.emplaceBack(r?1:0,n?1:0,o||0,a||0),i.emplaceBack(r?1:0,n?1:0,o||0,a||0),i.emplaceBack(r?1:0,n?1:0,o||0,a||0)}function tC(i){if(0===i.opacity&&!i.placed)return 0;if(1===i.opacity&&i.placed)return 4294967295;let r=i.placed?1:0,n=Math.floor(127*i.opacity);return 33554432*n+16777216*r+131072*n+65536*r+512*n+256*r+2*n+r}let tI=0;class tA{constructor(i){this._sortAcrossTiles="viewport-y"!==i.layout.get("symbol-z-order")&&!i.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(i,r,n,o,a){let s=this._bucketParts;for(;this._currentTileIndex<i.length;)if(r.getBucketParts(s,o,i[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,a())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,s.sort((i,r)=>i.sortKey-r.sortKey));this._currentPartIndex<s.length;)if(r.placeLayerBucketPart(s[this._currentPartIndex],this._seenCrossTileIDs,n),this._currentPartIndex++,a())return!0;return!1}}class tP{constructor(i,r,n,o,a,s,l,u){this.placement=new tE(i,r,s,l,u),this._currentPlacementIndex=n.length-1,this._forceFullPlacement=o,this._showCollisionBoxes=a,this._done=!1}isDone(){return this._done}continuePlacement(r,n,o){let a=i.exported.now(),s=()=>{let r=i.exported.now()-a;return!this._forceFullPlacement&&r>2};for(;this._currentPlacementIndex>=0;){let i=n[r[this._currentPlacementIndex]],a=this.placement.collisionIndex.transform.zoom;if("symbol"===i.type&&(!i.minzoom||i.minzoom<=a)&&(!i.maxzoom||i.maxzoom>a)){if(this._inProgressLayer||(this._inProgressLayer=new tA(i)),this._inProgressLayer.continuePlacement(o[i.source],this.placement,this._showCollisionBoxes,i,s))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(i){return this.placement.commit(i),this.placement}}let tk=512/i.EXTENT/2;class tL{constructor(i,r,n){this.tileID=i,this.indexedSymbolInstances={},this.bucketInstanceId=n;for(let n=0;n<r.length;n++){let o=r.get(n),a=o.key;this.indexedSymbolInstances[a]||(this.indexedSymbolInstances[a]=[]),this.indexedSymbolInstances[a].push({crossTileID:o.crossTileID,coord:this.getScaledCoordinates(o,i)})}}getScaledCoordinates(r,n){let o=tk/Math.pow(2,n.canonical.z-this.tileID.canonical.z);return{x:Math.floor((n.canonical.x*i.EXTENT+r.anchorX)*o),y:Math.floor((n.canonical.y*i.EXTENT+r.anchorY)*o)}}findMatches(i,r,n){let o=this.tileID.canonical.z<r.canonical.z?1:Math.pow(2,this.tileID.canonical.z-r.canonical.z);for(let a=0;a<i.length;a++){let s=i.get(a);if(s.crossTileID)continue;let l=this.indexedSymbolInstances[s.key];if(!l)continue;let u=this.getScaledCoordinates(s,r);for(let i of l)if(Math.abs(i.coord.x-u.x)<=o&&Math.abs(i.coord.y-u.y)<=o&&!n[i.crossTileID]){n[i.crossTileID]=!0,s.crossTileID=i.crossTileID;break}}}}class tM{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class tz{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(i){let r=Math.round((i-this.lng)/360);if(0!==r)for(let i in this.indexes){let n=this.indexes[i],o={};for(let i in n){let a=n[i];a.tileID=a.tileID.unwrapTo(a.tileID.wrap+r),o[a.tileID.key]=a}this.indexes[i]=o}this.lng=i}addBucket(i,r,n){if(this.indexes[i.overscaledZ]&&this.indexes[i.overscaledZ][i.key]){if(this.indexes[i.overscaledZ][i.key].bucketInstanceId===r.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(i.overscaledZ,this.indexes[i.overscaledZ][i.key])}for(let i=0;i<r.symbolInstances.length;i++)r.symbolInstances.get(i).crossTileID=0;this.usedCrossTileIDs[i.overscaledZ]||(this.usedCrossTileIDs[i.overscaledZ]={});let o=this.usedCrossTileIDs[i.overscaledZ];for(let n in this.indexes){let a=this.indexes[n];if(Number(n)>i.overscaledZ)for(let n in a){let s=a[n];s.tileID.isChildOf(i)&&s.findMatches(r.symbolInstances,i,o)}else{let s=a[i.scaledTo(Number(n)).key];s&&s.findMatches(r.symbolInstances,i,o)}}for(let i=0;i<r.symbolInstances.length;i++){let a=r.symbolInstances.get(i);a.crossTileID||(a.crossTileID=n.generate(),o[a.crossTileID]=!0)}return void 0===this.indexes[i.overscaledZ]&&(this.indexes[i.overscaledZ]={}),this.indexes[i.overscaledZ][i.key]=new tL(i,r.symbolInstances,r.bucketInstanceId),!0}removeBucketCrossTileIDs(i,r){for(let n in r.indexedSymbolInstances)for(let o of r.indexedSymbolInstances[n])delete this.usedCrossTileIDs[i][o.crossTileID]}removeStaleBuckets(i){let r=!1;for(let n in this.indexes){let o=this.indexes[n];for(let a in o)i[o[a].bucketInstanceId]||(this.removeBucketCrossTileIDs(n,o[a]),delete o[a],r=!0)}return r}}class tD{constructor(){this.layerIndexes={},this.crossTileIDs=new tM,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(i,r,n){let o=this.layerIndexes[i.id];void 0===o&&(o=this.layerIndexes[i.id]=new tz);let a=!1,s={};for(let l of(o.handleWrapJump(n),r)){let r=l.getBucket(i);r&&i.id===r.layerIds[0]&&(r.bucketInstanceId||(r.bucketInstanceId=++this.maxBucketInstanceId),o.addBucket(l.tileID,r,this.crossTileIDs)&&(a=!0),s[r.bucketInstanceId]=!0)}return o.removeStaleBuckets(s)&&(a=!0),a}pruneUnusedLayers(i){let r={};for(let n in i.forEach(i=>{r[i]=!0}),this.layerIndexes)r[n]||delete this.layerIndexes[n]}}var tR=i.createLayout([{name:"a_pos",type:"Int16",components:2}]);class tB extends i.Evented{constructor(i){super(),this.sourceCache=i,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.renderHistory=[],this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.deltaZoom=1,this.renderHistorySize=i._cache.max,i.usedForTerrain=!0,i.tileSize=this.tileSize*2**this.deltaZoom}destruct(){for(let i in this.sourceCache.usedForTerrain=!1,this.sourceCache.tileSize=null,this._tiles){let r=this._tiles[i];r.textures.forEach(i=>i.destroy()),r.textures=[]}}update(r,n){for(let o of(this.sourceCache.update(r,n),this._renderableTilesKeys=[],r.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:n})))this._renderableTilesKeys.push(o.key),this._tiles[o.key]||(o.posMatrix=new Float64Array(16),i.ortho(o.posMatrix,0,i.EXTENT,0,i.EXTENT,0,1),this._tiles[o.key]=new R(o,this.tileSize))}removeOutdated(i){let r={};for(let i of(this.renderHistory=this.renderHistory.filter((i,r)=>this.renderHistory.indexOf(i)===r).slice(0,this.renderHistorySize),this._renderableTilesKeys))r[i]=!0;for(let i of this.renderHistory)r[i]=!0;for(let n in this._tiles)r[n]||(this._tiles[n].clearTextures(i),delete this._tiles[n])}getRenderableTiles(){return this._renderableTilesKeys.map(i=>this.getTileByID(i))}getTileByID(i){return this._tiles[i]}getTerrainCoords(r){let n={};for(let o of this._renderableTilesKeys){let a=this._tiles[o].tileID;if(a.canonical.equals(r.canonical)){let a=r.clone();a.posMatrix=new Float64Array(16),i.ortho(a.posMatrix,0,i.EXTENT,0,i.EXTENT,0,1),n[o]=a}else if(a.canonical.isChildOf(r.canonical)){let s=r.clone();s.posMatrix=new Float64Array(16);let l=a.canonical.z-r.canonical.z,u=a.canonical.x-(a.canonical.x>>l<<l),h=a.canonical.y-(a.canonical.y>>l<<l),c=i.EXTENT>>l;i.ortho(s.posMatrix,0,c,0,c,0,1),i.translate(s.posMatrix,s.posMatrix,[-u*c,-h*c,0]),n[o]=s}else if(r.canonical.isChildOf(a.canonical)){let s=r.clone();s.posMatrix=new Float64Array(16);let l=r.canonical.z-a.canonical.z,u=r.canonical.x-(r.canonical.x>>l<<l),h=r.canonical.y-(r.canonical.y>>l<<l),c=i.EXTENT>>l;i.ortho(s.posMatrix,0,i.EXTENT,0,i.EXTENT,0,1),i.translate(s.posMatrix,s.posMatrix,[u*c,h*c,0]),i.scale(s.posMatrix,s.posMatrix,[1/2**l,1/2**l,0]),n[o]=s}}return n}getSourceTile(i,r){let n=this.sourceCache._source,o=i.overscaledZ-this.deltaZoom;if(o>n.maxzoom&&(o=n.maxzoom),o<n.minzoom)return null;this._sourceTileCache[i.key]||(this._sourceTileCache[i.key]=i.scaledTo(o).key);let a=this.sourceCache.getTileByID(this._sourceTileCache[i.key]);if((!a||!a.dem)&&r)for(;o>=n.minzoom&&(!a||!a.dem);)a=this.sourceCache.getTileByID(i.scaledTo(o--).key);return a}tilesAfterTime(i=Date.now()){return Object.values(this._tiles).filter(r=>r.timeLoaded>=i)}}class tO{constructor(i,r,n){this.style=i,this.sourceCache=new tB(r),this.options=n,this.exaggeration="number"==typeof n.exaggeration?n.exaggeration:1,this.elevationOffset="number"==typeof n.elevationOffset?n.elevationOffset:450,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024,this.clearRerenderCache()}getDEMElevation(r,n,o,a=i.EXTENT){if(!(n>=0&&n<a&&o>=0&&o<a))return this.elevationOffset;let s=0,l=this.getTerrainData(r);if(l.tile&&l.tile.dem){let r=i.transformMat4$1([],[n/a*i.EXTENT,o/a*i.EXTENT],l.u_terrain_matrix),u=[r[0]*l.tile.dem.dim,r[1]*l.tile.dem.dim],h=[Math.floor(u[0]),Math.floor(u[1])],c=l.tile.dem.get(h[0],h[1]),d=l.tile.dem.get(h[0],h[1]+1),p=l.tile.dem.get(h[0]+1,h[1]),f=l.tile.dem.get(h[0]+1,h[1]+1);s=i.number(i.number(c,d,u[0]-h[0]),i.number(p,f,u[0]-h[0]),u[1]-h[1])}return s}rememberForRerender(i,r){for(let n in this.sourceCache._tiles){let o=this.sourceCache._tiles[n];(o.tileID.equals(r)||o.tileID.isChildOf(r))&&(i===this.sourceCache.sourceCache.id&&(o.timeLoaded=Date.now()),this._rerender[i]=this._rerender[i]||{},this._rerender[i][o.tileID.key]=!0)}}needsRerender(i,r){return this._rerender[i]&&this._rerender[i][r.key]}clearRerenderCache(){this._rerender={}}getElevation(r,n,o,a=i.EXTENT){return(this.getDEMElevation(r,n,o,a)+this.elevationOffset)*this.exaggeration}getTerrainData(r){if(!this._emptyDemTexture){let r=this.style.map.painter.context,n=new i.RGBAImage({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new d(r,n,r.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new d(r,new i.RGBAImage({width:1,height:1}),r.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(r.gl.NEAREST,r.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=i.identity([])}let n=this.sourceCache.getSourceTile(r,!0);if(n&&n.dem&&(!n.demTexture||n.needsTerrainPrepare)){let i=this.style.map.painter.context;n.demTexture=this.style.map.painter.getTileTexture(n.dem.stride),n.demTexture?n.demTexture.update(n.dem.getPixels(),{premultiply:!1}):n.demTexture=new d(i,n.dem.getPixels(),i.gl.RGBA,{premultiply:!1}),n.demTexture.bind(i.gl.NEAREST,i.gl.CLAMP_TO_EDGE),n.needsTerrainPrepare=!1}let o=n&&n+n.tileID.key+r.key;if(o&&!this._demMatrixCache[o]){let o=this.sourceCache.sourceCache._source.maxzoom,a=r.canonical.z-n.tileID.canonical.z;r.overscaledZ>r.canonical.z&&(r.canonical.z>=o?a=r.canonical.z-o:i.warnOnce("cannot calculate elevation if elevation maxzoom > source.maxzoom"));let s=r.canonical.x-(r.canonical.x>>a<<a),l=r.canonical.y-(r.canonical.y>>a<<a),u=i.fromScaling(new Float64Array(16),[1/(i.EXTENT<<a),1/(i.EXTENT<<a),0]);i.translate(u,u,[s*i.EXTENT,l*i.EXTENT,0]),this._demMatrixCache[r.key]={matrix:u,coord:r}}return{u_depth:2,u_terrain:3,u_terrain_dim:n&&n.dem&&n.dem.dim||1,u_terrain_matrix:o?this._demMatrixCache[r.key].matrix:this._emptyDemMatrix,u_terrain_unpack:n&&n.dem&&n.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_offset:this.elevationOffset,u_terrain_exaggeration:this.exaggeration,texture:(n&&n.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:n}}getRTTFramebuffer(){let i=this.style.map.painter;if(!this._rttFramebuffer){let r=this.sourceCache.tileSize*this.qualityFactor;this._rttFramebuffer=i.context.createFramebuffer(r,r,!0),this._rttFramebuffer.depthAttachment.set(i.context.createRenderbuffer(i.context.gl.DEPTH_COMPONENT16,r,r))}return this._rttFramebuffer}getFramebuffer(i){let r=this.style.map.painter,n=r.width/devicePixelRatio,o=r.height/devicePixelRatio;return this._fbo&&(this._fbo.width!==n||this._fbo.height!==o)&&(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new d(r.context,{width:n,height:o,data:null},r.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(r.context.gl.NEAREST,r.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new d(r.context,{width:n,height:o,data:null},r.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(r.context.gl.NEAREST,r.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=r.context.createFramebuffer(n,o,!0),this._fbo.depthAttachment.set(r.context.createRenderbuffer(r.context.gl.DEPTH_COMPONENT16,n,o))),this._fbo.colorAttachment.set("coords"===i?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){let r=this.style.map.painter.context;if(this._coordsTexture)return this._coordsTexture;let n=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let i=0,r=0;i<this._coordsTextureSize;i++)for(let o=0;o<this._coordsTextureSize;o++,r+=4)n[r+0]=255&o,n[r+1]=255&i,n[r+2]=o>>8<<4|i>>8,n[r+3]=0;let o=new i.RGBAImage({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(n.buffer)),a=new d(r,o,r.gl.RGBA,{premultiply:!1});return a.bind(r.gl.NEAREST,r.gl.CLAMP_TO_EDGE),this._coordsTexture=a,a}pointCoordinate(r){let n=new Uint8Array(4),o=this.style.map.painter,a=o.context,s=a.gl;a.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),s.readPixels(r.x,o.height/devicePixelRatio-r.y-1,1,1,s.RGBA,s.UNSIGNED_BYTE,n),a.bindFramebuffer.set(null);let l=n[0]+(n[2]>>4<<8),u=n[1]+((15&n[2])<<8),h=this.coordsIndex[255-n[3]],c=h&&this.sourceCache.getTileByID(h);if(!c)return null;let d=this._coordsTextureSize,p=(1<<c.tileID.canonical.z)*d;return new i.MercatorCoordinate((c.tileID.canonical.x*d+l)/p,(c.tileID.canonical.y*d+u)/p,this.getElevation(c.tileID,l,u,d))}getTerrainMesh(){if(this._mesh)return this._mesh;let r=this.style.map.painter.context,n=new i.PosArray,o=new i.TriangleIndexArray,a=this.meshSize,s=i.EXTENT/a,l=a*a;for(let i=0;i<=a;i++)for(let r=0;r<=a;r++)n.emplaceBack(r*s,i*s);for(let i=0;i<l;i+=a+1)for(let r=0;r<a;r++)o.emplaceBack(r+i,a+r+i+1,a+r+i+2),o.emplaceBack(r+i,a+r+i+2,r+i+1);return this._mesh={indexBuffer:r.createIndexBuffer(o),vertexBuffer:r.createVertexBuffer(n,tR.members),segments:i.SegmentVector.simpleSegment(0,0,n.length,o.length)},this._mesh}getMinMaxElevation(i){let r=this.getTerrainData(i).tile,n={minElevation:null,maxElevation:null};return r&&r.dem&&(n.minElevation=(r.dem.min+this.elevationOffset)*this.exaggeration,n.maxElevation=(r.dem.max+this.elevationOffset)*this.exaggeration),n}}let tF=(r,n)=>i.emitValidationErrors(r,n&&n.filter(i=>"source.canvas"!==i.identifier)),tN=i.pick(W,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData"]),tU=i.pick(W,["setCenter","setZoom","setBearing","setPitch"]),tj=function(){let r={},n=i.spec.$version;for(let o in i.spec.$root){let a=i.spec.$root[o];if(a.required){let i=null;null!=(i="version"===o?n:"array"===a.type?[]:{})&&(r[o]=i)}}return r}();class tZ extends i.Evented{constructor(r,n={}){super(),this.map=r,this.dispatcher=new b(q(),this),this.imageManager=new p,this.imageManager.setEventedParent(this),this.glyphManager=new g(r._requestManager,n.localIdeographFontFamily),this.lineAtlas=new x(256,512),this.crossTileSymbolIndex=new tD,this._layers={},this._serializedLayers={},this._order=[],this.sourceCaches={},this.zoomHistory=new i.ZoomHistory,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("setReferrer",i.getReferrer());let o=this;this._rtlTextPluginCallback=tZ.registerForPluginStateChange(r=>{o.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:r.pluginStatus,pluginURL:r.pluginURL},(r,n)=>{if(i.triggerPluginCompletionEvent(r),n&&n.every(i=>i))for(let i in o.sourceCaches)o.sourceCaches[i].reload()})}),this.on("data",i=>{if("source"!==i.dataType||"metadata"!==i.sourceDataType)return;let r=this.sourceCaches[i.sourceId];if(!r)return;let n=r.getSource();if(n&&n.vectorLayerIds)for(let i in this._layers){let r=this._layers[i];r.source===n.id&&this._validateLayer(r)}})}loadURL(r,n={}){this.fire(new i.Event("dataloading",{dataType:"style"}));let o="boolean"!=typeof n.validate||n.validate,a=this.map._requestManager.transformRequest(r,i.ResourceType.Style);this._request=i.getJSON(a,(r,n)=>{this._request=null,r?this.fire(new i.ErrorEvent(r)):n&&this._load(n,o)})}loadJSON(r,n={}){this.fire(new i.Event("dataloading",{dataType:"style"})),this._request=i.exported.frame(()=>{this._request=null,this._load(r,!1!==n.validate)})}loadEmpty(){this.fire(new i.Event("dataloading",{dataType:"style"})),this._load(tj,!1)}_load(r,n){if(n&&tF(this,i.validateStyle(r)))return;for(let i in this._loaded=!0,this.stylesheet=r,r.sources)this.addSource(i,r.sources[i],{validate:!1});r.sprite?this._loadSprite(r.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(r.glyphs);let o=G(this.stylesheet.layers);for(let r of(this._order=o.map(i=>i.id),this._layers={},this._serializedLayers={},o))(r=i.createStyleLayer(r)).setEventedParent(this,{layer:{id:r.id}}),this._layers[r.id]=r,this._serializedLayers[r.id]=r.serialize();this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new v(this.stylesheet.light),this.setTerrain(this.stylesheet.terrain),this.fire(new i.Event("data",{dataType:"style"})),this.fire(new i.Event("style.load"))}_loadSprite(r){this._spriteRequest=function(r,n,o,a){let s,l,u;let h=o>1?"@2x":"",c=i.getJSON(n.transformRequest(n.normalizeSpriteURL(r,h,".json"),i.ResourceType.SpriteJSON),(i,r)=>{c=null,u||(u=i,s=r,p())}),d=i.getImage(n.transformRequest(n.normalizeSpriteURL(r,h,".png"),i.ResourceType.SpriteImage),(i,r)=>{d=null,u||(u=i,l=r,p())});function p(){if(u)a(u);else if(s&&l){let r=i.exported.getImageData(l),n={};for(let o in s){let{width:a,height:l,x:u,y:h,sdf:c,pixelRatio:d,stretchX:p,stretchY:f,content:m}=s[o],g=new i.RGBAImage({width:a,height:l});i.RGBAImage.copy(r,g,{x:u,y:h},{x:0,y:0},{width:a,height:l}),n[o]={data:g,pixelRatio:d,sdf:c,stretchX:p,stretchY:f,content:m}}a(null,n)}}return{cancel(){c&&(c.cancel(),c=null),d&&(d.cancel(),d=null)}}}(r,this.map._requestManager,this.map.getPixelRatio(),(r,n)=>{if(this._spriteRequest=null,r)this.fire(new i.ErrorEvent(r));else if(n)for(let i in n)this.imageManager.addImage(i,n[i]);this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new i.Event("data",{dataType:"style"}))})}_validateLayer(r){let n=this.sourceCaches[r.source];if(!n)return;let o=r.sourceLayer;if(!o)return;let a=n.getSource();("geojson"===a.type||a.vectorLayerIds&&-1===a.vectorLayerIds.indexOf(o))&&this.fire(new i.ErrorEvent(Error(`Source layer "${o}" does not exist on source "${a.id}" as specified by style layer "${r.id}".`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(let i in this.sourceCaches)if(!this.sourceCaches[i].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeLayers(i){let r=[];for(let n of i){let i=this._layers[n];"custom"!==i.type&&r.push(i.serialize())}return r}hasTransitions(){if(this.light&&this.light.hasTransition())return!0;for(let i in this.sourceCaches)if(this.sourceCaches[i].hasTransition())return!0;for(let i in this._layers)if(this._layers[i].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw Error("Style is not done loading.")}update(r){if(!this._loaded)return;let n=this._changed;if(this._changed){let i=Object.keys(this._updatedLayers),n=Object.keys(this._removedLayers);for(let r in(i.length||n.length)&&this._updateWorkerLayers(i,n),this._updatedSources){let i=this._updatedSources[r];if("reload"===i)this._reloadSource(r);else{if("clear"!==i)throw Error(`Invalid action ${i}`);this._clearSource(r)}}for(let i in this._updateTilesForChangedImages(),this._updatedPaintProps)this._layers[i].updateTransitions(r);this.light.updateTransitions(r),this._resetUpdates()}let o={};for(let i in this.sourceCaches){let r=this.sourceCaches[i];o[i]=r.used,r.used=!1}for(let i of this._order){let n=this._layers[i];n.recalculate(r,this._availableImages),!n.isHidden(r.zoom)&&n.source&&(this.sourceCaches[n.source].used=!0)}for(let r in o){let n=this.sourceCaches[r];o[r]!==n.used&&n.fire(new i.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:r}))}this.light.recalculate(r),this.z=r.zoom,n&&this.fire(new i.Event("data",{dataType:"style"}))}_updateTilesForChangedImages(){let i=Object.keys(this._changedImages);if(i.length){for(let r in this.sourceCaches)this.sourceCaches[r].reloadTilesForDependencies(["icons","patterns"],i);this._changedImages={}}}_updateWorkerLayers(i,r){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(i),removedIds:r})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}}setTerrain(r){if(this._checkLoaded(),this._terrainDataCallback&&this.off("data",this._terrainDataCallback),this._terrainfreezeElevationCallback&&this.map.off("freezeElevation",this._terrainfreezeElevationCallback),r){let i=this.sourceCaches[r.source];if(!i)throw Error(`cannot load terrain, because there exists no source with ID: ${r.source}`);this.terrain=new tO(this,i,r),this.map.transform.updateElevation(this.terrain),this._terrainfreezeElevationCallback=i=>{i.freeze?this.map.transform.freezeElevation=!0:(this.map.transform.freezeElevation=!1,this.map.transform.recalculateZoom(this.terrain))},this._terrainDataCallback=i=>{i.tile&&(i.sourceId===r.source?(this.map.transform.updateElevation(this.terrain),this.terrain.rememberForRerender(i.sourceId,i.tile.tileID)):"geojson"===i.source.type&&this.terrain.rememberForRerender(i.sourceId,i.tile.tileID))},this.on("data",this._terrainDataCallback),this.map.on("freezeElevation",this._terrainfreezeElevationCallback)}else this.terrain&&this.terrain.sourceCache.destruct(),this.terrain=null,this.map.transform.updateElevation(this.terrain);this.map.fire(new i.Event("terrain",{terrain:r}))}setState(r){if(this._checkLoaded(),tF(this,i.validateStyle(r)))return!1;(r=i.clone$1(r)).layers=G(r.layers);let n=(function(i,r){if(!i)return[{command:W.setStyle,args:[r]}];let n=[];try{if(!l(i.version,r.version))return[{command:W.setStyle,args:[r]}];l(i.center,r.center)||n.push({command:W.setCenter,args:[r.center]}),l(i.zoom,r.zoom)||n.push({command:W.setZoom,args:[r.zoom]}),l(i.bearing,r.bearing)||n.push({command:W.setBearing,args:[r.bearing]}),l(i.pitch,r.pitch)||n.push({command:W.setPitch,args:[r.pitch]}),l(i.sprite,r.sprite)||n.push({command:W.setSprite,args:[r.sprite]}),l(i.glyphs,r.glyphs)||n.push({command:W.setGlyphs,args:[r.glyphs]}),l(i.transition,r.transition)||n.push({command:W.setTransition,args:[r.transition]}),l(i.light,r.light)||n.push({command:W.setLight,args:[r.light]});let o={},a=[];!function(i,r,n,o){let a;for(a in r=r||{},i=i||{})Object.prototype.hasOwnProperty.call(i,a)&&(Object.prototype.hasOwnProperty.call(r,a)||X(a,n,o));for(a in r){var s,u;Object.prototype.hasOwnProperty.call(r,a)&&(Object.prototype.hasOwnProperty.call(i,a)?l(i[a],r[a])||("geojson"===i[a].type&&"geojson"===r[a].type&&function(i,r,n){let o;for(o in i[n])if(Object.prototype.hasOwnProperty.call(i[n],o)&&"data"!==o&&!l(i[n][o],r[n][o]))return!1;for(o in r[n])if(Object.prototype.hasOwnProperty.call(r[n],o)&&"data"!==o&&!l(i[n][o],r[n][o]))return!1;return!0}(i,r,a)?n.push({command:W.setGeoJSONSourceData,args:[a,r[a].data]}):(s=a,u=r,X(s,n,o),H(s,u,n))):H(a,r,n))}}(i.sources,r.sources,a,o);let s=[];i.layers&&i.layers.forEach(i=>{o[i.source]?n.push({command:W.removeLayer,args:[i.id]}):s.push(i)}),n=n.concat(a),function(i,r,n){let o,a,s,u,h,c,d;r=r||[];let p=(i=i||[]).map(J),f=r.map(J),m=i.reduce(Y,{}),g=r.reduce(Y,{}),_=p.slice(),y=Object.create(null);for(o=0,a=0;o<p.length;o++)s=p[o],Object.prototype.hasOwnProperty.call(g,s)?a++:(n.push({command:W.removeLayer,args:[s]}),_.splice(_.indexOf(s,a),1));for(o=0,a=0;o<f.length;o++)s=f[f.length-1-o],_[_.length-1-o]!==s&&(Object.prototype.hasOwnProperty.call(m,s)?(n.push({command:W.removeLayer,args:[s]}),_.splice(_.lastIndexOf(s,_.length-a),1)):a++,c=_[_.length-o],n.push({command:W.addLayer,args:[g[s],c]}),_.splice(_.length-o,0,s),y[s]=!0);for(o=0;o<f.length;o++)if(u=m[s=f[o]],h=g[s],!y[s]&&!l(u,h)){if(l(u.source,h.source)&&l(u["source-layer"],h["source-layer"])&&l(u.type,h.type)){for(d in K(u.layout,h.layout,n,s,null,W.setLayoutProperty),K(u.paint,h.paint,n,s,null,W.setPaintProperty),l(u.filter,h.filter)||n.push({command:W.setFilter,args:[s,h.filter]}),l(u.minzoom,h.minzoom)&&l(u.maxzoom,h.maxzoom)||n.push({command:W.setLayerZoomRange,args:[s,h.minzoom,h.maxzoom]}),u)Object.prototype.hasOwnProperty.call(u,d)&&"layout"!==d&&"paint"!==d&&"filter"!==d&&"metadata"!==d&&"minzoom"!==d&&"maxzoom"!==d&&(0===d.indexOf("paint.")?K(u[d],h[d],n,s,d.slice(6),W.setPaintProperty):l(u[d],h[d])||n.push({command:W.setLayerProperty,args:[s,d,h[d]]}));for(d in h)Object.prototype.hasOwnProperty.call(h,d)&&!Object.prototype.hasOwnProperty.call(u,d)&&"layout"!==d&&"paint"!==d&&"filter"!==d&&"metadata"!==d&&"minzoom"!==d&&"maxzoom"!==d&&(0===d.indexOf("paint.")?K(u[d],h[d],n,s,d.slice(6),W.setPaintProperty):l(u[d],h[d])||n.push({command:W.setLayerProperty,args:[s,d,h[d]]}))}else n.push({command:W.removeLayer,args:[s]}),c=_[_.lastIndexOf(s)+1],n.push({command:W.addLayer,args:[h,c]})}}(s,r.layers,n)}catch(i){console.warn("Unable to compute style diff:",i),n=[{command:W.setStyle,args:[r]}]}return n})(this.serialize(),r).filter(i=>!(i.command in tU));if(0===n.length)return!1;let o=n.filter(i=>!(i.command in tN));if(o.length>0)throw Error(`Unimplemented: ${o.map(i=>i.command).join(", ")}.`);return n.forEach(i=>{"setTransition"!==i.command&&this[i.command].apply(this,i.args)}),this.stylesheet=r,!0}addImage(r,n){if(this.getImage(r))return this.fire(new i.ErrorEvent(Error(`An image named "${r}" already exists.`)));this.imageManager.addImage(r,n),this._afterImageUpdated(r)}updateImage(i,r){this.imageManager.updateImage(i,r)}getImage(i){return this.imageManager.getImage(i)}removeImage(r){if(!this.getImage(r))return this.fire(new i.ErrorEvent(Error(`An image named "${r}" does not exist.`)));this.imageManager.removeImage(r),this._afterImageUpdated(r)}_afterImageUpdated(r){this._availableImages=this.imageManager.listImages(),this._changedImages[r]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new i.Event("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(r,n,o={}){if(this._checkLoaded(),void 0!==this.sourceCaches[r])throw Error(`Source "${r}" already exists.`);if(!n.type)throw Error(`The type property must be defined, but only the following properties were given: ${Object.keys(n).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(n.type)>=0&&this._validate(i.validateStyle.source,`sources.${r}`,n,null,o))return;this.map&&this.map._collectResourceTiming&&(n.collectResourceTiming=!0);let a=this.sourceCaches[r]=new F(r,n,this.dispatcher);a.style=this,a.setEventedParent(this,()=>({isSourceLoaded:this.loaded(),source:a.serialize(),sourceId:r})),a.onAdd(this.map),this._changed=!0}removeSource(r){if(this._checkLoaded(),void 0===this.sourceCaches[r])throw Error("There is no source with this ID");for(let n in this._layers)if(this._layers[n].source===r)return this.fire(new i.ErrorEvent(Error(`Source "${r}" cannot be removed while layer "${n}" is using it.`)));let n=this.sourceCaches[r];delete this.sourceCaches[r],delete this._updatedSources[r],n.fire(new i.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:r})),n.setEventedParent(null),n.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(i,r){if(this._checkLoaded(),void 0===this.sourceCaches[i])throw Error(`There is no source with this ID=${i}`);let n=this.sourceCaches[i].getSource();if("geojson"!==n.type)throw Error(`geojsonSource.type is ${n.type}, which is !== 'geojson`);n.setData(r),this._changed=!0}getSource(i){return this.sourceCaches[i]&&this.sourceCaches[i].getSource()}addLayer(r,n,o={}){let a;this._checkLoaded();let s=r.id;if(this.getLayer(s))return void this.fire(new i.ErrorEvent(Error(`Layer "${s}" already exists on this map.`)));if("custom"===r.type){if(tF(this,i.validateCustomStyleLayer(r)))return;a=i.createStyleLayer(r)}else{if("object"==typeof r.source&&(this.addSource(s,r.source),r=i.clone$1(r),r=i.extend(r,{source:s})),this._validate(i.validateStyle.layer,`layers.${s}`,r,{arrayIndex:-1},o))return;a=i.createStyleLayer(r),this._validateLayer(a),a.setEventedParent(this,{layer:{id:s}}),this._serializedLayers[a.id]=a.serialize()}let l=n?this._order.indexOf(n):this._order.length;if(n&&-1===l)this.fire(new i.ErrorEvent(Error(`Cannot add layer "${s}" before non-existing layer "${n}".`)));else{if(this._order.splice(l,0,s),this._layerOrderChanged=!0,this._layers[s]=a,this._removedLayers[s]&&a.source&&"custom"!==a.type){let i=this._removedLayers[s];delete this._removedLayers[s],i.type!==a.type?this._updatedSources[a.source]="clear":(this._updatedSources[a.source]="reload",this.sourceCaches[a.source].pause())}this._updateLayer(a),a.onAdd&&a.onAdd(this.map)}}moveLayer(r,n){if(this._checkLoaded(),this._changed=!0,!this._layers[r])return void this.fire(new i.ErrorEvent(Error(`The layer '${r}' does not exist in the map's style and cannot be moved.`)));if(r===n)return;let o=this._order.indexOf(r);this._order.splice(o,1);let a=n?this._order.indexOf(n):this._order.length;n&&-1===a?this.fire(new i.ErrorEvent(Error(`Cannot move layer "${r}" before non-existing layer "${n}".`))):(this._order.splice(a,0,r),this._layerOrderChanged=!0)}removeLayer(r){this._checkLoaded();let n=this._layers[r];if(!n)return void this.fire(new i.ErrorEvent(Error(`Cannot remove non-existing layer "${r}".`)));n.setEventedParent(null);let o=this._order.indexOf(r);this._order.splice(o,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[r]=n,delete this._layers[r],delete this._serializedLayers[r],delete this._updatedLayers[r],delete this._updatedPaintProps[r],n.onRemove&&n.onRemove(this.map)}getLayer(i){return this._layers[i]}hasLayer(i){return i in this._layers}setLayerZoomRange(r,n,o){this._checkLoaded();let a=this.getLayer(r);a?a.minzoom===n&&a.maxzoom===o||(null!=n&&(a.minzoom=n),null!=o&&(a.maxzoom=o),this._updateLayer(a)):this.fire(new i.ErrorEvent(Error(`Cannot set the zoom range of non-existing layer "${r}".`)))}setFilter(r,n,o={}){this._checkLoaded();let a=this.getLayer(r);if(a){if(!l(a.filter,n))return null==n?(a.filter=void 0,void this._updateLayer(a)):void(this._validate(i.validateStyle.filter,`layers.${a.id}.filter`,n,null,o)||(a.filter=i.clone$1(n),this._updateLayer(a)))}else this.fire(new i.ErrorEvent(Error(`Cannot filter non-existing layer "${r}".`)))}getFilter(r){return i.clone$1(this.getLayer(r).filter)}setLayoutProperty(r,n,o,a={}){this._checkLoaded();let s=this.getLayer(r);s?l(s.getLayoutProperty(n),o)||(s.setLayoutProperty(n,o,a),this._updateLayer(s)):this.fire(new i.ErrorEvent(Error(`Cannot style non-existing layer "${r}".`)))}getLayoutProperty(r,n){let o=this.getLayer(r);if(o)return o.getLayoutProperty(n);this.fire(new i.ErrorEvent(Error(`Cannot get style of non-existing layer "${r}".`)))}setPaintProperty(r,n,o,a={}){this._checkLoaded();let s=this.getLayer(r);s?l(s.getPaintProperty(n),o)||(s.setPaintProperty(n,o,a)&&this._updateLayer(s),this._changed=!0,this._updatedPaintProps[r]=!0):this.fire(new i.ErrorEvent(Error(`Cannot style non-existing layer "${r}".`)))}getPaintProperty(i,r){return this.getLayer(i).getPaintProperty(r)}setFeatureState(r,n){this._checkLoaded();let o=r.source,a=r.sourceLayer,s=this.sourceCaches[o];if(void 0===s)return void this.fire(new i.ErrorEvent(Error(`The source '${o}' does not exist in the map's style.`)));let l=s.getSource().type;"geojson"===l&&a?this.fire(new i.ErrorEvent(Error("GeoJSON sources cannot have a sourceLayer parameter."))):"vector"!==l||a?(void 0===r.id&&this.fire(new i.ErrorEvent(Error("The feature id parameter must be provided."))),s.setFeatureState(a,r.id,n)):this.fire(new i.ErrorEvent(Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(r,n){this._checkLoaded();let o=r.source,a=this.sourceCaches[o];if(void 0===a)return void this.fire(new i.ErrorEvent(Error(`The source '${o}' does not exist in the map's style.`)));let s=a.getSource().type,l="vector"===s?r.sourceLayer:void 0;"vector"!==s||l?n&&"string"!=typeof r.id&&"number"!=typeof r.id?this.fire(new i.ErrorEvent(Error("A feature id is required to remove its specific state property."))):a.removeFeatureState(l,r.id,n):this.fire(new i.ErrorEvent(Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(r){this._checkLoaded();let n=r.source,o=r.sourceLayer,a=this.sourceCaches[n];if(void 0!==a)return"vector"!==a.getSource().type||o?(void 0===r.id&&this.fire(new i.ErrorEvent(Error("The feature id parameter must be provided."))),a.getFeatureState(o,r.id)):void this.fire(new i.ErrorEvent(Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new i.ErrorEvent(Error(`The source '${n}' does not exist in the map's style.`)))}getTransition(){return i.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){return i.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,sources:i.mapObject(this.sourceCaches,i=>i.serialize()),layers:this._serializeLayers(this._order)},i=>void 0!==i)}_updateLayer(i){this._updatedLayers[i.id]=!0,i.source&&!this._updatedSources[i.source]&&"raster"!==this.sourceCaches[i.source].getSource().type&&(this._updatedSources[i.source]="reload",this.sourceCaches[i.source].pause()),this._changed=!0}_flattenAndSortRenderedFeatures(i){let r=i=>"fill-extrusion"===this._layers[i].type,n={},o=[];for(let a=this._order.length-1;a>=0;a--){let s=this._order[a];if(r(s))for(let r of(n[s]=a,i)){let i=r[s];if(i)for(let r of i)o.push(r)}}o.sort((i,r)=>r.intersectionZ-i.intersectionZ);let a=[];for(let s=this._order.length-1;s>=0;s--){let l=this._order[s];if(r(l))for(let i=o.length-1;i>=0;i--){let r=o[i].feature;if(n[r.layer.id]<s)break;a.push(r),o.pop()}else for(let r of i){let i=r[l];if(i)for(let r of i)a.push(r.feature)}}return a}queryRenderedFeatures(r,n,o){n&&n.filter&&this._validate(i.validateStyle.filter,"queryRenderedFeatures.filter",n.filter,null,n);let a={};if(n&&n.layers){if(!Array.isArray(n.layers))return this.fire(new i.ErrorEvent(Error("parameters.layers must be an Array."))),[];for(let r of n.layers){let n=this._layers[r];if(!n)return this.fire(new i.ErrorEvent(Error(`The layer '${r}' does not exist in the map's style and cannot be queried for features.`))),[];a[n.source]=!0}}let s=[];for(let l in n.availableImages=this._availableImages,this.sourceCaches)n.layers&&!a[l]||s.push(function(r,n,o,a,s,l){let u=function(i,r,n){if(i)for(let o of i){let i=r[o];if(i&&i.source===n&&"fill-extrusion"===i.type)return!0}else for(let i in r){let o=r[i];if(o.source===n&&"fill-extrusion"===o.type)return!0}return!1}(s&&s.layers,n,r.id),h=l.maxPitchScaleFactor(),c=r.tilesIn(a,h,u);c.sort(D);let d=[];for(let a of c)d.push({wrappedTileID:a.tileID.wrapped().key,queryResults:a.tile.queryRenderedFeatures(n,o,r._state,a.queryGeometry,a.cameraQueryGeometry,a.scale,s,l,h,function(r,n){let o=i.create();return i.translate(o,o,[1,1,0]),i.scale(o,o,[.5*r.width,.5*r.height,1]),i.multiply(o,o,r.calculatePosMatrix(n.toUnwrapped()))}(r.transform,a.tileID))});let p=function(i){let r={},n={};for(let o of i){let i=o.queryResults,a=o.wrappedTileID,s=n[a]=n[a]||{};for(let n in i){let o=i[n],a=s[n]=s[n]||{},l=r[n]=r[n]||[];for(let i of o)a[i.featureIndex]||(a[i.featureIndex]=!0,l.push(i))}}return r}(d);for(let i in p)p[i].forEach(i=>{let n=i.feature,o=r.getFeatureState(n.layer["source-layer"],n.id);n.source=n.layer.source,n.layer["source-layer"]&&(n.sourceLayer=n.layer["source-layer"]),n.state=o});return p}(this.sourceCaches[l],this._layers,this._serializedLayers,r,n,o));return this.placement&&s.push(function(i,r,n,o,a,s,l){let u={},h=s.queryRenderedSymbols(o),c=[];for(let i of Object.keys(h).map(Number))c.push(l[i]);for(let n of(c.sort(D),c)){let o=n.featureIndex.lookupSymbolFeatures(h[n.bucketInstanceId],r,n.bucketIndex,n.sourceLayerIndex,a.filter,a.layers,a.availableImages,i);for(let i in o){let r=u[i]=u[i]||[],a=o[i];for(let i of(a.sort((i,r)=>{let o=n.featureSortOrder;if(o){let n=o.indexOf(i.featureIndex);return o.indexOf(r.featureIndex)-n}return r.featureIndex-i.featureIndex}),a))r.push(i)}}for(let r in u)u[r].forEach(o=>{let a=o.feature,s=n[i[r].source].getFeatureState(a.layer["source-layer"],a.id);a.source=a.layer.source,a.layer["source-layer"]&&(a.sourceLayer=a.layer["source-layer"]),a.state=s});return u}(this._layers,this._serializedLayers,this.sourceCaches,r,n,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(s)}querySourceFeatures(r,n){n&&n.filter&&this._validate(i.validateStyle.filter,"querySourceFeatures.filter",n.filter,null,n);let o=this.sourceCaches[r];return o?function(i,r){let n=i.getRenderableIds().map(r=>i.getTileByID(r)),o=[],a={};for(let i=0;i<n.length;i++){let s=n[i],l=s.tileID.canonical.key;a[l]||(a[l]=!0,s.querySourceFeatures(o,r))}return o}(o,n):[]}addSourceType(i,r,n){return tZ.getSourceType(i)?n(Error(`A source type called "${i}" already exists.`)):(tZ.setSourceType(i,r),r.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:i,url:r.workerSourceURL},n):n(null,null))}getLight(){return this.light.getLight()}setLight(r,n={}){this._checkLoaded();let o=this.light.getLight(),a=!1;for(let i in r)if(!l(r[i],o[i])){a=!0;break}if(!a)return;let s={now:i.exported.now(),transition:i.extend({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(r,n),this.light.updateTransitions(s)}_validate(r,n,o,a,s={}){return(!s||!1!==s.validate)&&tF(this,r.call(i.validateStyle,i.extend({key:n,style:this.serialize(),value:o,styleSpec:i.spec},a)))}_remove(){for(let r in this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),i.evented.off("pluginStateChange",this._rtlTextPluginCallback),this._layers)this._layers[r].setEventedParent(null);for(let i in this.sourceCaches){let r=this.sourceCaches[i];r.setEventedParent(null),r.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()}_clearSource(i){this.sourceCaches[i].clearTiles()}_reloadSource(i){this.sourceCaches[i].resume(),this.sourceCaches[i].reload()}_updateSources(i){for(let r in this.sourceCaches)this.sourceCaches[r].update(i,this.terrain)}_generateCollisionBoxes(){for(let i in this.sourceCaches)this._reloadSource(i)}_updatePlacement(r,n,o,a,s=!1){let l=!1,u=!1,h={};for(let i of this._order){let n=this._layers[i];if("symbol"!==n.type)continue;if(!h[n.source]){let i=this.sourceCaches[n.source];h[n.source]=i.getRenderableIds(!0).map(r=>i.getTileByID(r)).sort((i,r)=>r.tileID.overscaledZ-i.tileID.overscaledZ||(i.tileID.isLessThan(r.tileID)?-1:1))}let o=this.crossTileSymbolIndex.addLayer(n,h[n.source],r.center.lng);l=l||o}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((s=s||this._layerOrderChanged||0===o)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(i.exported.now(),r.zoom))&&(this.pauseablePlacement=new tP(r,this.terrain,this._order,s,n,o,a,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,h),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(i.exported.now()),u=!0),l&&this.pauseablePlacement.placement.setStale()),u||l)for(let i of this._order){let r=this._layers[i];"symbol"===r.type&&this.placement.updateLayerOpacities(r,h[r.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(i.exported.now())}_releaseSymbolFadeTiles(){for(let i in this.sourceCaches)this.sourceCaches[i].releaseSymbolFadeTiles()}getImages(i,r,n){this.imageManager.getImages(r.icons,n),this._updateTilesForChangedImages();let o=this.sourceCaches[r.source];o&&o.setDependencies(r.tileID.key,r.type,r.icons)}getGlyphs(i,r,n){this.glyphManager.getGlyphs(r.stacks,n)}getResource(r,n,o){return i.makeRequest(n,o)}}tZ.getSourceType=function(i){return z[i]},tZ.setSourceType=function(i,r){z[i]=r},tZ.registerForPluginStateChange=i.registerForPluginStateChange;var tV="attribute vec2 a_pos;uniform mat4 u_matrix;varying vec2 v_texture_pos;varying float v_depth;void main() {v_texture_pos=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos,get_elevation(a_pos),1.0);v_depth=gl_Position.z/gl_Position.w;}";let tq={prelude:tG("#ifdef GL_ES\nprecision mediump float;\n#else\n#if !defined(lowp)\n#define lowp\n#endif\n#if !defined(mediump)\n#define mediump\n#endif\n#if !defined(highp)\n#define highp\n#endif\n#endif","#ifdef GL_ES\nprecision highp float;\n#else\n#if !defined(lowp)\n#define lowp\n#endif\n#if !defined(mediump)\n#define mediump\n#endif\n#if !defined(highp)\n#define highp\n#endif\n#endif\nvec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0\n);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}\n#ifdef TERRAIN3D\nuniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_offset;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;\n#endif\nconst highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {\n#ifdef TERRAIN3D\nhighp float d=unpack(texture2D(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));\n#else\nreturn 1.0;\n#endif\n}float calculate_visibility(vec4 pos) {\n#ifdef TERRAIN3D\nvec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;\n#else\nreturn 1.0;\n#endif\n}float ele(vec2 pos) {\n#ifdef TERRAIN3D\nvec4 rgb=(texture2D(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;\n#else\nreturn 0.0;\n#endif\n}float get_elevation(vec2 pos) {\n#ifdef TERRAIN3D\nvec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return (elevation+u_terrain_offset)*u_terrain_exaggeration;\n#else\nreturn 0.0;\n#endif\n}"),background:tG("uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),backgroundPattern:tG("uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:tG("varying vec3 v_data;varying float v_visibility;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;varying float v_visibility;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvoid main(void) {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);float ele=get_elevation(circle_center);v_visibility=calculate_visibility(u_matrix*vec4(circle_center,ele,1.0));if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,ele,1);} else {gl_Position=u_matrix*vec4(circle_center,ele,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}"),clippingMask:tG("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:tG("uniform highp float u_intensity;varying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#define GAUSS_COEF 0.3989422804014327\nvoid main() {\n#pragma mapbox: initialize highp float weight\nfloat d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#pragma mapbox: define mediump float radius\nconst highp float ZERO=1.0/255.0/16.0;\n#define GAUSS_COEF 0.3989422804014327\nvoid main(void) {\n#pragma mapbox: initialize highp float weight\n#pragma mapbox: initialize mediump float radius\nvec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}"),heatmapTexture:tG("uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(0.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:tG("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,get_elevation(a_pos),1.0);gl_Position.xy+=(a_extrude+a_shift)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:tG("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:tG("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,get_elevation(a_pos),1);}"),fill:tG("#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\ngl_FragColor=color*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);}"),fillOutline:tG("varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}"),fillOutlinePattern:tG("uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}"),fillPattern:tG("#ifdef GL_ES\nprecision highp float;\n#endif\nuniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}"),fillExtrusion:tG("varying vec4 v_color;void main() {gl_FragColor=v_color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;\n#ifdef TERRAIN3D\nattribute vec2 a_centroid;\n#endif\nvarying vec4 v_color;\n#pragma mapbox: define highp float base\n#pragma mapbox: define highp float height\n#pragma mapbox: define highp vec4 color\nvoid main() {\n#pragma mapbox: initialize highp float base\n#pragma mapbox: initialize highp float height\n#pragma mapbox: initialize highp vec4 color\nvec3 normal=a_normal_ed.xyz;\n#ifdef TERRAIN3D\nfloat baseDelta=10.0;float ele=get_elevation(a_centroid);\n#else\nfloat baseDelta=0.0;float ele=0.0;\n#endif\nbase=max(0.0,ele+base-baseDelta);height=max(0.0,ele+height);float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}"),fillExtrusionPattern:tG("uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;\n#ifdef TERRAIN3D\nattribute vec2 a_centroid;\n#endif\nvarying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;\n#ifdef TERRAIN3D\nfloat baseDelta=10.0;float ele=get_elevation(a_centroid);\n#else\nfloat baseDelta=0.0;float ele=0.0;\n#endif\nbase=max(0.0,ele+base-baseDelta);height=max(0.0,ele+height);float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0\n? a_pos\n: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}"),hillshadePrepare:tG("#ifdef GL_ES\nprecision highp float;\n#endif\nuniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:tG("uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;\n#define PI 3.141592653589793\nvoid main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),line:tG("uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;\n#ifdef TERRAIN3D\nv_gamma_scale=1.0;\n#else\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#endif\nv_width2=vec2(outset,inset);}"),lineGradient:tG("uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);gl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;\n#ifdef TERRAIN3D\nv_gamma_scale=1.0;\n#else\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#endif\nv_width2=vec2(outset,inset);}"),linePattern:tG("#ifdef GL_ES\nprecision highp float;\n#endif\nuniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\n#define LINE_DISTANCE_SCALE 2.0\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;\n#ifdef TERRAIN3D\nv_gamma_scale=1.0;\n#else\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#endif\nv_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}"),lineSDF:tG("uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\n#define LINE_DISTANCE_SCALE 2.0\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;\n#ifdef TERRAIN3D\nv_gamma_scale=1.0;\n#else\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#endif\nv_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}"),raster:tG("uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),symbolIcon:tG("uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nlowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0),z,1.0);v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}"),symbolSDF:tG("#define SDF_PX 8.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset),z,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}"),symbolTextAndIcon:tG("#define SDF_PX 8.0\n#define SDF 1.0\n#define ICON 0.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\nreturn;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),z,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}"),terrain:tG("uniform sampler2D u_texture;varying vec2 v_texture_pos;void main() {gl_FragColor=texture2D(u_texture,v_texture_pos);}",tV),terrainDepth:tG("varying float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {gl_FragColor=pack(v_depth);}",tV),terrainCoords:tG("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;varying vec2 v_texture_pos;void main() {vec4 rgba=texture2D(u_texture,v_texture_pos);gl_FragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}",tV)};function tG(i,r){let n=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,o=r.match(/attribute ([\w]+) ([\w]+)/g),a=i.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),s=r.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),l=s?s.concat(a):a,u={};return{fragmentSource:i=i.replace(n,(i,r,n,o,a)=>(u[a]=!0,"define"===r?`
#ifndef HAS_UNIFORM_u_${a}
varying ${n} ${o} ${a};
#else
uniform ${n} ${o} u_${a};
#endif
`:`
#ifdef HAS_UNIFORM_u_${a}
    ${n} ${o} ${a} = u_${a};
#endif
`)),vertexSource:r=r.replace(n,(i,r,n,o,a)=>{let s="float"===o?"vec2":"vec4",l=a.match(/color/)?"color":s;return u[a]?"define"===r?`
#ifndef HAS_UNIFORM_u_${a}
uniform lowp float u_${a}_t;
attribute ${n} ${s} a_${a};
varying ${n} ${o} ${a};
#else
uniform ${n} ${o} u_${a};
#endif
`:"vec4"===l?`
#ifndef HAS_UNIFORM_u_${a}
    ${a} = a_${a};
#else
    ${n} ${o} ${a} = u_${a};
#endif
`:`
#ifndef HAS_UNIFORM_u_${a}
    ${a} = unpack_mix_${l}(a_${a}, u_${a}_t);
#else
    ${n} ${o} ${a} = u_${a};
#endif
`:"define"===r?`
#ifndef HAS_UNIFORM_u_${a}
uniform lowp float u_${a}_t;
attribute ${n} ${s} a_${a};
#else
uniform ${n} ${o} u_${a};
#endif
`:"vec4"===l?`
#ifndef HAS_UNIFORM_u_${a}
    ${n} ${o} ${a} = a_${a};
#else
    ${n} ${o} ${a} = u_${a};
#endif
`:`
#ifndef HAS_UNIFORM_u_${a}
    ${n} ${o} ${a} = unpack_mix_${l}(a_${a}, u_${a}_t);
#else
    ${n} ${o} ${a} = u_${a};
#endif
`}),staticAttributes:o,staticUniforms:l}}class t${constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(i,r,n,o,a,s,l,u,h){this.context=i;let c=this.boundPaintVertexBuffers.length!==o.length;for(let i=0;!c&&i<o.length;i++)this.boundPaintVertexBuffers[i]!==o[i]&&(c=!0);i.extVertexArrayObject&&this.vao&&this.boundProgram===r&&this.boundLayoutVertexBuffer===n&&!c&&this.boundIndexBuffer===a&&this.boundVertexOffset===s&&this.boundDynamicVertexBuffer===l&&this.boundDynamicVertexBuffer2===u&&this.boundDynamicVertexBuffer3===h?(i.bindVertexArrayOES.set(this.vao),l&&l.bind(),a&&a.dynamicDraw&&a.bind(),u&&u.bind(),h&&h.bind()):this.freshBind(r,n,o,a,s,l,u,h)}freshBind(i,r,n,o,a,s,l,u){let h;let c=i.numAttributes,d=this.context,p=d.gl;if(d.extVertexArrayObject)this.vao&&this.destroy(),this.vao=d.extVertexArrayObject.createVertexArrayOES(),d.bindVertexArrayOES.set(this.vao),h=0,this.boundProgram=i,this.boundLayoutVertexBuffer=r,this.boundPaintVertexBuffers=n,this.boundIndexBuffer=o,this.boundVertexOffset=a,this.boundDynamicVertexBuffer=s,this.boundDynamicVertexBuffer2=l,this.boundDynamicVertexBuffer3=u;else{h=d.currentNumAttributes||0;for(let i=c;i<h;i++)p.disableVertexAttribArray(i)}for(let o of(r.enableAttributes(p,i),n))o.enableAttributes(p,i);for(let o of(s&&s.enableAttributes(p,i),l&&l.enableAttributes(p,i),u&&u.enableAttributes(p,i),r.bind(),r.setVertexAttribPointers(p,i,a),n))o.bind(),o.setVertexAttribPointers(p,i,a);s&&(s.bind(),s.setVertexAttribPointers(p,i,a)),o&&o.bind(),l&&(l.bind(),l.setVertexAttribPointers(p,i,a)),u&&(u.bind(),u.setVertexAttribPointers(p,i,a)),d.currentNumAttributes=c}destroy(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)}}function tW(i){let r=[];for(let n=0;n<i.length;n++){if(null===i[n])continue;let o=i[n].split(" ");r.push(o.pop())}return r}class tH{constructor(r,n,o,a,s,l,u){let h=r.gl;this.program=h.createProgram();let c=tW(o.staticAttributes),d=a?a.getBinderAttributes():[],p=c.concat(d),f=tq.prelude.staticUniforms?tW(tq.prelude.staticUniforms):[],m=o.staticUniforms?tW(o.staticUniforms):[],g=a?a.getBinderUniforms():[],_=f.concat(m).concat(g),y=[];for(let i of _)0>y.indexOf(i)&&y.push(i);let v=a?a.defines():[];l&&v.push("#define OVERDRAW_INSPECTOR;"),u&&v.push("#define TERRAIN3D;");let x=v.concat(tq.prelude.fragmentSource,o.fragmentSource).join("\n"),b=v.concat(tq.prelude.vertexSource,o.vertexSource).join("\n"),w=h.createShader(h.FRAGMENT_SHADER);if(h.isContextLost())return void(this.failedToCreate=!0);h.shaderSource(w,x),h.compileShader(w),h.attachShader(this.program,w);let T=h.createShader(h.VERTEX_SHADER);if(h.isContextLost())return void(this.failedToCreate=!0);h.shaderSource(T,b),h.compileShader(T),h.attachShader(this.program,T),this.attributes={};let E={};this.numAttributes=p.length;for(let i=0;i<this.numAttributes;i++)p[i]&&(h.bindAttribLocation(this.program,i,p[i]),this.attributes[p[i]]=i);h.linkProgram(this.program),h.deleteShader(T),h.deleteShader(w);for(let i=0;i<y.length;i++){let r=y[i];if(r&&!E[r]){let i=h.getUniformLocation(this.program,r);i&&(E[r]=i)}}this.fixedUniforms=s(r,E),this.terrainUniforms={u_depth:new i.Uniform1i(r,E.u_depth),u_terrain:new i.Uniform1i(r,E.u_terrain),u_terrain_dim:new i.Uniform1f(r,E.u_terrain_dim),u_terrain_matrix:new i.UniformMatrix4f(r,E.u_terrain_matrix),u_terrain_unpack:new i.Uniform4f(r,E.u_terrain_unpack),u_terrain_offset:new i.Uniform1f(r,E.u_terrain_offset),u_terrain_exaggeration:new i.Uniform1f(r,E.u_terrain_exaggeration)},this.binderUniforms=a?a.getUniforms(r,E):[]}draw(i,r,n,o,a,s,l,u,h,c,d,p,f,m,g,_,y,v){let x=i.gl;if(this.failedToCreate)return;if(i.program.set(this.program),i.setDepthMode(n),i.setStencilMode(o),i.setColorMode(a),i.setCullFace(s),u)for(let r in i.activeTexture.set(x.TEXTURE2),x.bindTexture(x.TEXTURE_2D,u.depthTexture),i.activeTexture.set(x.TEXTURE3),x.bindTexture(x.TEXTURE_2D,u.texture),this.terrainUniforms)this.terrainUniforms[r].set(u[r]);for(let i in this.fixedUniforms)this.fixedUniforms[i].set(l[i]);g&&g.setUniforms(i,this.binderUniforms,f,{zoom:m});let b=0;switch(r){case x.LINES:b=2;break;case x.TRIANGLES:b=3;break;case x.LINE_STRIP:b=1}for(let n of p.get()){let o=n.vaos||(n.vaos={});(o[h]||(o[h]=new t$)).bind(i,this,c,g?g.getPaintVertexBuffers():[],d,n.vertexOffset,_,y,v),x.drawElements(r,n.primitiveLength*b,x.UNSIGNED_SHORT,n.primitiveOffset*b*2)}}}function tX(i,r,n){let o=1/tm(n,1,r.transform.tileZoom),a=Math.pow(2,n.tileID.overscaledZ),s=n.tileSize*Math.pow(2,r.transform.tileZoom)/a,l=s*(n.tileID.canonical.x+n.tileID.wrap*a),u=s*n.tileID.canonical.y;return{u_image:0,u_texsize:n.imageAtlasTexture.size,u_scale:[o,i.fromScale,i.toScale],u_fade:i.t,u_pixel_coord_upper:[l>>16,u>>16],u_pixel_coord_lower:[65535&l,65535&u]}}let tK=(r,n,o,a)=>{let s=n.style.light,l=s.properties.get("position"),u=[l.x,l.y,l.z],h=i.create$1();"viewport"===s.properties.get("anchor")&&i.fromRotation(h,-n.transform.angle),i.transformMat3(u,u,h);let c=s.properties.get("color");return{u_matrix:r,u_lightpos:u,u_lightintensity:s.properties.get("intensity"),u_lightcolor:[c.r,c.g,c.b],u_vertical_gradient:+o,u_opacity:a}},tJ=(r,n,o,a,s,l,u)=>i.extend(tK(r,n,o,a),tX(l,n,u),{u_height_factor:-Math.pow(2,s.overscaledZ)/u.tileSize/8}),tY=i=>({u_matrix:i}),tQ=(r,n,o,a)=>i.extend(tY(r),tX(o,n,a)),t0=(i,r)=>({u_matrix:i,u_world:r}),t1=(r,n,o,a,s)=>i.extend(tQ(r,n,o,a),{u_world:s}),t2=(i,r,n,o)=>{let a,s;let l=i.transform;if("map"===o.paint.get("circle-pitch-alignment")){let i=tm(n,1,l.zoom);a=!0,s=[i,i]}else a=!1,s=l.pixelsToGLUnits;return{u_camera_to_center_distance:l.cameraToCenterDistance,u_scale_with_map:+("map"===o.paint.get("circle-pitch-scale")),u_matrix:i.translatePosMatrix(r.posMatrix,n,o.paint.get("circle-translate"),o.paint.get("circle-translate-anchor")),u_pitch_with_map:+a,u_device_pixel_ratio:i.pixelRatio,u_extrude_scale:s}},t3=(i,r,n)=>{let o=tm(n,1,r.zoom),a=Math.pow(2,r.zoom-n.tileID.overscaledZ),s=n.tileID.overscaleFactor();return{u_matrix:i,u_camera_to_center_distance:r.cameraToCenterDistance,u_pixels_to_tile_units:o,u_extrude_scale:[r.pixelsToGLUnits[0]/(o*a),r.pixelsToGLUnits[1]/(o*a)],u_overscale_factor:s}},t5=(i,r,n=1)=>({u_matrix:i,u_color:r,u_overlay:0,u_overlay_scale:n}),t4=i=>({u_matrix:i}),t6=(i,r,n,o)=>({u_matrix:i,u_extrude_scale:tm(r,1,n),u_intensity:o}),t8=(i,r,n,o)=>{let a=i.transform;return{u_matrix:ei(i,r,n,o),u_ratio:1/tm(r,1,a.zoom),u_device_pixel_ratio:i.pixelRatio,u_units_to_pixels:[1/a.pixelsToGLUnits[0],1/a.pixelsToGLUnits[1]]}},t9=(r,n,o,a,s)=>i.extend(t8(r,n,o,s),{u_image:0,u_image_height:a}),t7=(i,r,n,o,a)=>{let s=i.transform,l=ee(r,s);return{u_matrix:ei(i,r,n,a),u_texsize:r.imageAtlasTexture.size,u_ratio:1/tm(r,1,s.zoom),u_device_pixel_ratio:i.pixelRatio,u_image:0,u_scale:[l,o.fromScale,o.toScale],u_fade:o.t,u_units_to_pixels:[1/s.pixelsToGLUnits[0],1/s.pixelsToGLUnits[1]]}},et=(r,n,o,a,s,l)=>{let u=r.lineAtlas,h=ee(n,r.transform),c="round"===o.layout.get("line-cap"),d=u.getDash(a.from,c),p=u.getDash(a.to,c),f=d.width*s.fromScale,m=p.width*s.toScale;return i.extend(t8(r,n,o,l),{u_patternscale_a:[h/f,-d.height/2],u_patternscale_b:[h/m,-p.height/2],u_sdfgamma:u.width/(256*Math.min(f,m)*r.pixelRatio)/2,u_image:0,u_tex_y_a:d.y,u_tex_y_b:p.y,u_mix:s.t})};function ee(i,r){return 1/tm(i,1,r.tileZoom)}function ei(i,r,n,o){return i.translatePosMatrix(o?o.posMatrix:r.tileID.posMatrix,r,n.paint.get("line-translate"),n.paint.get("line-translate-anchor"))}let er=(i,r,n,o,a)=>{var s,l;return{u_matrix:i,u_tl_parent:r,u_scale_parent:n,u_buffer_scale:1,u_fade_t:o.mix,u_opacity:o.opacity*a.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:a.paint.get("raster-brightness-min"),u_brightness_high:a.paint.get("raster-brightness-max"),u_saturation_factor:(l=a.paint.get("raster-saturation"))>0?1-1/(1.001-l):-l,u_contrast_factor:(s=a.paint.get("raster-contrast"))>0?1/(1-s):1+s,u_spin_weights:function(i){i*=Math.PI/180;let r=Math.sin(i),n=Math.cos(i);return[(2*n+1)/3,(-Math.sqrt(3)*r-n+1)/3,(Math.sqrt(3)*r-n+1)/3]}(a.paint.get("raster-hue-rotate"))}},en=(i,r,n,o,a,s,l,u,h,c)=>{let d=a.transform;return{u_is_size_zoom_constant:+("constant"===i||"source"===i),u_is_size_feature_constant:+("constant"===i||"camera"===i),u_size_t:r?r.uSizeT:0,u_size:r?r.uSize:0,u_camera_to_center_distance:d.cameraToCenterDistance,u_pitch:d.pitch/360*2*Math.PI,u_rotate_symbol:+n,u_aspect_ratio:d.width/d.height,u_fade_change:a.options.fadeDuration?a.symbolFadeChange:1,u_matrix:s,u_label_plane_matrix:l,u_coord_matrix:u,u_is_text:+h,u_pitch_with_map:+o,u_texsize:c,u_texture:0}},eo=(r,n,o,a,s,l,u,h,c,d,p)=>{let f=s.transform;return i.extend(en(r,n,o,a,s,l,u,h,c,d),{u_gamma_scale:a?Math.cos(f._pitch)*f.cameraToCenterDistance:1,u_device_pixel_ratio:s.pixelRatio,u_is_halo:+p})},ea=(r,n,o,a,s,l,u,h,c,d)=>i.extend(eo(r,n,o,a,s,l,u,h,!0,c,!0),{u_texsize_icon:d,u_texture_icon:1}),es=(i,r,n)=>({u_matrix:i,u_opacity:r,u_color:n}),el=(r,n,o,a,s,l)=>i.extend(function(i,r,n,o){let a=n.imageManager.getPattern(i.from.toString()),s=n.imageManager.getPattern(i.to.toString()),{width:l,height:u}=n.imageManager.getPixelSize(),h=Math.pow(2,o.tileID.overscaledZ),c=o.tileSize*Math.pow(2,n.transform.tileZoom)/h,d=c*(o.tileID.canonical.x+o.tileID.wrap*h),p=c*o.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:a.tl,u_pattern_br_a:a.br,u_pattern_tl_b:s.tl,u_pattern_br_b:s.br,u_texsize:[l,u],u_mix:r.t,u_pattern_size_a:a.displaySize,u_pattern_size_b:s.displaySize,u_scale_a:r.fromScale,u_scale_b:r.toScale,u_tile_units_to_pixels:1/tm(o,1,n.transform.tileZoom),u_pixel_coord_upper:[d>>16,p>>16],u_pixel_coord_lower:[65535&d,65535&p]}}(a,l,o,s),{u_matrix:r,u_opacity:n}),eu={fillExtrusion:(r,n)=>({u_matrix:new i.UniformMatrix4f(r,n.u_matrix),u_lightpos:new i.Uniform3f(r,n.u_lightpos),u_lightintensity:new i.Uniform1f(r,n.u_lightintensity),u_lightcolor:new i.Uniform3f(r,n.u_lightcolor),u_vertical_gradient:new i.Uniform1f(r,n.u_vertical_gradient),u_opacity:new i.Uniform1f(r,n.u_opacity)}),fillExtrusionPattern:(r,n)=>({u_matrix:new i.UniformMatrix4f(r,n.u_matrix),u_lightpos:new i.Uniform3f(r,n.u_lightpos),u_lightintensity:new i.Uniform1f(r,n.u_lightintensity),u_lightcolor:new i.Uniform3f(r,n.u_lightcolor),u_vertical_gradient:new i.Uniform1f(r,n.u_vertical_gradient),u_height_factor:new i.Uniform1f(r,n.u_height_factor),u_image:new i.Uniform1i(r,n.u_image),u_texsize:new i.Uniform2f(r,n.u_texsize),u_pixel_coord_upper:new i.Uniform2f(r,n.u_pixel_coord_upper),u_pixel_coord_lower:new i.Uniform2f(r,n.u_pixel_coord_lower),u_scale:new i.Uniform3f(r,n.u_scale),u_fade:new i.Uniform1f(r,n.u_fade),u_opacity:new i.Uniform1f(r,n.u_opacity)}),fill:(r,n)=>({u_matrix:new i.UniformMatrix4f(r,n.u_matrix)}),fillPattern:(r,n)=>({u_matrix:new i.UniformMatrix4f(r,n.u_matrix),u_image:new i.Uniform1i(r,n.u_image),u_texsize:new i.Uniform2f(r,n.u_texsize),u_pixel_coord_upper:new i.Uniform2f(r,n.u_pixel_coord_upper),u_pixel_coord_lower:new i.Uniform2f(r,n.u_pixel_coord_lower),u_scale:new i.Uniform3f(r,n.u_scale),u_fade:new i.Uniform1f(r,n.u_fade)}),fillOutline:(r,n)=>({u_matrix:new i.UniformMatrix4f(r,n.u_matrix),u_world:new i.Uniform2f(r,n.u_world)}),fillOutlinePattern:(r,n)=>({u_matrix:new i.UniformMatrix4f(r,n.u_matrix),u_world:new i.Uniform2f(r,n.u_world),u_image:new i.Uniform1i(r,n.u_image),u_texsize:new i.Uniform2f(r,n.u_texsize),u_pixel_coord_upper:new i.Uniform2f(r,n.u_pixel_coord_upper),u_pixel_coord_lower:new i.Uniform2f(r,n.u_pixel_coord_lower),u_scale:new i.Uniform3f(r,n.u_scale),u_fade:new i.Uniform1f(r,n.u_fade)}),circle:(r,n)=>({u_camera_to_center_distance:new i.Uniform1f(r,n.u_camera_to_center_distance),u_scale_with_map:new i.Uniform1i(r,n.u_scale_with_map),u_pitch_with_map:new i.Uniform1i(r,n.u_pitch_with_map),u_extrude_scale:new i.Uniform2f(r,n.u_extrude_scale),u_device_pixel_ratio:new i.Uniform1f(r,n.u_device_pixel_ratio),u_matrix:new i.UniformMatrix4f(r,n.u_matrix)}),collisionBox:(r,n)=>({u_matrix:new i.UniformMatrix4f(r,n.u_matrix),u_camera_to_center_distance:new i.Uniform1f(r,n.u_camera_to_center_distance),u_pixels_to_tile_units:new i.Uniform1f(r,n.u_pixels_to_tile_units),u_extrude_scale:new i.Uniform2f(r,n.u_extrude_scale),u_overscale_factor:new i.Uniform1f(r,n.u_overscale_factor)}),collisionCircle:(r,n)=>({u_matrix:new i.UniformMatrix4f(r,n.u_matrix),u_inv_matrix:new i.UniformMatrix4f(r,n.u_inv_matrix),u_camera_to_center_distance:new i.Uniform1f(r,n.u_camera_to_center_distance),u_viewport_size:new i.Uniform2f(r,n.u_viewport_size)}),debug:(r,n)=>({u_color:new i.UniformColor(r,n.u_color),u_matrix:new i.UniformMatrix4f(r,n.u_matrix),u_overlay:new i.Uniform1i(r,n.u_overlay),u_overlay_scale:new i.Uniform1f(r,n.u_overlay_scale)}),clippingMask:(r,n)=>({u_matrix:new i.UniformMatrix4f(r,n.u_matrix)}),heatmap:(r,n)=>({u_extrude_scale:new i.Uniform1f(r,n.u_extrude_scale),u_intensity:new i.Uniform1f(r,n.u_intensity),u_matrix:new i.UniformMatrix4f(r,n.u_matrix)}),heatmapTexture:(r,n)=>({u_matrix:new i.UniformMatrix4f(r,n.u_matrix),u_world:new i.Uniform2f(r,n.u_world),u_image:new i.Uniform1i(r,n.u_image),u_color_ramp:new i.Uniform1i(r,n.u_color_ramp),u_opacity:new i.Uniform1f(r,n.u_opacity)}),hillshade:(r,n)=>({u_matrix:new i.UniformMatrix4f(r,n.u_matrix),u_image:new i.Uniform1i(r,n.u_image),u_latrange:new i.Uniform2f(r,n.u_latrange),u_light:new i.Uniform2f(r,n.u_light),u_shadow:new i.UniformColor(r,n.u_shadow),u_highlight:new i.UniformColor(r,n.u_highlight),u_accent:new i.UniformColor(r,n.u_accent)}),hillshadePrepare:(r,n)=>({u_matrix:new i.UniformMatrix4f(r,n.u_matrix),u_image:new i.Uniform1i(r,n.u_image),u_dimension:new i.Uniform2f(r,n.u_dimension),u_zoom:new i.Uniform1f(r,n.u_zoom),u_unpack:new i.Uniform4f(r,n.u_unpack)}),line:(r,n)=>({u_matrix:new i.UniformMatrix4f(r,n.u_matrix),u_ratio:new i.Uniform1f(r,n.u_ratio),u_device_pixel_ratio:new i.Uniform1f(r,n.u_device_pixel_ratio),u_units_to_pixels:new i.Uniform2f(r,n.u_units_to_pixels)}),lineGradient:(r,n)=>({u_matrix:new i.UniformMatrix4f(r,n.u_matrix),u_ratio:new i.Uniform1f(r,n.u_ratio),u_device_pixel_ratio:new i.Uniform1f(r,n.u_device_pixel_ratio),u_units_to_pixels:new i.Uniform2f(r,n.u_units_to_pixels),u_image:new i.Uniform1i(r,n.u_image),u_image_height:new i.Uniform1f(r,n.u_image_height)}),linePattern:(r,n)=>({u_matrix:new i.UniformMatrix4f(r,n.u_matrix),u_texsize:new i.Uniform2f(r,n.u_texsize),u_ratio:new i.Uniform1f(r,n.u_ratio),u_device_pixel_ratio:new i.Uniform1f(r,n.u_device_pixel_ratio),u_image:new i.Uniform1i(r,n.u_image),u_units_to_pixels:new i.Uniform2f(r,n.u_units_to_pixels),u_scale:new i.Uniform3f(r,n.u_scale),u_fade:new i.Uniform1f(r,n.u_fade)}),lineSDF:(r,n)=>({u_matrix:new i.UniformMatrix4f(r,n.u_matrix),u_ratio:new i.Uniform1f(r,n.u_ratio),u_device_pixel_ratio:new i.Uniform1f(r,n.u_device_pixel_ratio),u_units_to_pixels:new i.Uniform2f(r,n.u_units_to_pixels),u_patternscale_a:new i.Uniform2f(r,n.u_patternscale_a),u_patternscale_b:new i.Uniform2f(r,n.u_patternscale_b),u_sdfgamma:new i.Uniform1f(r,n.u_sdfgamma),u_image:new i.Uniform1i(r,n.u_image),u_tex_y_a:new i.Uniform1f(r,n.u_tex_y_a),u_tex_y_b:new i.Uniform1f(r,n.u_tex_y_b),u_mix:new i.Uniform1f(r,n.u_mix)}),raster:(r,n)=>({u_matrix:new i.UniformMatrix4f(r,n.u_matrix),u_tl_parent:new i.Uniform2f(r,n.u_tl_parent),u_scale_parent:new i.Uniform1f(r,n.u_scale_parent),u_buffer_scale:new i.Uniform1f(r,n.u_buffer_scale),u_fade_t:new i.Uniform1f(r,n.u_fade_t),u_opacity:new i.Uniform1f(r,n.u_opacity),u_image0:new i.Uniform1i(r,n.u_image0),u_image1:new i.Uniform1i(r,n.u_image1),u_brightness_low:new i.Uniform1f(r,n.u_brightness_low),u_brightness_high:new i.Uniform1f(r,n.u_brightness_high),u_saturation_factor:new i.Uniform1f(r,n.u_saturation_factor),u_contrast_factor:new i.Uniform1f(r,n.u_contrast_factor),u_spin_weights:new i.Uniform3f(r,n.u_spin_weights)}),symbolIcon:(r,n)=>({u_is_size_zoom_constant:new i.Uniform1i(r,n.u_is_size_zoom_constant),u_is_size_feature_constant:new i.Uniform1i(r,n.u_is_size_feature_constant),u_size_t:new i.Uniform1f(r,n.u_size_t),u_size:new i.Uniform1f(r,n.u_size),u_camera_to_center_distance:new i.Uniform1f(r,n.u_camera_to_center_distance),u_pitch:new i.Uniform1f(r,n.u_pitch),u_rotate_symbol:new i.Uniform1i(r,n.u_rotate_symbol),u_aspect_ratio:new i.Uniform1f(r,n.u_aspect_ratio),u_fade_change:new i.Uniform1f(r,n.u_fade_change),u_matrix:new i.UniformMatrix4f(r,n.u_matrix),u_label_plane_matrix:new i.UniformMatrix4f(r,n.u_label_plane_matrix),u_coord_matrix:new i.UniformMatrix4f(r,n.u_coord_matrix),u_is_text:new i.Uniform1i(r,n.u_is_text),u_pitch_with_map:new i.Uniform1i(r,n.u_pitch_with_map),u_texsize:new i.Uniform2f(r,n.u_texsize),u_texture:new i.Uniform1i(r,n.u_texture)}),symbolSDF:(r,n)=>({u_is_size_zoom_constant:new i.Uniform1i(r,n.u_is_size_zoom_constant),u_is_size_feature_constant:new i.Uniform1i(r,n.u_is_size_feature_constant),u_size_t:new i.Uniform1f(r,n.u_size_t),u_size:new i.Uniform1f(r,n.u_size),u_camera_to_center_distance:new i.Uniform1f(r,n.u_camera_to_center_distance),u_pitch:new i.Uniform1f(r,n.u_pitch),u_rotate_symbol:new i.Uniform1i(r,n.u_rotate_symbol),u_aspect_ratio:new i.Uniform1f(r,n.u_aspect_ratio),u_fade_change:new i.Uniform1f(r,n.u_fade_change),u_matrix:new i.UniformMatrix4f(r,n.u_matrix),u_label_plane_matrix:new i.UniformMatrix4f(r,n.u_label_plane_matrix),u_coord_matrix:new i.UniformMatrix4f(r,n.u_coord_matrix),u_is_text:new i.Uniform1i(r,n.u_is_text),u_pitch_with_map:new i.Uniform1i(r,n.u_pitch_with_map),u_texsize:new i.Uniform2f(r,n.u_texsize),u_texture:new i.Uniform1i(r,n.u_texture),u_gamma_scale:new i.Uniform1f(r,n.u_gamma_scale),u_device_pixel_ratio:new i.Uniform1f(r,n.u_device_pixel_ratio),u_is_halo:new i.Uniform1i(r,n.u_is_halo)}),symbolTextAndIcon:(r,n)=>({u_is_size_zoom_constant:new i.Uniform1i(r,n.u_is_size_zoom_constant),u_is_size_feature_constant:new i.Uniform1i(r,n.u_is_size_feature_constant),u_size_t:new i.Uniform1f(r,n.u_size_t),u_size:new i.Uniform1f(r,n.u_size),u_camera_to_center_distance:new i.Uniform1f(r,n.u_camera_to_center_distance),u_pitch:new i.Uniform1f(r,n.u_pitch),u_rotate_symbol:new i.Uniform1i(r,n.u_rotate_symbol),u_aspect_ratio:new i.Uniform1f(r,n.u_aspect_ratio),u_fade_change:new i.Uniform1f(r,n.u_fade_change),u_matrix:new i.UniformMatrix4f(r,n.u_matrix),u_label_plane_matrix:new i.UniformMatrix4f(r,n.u_label_plane_matrix),u_coord_matrix:new i.UniformMatrix4f(r,n.u_coord_matrix),u_is_text:new i.Uniform1i(r,n.u_is_text),u_pitch_with_map:new i.Uniform1i(r,n.u_pitch_with_map),u_texsize:new i.Uniform2f(r,n.u_texsize),u_texsize_icon:new i.Uniform2f(r,n.u_texsize_icon),u_texture:new i.Uniform1i(r,n.u_texture),u_texture_icon:new i.Uniform1i(r,n.u_texture_icon),u_gamma_scale:new i.Uniform1f(r,n.u_gamma_scale),u_device_pixel_ratio:new i.Uniform1f(r,n.u_device_pixel_ratio),u_is_halo:new i.Uniform1i(r,n.u_is_halo)}),background:(r,n)=>({u_matrix:new i.UniformMatrix4f(r,n.u_matrix),u_opacity:new i.Uniform1f(r,n.u_opacity),u_color:new i.UniformColor(r,n.u_color)}),backgroundPattern:(r,n)=>({u_matrix:new i.UniformMatrix4f(r,n.u_matrix),u_opacity:new i.Uniform1f(r,n.u_opacity),u_image:new i.Uniform1i(r,n.u_image),u_pattern_tl_a:new i.Uniform2f(r,n.u_pattern_tl_a),u_pattern_br_a:new i.Uniform2f(r,n.u_pattern_br_a),u_pattern_tl_b:new i.Uniform2f(r,n.u_pattern_tl_b),u_pattern_br_b:new i.Uniform2f(r,n.u_pattern_br_b),u_texsize:new i.Uniform2f(r,n.u_texsize),u_mix:new i.Uniform1f(r,n.u_mix),u_pattern_size_a:new i.Uniform2f(r,n.u_pattern_size_a),u_pattern_size_b:new i.Uniform2f(r,n.u_pattern_size_b),u_scale_a:new i.Uniform1f(r,n.u_scale_a),u_scale_b:new i.Uniform1f(r,n.u_scale_b),u_pixel_coord_upper:new i.Uniform2f(r,n.u_pixel_coord_upper),u_pixel_coord_lower:new i.Uniform2f(r,n.u_pixel_coord_lower),u_tile_units_to_pixels:new i.Uniform1f(r,n.u_tile_units_to_pixels)}),terrain:(r,n)=>({u_matrix:new i.UniformMatrix4f(r,n.u_matrix),u_texture:new i.Uniform1i(r,n.u_texture)}),terrainDepth:(r,n)=>({u_matrix:new i.UniformMatrix4f(r,n.u_matrix)}),terrainCoords:(r,n)=>({u_matrix:new i.UniformMatrix4f(r,n.u_matrix),u_texture:new i.Uniform1i(r,n.u_texture),u_terrain_coords_id:new i.Uniform1f(r,n.u_terrain_coords_id)})};class eh{constructor(i,r,n){this.context=i;let o=i.gl;this.buffer=o.createBuffer(),this.dynamicDraw=!!n,this.context.unbindVAO(),i.bindElementBuffer.set(this.buffer),o.bufferData(o.ELEMENT_ARRAY_BUFFER,r.arrayBuffer,this.dynamicDraw?o.DYNAMIC_DRAW:o.STATIC_DRAW),this.dynamicDraw||delete r.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(i){let r=this.context.gl;if(!this.dynamicDraw)throw Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),r.bufferSubData(r.ELEMENT_ARRAY_BUFFER,0,i.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}let ec={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class ed{constructor(i,r,n,o){this.length=r.length,this.attributes=n,this.itemSize=r.bytesPerElement,this.dynamicDraw=o,this.context=i;let a=i.gl;this.buffer=a.createBuffer(),i.bindVertexBuffer.set(this.buffer),a.bufferData(a.ARRAY_BUFFER,r.arrayBuffer,this.dynamicDraw?a.DYNAMIC_DRAW:a.STATIC_DRAW),this.dynamicDraw||delete r.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(i){if(i.length!==this.length)throw Error(`Length of new data is ${i.length}, which doesn't match current length of ${this.length}`);let r=this.context.gl;this.bind(),r.bufferSubData(r.ARRAY_BUFFER,0,i.arrayBuffer)}enableAttributes(i,r){for(let n=0;n<this.attributes.length;n++){let o=r.attributes[this.attributes[n].name];void 0!==o&&i.enableVertexAttribArray(o)}}setVertexAttribPointers(i,r,n){for(let o=0;o<this.attributes.length;o++){let a=this.attributes[o],s=r.attributes[a.name];void 0!==s&&i.vertexAttribPointer(s,a.components,i[ec[a.type]],!1,this.itemSize,a.offset+this.itemSize*(n||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class ep{constructor(i){this.gl=i.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(i){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class ef extends ep{getDefault(){return i.Color.transparent}set(i){let r=this.current;(i.r!==r.r||i.g!==r.g||i.b!==r.b||i.a!==r.a||this.dirty)&&(this.gl.clearColor(i.r,i.g,i.b,i.a),this.current=i,this.dirty=!1)}}class em extends ep{getDefault(){return 1}set(i){(i!==this.current||this.dirty)&&(this.gl.clearDepth(i),this.current=i,this.dirty=!1)}}class eg extends ep{getDefault(){return 0}set(i){(i!==this.current||this.dirty)&&(this.gl.clearStencil(i),this.current=i,this.dirty=!1)}}class e_ extends ep{getDefault(){return[!0,!0,!0,!0]}set(i){let r=this.current;(i[0]!==r[0]||i[1]!==r[1]||i[2]!==r[2]||i[3]!==r[3]||this.dirty)&&(this.gl.colorMask(i[0],i[1],i[2],i[3]),this.current=i,this.dirty=!1)}}class ey extends ep{getDefault(){return!0}set(i){(i!==this.current||this.dirty)&&(this.gl.depthMask(i),this.current=i,this.dirty=!1)}}class ev extends ep{getDefault(){return 255}set(i){(i!==this.current||this.dirty)&&(this.gl.stencilMask(i),this.current=i,this.dirty=!1)}}class ex extends ep{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(i){let r=this.current;(i.func!==r.func||i.ref!==r.ref||i.mask!==r.mask||this.dirty)&&(this.gl.stencilFunc(i.func,i.ref,i.mask),this.current=i,this.dirty=!1)}}class eb extends ep{getDefault(){let i=this.gl;return[i.KEEP,i.KEEP,i.KEEP]}set(i){let r=this.current;(i[0]!==r[0]||i[1]!==r[1]||i[2]!==r[2]||this.dirty)&&(this.gl.stencilOp(i[0],i[1],i[2]),this.current=i,this.dirty=!1)}}class ew extends ep{getDefault(){return!1}set(i){if(i===this.current&&!this.dirty)return;let r=this.gl;i?r.enable(r.STENCIL_TEST):r.disable(r.STENCIL_TEST),this.current=i,this.dirty=!1}}class eT extends ep{getDefault(){return[0,1]}set(i){let r=this.current;(i[0]!==r[0]||i[1]!==r[1]||this.dirty)&&(this.gl.depthRange(i[0],i[1]),this.current=i,this.dirty=!1)}}class eE extends ep{getDefault(){return!1}set(i){if(i===this.current&&!this.dirty)return;let r=this.gl;i?r.enable(r.DEPTH_TEST):r.disable(r.DEPTH_TEST),this.current=i,this.dirty=!1}}class eS extends ep{getDefault(){return this.gl.LESS}set(i){(i!==this.current||this.dirty)&&(this.gl.depthFunc(i),this.current=i,this.dirty=!1)}}class eC extends ep{getDefault(){return!1}set(i){if(i===this.current&&!this.dirty)return;let r=this.gl;i?r.enable(r.BLEND):r.disable(r.BLEND),this.current=i,this.dirty=!1}}class eI extends ep{getDefault(){let i=this.gl;return[i.ONE,i.ZERO]}set(i){let r=this.current;(i[0]!==r[0]||i[1]!==r[1]||this.dirty)&&(this.gl.blendFunc(i[0],i[1]),this.current=i,this.dirty=!1)}}class eA extends ep{getDefault(){return i.Color.transparent}set(i){let r=this.current;(i.r!==r.r||i.g!==r.g||i.b!==r.b||i.a!==r.a||this.dirty)&&(this.gl.blendColor(i.r,i.g,i.b,i.a),this.current=i,this.dirty=!1)}}class eP extends ep{getDefault(){return this.gl.FUNC_ADD}set(i){(i!==this.current||this.dirty)&&(this.gl.blendEquation(i),this.current=i,this.dirty=!1)}}class ek extends ep{getDefault(){return!1}set(i){if(i===this.current&&!this.dirty)return;let r=this.gl;i?r.enable(r.CULL_FACE):r.disable(r.CULL_FACE),this.current=i,this.dirty=!1}}class eL extends ep{getDefault(){return this.gl.BACK}set(i){(i!==this.current||this.dirty)&&(this.gl.cullFace(i),this.current=i,this.dirty=!1)}}class eM extends ep{getDefault(){return this.gl.CCW}set(i){(i!==this.current||this.dirty)&&(this.gl.frontFace(i),this.current=i,this.dirty=!1)}}class ez extends ep{getDefault(){return null}set(i){(i!==this.current||this.dirty)&&(this.gl.useProgram(i),this.current=i,this.dirty=!1)}}class eD extends ep{getDefault(){return this.gl.TEXTURE0}set(i){(i!==this.current||this.dirty)&&(this.gl.activeTexture(i),this.current=i,this.dirty=!1)}}class eR extends ep{getDefault(){let i=this.gl;return[0,0,i.drawingBufferWidth,i.drawingBufferHeight]}set(i){let r=this.current;(i[0]!==r[0]||i[1]!==r[1]||i[2]!==r[2]||i[3]!==r[3]||this.dirty)&&(this.gl.viewport(i[0],i[1],i[2],i[3]),this.current=i,this.dirty=!1)}}class eB extends ep{getDefault(){return null}set(i){if(i===this.current&&!this.dirty)return;let r=this.gl;r.bindFramebuffer(r.FRAMEBUFFER,i),this.current=i,this.dirty=!1}}class eO extends ep{getDefault(){return null}set(i){if(i===this.current&&!this.dirty)return;let r=this.gl;r.bindRenderbuffer(r.RENDERBUFFER,i),this.current=i,this.dirty=!1}}class eF extends ep{getDefault(){return null}set(i){if(i===this.current&&!this.dirty)return;let r=this.gl;r.bindTexture(r.TEXTURE_2D,i),this.current=i,this.dirty=!1}}class eN extends ep{getDefault(){return null}set(i){if(i===this.current&&!this.dirty)return;let r=this.gl;r.bindBuffer(r.ARRAY_BUFFER,i),this.current=i,this.dirty=!1}}class eU extends ep{getDefault(){return null}set(i){let r=this.gl;r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,i),this.current=i,this.dirty=!1}}class ej extends ep{constructor(i){super(i),this.vao=i.extVertexArrayObject}getDefault(){return null}set(i){this.vao&&(i!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(i),this.current=i,this.dirty=!1)}}class eZ extends ep{getDefault(){return 4}set(i){if(i===this.current&&!this.dirty)return;let r=this.gl;r.pixelStorei(r.UNPACK_ALIGNMENT,i),this.current=i,this.dirty=!1}}class eV extends ep{getDefault(){return!1}set(i){if(i===this.current&&!this.dirty)return;let r=this.gl;r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,i),this.current=i,this.dirty=!1}}class eq extends ep{getDefault(){return!1}set(i){if(i===this.current&&!this.dirty)return;let r=this.gl;r.pixelStorei(r.UNPACK_FLIP_Y_WEBGL,i),this.current=i,this.dirty=!1}}class eG extends ep{constructor(i,r){super(i),this.context=i,this.parent=r}getDefault(){return null}}class e$ extends eG{setDirty(){this.dirty=!0}set(i){if(i===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);let r=this.gl;r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,i,0),this.current=i,this.dirty=!1}}class eW extends eG{set(i){if(i===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);let r=this.gl;r.framebufferRenderbuffer(r.FRAMEBUFFER,r.DEPTH_ATTACHMENT,r.RENDERBUFFER,i),this.current=i,this.dirty=!1}}class eH{constructor(i,r,n,o){this.context=i,this.width=r,this.height=n;let a=i.gl,s=this.framebuffer=a.createFramebuffer();if(this.colorAttachment=new e$(i,s),o&&(this.depthAttachment=new eW(i,s)),a.checkFramebufferStatus(a.FRAMEBUFFER)!==a.FRAMEBUFFER_COMPLETE)throw Error("Framebuffer is not complete")}destroy(){let i=this.context.gl,r=this.colorAttachment.get();if(r&&i.deleteTexture(r),this.depthAttachment){let r=this.depthAttachment.get();r&&i.deleteRenderbuffer(r)}i.deleteFramebuffer(this.framebuffer)}}class eX{constructor(i,r,n){this.blendFunction=i,this.blendColor=r,this.mask=n}}eX.Replace=[1,0],eX.disabled=new eX(eX.Replace,i.Color.transparent,[!1,!1,!1,!1]),eX.unblended=new eX(eX.Replace,i.Color.transparent,[!0,!0,!0,!0]),eX.alphaBlended=new eX([1,771],i.Color.transparent,[!0,!0,!0,!0]);class eK{constructor(i){this.gl=i,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),this.clearColor=new ef(this),this.clearDepth=new em(this),this.clearStencil=new eg(this),this.colorMask=new e_(this),this.depthMask=new ey(this),this.stencilMask=new ev(this),this.stencilFunc=new ex(this),this.stencilOp=new eb(this),this.stencilTest=new ew(this),this.depthRange=new eT(this),this.depthTest=new eE(this),this.depthFunc=new eS(this),this.blend=new eC(this),this.blendFunc=new eI(this),this.blendColor=new eA(this),this.blendEquation=new eP(this),this.cullFace=new ek(this),this.cullFaceSide=new eL(this),this.frontFace=new eM(this),this.program=new ez(this),this.activeTexture=new eD(this),this.viewport=new eR(this),this.bindFramebuffer=new eB(this),this.bindRenderbuffer=new eO(this),this.bindTexture=new eF(this),this.bindVertexBuffer=new eN(this),this.bindElementBuffer=new eU(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new ej(this),this.pixelStoreUnpack=new eZ(this),this.pixelStoreUnpackPremultiplyAlpha=new eV(this),this.pixelStoreUnpackFlipY=new eq(this),this.extTextureFilterAnisotropic=i.getExtension("EXT_texture_filter_anisotropic")||i.getExtension("MOZ_EXT_texture_filter_anisotropic")||i.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=i.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureHalfFloat=i.getExtension("OES_texture_half_float"),this.extTextureHalfFloat&&(i.getExtension("OES_texture_half_float_linear"),this.extRenderToTextureHalfFloat=i.getExtension("EXT_color_buffer_half_float")),this.extTimerQuery=i.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=i.getParameter(i.MAX_TEXTURE_SIZE)}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(i,r){return new eh(this,i,r)}createVertexBuffer(i,r,n){return new ed(this,i,r,n)}createRenderbuffer(i,r,n){let o=this.gl,a=o.createRenderbuffer();return this.bindRenderbuffer.set(a),o.renderbufferStorage(o.RENDERBUFFER,i,r,n),this.bindRenderbuffer.set(null),a}createFramebuffer(i,r,n){return new eH(this,i,r,n)}clear({color:i,depth:r}){let n=this.gl,o=0;i&&(o|=n.COLOR_BUFFER_BIT,this.clearColor.set(i),this.colorMask.set([!0,!0,!0,!0])),void 0!==r&&(o|=n.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(r),this.depthMask.set(!0)),n.clear(o)}setCullFace(i){!1===i.enable?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(i.mode),this.frontFace.set(i.frontFace))}setDepthMode(i){i.func!==this.gl.ALWAYS||i.mask?(this.depthTest.set(!0),this.depthFunc.set(i.func),this.depthMask.set(i.mask),this.depthRange.set(i.range)):this.depthTest.set(!1)}setStencilMode(i){i.test.func!==this.gl.ALWAYS||i.mask?(this.stencilTest.set(!0),this.stencilMask.set(i.mask),this.stencilOp.set([i.fail,i.depthFail,i.pass]),this.stencilFunc.set({func:i.test.func,ref:i.ref,mask:i.test.mask})):this.stencilTest.set(!1)}setColorMode(i){l(i.blendFunction,eX.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(i.blendFunction),this.blendColor.set(i.blendColor)),this.colorMask.set(i.mask)}unbindVAO(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)}}class eJ{constructor(i,r,n){this.func=i,this.mask=r,this.range=n}}eJ.ReadOnly=!1,eJ.ReadWrite=!0,eJ.disabled=new eJ(519,eJ.ReadOnly,[0,1]);class eY{constructor(i,r,n,o,a,s){this.test=i,this.ref=r,this.mask=n,this.fail=o,this.depthFail=a,this.pass=s}}eY.disabled=new eY({func:519,mask:0},0,0,7680,7680,7680);class eQ{constructor(i,r,n){this.enable=i,this.mode=r,this.frontFace=n}}function e0(r,n,a,s,l,u,h){var c;let d=r.context,p=d.gl,f=r.useProgram("collisionBox"),m=[],g=0,_=0;for(let o=0;o<s.length;o++){let c=s[o],y=n.getTile(c),v=y.getBucket(a);if(!v)continue;let x=c.posMatrix;0===l[0]&&0===l[1]||(x=r.translatePosMatrix(c.posMatrix,y,l,u));let b=h?v.textCollisionBox:v.iconCollisionBox,w=v.collisionCircleArray;if(w.length>0){let n=i.create(),o=x;i.mul(n,v.placementInvProjMatrix,r.transform.glCoordMatrix),i.mul(n,n,v.placementViewportMatrix),m.push({circleArray:w,circleOffset:_,transform:o,invTransform:n,coord:c}),g+=w.length/4,_=g}b&&f.draw(d,p.LINES,eJ.disabled,eY.disabled,r.colorModeForRenderPass(),eQ.disabled,t3(x,r.transform,y),r.style.terrain&&r.style.terrain.getTerrainData(c),a.id,b.layoutVertexBuffer,b.indexBuffer,b.segments,null,r.transform.zoom,null,null,b.collisionVertexBuffer)}if(!h||!m.length)return;let y=r.useProgram("collisionCircle"),v=new i.CollisionCircleLayoutArray;v.resize(4*g),v._trim();let x=0;for(let i of m)for(let r=0;r<i.circleArray.length/4;r++){let n=4*r,o=i.circleArray[n+0],a=i.circleArray[n+1],s=i.circleArray[n+2],l=i.circleArray[n+3];v.emplace(x++,o,a,s,l,0),v.emplace(x++,o,a,s,l,1),v.emplace(x++,o,a,s,l,2),v.emplace(x++,o,a,s,l,3)}(!o||o.length<2*g)&&(o=function(r){let n=2*r,o=new i.QuadTriangleArray;o.resize(n),o._trim();for(let i=0;i<n;i++){let r=6*i;o.uint16[r+0]=4*i+0,o.uint16[r+1]=4*i+1,o.uint16[r+2]=4*i+2,o.uint16[r+3]=4*i+2,o.uint16[r+4]=4*i+3,o.uint16[r+5]=4*i+0}return o}(g));let b=d.createIndexBuffer(o,!0),w=d.createVertexBuffer(v,i.collisionCircleLayout.members,!0);for(let n of m){let o={u_matrix:n.transform,u_inv_matrix:n.invTransform,u_camera_to_center_distance:(c=r.transform).cameraToCenterDistance,u_viewport_size:[c.width,c.height]};y.draw(d,p.TRIANGLES,eJ.disabled,eY.disabled,r.colorModeForRenderPass(),eQ.disabled,o,r.style.terrain&&r.style.terrain.getTerrainData(n.coord),a.id,w,b,i.SegmentVector.simpleSegment(0,2*n.circleOffset,n.circleArray.length,n.circleArray.length/2),null,r.transform.zoom,null,null,null)}w.destroy(),b.destroy()}eQ.disabled=new eQ(!1,1029,2305),eQ.backCCW=new eQ(!0,1029,2305);let e1=i.identity(new Float32Array(16));function e2(r,n,o,a,s,l,u,h,c,d,p,f){let m=r.context,g=m.gl,_=r.transform,y="map"===h,v="map"===c,x="viewport"!==h&&"point"!==o.layout.get("symbol-placement"),b=y&&!v&&!x,w=!o.layout.get("symbol-sort-key").isConstant(),T=!1,E=r.depthModeForSublayer(0,eJ.ReadOnly),S=o.layout.get("text-variable-anchor"),C=[];for(let h of a){let a;let c=n.getTile(h),p=c.getBucket(o);if(!p)continue;let f=s?p.text:p.icon;if(!f||!f.segments.get().length)continue;let m=f.programConfigurations.get(o.id),E=s||p.sdfIcons,I=s?p.textSizeData:p.iconSizeData,A=v||0!==_.pitch,P=r.useProgram(p.iconsInText&&s?"symbolTextAndIcon":E?"symbolSDF":"symbolIcon",m),k=i.evaluateSizeForZoom(I,_.zoom),M=r.style.terrain&&r.style.terrain.getTerrainData(h),z,D,R,B,O=[0,0],F=null;if(s){if(D=c.glyphAtlasTexture,R=g.LINEAR,z=c.glyphAtlasTexture.size,p.iconsInText){O=c.imageAtlasTexture.size,F=c.imageAtlasTexture;let i="composite"===I.kind||"camera"===I.kind;B=A||r.options.rotating||r.options.zooming||i?g.LINEAR:g.NEAREST}}else{let i=1!==o.layout.get("icon-size").constantOr(0)||p.iconsNeedLinear;D=c.imageAtlasTexture,R=E||r.options.rotating||r.options.zooming||i||A?g.LINEAR:g.NEAREST,z=c.imageAtlasTexture.size}let N=tm(c,1,r.transform.zoom),U=ti(h.posMatrix,v,y,r.transform,N),j=tr(h.posMatrix,v,y,r.transform,N),Z=S&&p.hasTextData(),V="none"!==o.layout.get("icon-text-fit")&&Z&&p.hasIconData();if(x){let n=r.style.terrain?(i,n)=>r.style.terrain.getElevation(h,i,n):null,a="map"===o.layout.get("text-rotation-alignment");!function(r,n,o,a,s,l,u,h,c,d){let p=a?r.textSizeData:r.iconSizeData,f=i.evaluateSizeForZoom(p,o.transform.zoom),m=[256/o.width*2+1,256/o.height*2+1],g=a?r.text.dynamicLayoutVertexArray:r.icon.dynamicLayoutVertexArray;g.clear();let _=r.lineVertexArray,y=a?r.text.placedSymbolArray:r.icon.placedSymbolArray,v=o.transform.width/o.transform.height,x=!1;for(let a=0;a<y.length;a++){let b;let w=y.get(a);if(w.hidden||w.writingMode===i.WritingMode.vertical&&!x||(x=!1,d?(b=[w.anchorX,w.anchorY,d(w.anchorX,w.anchorY),1],i.transformMat4(b,b,n)):tp(b=[w.anchorX,w.anchorY,0,1],b,n),!function(i,r){let n=i[0]/i[3],o=i[1]/i[3];return n>=-r[0]&&n<=r[0]&&o>=-r[1]&&o<=r[1]}(b,m))){td(w.numGlyphs,g);continue}let T=to(o.transform.cameraToCenterDistance,b[3]),E=i.evaluateSizeForFeature(p,f,w),S=u?E/T:E*T,C=new i.pointGeometry(w.anchorX,w.anchorY),I=tn(C,s,d).point,A={},P=tl(w,S,!1,h,n,s,l,r.glyphOffsetArray,_,g,I,C,A,v,c,d);x=P.useVertical,(P.notEnoughRoom||x||P.needsFlipping&&tl(w,S,!0,h,n,s,l,r.glyphOffsetArray,_,g,I,C,A,v,c,d).notEnoughRoom)&&td(w.numGlyphs,g)}a?r.text.dynamicLayoutVertexBuffer.updateData(g):r.icon.dynamicLayoutVertexBuffer.updateData(g)}(p,h.posMatrix,r,s,U,j,v,d,a,n)}let q=r.translatePosMatrix(h.posMatrix,c,l,u),G=x||s&&S||V?e1:U,W=r.translatePosMatrix(j,c,l,u,!0),H=E&&0!==o.paint.get(s?"text-halo-width":"icon-halo-width").constantOr(1);a=E?p.iconsInText?ea(I.kind,k,b,v,r,q,G,W,z,O):eo(I.kind,k,b,v,r,q,G,W,s,z,!0):en(I.kind,k,b,v,r,q,G,W,s,z);let X={program:P,buffers:f,uniformValues:a,atlasTexture:D,atlasTextureIcon:F,atlasInterpolation:R,atlasInterpolationIcon:B,isSDF:E,hasHalo:H};if(w&&p.canOverlap){T=!0;let r=f.segments.get();for(let n of r)C.push({segments:new i.SegmentVector([n]),sortKey:n.sortKey,state:X,terrainData:M})}else C.push({segments:f.segments,sortKey:0,state:X,terrainData:M})}for(let i of(T&&C.sort((i,r)=>i.sortKey-r.sortKey),C)){let n=i.state;if(m.activeTexture.set(g.TEXTURE0),n.atlasTexture.bind(n.atlasInterpolation,g.CLAMP_TO_EDGE),n.atlasTextureIcon&&(m.activeTexture.set(g.TEXTURE1),n.atlasTextureIcon&&n.atlasTextureIcon.bind(n.atlasInterpolationIcon,g.CLAMP_TO_EDGE)),n.isSDF){let a=n.uniformValues;n.hasHalo&&(a.u_is_halo=1,e3(n.buffers,i.segments,o,r,n.program,E,p,f,a,i.terrainData)),a.u_is_halo=0}e3(n.buffers,i.segments,o,r,n.program,E,p,f,n.uniformValues,i.terrainData)}}function e3(i,r,n,o,a,s,l,u,h,c){let d=o.context;a.draw(d,d.gl.TRIANGLES,s,l,u,eQ.disabled,h,c,n.id,i.layoutVertexBuffer,i.indexBuffer,r,n.paint,o.transform.zoom,i.programConfigurations.get(n.id),i.dynamicLayoutVertexBuffer,i.opacityVertexBuffer)}function e5(i,r,n,o,a,s,l){let u,h,c,d,p;let f=i.context.gl,m=n.paint.get("fill-pattern"),g=m&&m.constantOr(1),_=n.getCrossfadeParameters();for(let y of(l?(h=g&&!n.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",u=f.LINES):(h=g?"fillPattern":"fill",u=f.TRIANGLES),o)){let o=r.getTile(y);if(g&&!o.patternsLoaded())continue;let v=o.getBucket(n);if(!v)continue;let x=v.programConfigurations.get(n.id),b=i.useProgram(h,x),w=i.style.terrain&&i.style.terrain.getTerrainData(y);g&&(i.context.activeTexture.set(f.TEXTURE0),o.imageAtlasTexture.bind(f.LINEAR,f.CLAMP_TO_EDGE),x.updatePaintBuffers(_));let T=m.constantOr(null);if(T&&o.imageAtlas){let i=o.imageAtlas,r=i.patternPositions[T.to.toString()],n=i.patternPositions[T.from.toString()];r&&n&&x.setConstantPatternPositions(r,n)}let E=w?y:null,S=i.translatePosMatrix(E?E.posMatrix:y.posMatrix,o,n.paint.get("fill-translate"),n.paint.get("fill-translate-anchor"));if(l){d=v.indexBuffer2,p=v.segments2;let r=[f.drawingBufferWidth,f.drawingBufferHeight];c="fillOutlinePattern"===h&&g?t1(S,i,_,o,r):t0(S,r)}else d=v.indexBuffer,p=v.segments,c=g?tQ(S,i,_,o):tY(S);b.draw(i.context,u,a,i.stencilModeForClipping(y),s,eQ.disabled,c,w,n.id,v.layoutVertexBuffer,d,p,n.paint,i.transform.zoom,x)}}function e4(i,r,n,o,a,s,l){let u=i.context,h=u.gl,c=n.paint.get("fill-extrusion-pattern"),d=c.constantOr(1),p=n.getCrossfadeParameters(),f=n.paint.get("fill-extrusion-opacity");for(let m of o){let o=r.getTile(m),g=o.getBucket(n);if(!g)continue;let _=i.style.terrain&&i.style.terrain.getTerrainData(m),y=g.programConfigurations.get(n.id),v=i.useProgram(d?"fillExtrusionPattern":"fillExtrusion",y);d&&(i.context.activeTexture.set(h.TEXTURE0),o.imageAtlasTexture.bind(h.LINEAR,h.CLAMP_TO_EDGE),y.updatePaintBuffers(p));let x=c.constantOr(null);if(x&&o.imageAtlas){let i=o.imageAtlas,r=i.patternPositions[x.to.toString()],n=i.patternPositions[x.from.toString()];r&&n&&y.setConstantPatternPositions(r,n)}let b=i.translatePosMatrix(m.posMatrix,o,n.paint.get("fill-extrusion-translate"),n.paint.get("fill-extrusion-translate-anchor")),w=n.paint.get("fill-extrusion-vertical-gradient"),T=d?tJ(b,i,w,f,m,p,o):tK(b,i,w,f);v.draw(u,u.gl.TRIANGLES,a,s,l,eQ.backCCW,T,_,n.id,g.layoutVertexBuffer,g.indexBuffer,g.segments,n.paint,i.transform.zoom,y,i.style.terrain&&g.centroidVertexBuffer)}}let e6=new i.Color(1,0,0,1),e8=new i.Color(0,1,0,1),e9=new i.Color(0,0,1,1),e7=new i.Color(1,0,1,1),it=new i.Color(0,1,1,1);function ie(i,r,n,o){ir(i,0,r+n/2,i.transform.width,n,o)}function ii(i,r,n,o){ir(i,r-n/2,0,n,i.transform.height,o)}function ir(i,r,n,o,a,s){let l=i.context,u=l.gl;u.enable(u.SCISSOR_TEST),u.scissor(r*i.pixelRatio,n*i.pixelRatio,o*i.pixelRatio,a*i.pixelRatio),l.clear({color:s}),u.disable(u.SCISSOR_TEST)}function io(i,r,n){let o=i.context,a=o.gl,s=i.colorModeForRenderPass(),l=new eJ(a.LEQUAL,eJ.ReadWrite,i.depthRangeFor3D),u=i.useProgram("terrain"),h=r.getTerrainMesh(),c=r.getTerrainData(n.tileID);o.bindFramebuffer.set(null),o.viewport.set([0,0,i.width,i.height]),o.activeTexture.set(a.TEXTURE0),a.bindTexture(a.TEXTURE_2D,r.getRTTFramebuffer().colorAttachment.get());let d=i.transform.calculatePosMatrix(n.tileID.toUnwrapped());u.draw(o,a.TRIANGLES,l,eY.disabled,s,eQ.backCCW,{u_matrix:d,u_texture:0},c,"terrain",h.vertexBuffer,h.indexBuffer,h.segments)}function ia(i,r,n,o){let a=i.context,s=n.tileSize*r.qualityFactor;n.textures[o]||(n.textures[o]=i.getTileTexture(s)||new d(a,{width:s,height:s,data:null},a.gl.RGBA),n.textures[o].bind(a.gl.LINEAR,a.gl.CLAMP_TO_EDGE),0===o&&r.sourceCache.renderHistory.unshift(n.tileID.key));let l=r.getRTTFramebuffer();l.colorAttachment.set(n.textures[o].texture),a.bindFramebuffer.set(l.framebuffer),a.viewport.set([0,0,s,s])}class is{constructor(i){this._coordsDescendingInv={},this._coordsDescendingInvStr={},this.painter=i,this._renderToTexture={background:!0,fill:!0,line:!0,raster:!0},this._coordsDescendingInv={},this._coordsDescendingInvStr={},this._stacks=[],this._prevType=null,this._rerender={},this._renderableTiles=i.style.terrain.sourceCache.getRenderableTiles(),this._init()}_init(){let i=this.painter.style,r=i.terrain;for(let n in i.sourceCaches){this._coordsDescendingInv[n]={};let o=i.sourceCaches[n].getVisibleCoordinates();for(let i of o){let o=r.sourceCache.getTerrainCoords(i);for(let i in o)this._coordsDescendingInv[n][i]||(this._coordsDescendingInv[n][i]=[]),this._coordsDescendingInv[n][i].push(o[i])}}for(let r of i._order){let n=i._layers[r],o=n.source;if(this._renderToTexture[n.type]&&!this._coordsDescendingInvStr[o])for(let i in this._coordsDescendingInvStr[o]={},this._coordsDescendingInv[o])this._coordsDescendingInvStr[o][i]=this._coordsDescendingInv[o][i].map(i=>i.key).sort().join()}return this._renderableTiles.forEach(i=>{for(let n in this._coordsDescendingInvStr){let o=this._coordsDescendingInvStr[n][i.tileID.key];o&&o!==i.textureCoords[n]&&i.clearTextures(this.painter),r.needsRerender(n,i.tileID)&&i.clearTextures(this.painter)}this._rerender[i.tileID.key]=!i.textures.length}),r.clearRerenderCache(),r.sourceCache.removeOutdated(this.painter),this}renderLayer(r){let n=r.type,o=this.painter,a=o.style._order,s=o.currentLayer,l=s+1===a.length;if(this._renderToTexture[n]&&(this._prevType&&this._renderToTexture[this._prevType]||this._stacks.push([]),this._prevType=n,this._stacks[this._stacks.length-1].push(a[s]),!l))return!0;if(this._renderToTexture[this._prevType]||"hillshade"===n||this._renderToTexture[n]&&l){this._prevType=n;let l=this._stacks.length-1,u=this._stacks[l]||[];for(let r of this._renderableTiles){if(ia(o,o.style.terrain,r,l),this._rerender[r.tileID.key]){o.context.clear({color:i.Color.transparent});for(let i=0;i<u.length;i++){let n=o.style._layers[u[i]],a=n.source?this._coordsDescendingInv[n.source][r.tileID.key]:[r.tileID];o._renderTileClippingMasks(n,a),o.renderLayer(o,o.style.sourceCaches[n.source],n,a),n.source&&(r.textureCoords[n.source]=this._coordsDescendingInvStr[n.source][r.tileID.key])}}io(o,o.style.terrain,r)}if("hillshade"===n){for(let n of(this._stacks.push([a[s]]),this._renderableTiles)){let a=this._coordsDescendingInv[r.source][n.tileID.key];ia(o,o.style.terrain,n,this._stacks.length-1),o.context.clear({color:i.Color.transparent}),o._renderTileClippingMasks(r,a),o.renderLayer(o,o.style.sourceCaches[r.source],r,a),io(o,o.style.terrain,n)}return!0}return this._renderToTexture[n]}return!1}}let il={symbol:function(r,n,o,a,s){if("translucent"!==r.renderPass)return;let l=eY.disabled,u=r.colorModeForRenderPass();o.layout.get("text-variable-anchor")&&function(r,n,o,a,s,l,u){let h=n.transform,c="map"===s,d="map"===l;for(let s of r){let r=a.getTile(s),l=r.getBucket(o);if(!l||!l.text||!l.text.segments.get().length)continue;let p=i.evaluateSizeForZoom(l.textSizeData,h.zoom),f=tm(r,1,n.transform.zoom),m=ti(s.posMatrix,d,c,n.transform,f),g="none"!==o.layout.get("icon-text-fit")&&l.hasIconData();if(p){let o=Math.pow(2,h.zoom-r.tileID.overscaledZ);(function(r,n,o,a,s,l,u,h,c,d,p){let f=r.text.placedSymbolArray,m=r.text.dynamicLayoutVertexArray,g=r.icon.dynamicLayoutVertexArray,_={};m.clear();for(let g=0;g<f.length;g++){let y=f.get(g),v=r.allowVerticalPlacement&&!y.placedOrientation,x=y.hidden||!y.crossTileID||v?null:a[y.crossTileID];if(x){let a=new i.pointGeometry(y.anchorX,y.anchorY),f=tn(a,o?u:l,p),g=to(s.cameraToCenterDistance,f.signedDistanceFromCamera),v=i.evaluateSizeForFeature(r.textSizeData,c,y)*g/i.ONE_EM;o&&(v*=r.tilePixelRatio/h);let{width:b,height:w,anchor:T,textOffset:E,textBoxScale:S}=x,C=function(r,n,o,a,s,l){let{horizontalAlign:u,verticalAlign:h}=i.getAnchorAlignment(r),c=i.evaluateVariableOffset(r,a);return new i.pointGeometry((-(u-.5)*n/s+c[0])*l,(-(h-.5)*o/s+c[1])*l)}(T,b,w,E,S,v),I=o?tn(a.add(C),l,p).point:f.point.add(n?C.rotate(-s.angle):C),A=r.allowVerticalPlacement&&y.placedOrientation===i.WritingMode.vertical?Math.PI/2:0;for(let r=0;r<y.numGlyphs;r++)i.addDynamicAttributes(m,I,A);d&&y.associatedIconIndex>=0&&(_[y.associatedIconIndex]={shiftedAnchor:I,angle:A})}else td(y.numGlyphs,m)}if(d){g.clear();let n=r.icon.placedSymbolArray;for(let r=0;r<n.length;r++){let o=n.get(r);if(o.hidden)td(o.numGlyphs,g);else{let n=_[r];if(n)for(let r=0;r<o.numGlyphs;r++)i.addDynamicAttributes(g,n.shiftedAnchor,n.angle);else td(o.numGlyphs,g)}}r.icon.dynamicLayoutVertexBuffer.updateData(g)}r.text.dynamicLayoutVertexBuffer.updateData(m)})(l,c,d,u,h,m,s.posMatrix,o,p,g,n.style.terrain?(i,r)=>n.style.terrain.getElevation(s,i,r):null)}}}(a,r,o,n,o.layout.get("text-rotation-alignment"),o.layout.get("text-pitch-alignment"),s),0!==o.paint.get("icon-opacity").constantOr(1)&&e2(r,n,o,a,!1,o.paint.get("icon-translate"),o.paint.get("icon-translate-anchor"),o.layout.get("icon-rotation-alignment"),o.layout.get("icon-pitch-alignment"),o.layout.get("icon-keep-upright"),l,u),0!==o.paint.get("text-opacity").constantOr(1)&&e2(r,n,o,a,!0,o.paint.get("text-translate"),o.paint.get("text-translate-anchor"),o.layout.get("text-rotation-alignment"),o.layout.get("text-pitch-alignment"),o.layout.get("text-keep-upright"),l,u),n.map.showCollisionBoxes&&(e0(r,n,o,a,o.paint.get("text-translate"),o.paint.get("text-translate-anchor"),!0),e0(r,n,o,a,o.paint.get("icon-translate"),o.paint.get("icon-translate-anchor"),!1))},circle:function(r,n,o,a){if("translucent"!==r.renderPass)return;let s=o.paint.get("circle-opacity"),l=o.paint.get("circle-stroke-width"),u=o.paint.get("circle-stroke-opacity"),h=!o.layout.get("circle-sort-key").isConstant();if(0===s.constantOr(1)&&(0===l.constantOr(1)||0===u.constantOr(1)))return;let c=r.context,d=c.gl,p=r.depthModeForSublayer(0,eJ.ReadOnly),f=eY.disabled,m=r.colorModeForRenderPass(),g=[];for(let s=0;s<a.length;s++){let l=a[s],u=n.getTile(l),c=u.getBucket(o);if(!c)continue;let d=c.programConfigurations.get(o.id),p=r.useProgram("circle",d),f=c.layoutVertexBuffer,m=c.indexBuffer,_=r.style.terrain&&r.style.terrain.getTerrainData(l),y={programConfiguration:d,program:p,layoutVertexBuffer:f,indexBuffer:m,uniformValues:t2(r,l,u,o),terrainData:_};if(h){let r=c.segments.get();for(let n of r)g.push({segments:new i.SegmentVector([n]),sortKey:n.sortKey,state:y})}else g.push({segments:c.segments,sortKey:0,state:y})}for(let i of(h&&g.sort((i,r)=>i.sortKey-r.sortKey),g)){let{programConfiguration:n,program:a,layoutVertexBuffer:s,indexBuffer:l,uniformValues:u,terrainData:h}=i.state;a.draw(c,d.TRIANGLES,p,f,m,eQ.disabled,u,h,o.id,s,l,i.segments,o.paint,r.transform.zoom,n)}},heatmap:function(r,n,o,a){if(0!==o.paint.get("heatmap-opacity")){if("offscreen"===r.renderPass){let s=r.context,l=s.gl,u=eY.disabled,h=new eX([l.ONE,l.ONE],i.Color.transparent,[!0,!0,!0,!0]);(function(i,r,n){let o=i.gl;i.activeTexture.set(o.TEXTURE1),i.viewport.set([0,0,r.width/4,r.height/4]);let a=n.heatmapFbo;if(a)o.bindTexture(o.TEXTURE_2D,a.colorAttachment.get()),i.bindFramebuffer.set(a.framebuffer);else{let s=o.createTexture();o.bindTexture(o.TEXTURE_2D,s),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_S,o.CLAMP_TO_EDGE),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_T,o.CLAMP_TO_EDGE),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MIN_FILTER,o.LINEAR),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MAG_FILTER,o.LINEAR),a=n.heatmapFbo=i.createFramebuffer(r.width/4,r.height/4,!1),function(i,r,n,o){let a=i.gl;a.texImage2D(a.TEXTURE_2D,0,a.RGBA,r.width/4,r.height/4,0,a.RGBA,i.extRenderToTextureHalfFloat?i.extTextureHalfFloat.HALF_FLOAT_OES:a.UNSIGNED_BYTE,null),o.colorAttachment.set(n)}(i,r,s,a)}})(s,r,o),s.clear({color:i.Color.transparent});for(let i=0;i<a.length;i++){let c=a[i];if(n.hasRenderableParent(c))continue;let d=n.getTile(c),p=d.getBucket(o);if(!p)continue;let f=p.programConfigurations.get(o.id),m=r.useProgram("heatmap",f),{zoom:g}=r.transform;m.draw(s,l.TRIANGLES,eJ.disabled,u,h,eQ.disabled,t6(c.posMatrix,d,g,o.paint.get("heatmap-intensity")),null,o.id,p.layoutVertexBuffer,p.indexBuffer,p.segments,o.paint,r.transform.zoom,f)}s.viewport.set([0,0,r.width,r.height])}else"translucent"===r.renderPass&&(r.context.setColorMode(r.colorModeForRenderPass()),function(r,n){let o=r.context,a=o.gl,s=n.heatmapFbo;if(!s)return;o.activeTexture.set(a.TEXTURE0),a.bindTexture(a.TEXTURE_2D,s.colorAttachment.get()),o.activeTexture.set(a.TEXTURE1);let l=n.colorRampTexture;l||(l=n.colorRampTexture=new d(o,n.colorRamp,a.RGBA)),l.bind(a.LINEAR,a.CLAMP_TO_EDGE),r.useProgram("heatmapTexture").draw(o,a.TRIANGLES,eJ.disabled,eY.disabled,r.colorModeForRenderPass(),eQ.disabled,((r,n,o,a)=>{let s=i.create();i.ortho(s,0,r.width,r.height,0,0,1);let l=r.context.gl;return{u_matrix:s,u_world:[l.drawingBufferWidth,l.drawingBufferHeight],u_image:0,u_color_ramp:1,u_opacity:n.paint.get("heatmap-opacity")}})(r,n),null,n.id,r.viewportBuffer,r.quadTriangleIndexBuffer,r.viewportSegments,n.paint,r.transform.zoom)}(r,o))}},line:function(r,n,o,a){if("translucent"!==r.renderPass)return;let s=o.paint.get("line-opacity"),l=o.paint.get("line-width");if(0===s.constantOr(1)||0===l.constantOr(1))return;let u=r.depthModeForSublayer(0,eJ.ReadOnly),h=r.colorModeForRenderPass(),c=o.paint.get("line-dasharray"),p=o.paint.get("line-pattern"),f=p.constantOr(1),m=o.paint.get("line-gradient"),g=o.getCrossfadeParameters(),_=f?"linePattern":c?"lineSDF":m?"lineGradient":"line",y=r.context,v=y.gl,x=!0;for(let s of a){let a=n.getTile(s);if(f&&!a.patternsLoaded())continue;let l=a.getBucket(o);if(!l)continue;let b=l.programConfigurations.get(o.id),w=r.context.program.get(),T=r.useProgram(_,b),E=x||T.program!==w,S=r.style.terrain&&r.style.terrain.getTerrainData(s),C=p.constantOr(null);if(C&&a.imageAtlas){let i=a.imageAtlas,r=i.patternPositions[C.to.toString()],n=i.patternPositions[C.from.toString()];r&&n&&b.setConstantPatternPositions(r,n)}let I=S?s:null,A=f?t7(r,a,o,g,I):c?et(r,a,o,c,g,I):m?t9(r,a,o,l.lineClipsArray.length,I):t8(r,a,o,I);if(f)y.activeTexture.set(v.TEXTURE0),a.imageAtlasTexture.bind(v.LINEAR,v.CLAMP_TO_EDGE),b.updatePaintBuffers(g);else if(c&&(E||r.lineAtlas.dirty))y.activeTexture.set(v.TEXTURE0),r.lineAtlas.bind(y);else if(m){let a=l.gradients[o.id],u=a.texture;if(o.gradientVersion!==a.version){let h=256;if(o.stepInterpolant){let o=n.getSource().maxzoom,a=s.canonical.z===o?Math.ceil(1<<r.transform.maxZoom-s.canonical.z):1;h=i.clamp(i.nextPowerOfTwo(l.maxLineLength/i.EXTENT*1024*a),256,y.maxTextureSize)}a.gradient=i.renderColorRamp({expression:o.gradientExpression(),evaluationKey:"lineProgress",resolution:h,image:a.gradient||void 0,clips:l.lineClipsArray}),a.texture?a.texture.update(a.gradient):a.texture=new d(y,a.gradient,v.RGBA),a.version=o.gradientVersion,u=a.texture}y.activeTexture.set(v.TEXTURE0),u.bind(o.stepInterpolant?v.NEAREST:v.LINEAR,v.CLAMP_TO_EDGE)}T.draw(y,v.TRIANGLES,u,r.stencilModeForClipping(s),h,eQ.disabled,A,S,o.id,l.layoutVertexBuffer,l.indexBuffer,l.segments,o.paint,r.transform.zoom,b,l.layoutVertexBuffer2),x=!1}},fill:function(r,n,o,a){let s=o.paint.get("fill-color"),l=o.paint.get("fill-opacity");if(0===l.constantOr(1))return;let u=r.colorModeForRenderPass(),h=o.paint.get("fill-pattern"),c=r.opaquePassEnabledForLayer()&&!h.constantOr(1)&&1===s.constantOr(i.Color.transparent).a&&1===l.constantOr(0)?"opaque":"translucent";if(r.renderPass===c){let i=r.depthModeForSublayer(1,"opaque"===r.renderPass?eJ.ReadWrite:eJ.ReadOnly);e5(r,n,o,a,i,u,!1)}if("translucent"===r.renderPass&&o.paint.get("fill-antialias")){let i=r.depthModeForSublayer(o.getPaintProperty("fill-outline-color")?2:0,eJ.ReadOnly);e5(r,n,o,a,i,u,!0)}},"fill-extrusion":function(i,r,n,o){let a=n.paint.get("fill-extrusion-opacity");if(0!==a&&"translucent"===i.renderPass){let s=new eJ(i.context.gl.LEQUAL,eJ.ReadWrite,i.depthRangeFor3D);if(1!==a||n.paint.get("fill-extrusion-pattern").constantOr(1))e4(i,r,n,o,s,eY.disabled,eX.disabled),e4(i,r,n,o,s,i.stencilModeFor3D(),i.colorModeForRenderPass());else{let a=i.colorModeForRenderPass();e4(i,r,n,o,s,eY.disabled,a)}}},hillshade:function(r,n,o,a){if("offscreen"!==r.renderPass&&"translucent"!==r.renderPass)return;let s=r.context,l=r.depthModeForSublayer(0,eJ.ReadOnly),u=r.colorModeForRenderPass(),[h,c]="translucent"===r.renderPass?r.stencilConfigForOverlap(a):[{},a];for(let a of c){let s=n.getTile(a);void 0!==s.needsHillshadePrepare&&s.needsHillshadePrepare&&"offscreen"===r.renderPass?function(r,n,o,a,s,l){let u=r.context,h=u.gl,c=n.dem;if(c&&c.data){let p=c.dim,f=c.stride,m=c.getPixels();if(u.activeTexture.set(h.TEXTURE1),u.pixelStoreUnpackPremultiplyAlpha.set(!1),n.demTexture=n.demTexture||r.getTileTexture(f),n.demTexture){let i=n.demTexture;i.update(m,{premultiply:!1}),i.bind(h.NEAREST,h.CLAMP_TO_EDGE)}else n.demTexture=new d(u,m,h.RGBA,{premultiply:!1}),n.demTexture.bind(h.NEAREST,h.CLAMP_TO_EDGE);u.activeTexture.set(h.TEXTURE0);let g=n.fbo;if(!g){let i=new d(u,{width:p,height:p,data:null},h.RGBA);i.bind(h.LINEAR,h.CLAMP_TO_EDGE),(g=n.fbo=u.createFramebuffer(p,p,!0)).colorAttachment.set(i.texture)}u.bindFramebuffer.set(g.framebuffer),u.viewport.set([0,0,p,p]),r.useProgram("hillshadePrepare").draw(u,h.TRIANGLES,a,s,l,eQ.disabled,((r,n)=>{let o=n.stride,a=i.create();return i.ortho(a,0,i.EXTENT,-i.EXTENT,0,0,1),i.translate(a,a,[0,-i.EXTENT,0]),{u_matrix:a,u_image:1,u_dimension:[o,o],u_zoom:r.overscaledZ,u_unpack:n.getUnpackVector()}})(n.tileID,c),null,o.id,r.rasterBoundsBuffer,r.quadTriangleIndexBuffer,r.rasterBoundsSegments),n.needsHillshadePrepare=!1}}(r,s,o,l,eY.disabled,u):"translucent"===r.renderPass&&function(r,n,o,a,s,l,u){let h=r.context,c=h.gl,d=o.fbo;if(!d)return;let p=r.useProgram("hillshade"),f=r.style.terrain&&r.style.terrain.getTerrainData(n);h.activeTexture.set(c.TEXTURE0),c.bindTexture(c.TEXTURE_2D,d.colorAttachment.get()),p.draw(h,c.TRIANGLES,s,l,u,eQ.disabled,((r,n,o,a)=>{let s=o.paint.get("hillshade-shadow-color"),l=o.paint.get("hillshade-highlight-color"),u=o.paint.get("hillshade-accent-color"),h=o.paint.get("hillshade-illumination-direction")*(Math.PI/180);"viewport"===o.paint.get("hillshade-illumination-anchor")&&(h-=r.transform.angle);let c=!r.options.moving;return{u_matrix:a?a.posMatrix:r.transform.calculatePosMatrix(n.tileID.toUnwrapped(),c),u_image:0,u_latrange:function(r,n){let o=Math.pow(2,n.canonical.z),a=n.canonical.y;return[new i.MercatorCoordinate(0,a/o).toLngLat().lat,new i.MercatorCoordinate(0,(a+1)/o).toLngLat().lat]}(0,n.tileID),u_light:[o.paint.get("hillshade-exaggeration"),h],u_shadow:s,u_highlight:l,u_accent:u}})(r,o,a,f?n:null),f,a.id,r.rasterBoundsBuffer,r.quadTriangleIndexBuffer,r.rasterBoundsSegments)}(r,a,s,o,l,h[a.overscaledZ],u)}s.viewport.set([0,0,r.width,r.height])},raster:function(r,n,o,a){if("translucent"!==r.renderPass||0===o.paint.get("raster-opacity")||!a.length)return;let s=r.context,l=s.gl,u=n.getSource(),h=r.useProgram("raster"),c=r.colorModeForRenderPass(),[d,p]=u instanceof P?[{},a]:r.stencilConfigForOverlap(a),f=p[p.length-1].overscaledZ,m=!r.options.moving;for(let a of p){let p,g;let _=r.depthModeForSublayer(a.overscaledZ-f,1===o.paint.get("raster-opacity")?eJ.ReadWrite:eJ.ReadOnly,l.LESS),y=n.getTile(a);y.registerFadeDuration(o.paint.get("raster-fade-duration"));let v=n.findLoadedParent(a,0),x=function(r,n,o,a,s,l){let u=a.paint.get("raster-fade-duration");if(!l&&u>0){let a=i.exported.now(),l=(a-r.timeAdded)/u,h=n?(a-n.timeAdded)/u:-1,c=o.getSource(),d=s.coveringZoomLevel({tileSize:c.tileSize,roundZoom:c.roundZoom}),p=!n||Math.abs(n.tileID.overscaledZ-d)>Math.abs(r.tileID.overscaledZ-d),f=p&&r.refreshedUponExpiration?1:i.clamp(p?l:1-h,0,1);return r.refreshedUponExpiration&&l>=1&&(r.refreshedUponExpiration=!1),n?{opacity:1,mix:1-f}:{opacity:f,mix:0}}return{opacity:1,mix:0}}(y,v,n,o,r.transform,r.style.terrain),b="nearest"===o.paint.get("raster-resampling")?l.NEAREST:l.LINEAR;s.activeTexture.set(l.TEXTURE0),y.texture.bind(b,l.CLAMP_TO_EDGE,l.LINEAR_MIPMAP_NEAREST),s.activeTexture.set(l.TEXTURE1),v?(v.texture.bind(b,l.CLAMP_TO_EDGE,l.LINEAR_MIPMAP_NEAREST),p=Math.pow(2,v.tileID.overscaledZ-y.tileID.overscaledZ),g=[y.tileID.canonical.x*p%1,y.tileID.canonical.y*p%1]):y.texture.bind(b,l.CLAMP_TO_EDGE,l.LINEAR_MIPMAP_NEAREST);let w=r.style.terrain&&r.style.terrain.getTerrainData(a),T=w?a:null,E=T?T.posMatrix:r.transform.calculatePosMatrix(a.toUnwrapped(),m),S=er(E,g||[0,0],p||1,x,o);u instanceof P?h.draw(s,l.TRIANGLES,_,eY.disabled,c,eQ.disabled,S,w,o.id,u.boundsBuffer,r.quadTriangleIndexBuffer,u.boundsSegments):h.draw(s,l.TRIANGLES,_,d[a.overscaledZ],c,eQ.disabled,S,w,o.id,r.rasterBoundsBuffer,r.quadTriangleIndexBuffer,r.rasterBoundsSegments)}},background:function(i,r,n,o){let a=n.paint.get("background-color"),s=n.paint.get("background-opacity");if(0===s)return;let l=i.context,u=l.gl,h=i.transform,c=h.tileSize,d=n.paint.get("background-pattern");if(i.isPatternMissing(d))return;let p=!d&&1===a.a&&1===s&&i.opaquePassEnabledForLayer()?"opaque":"translucent";if(i.renderPass!==p)return;let f=eY.disabled,m=i.depthModeForSublayer(0,"opaque"===p?eJ.ReadWrite:eJ.ReadOnly),g=i.colorModeForRenderPass(),_=i.useProgram(d?"backgroundPattern":"background"),y=o||h.coveringTiles({tileSize:c,terrain:i.style.terrain});d&&(l.activeTexture.set(u.TEXTURE0),i.imageManager.bind(i.context));let v=n.getCrossfadeParameters();for(let r of y){let h=o?r.posMatrix:i.transform.calculatePosMatrix(r.toUnwrapped()),p=d?el(h,s,i,d,{tileID:r,tileSize:c},v):es(h,s,a),y=i.style.terrain&&i.style.terrain.getTerrainData(r);_.draw(l,u.TRIANGLES,m,f,g,eQ.disabled,p,y,n.id,i.tileExtentBuffer,i.quadTriangleIndexBuffer,i.tileExtentSegments)}},debug:function(r,n,o){for(let a=0;a<o.length;a++)!function(r,n,o){let a=r.context,s=a.gl,l=o.posMatrix,u=r.useProgram("debug"),h=eJ.disabled,c=eY.disabled,d=r.colorModeForRenderPass(),p="$debug",f=r.style.terrain&&r.style.terrain.getTerrainData(o);a.activeTexture.set(s.TEXTURE0),r.emptyTexture.bind(s.LINEAR,s.CLAMP_TO_EDGE);let m=n.getTileByID(o.key).latestRawTileData,g=Math.floor((m&&m.byteLength||0)/1024),_=n.getTile(o).tileSize,y=512/Math.min(_,512)*(o.overscaledZ/r.transform.zoom)*.5,v=o.canonical.toString();o.overscaledZ!==o.canonical.z&&(v+=` => ${o.overscaledZ}`),function(i,r){i.initDebugOverlayCanvas();let n=i.debugOverlayCanvas,o=i.context.gl,a=i.debugOverlayCanvas.getContext("2d");a.clearRect(0,0,n.width,n.height),a.shadowColor="white",a.shadowBlur=2,a.lineWidth=1.5,a.strokeStyle="white",a.textBaseline="top",a.font="bold 36px Open Sans, sans-serif",a.fillText(r,5,5),a.strokeText(r,5,5),i.debugOverlayTexture.update(n),i.debugOverlayTexture.bind(o.LINEAR,o.CLAMP_TO_EDGE)}(r,`${v} ${g}kB`),u.draw(a,s.TRIANGLES,h,c,eX.alphaBlended,eQ.disabled,t5(l,i.Color.transparent,y),null,p,r.debugBuffer,r.quadTriangleIndexBuffer,r.debugSegments),u.draw(a,s.LINE_STRIP,h,c,d,eQ.disabled,t5(l,i.Color.red),f,p,r.debugBuffer,r.tileBorderIndexBuffer,r.debugSegments)}(r,n,o[a])},custom:function(i,r,n){let o=i.context,a=n.implementation;if("offscreen"===i.renderPass){let r=a.prerender;r&&(i.setCustomLayerDefaults(),o.setColorMode(i.colorModeForRenderPass()),r.call(a,o.gl,i.transform.customLayerMatrix()),o.setDirty(),i.setBaseState())}else if("translucent"===i.renderPass){i.setCustomLayerDefaults(),o.setColorMode(i.colorModeForRenderPass()),o.setStencilMode(eY.disabled);let r="3d"===a.renderingMode?new eJ(i.context.gl.LEQUAL,eJ.ReadWrite,i.depthRangeFor3D):i.depthModeForSublayer(0,eJ.ReadOnly);o.setDepthMode(r),a.render(o.gl,i.transform.customLayerMatrix()),o.setDirty(),i.setBaseState(),o.bindFramebuffer.set(null)}}};class iu{constructor(r,n){this.context=new eK(r),this.transform=n,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:i.create(),renderTime:0},this.setup(),this.numSublayers=F.maxUnderzooming+F.maxOverzooming+1,this.depthEpsilon=1/65536,this.crossTileSymbolIndex=new tD,this.gpuTimers={}}resize(i,r,n){if(this.width=i*n,this.height=r*n,this.pixelRatio=n,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(let i of this.style._order)this.style._layers[i].resize()}setup(){let r=this.context,n=new i.PosArray;n.emplaceBack(0,0),n.emplaceBack(i.EXTENT,0),n.emplaceBack(0,i.EXTENT),n.emplaceBack(i.EXTENT,i.EXTENT),this.tileExtentBuffer=r.createVertexBuffer(n,tR.members),this.tileExtentSegments=i.SegmentVector.simpleSegment(0,0,4,2);let o=new i.PosArray;o.emplaceBack(0,0),o.emplaceBack(i.EXTENT,0),o.emplaceBack(0,i.EXTENT),o.emplaceBack(i.EXTENT,i.EXTENT),this.debugBuffer=r.createVertexBuffer(o,tR.members),this.debugSegments=i.SegmentVector.simpleSegment(0,0,4,5);let a=new i.RasterBoundsArray;a.emplaceBack(0,0,0,0),a.emplaceBack(i.EXTENT,0,i.EXTENT,0),a.emplaceBack(0,i.EXTENT,0,i.EXTENT),a.emplaceBack(i.EXTENT,i.EXTENT,i.EXTENT,i.EXTENT),this.rasterBoundsBuffer=r.createVertexBuffer(a,A.members),this.rasterBoundsSegments=i.SegmentVector.simpleSegment(0,0,4,2);let s=new i.PosArray;s.emplaceBack(0,0),s.emplaceBack(1,0),s.emplaceBack(0,1),s.emplaceBack(1,1),this.viewportBuffer=r.createVertexBuffer(s,tR.members),this.viewportSegments=i.SegmentVector.simpleSegment(0,0,4,2);let l=new i.LineStripIndexArray;l.emplaceBack(0),l.emplaceBack(1),l.emplaceBack(3),l.emplaceBack(2),l.emplaceBack(0),this.tileBorderIndexBuffer=r.createIndexBuffer(l);let u=new i.TriangleIndexArray;u.emplaceBack(0,1,2),u.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=r.createIndexBuffer(u),this.emptyTexture=new d(r,{width:1,height:1,data:new Uint8Array([0,0,0,0])},r.gl.RGBA);let h=this.context.gl;this.stencilClearMode=new eY({func:h.ALWAYS,mask:0},0,255,h.ZERO,h.ZERO,h.ZERO)}clearStencil(){let r=this.context,n=r.gl;this.nextStencilID=1,this.currentStencilSource=void 0;let o=i.create();i.ortho(o,0,this.width,this.height,0,0,1),i.scale(o,o,[n.drawingBufferWidth,n.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(r,n.TRIANGLES,eJ.disabled,this.stencilClearMode,eX.disabled,eQ.disabled,t4(o),null,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(i,r){if(this.currentStencilSource===i.source||!i.isTileClipped()||!r||!r.length)return;this.currentStencilSource=i.source;let n=this.context,o=n.gl;this.nextStencilID+r.length>256&&this.clearStencil(),n.setColorMode(eX.disabled),n.setDepthMode(eJ.disabled);let a=this.useProgram("clippingMask");for(let i of(this._tileClippingMaskIDs={},r)){let r=this._tileClippingMaskIDs[i.key]=this.nextStencilID++,s=this.style.terrain&&this.style.terrain.getTerrainData(i);a.draw(n,o.TRIANGLES,eJ.disabled,new eY({func:o.ALWAYS,mask:0},r,255,o.KEEP,o.KEEP,o.REPLACE),eX.disabled,eQ.disabled,t4(i.posMatrix),s,"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();let i=this.nextStencilID++,r=this.context.gl;return new eY({func:r.NOTEQUAL,mask:255},i,255,r.KEEP,r.KEEP,r.REPLACE)}stencilModeForClipping(i){let r=this.context.gl;return new eY({func:r.EQUAL,mask:255},this._tileClippingMaskIDs[i.key],0,r.KEEP,r.KEEP,r.REPLACE)}stencilConfigForOverlap(i){let r=this.context.gl,n=i.sort((i,r)=>r.overscaledZ-i.overscaledZ),o=n[n.length-1].overscaledZ,a=n[0].overscaledZ-o+1;if(a>1){this.currentStencilSource=void 0,this.nextStencilID+a>256&&this.clearStencil();let i={};for(let n=0;n<a;n++)i[n+o]=new eY({func:r.GEQUAL,mask:255},n+this.nextStencilID,255,r.KEEP,r.KEEP,r.REPLACE);return this.nextStencilID+=a,[i,n]}return[{[o]:eY.disabled},n]}colorModeForRenderPass(){let r=this.context.gl;if(this._showOverdrawInspector){let n=1/8;return new eX([r.CONSTANT_COLOR,r.ONE],new i.Color(n,n,n,0),[!0,!0,!0,!0])}return"opaque"===this.renderPass?eX.unblended:eX.alphaBlended}depthModeForSublayer(i,r,n){if(!this.opaquePassEnabledForLayer())return eJ.disabled;let o=1-((1+this.currentLayer)*this.numSublayers+i)*this.depthEpsilon;return new eJ(n||this.context.gl.LEQUAL,r,[o,o])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(r,n){this.style=r,this.options=n,this.lineAtlas=r.lineAtlas,this.imageManager=r.imageManager,this.glyphManager=r.glyphManager,this.symbolFadeChange=r.placement.symbolFadeChange(i.exported.now()),this.imageManager.beginFrame();let o=this.style._order,a=this.style.sourceCaches,s=this.style.terrain&&new is(this);for(let i in a){let r=a[i];r.used&&r.prepare(this.context)}let l={},u={},h={};for(let i in a){let r=a[i];l[i]=r.getVisibleCoordinates(),u[i]=l[i].slice().reverse(),h[i]=r.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let i=0;i<o.length;i++)if(this.style._layers[o[i]].is3D()){this.opaquePassCutoff=i;break}if(s){this.opaquePassCutoff=0;let r=this.style.terrain.sourceCache.tilesAfterTime(this.terrainFacilitator.renderTime);(this.terrainFacilitator.dirty||!i.equals(this.terrainFacilitator.matrix,this.transform.projMatrix)||r.length)&&(i.copy(this.terrainFacilitator.matrix,this.transform.projMatrix),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,function(r,n){let o=r.context,a=o.gl,s=eX.unblended,l=new eJ(a.LEQUAL,eJ.ReadWrite,[0,1]),u=n.getTerrainMesh(),h=n.sourceCache.getRenderableTiles(),c=r.useProgram("terrainDepth");for(let d of(o.bindFramebuffer.set(n.getFramebuffer("depth").framebuffer),o.viewport.set([0,0,r.width/devicePixelRatio,r.height/devicePixelRatio]),o.clear({color:i.Color.transparent,depth:1}),h)){let i=n.getTerrainData(d.tileID),h=r.transform.calculatePosMatrix(d.tileID.toUnwrapped());c.draw(o,a.TRIANGLES,l,eY.disabled,s,eQ.backCCW,{u_matrix:h},i,"terrain",u.vertexBuffer,u.indexBuffer,u.segments)}o.bindFramebuffer.set(null),o.viewport.set([0,0,r.width,r.height])}(this,this.style.terrain),function(r,n){let o=r.context,a=o.gl,s=eX.unblended,l=new eJ(a.LEQUAL,eJ.ReadWrite,[0,1]),u=n.getTerrainMesh(),h=n.getCoordsTexture(),c=n.sourceCache.getRenderableTiles(),d=r.useProgram("terrainCoords");for(let p of(o.bindFramebuffer.set(n.getFramebuffer("coords").framebuffer),o.viewport.set([0,0,r.width/devicePixelRatio,r.height/devicePixelRatio]),o.clear({color:i.Color.transparent,depth:1}),n.coordsIndex=[],c)){let i=n.getTerrainData(p.tileID);o.activeTexture.set(a.TEXTURE0),a.bindTexture(a.TEXTURE_2D,h.texture);let c=r.transform.calculatePosMatrix(p.tileID.toUnwrapped());d.draw(o,a.TRIANGLES,l,eY.disabled,s,eQ.backCCW,{u_matrix:c,u_terrain_coords_id:(255-n.coordsIndex.length)/255,u_texture:0},i,"terrain",u.vertexBuffer,u.indexBuffer,u.segments),n.coordsIndex.push(p.tileID.key)}o.bindFramebuffer.set(null),o.viewport.set([0,0,r.width,r.height])}(this,this.style.terrain))}for(let i of(this.renderPass="offscreen",o)){let r=this.style._layers[i];if(!r.hasOffscreenPass()||r.isHidden(this.transform.zoom))continue;let n=u[r.source];("custom"===r.type||n.length)&&this.renderLayer(this,a[r.source],r,n)}if(this.context.bindFramebuffer.set(null),this.context.clear({color:n.showOverdrawInspector?i.Color.black:i.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=n.showOverdrawInspector,this.depthRangeFor3D=[0,1-(r._order.length+2)*this.numSublayers*this.depthEpsilon],!s)for(this.renderPass="opaque",this.currentLayer=o.length-1;this.currentLayer>=0;this.currentLayer--){let i=this.style._layers[o[this.currentLayer]],r=a[i.source],n=l[i.source];this._renderTileClippingMasks(i,n),this.renderLayer(this,r,i,n)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<o.length;this.currentLayer++){let i=this.style._layers[o[this.currentLayer]],r=a[i.source];if(s&&s.renderLayer(i))continue;let n=("symbol"===i.type?h:u)[i.source];this._renderTileClippingMasks(i,l[i.source]),this.renderLayer(this,r,i,n)}if(this.options.showTileBoundaries){let i,r;Object.values(this.style._layers).forEach(n=>{n.source&&!n.isHidden(this.transform.zoom)&&(n.source!==(r&&r.id)&&(r=this.style.sourceCaches[n.source]),(!i||i.getSource().maxzoom<r.getSource().maxzoom)&&(i=r))}),i&&il.debug(this,i,i.getVisibleCoordinates())}this.options.showPadding&&function(i){var r,n;let o=i.transform.padding;ie(i,i.transform.height-(o.top||0),3,e6),ie(i,o.bottom||0,3,e8),ii(i,o.left||0,3,e9),ii(i,i.transform.width-(o.right||0),3,e7);let a=i.transform.centerPoint;r=a.x,n=i.transform.height-a.y,ir(i,r-1,n-10,2,20,it),ir(i,r-10,n-1,20,2,it)}(this),this.context.setDefault()}renderLayer(i,r,n,o){n.isHidden(this.transform.zoom)||("background"===n.type||"custom"===n.type||(o||[]).length)&&(this.id=n.id,this.gpuTimingStart(n),il[n.type](i,r,n,o,this.style.placement.variableOffsets),this.gpuTimingEnd())}gpuTimingStart(i){if(!this.options.gpuTiming)return;let r=this.context.extTimerQuery,n=this.gpuTimers[i.id];n||(n=this.gpuTimers[i.id]={calls:0,cpuTime:0,query:r.createQueryEXT()}),n.calls++,r.beginQueryEXT(r.TIME_ELAPSED_EXT,n.query)}gpuTimingEnd(){if(!this.options.gpuTiming)return;let i=this.context.extTimerQuery;i.endQueryEXT(i.TIME_ELAPSED_EXT)}collectGpuTimers(){let i=this.gpuTimers;return this.gpuTimers={},i}queryGpuTimers(i){let r={};for(let n in i){let o=i[n],a=this.context.extTimerQuery,s=a.getQueryObjectEXT(o.query,a.QUERY_RESULT_EXT)/1e6;a.deleteQueryEXT(o.query),r[n]=s}return r}translatePosMatrix(r,n,o,a,s){if(!o[0]&&!o[1])return r;let l=s?"map"===a?this.transform.angle:0:"viewport"===a?-this.transform.angle:0;if(l){let i=Math.sin(l),r=Math.cos(l);o=[o[0]*r-o[1]*i,o[0]*i+o[1]*r]}let u=[s?o[0]:tm(n,o[0],this.transform.zoom),s?o[1]:tm(n,o[1],this.transform.zoom),0],h=new Float32Array(16);return i.translate(h,r,u),h}saveTileTexture(i){let r=this._tileTextures[i.size[0]];r?r.push(i):this._tileTextures[i.size[0]]=[i]}getTileTexture(i){let r=this._tileTextures[i];return r&&r.length>0?r.pop():null}isPatternMissing(i){if(!i)return!1;if(!i.from||!i.to)return!0;let r=this.imageManager.getPattern(i.from.toString()),n=this.imageManager.getPattern(i.to.toString());return!r||!n}useProgram(i,r){this.cache=this.cache||{};let n=i+(r?r.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"")+(this.style.terrain?"/terrain":"");return this.cache[n]||(this.cache[n]=new tH(this.context,i,tq[i],r,eu[i],this._showOverdrawInspector,this.style.terrain)),this.cache[n]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){let i=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(i.FUNC_ADD)}initDebugOverlayCanvas(){null==this.debugOverlayCanvas&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new d(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}}class ih{constructor(i,r){this.points=i,this.planes=r}static fromInvProjectionMatrix(r,n,o){let a=Math.pow(2,o),s=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(o=>{let s=1/(o=i.transformMat4([],o,r))[3]/n*a;return i.mul$1(o,o,[s,s,1/o[3],s])}),l=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(r=>{let n=i.sub([],s[r[0]],s[r[1]]),o=i.sub([],s[r[2]],s[r[1]]),a=i.normalize([],i.cross([],n,o)),l=-i.dot(a,s[r[1]]);return a.concat(l)});return new ih(s,l)}}class ic{constructor(r,n){this.min=r,this.max=n,this.center=i.scale$1([],i.add([],this.min,this.max),.5)}quadrant(r){let n=[r%2==0,r<2],o=i.clone$2(this.min),a=i.clone$2(this.max);for(let i=0;i<n.length;i++)o[i]=n[i]?this.min[i]:this.center[i],a[i]=n[i]?this.center[i]:this.max[i];return a[2]=this.max[2],new ic(o,a)}distanceX(i){return Math.max(Math.min(this.max[0],i[0]),this.min[0])-i[0]}distanceY(i){return Math.max(Math.min(this.max[1],i[1]),this.min[1])-i[1]}intersects(r){let n=[[this.min[0],this.min[1],this.min[2],1],[this.max[0],this.min[1],this.min[2],1],[this.max[0],this.max[1],this.min[2],1],[this.min[0],this.max[1],this.min[2],1],[this.min[0],this.min[1],this.max[2],1],[this.max[0],this.min[1],this.max[2],1],[this.max[0],this.max[1],this.max[2],1],[this.min[0],this.max[1],this.max[2],1]],o=!0;for(let a=0;a<r.planes.length;a++){let s=r.planes[a],l=0;for(let r=0;r<n.length;r++)i.dot$1(s,n[r])>=0&&l++;if(0===l)return 0;l!==n.length&&(o=!1)}if(o)return 2;for(let i=0;i<3;i++){let n=Number.MAX_VALUE,o=-Number.MAX_VALUE;for(let a=0;a<r.points.length;a++){let s=r.points[a][i]-this.min[i];n=Math.min(n,s),o=Math.max(o,s)}if(o<0||n>this.max[i]-this.min[i])return 0}return 1}}class id{constructor(i=0,r=0,n=0,o=0){if(isNaN(i)||i<0||isNaN(r)||r<0||isNaN(n)||n<0||isNaN(o)||o<0)throw Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=i,this.bottom=r,this.left=n,this.right=o}interpolate(r,n,o){return null!=n.top&&null!=r.top&&(this.top=i.number(r.top,n.top,o)),null!=n.bottom&&null!=r.bottom&&(this.bottom=i.number(r.bottom,n.bottom,o)),null!=n.left&&null!=r.left&&(this.left=i.number(r.left,n.left,o)),null!=n.right&&null!=r.right&&(this.right=i.number(r.right,n.right,o)),this}getCenter(r,n){let o=i.clamp((this.left+r-this.right)/2,0,r),a=i.clamp((this.top+n-this.bottom)/2,0,n);return new i.pointGeometry(o,a)}equals(i){return this.top===i.top&&this.bottom===i.bottom&&this.left===i.left&&this.right===i.right}clone(){return new id(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}class ip{constructor(r,n,o,a,s){this.tileSize=512,this.maxValidLatitude=85.051129,this.freezeElevation=!1,this._renderWorldCopies=void 0===s||!!s,this._minZoom=r||0,this._maxZoom=n||22,this._minPitch=null==o?0:o,this._maxPitch=null==a?60:a,this.setMaxBounds(),this.width=0,this.height=0,this._center=new i.LngLat(0,0),this._elevation=0,this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new id,this._posMatrixCache={},this._alignedPosMatrixCache={}}clone(){let i=new ip(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return i.tileSize=this.tileSize,i.latRange=this.latRange,i.width=this.width,i.height=this.height,i._center=this._center,i._elevation=this._elevation,i.zoom=this.zoom,i.angle=this.angle,i._fov=this._fov,i._pitch=this._pitch,i._unmodified=this._unmodified,i._edgeInsets=this._edgeInsets.clone(),i._calcMatrices(),i}get minZoom(){return this._minZoom}set minZoom(i){this._minZoom!==i&&(this._minZoom=i,this.zoom=Math.max(this.zoom,i))}get maxZoom(){return this._maxZoom}set maxZoom(i){this._maxZoom!==i&&(this._maxZoom=i,this.zoom=Math.min(this.zoom,i))}get minPitch(){return this._minPitch}set minPitch(i){this._minPitch!==i&&(this._minPitch=i,this.pitch=Math.max(this.pitch,i))}get maxPitch(){return this._maxPitch}set maxPitch(i){this._maxPitch!==i&&(this._maxPitch=i,this.pitch=Math.min(this.pitch,i))}get renderWorldCopies(){return this._renderWorldCopies}set renderWorldCopies(i){void 0===i?i=!0:null===i&&(i=!1),this._renderWorldCopies=i}get worldSize(){return this.tileSize*this.scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new i.pointGeometry(this.width,this.height)}get bearing(){return-this.angle/Math.PI*180}set bearing(r){var n,o,a,s,l,u,h,c,d,p;let f=-i.wrap(r,-180,180)*Math.PI/180;this.angle!==f&&(this._unmodified=!1,this.angle=f,this._calcMatrices(),this.rotationMatrix=(n=new i.ARRAY_TYPE(4),i.ARRAY_TYPE!=Float32Array&&(n[1]=0,n[2]=0),n[0]=1,n[3]=1,n),o=this.rotationMatrix,a=this.rotationMatrix,s=this.angle,l=a[0],u=a[1],h=a[2],c=a[3],d=Math.sin(s),p=Math.cos(s),o[0]=l*p+h*d,o[1]=u*p+c*d,o[2]=-(l*d)+h*p,o[3]=-(u*d)+c*p)}get pitch(){return this._pitch/Math.PI*180}set pitch(r){let n=i.clamp(r,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==n&&(this._unmodified=!1,this._pitch=n,this._calcMatrices())}get fov(){return this._fov/Math.PI*180}set fov(i){i=Math.max(.01,Math.min(60,i)),this._fov!==i&&(this._unmodified=!1,this._fov=i/180*Math.PI,this._calcMatrices())}get zoom(){return this._zoom}set zoom(i){let r=Math.min(Math.max(i,this.minZoom),this.maxZoom);this._zoom!==r&&(this._unmodified=!1,this._zoom=r,this.scale=this.zoomScale(r),this.tileZoom=Math.floor(r),this.zoomFraction=r-this.tileZoom,this._constrain(),this._calcMatrices())}get center(){return this._center}set center(i){i.lat===this._center.lat&&i.lng===this._center.lng||(this._unmodified=!1,this._center=i,this._constrain(),this._calcMatrices())}get elevation(){return this._elevation}set elevation(i){i!==this._elevation&&(this._elevation=i,this._constrain(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}set padding(i){this._edgeInsets.equals(i)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,i,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}isPaddingEqual(i){return this._edgeInsets.equals(i)}interpolatePadding(i,r,n){this._unmodified=!1,this._edgeInsets.interpolate(i,r,n),this._constrain(),this._calcMatrices()}coveringZoomLevel(i){let r=(i.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/i.tileSize));return Math.max(0,r)}getVisibleUnwrappedCoordinates(r){let n=[new i.UnwrappedTileID(0,r)];if(this._renderWorldCopies){let o=this.pointCoordinate(new i.pointGeometry(0,0)),a=this.pointCoordinate(new i.pointGeometry(this.width,0)),s=this.pointCoordinate(new i.pointGeometry(this.width,this.height)),l=this.pointCoordinate(new i.pointGeometry(0,this.height)),u=Math.floor(Math.min(o.x,a.x,s.x,l.x)),h=Math.floor(Math.max(o.x,a.x,s.x,l.x));for(let o=u-1;o<=h+1;o++)0!==o&&n.push(new i.UnwrappedTileID(o,r))}return n}coveringTiles(r){var n,o;let a=this.coveringZoomLevel(r),s=a;if(void 0!==r.minzoom&&a<r.minzoom)return[];void 0!==r.maxzoom&&a>r.maxzoom&&(a=r.maxzoom);let l=this.pointCoordinate(this.getCameraPoint()),u=i.MercatorCoordinate.fromLngLat(this.center),h=Math.pow(2,a),c=[h*l.x,h*l.y,0],d=[h*u.x,h*u.y,0],p=ih.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,a),f=r.minzoom||0;!r.terrain&&this.pitch<=60&&this._edgeInsets.top<.1&&(f=a);let m=r.terrain?2/Math.min(this.tileSize,r.tileSize)*this.tileSize:3,g=i=>({aabb:new ic([i*h,0,0],[(i+1)*h,h,0]),zoom:0,x:0,y:0,wrap:i,fullyVisible:!1}),_=[],y=[],v=a,x=r.reparseOverscaled?s:a;if(this._renderWorldCopies)for(let i=1;i<=3;i++)_.push(g(-i)),_.push(g(i));for(_.push(g(0));_.length>0;){let a=_.pop(),s=a.x,l=a.y,u=a.fullyVisible;if(!u){let i=a.aabb.intersects(p);if(0===i)continue;u=2===i}let h=r.terrain?c:d,g=a.aabb.distanceX(h),b=a.aabb.distanceY(h),w=Math.max(Math.abs(g),Math.abs(b)),T=m+(1<<v-a.zoom)-2;if(a.zoom===v||w>T&&a.zoom>=f){let r=v-a.zoom,n=c[0]-.5-(s<<r),o=c[1]-.5-(l<<r);y.push({tileID:new i.OverscaledTileID(a.zoom===v?x:a.zoom,a.wrap,a.zoom,s,l),distanceSq:i.sqrLen([d[0]-.5-s,d[1]-.5-l]),tileDistanceToCamera:Math.sqrt(n*n+o*o)})}else for(let h=0;h<4;h++){let c=(s<<1)+h%2,d=(l<<1)+(h>>1),p=a.zoom+1,f=a.aabb.quadrant(h);if(r.terrain){let s=new i.OverscaledTileID(p,a.wrap,p,c,d),l=r.terrain.getMinMaxElevation(s),u=null!==(n=l.minElevation)&&void 0!==n?n:this.elevation,h=null!==(o=l.maxElevation)&&void 0!==o?o:this.elevation;f=new ic([f.min[0],f.min[1],u],[f.max[0],f.max[1],h])}_.push({aabb:f,zoom:p,x:c,y:d,wrap:a.wrap,fullyVisible:u})}}return y.sort((i,r)=>i.distanceSq-r.distanceSq).map(i=>i.tileID)}resize(i,r){this.width=i,this.height=r,this.pixelsToGLUnits=[2/i,-2/r],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(i){return Math.pow(2,i)}scaleZoom(i){return Math.log(i)/Math.LN2}project(r){let n=i.clamp(r.lat,-this.maxValidLatitude,this.maxValidLatitude);return new i.pointGeometry(i.mercatorXfromLng(r.lng)*this.worldSize,i.mercatorYfromLat(n)*this.worldSize)}unproject(r){return new i.MercatorCoordinate(r.x/this.worldSize,r.y/this.worldSize).toLngLat()}get point(){return this.project(this.center)}updateElevation(i){this.freezeElevation||(this.elevation=i?this.getElevation(this._center,i):0)}getElevation(r,n){let o=i.MercatorCoordinate.fromLngLat(r),a=(1<<this.tileZoom)*i.EXTENT,s=o.x*a,l=o.y*a,u=Math.floor(s/i.EXTENT),h=Math.floor(l/i.EXTENT),c=new i.OverscaledTileID(this.tileZoom,0,this.tileZoom,u,h);return n.getElevation(c,s%i.EXTENT,l%i.EXTENT,i.EXTENT)}getCameraPosition(){return{lngLat:this.pointLocation(this.getCameraPoint()),altitude:Math.cos(this._pitch)*this.cameraToCenterDistance/this._pixelPerMeter+this.elevation}}recalculateZoom(r){let n=this.pointLocation(this.centerPoint,r),o=this.getElevation(n,r);if(!(this.elevation-o))return;let a=this.getCameraPosition(),s=i.MercatorCoordinate.fromLngLat(a.lngLat,a.altitude),l=i.MercatorCoordinate.fromLngLat(n,o),u=s.x-l.x,h=s.y-l.y,c=s.z-l.z,d=Math.sqrt(u*u+h*h+c*c),p=this.scaleZoom(this.cameraToCenterDistance/d/this.tileSize);this._elevation=o,this._center=n,this.zoom=p}setLocationAtPoint(r,n){let o=this.pointCoordinate(n),a=this.pointCoordinate(this.centerPoint),s=this.locationCoordinate(r),l=new i.MercatorCoordinate(s.x-(o.x-a.x),s.y-(o.y-a.y));this.center=this.coordinateLocation(l),this._renderWorldCopies&&(this.center=this.center.wrap())}locationPoint(i,r){return r?this.coordinatePoint(this.locationCoordinate(i),this.getElevation(i,r),this.pixelMatrix3D):this.coordinatePoint(this.locationCoordinate(i))}pointLocation(i,r){return this.coordinateLocation(this.pointCoordinate(i,r))}locationCoordinate(r){return i.MercatorCoordinate.fromLngLat(r)}coordinateLocation(i){return i&&i.toLngLat()}pointCoordinate(r,n){if(n){let i=n.pointCoordinate(r);if(null!=i)return i}let o=[r.x,r.y,0,1],a=[r.x,r.y,1,1];i.transformMat4(o,o,this.pixelMatrixInverse),i.transformMat4(a,a,this.pixelMatrixInverse);let s=o[3],l=a[3],u=o[1]/s,h=a[1]/l,c=o[2]/s,d=a[2]/l,p=c===d?0:(0-c)/(d-c);return new i.MercatorCoordinate(i.number(o[0]/s,a[0]/l,p)/this.worldSize,i.number(u,h,p)/this.worldSize)}coordinatePoint(r,n=0,o=this.pixelMatrix){let a=[r.x*this.worldSize,r.y*this.worldSize,n,1];return i.transformMat4(a,a,o),new i.pointGeometry(a[0]/a[3],a[1]/a[3])}getBounds(){let r=Math.max(0,this.height/2-this.getHorizon());return(new i.LngLatBounds).extend(this.pointLocation(new i.pointGeometry(0,r))).extend(this.pointLocation(new i.pointGeometry(this.width,r))).extend(this.pointLocation(new i.pointGeometry(this.width,this.height))).extend(this.pointLocation(new i.pointGeometry(0,this.height)))}getMaxBounds(){return this.latRange&&2===this.latRange.length&&this.lngRange&&2===this.lngRange.length?new i.LngLatBounds([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null}getHorizon(){return Math.tan(Math.PI/2-this._pitch)*this.cameraToCenterDistance*.85}setMaxBounds(i){i?(this.lngRange=[i.getWest(),i.getEast()],this.latRange=[i.getSouth(),i.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude])}calculatePosMatrix(r,n=!1){let o=r.key,a=n?this._alignedPosMatrixCache:this._posMatrixCache;if(a[o])return a[o];let s=r.canonical,l=this.worldSize/this.zoomScale(s.z),u=s.x+Math.pow(2,s.z)*r.wrap,h=i.identity(new Float64Array(16));return i.translate(h,h,[u*l,s.y*l,0]),i.scale(h,h,[l/i.EXTENT,l/i.EXTENT,1]),i.multiply(h,n?this.alignedProjMatrix:this.projMatrix,h),a[o]=new Float32Array(h),a[o]}customLayerMatrix(){return this.mercatorMatrix.slice()}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;let r,n,o,a,s=-90,l=90,u=-180,h=180,c=this.size,d=this._unmodified;if(this.latRange){let n=this.latRange;s=i.mercatorYfromLat(n[1])*this.worldSize,r=(l=i.mercatorYfromLat(n[0])*this.worldSize)-s<c.y?c.y/(l-s):0}if(this.lngRange){let r=this.lngRange;u=i.wrap(i.mercatorXfromLng(r[0])*this.worldSize,0,this.worldSize),(h=i.wrap(i.mercatorXfromLng(r[1])*this.worldSize,0,this.worldSize))<u&&(h+=this.worldSize),n=h-u<c.x?c.x/(h-u):0}let p=this.point,f=Math.max(n||0,r||0);if(f)return this.center=this.unproject(new i.pointGeometry(n?(h+u)/2:p.x,r?(l+s)/2:p.y)),this.zoom+=this.scaleZoom(f),this._unmodified=d,void(this._constraining=!1);if(this.latRange){let i=p.y,r=c.y/2;i-r<s&&(a=s+r),i+r>l&&(a=l-r)}if(this.lngRange){let r=(u+h)/2,n=i.wrap(p.x,r-this.worldSize/2,r+this.worldSize/2),a=c.x/2;n-a<u&&(o=u+a),n+a>h&&(o=h-a)}void 0===o&&void 0===a||(this.center=this.unproject(new i.pointGeometry(void 0!==o?o:p.x,void 0!==a?a:p.y)).wrap()),this._unmodified=d,this._constraining=!1}_calcMatrices(){if(!this.height)return;let r=this.centerOffset,n=this.point.x,o=this.point.y;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height,this._pixelPerMeter=i.mercatorZfromAltitude(1,this.center.lat)*this.worldSize;let a=i.identity(new Float64Array(16));i.scale(a,a,[this.width/2,-this.height/2,1]),i.translate(a,a,[1,-1,0]),this.labelPlaneMatrix=a,a=i.identity(new Float64Array(16)),i.scale(a,a,[1,-1,1]),i.translate(a,a,[-1,-1,0]),i.scale(a,a,[2/this.width,2/this.height,1]),this.glCoordMatrix=a,this.cameraToSeaLevelDistance=this.cameraToCenterDistance+this._elevation*this._pixelPerMeter/Math.cos(this._pitch);let s=Math.PI/2+this._pitch,l=this._fov*(.5+r.y/this.height),u=Math.sin(l)*this.cameraToSeaLevelDistance/Math.sin(i.clamp(Math.PI-s-l,.01,Math.PI-.01)),h=this.getHorizon(),c=2*Math.atan(h/this.cameraToCenterDistance)*(.5+r.y/(2*h)),d=Math.sin(c)*this.cameraToSeaLevelDistance/Math.sin(i.clamp(Math.PI-s-c,.01,Math.PI-.01)),p=Math.cos(Math.PI/2-this._pitch)*u+this.cameraToSeaLevelDistance,f=Math.cos(Math.PI/2-this._pitch)*d+this.cameraToSeaLevelDistance,m=1.01*Math.min(p,f),g=this.height/50;a=new Float64Array(16),i.perspective(a,this._fov,this.width/this.height,g,m),a[8]=-(2*r.x)/this.width,a[9]=2*r.y/this.height,i.scale(a,a,[1,-1,1]),i.translate(a,a,[0,0,-this.cameraToCenterDistance]),i.rotateX(a,a,this._pitch),i.rotateZ(a,a,this.angle),i.translate(a,a,[-n,-o,0]),this.mercatorMatrix=i.scale([],a,[this.worldSize,this.worldSize,this.worldSize]),i.scale(a,a,[1,1,this._pixelPerMeter]),this.pixelMatrix=i.multiply(new Float64Array(16),this.labelPlaneMatrix,a),i.translate(a,a,[0,0,-this.elevation]),this.projMatrix=a,this.invProjMatrix=i.invert([],a),this.pixelMatrix3D=i.multiply(new Float64Array(16),this.labelPlaneMatrix,a);let _=this.width%2/2,y=this.height%2/2,v=Math.cos(this.angle),x=Math.sin(this.angle),b=n-Math.round(n)+v*_+x*y,w=o-Math.round(o)+v*y+x*_,T=new Float64Array(a);if(i.translate(T,T,[b>.5?b-1:b,w>.5?w-1:w,0]),this.alignedProjMatrix=T,!(a=i.invert(new Float64Array(16),this.pixelMatrix)))throw Error("failed to invert matrix");this.pixelMatrixInverse=a,this._posMatrixCache={},this._alignedPosMatrixCache={}}maxPitchScaleFactor(){if(!this.pixelMatrixInverse)return 1;let r=this.pointCoordinate(new i.pointGeometry(0,0)),n=[r.x*this.worldSize,r.y*this.worldSize,0,1];return i.transformMat4(n,n,this.pixelMatrix)[3]/this.cameraToCenterDistance}getCameraPoint(){let r=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new i.pointGeometry(0,r))}getCameraQueryGeometry(r){let n=this.getCameraPoint();if(1===r.length)return[r[0],n];{let o=n.x,a=n.y,s=n.x,l=n.y;for(let i of r)o=Math.min(o,i.x),a=Math.min(a,i.y),s=Math.max(s,i.x),l=Math.max(l,i.y);return[new i.pointGeometry(o,a),new i.pointGeometry(s,a),new i.pointGeometry(s,l),new i.pointGeometry(o,l),new i.pointGeometry(o,a)]}}}class im{constructor(r){this._hashName=r&&encodeURIComponent(r),i.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=function(i,r){let n=!1,o=null,a=()=>{o=null,n&&(i(),o=setTimeout(a,300),n=!1)};return()=>(n=!0,o||a(),o)}(this._updateHashUnthrottled.bind(this))}addTo(i){return this._map=i,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this}getHashString(i){let r=this._map.getCenter(),n=Math.round(100*this._map.getZoom())/100,o=Math.ceil((n*Math.LN2+Math.log(512/360/.5))/Math.LN10),a=Math.pow(10,o),s=Math.round(r.lng*a)/a,l=Math.round(r.lat*a)/a,u=this._map.getBearing(),h=this._map.getPitch(),c="";if(c+=i?`/${s}/${l}/${n}`:`${n}/${l}/${s}`,(u||h)&&(c+="/"+Math.round(10*u)/10),h&&(c+=`/${Math.round(h)}`),this._hashName){let i=this._hashName,r=!1,n=window.location.hash.slice(1).split("&").map(n=>{let o=n.split("=")[0];return o===i?(r=!0,`${o}=${c}`):n}).filter(i=>i);return r||n.push(`${i}=${c}`),`#${n.join("&")}`}return`#${c}`}_getCurrentHash(){let i=window.location.hash.replace("#","");if(this._hashName){let r;return i.split("&").map(i=>i.split("=")).forEach(i=>{i[0]===this._hashName&&(r=i)}),(r&&r[1]||"").split("/")}return i.split("/")}_onHashChange(){let i=this._getCurrentHash();if(i.length>=3&&!i.some(i=>isNaN(i))){let r=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(i[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+i[2],+i[1]],zoom:+i[0],bearing:r,pitch:+(i[4]||0)}),!0}return!1}_updateHashUnthrottled(){let i=window.location.href.replace(/(#.+)?$/,this.getHashString());try{window.history.replaceState(window.history.state,null,i)}catch(i){}}}let ig={linearity:.3,easing:i.bezier(0,0,.3,1)},i_=i.extend({deceleration:2500,maxSpeed:1400},ig),iy=i.extend({deceleration:20,maxSpeed:1400},ig),iv=i.extend({deceleration:1e3,maxSpeed:360},ig),ix=i.extend({deceleration:1e3,maxSpeed:90},ig);class ib{constructor(i){this._map=i,this.clear()}clear(){this._inertiaBuffer=[]}record(r){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:i.exported.now(),settings:r})}_drainInertiaBuffer(){let r=this._inertiaBuffer,n=i.exported.now();for(;r.length>0&&n-r[0].time>160;)r.shift()}_onMoveEnd(r){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;let n={zoom:0,bearing:0,pitch:0,pan:new i.pointGeometry(0,0),pinchAround:void 0,around:void 0};for(let{settings:i}of this._inertiaBuffer)n.zoom+=i.zoomDelta||0,n.bearing+=i.bearingDelta||0,n.pitch+=i.pitchDelta||0,i.panDelta&&n.pan._add(i.panDelta),i.around&&(n.around=i.around),i.pinchAround&&(n.pinchAround=i.pinchAround);let o=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,a={};if(n.pan.mag()){let s=iT(n.pan.mag(),o,i.extend({},i_,r||{}));a.offset=n.pan.mult(s.amount/n.pan.mag()),a.center=this._map.transform.center,iw(a,s)}if(n.zoom){let i=iT(n.zoom,o,iy);a.zoom=this._map.transform.zoom+i.amount,iw(a,i)}if(n.bearing){let r=iT(n.bearing,o,iv);a.bearing=this._map.transform.bearing+i.clamp(r.amount,-179,179),iw(a,r)}if(n.pitch){let i=iT(n.pitch,o,ix);a.pitch=this._map.transform.pitch+i.amount,iw(a,i)}if(a.zoom||a.bearing){let i=void 0===n.pinchAround?n.around:n.pinchAround;a.around=i?this._map.unproject(i):this._map.getCenter()}return this.clear(),i.extend(a,{noMoveStart:!0})}}function iw(i,r){(!i.duration||i.duration<r.duration)&&(i.duration=r.duration,i.easing=r.easing)}function iT(r,n,o){let{maxSpeed:a,linearity:s,deceleration:l}=o,u=i.clamp(r*s/(n/1e3),-a,a),h=Math.abs(u)/(l*s);return{easing:o.easing,duration:1e3*h,amount:u*(h/2)}}class iE extends i.Event{constructor(r,n,o,a={}){let s=u.mousePos(n.getCanvasContainer(),o),l=n.unproject(s);super(r,i.extend({point:s,lngLat:l,originalEvent:o},a)),this._defaultPrevented=!1,this.target=n}preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}}class iS extends i.Event{constructor(r,n,o){let a="touchend"===r?o.changedTouches:o.touches,s=u.touchPos(n.getCanvasContainer(),a),l=s.map(i=>n.unproject(i)),h=s.reduce((i,r,n,o)=>i.add(r.div(o.length)),new i.pointGeometry(0,0));super(r,{points:s,point:h,lngLats:l,lngLat:n.unproject(h),originalEvent:o}),this._defaultPrevented=!1}preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}}class iC extends i.Event{constructor(i,r,n){super(i,{originalEvent:n}),this._defaultPrevented=!1}preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}}class iI{constructor(i,r){this._map=i,this._clickTolerance=r.clickTolerance}reset(){delete this._mousedownPos}wheel(i){return this._firePreventable(new iC(i.type,this._map,i))}mousedown(i,r){return this._mousedownPos=r,this._firePreventable(new iE(i.type,this._map,i))}mouseup(i){this._map.fire(new iE(i.type,this._map,i))}click(i,r){this._mousedownPos&&this._mousedownPos.dist(r)>=this._clickTolerance||this._map.fire(new iE(i.type,this._map,i))}dblclick(i){return this._firePreventable(new iE(i.type,this._map,i))}mouseover(i){this._map.fire(new iE(i.type,this._map,i))}mouseout(i){this._map.fire(new iE(i.type,this._map,i))}touchstart(i){return this._firePreventable(new iS(i.type,this._map,i))}touchmove(i){this._map.fire(new iS(i.type,this._map,i))}touchend(i){this._map.fire(new iS(i.type,this._map,i))}touchcancel(i){this._map.fire(new iS(i.type,this._map,i))}_firePreventable(i){if(this._map.fire(i),i.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class iA{constructor(i){this._map=i}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(i){this._map.fire(new iE(i.type,this._map,i))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new iE("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(i){this._delayContextMenu?this._contextMenuEvent=i:this._ignoreContextMenu||this._map.fire(new iE(i.type,this._map,i)),this._map.listens("contextmenu")&&i.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class iP{constructor(i,r){this._map=i,this._el=i.getCanvasContainer(),this._container=i.getContainer(),this._clickTolerance=r.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(i,r){this.isEnabled()&&i.shiftKey&&0===i.button&&(u.disableDrag(),this._startPos=this._lastPos=r,this._active=!0)}mousemoveWindow(i,r){if(!this._active||this._lastPos.equals(r)||!this._box&&r.dist(this._startPos)<this._clickTolerance)return;let n=this._startPos;this._lastPos=r,this._box||(this._box=u.create("div","maplibregl-boxzoom mapboxgl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair","mapboxgl-crosshair"),this._fireEvent("boxzoomstart",i));let o=Math.min(n.x,r.x),a=Math.max(n.x,r.x),s=Math.min(n.y,r.y),l=Math.max(n.y,r.y);u.setTransform(this._box,`translate(${o}px,${s}px)`),this._box.style.width=a-o+"px",this._box.style.height=l-s+"px"}mouseupWindow(r,n){if(!this._active||0!==r.button)return;let o=this._startPos;if(this.reset(),u.suppressClick(),o.x!==n.x||o.y!==n.y)return this._map.fire(new i.Event("boxzoomend",{originalEvent:r})),{cameraAnimation:i=>i.fitScreenCoordinates(o,n,this._map.getBearing(),{linear:!0})};this._fireEvent("boxzoomcancel",r)}keydown(i){this._active&&27===i.keyCode&&(this.reset(),this._fireEvent("boxzoomcancel",i))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair","mapboxgl-crosshair"),this._box&&(u.remove(this._box),this._box=null),u.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(r,n){return this._map.fire(new i.Event(r,{originalEvent:n}))}}function ik(i,r){if(i.length!==r.length)throw Error(`The number of touches and points are not equal - touches ${i.length}, points ${r.length}`);let n={};for(let o=0;o<i.length;o++)n[i[o].identifier]=r[o];return n}class iL{constructor(i){this.reset(),this.numTouches=i.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(r,n,o){(this.centroid||o.length>this.numTouches)&&(this.aborted=!0),this.aborted||(void 0===this.startTime&&(this.startTime=r.timeStamp),o.length===this.numTouches&&(this.centroid=function(r){let n=new i.pointGeometry(0,0);for(let i of r)n._add(i);return n.div(r.length)}(n),this.touches=ik(o,n)))}touchmove(i,r,n){if(this.aborted||!this.centroid)return;let o=ik(n,r);for(let i in this.touches){let r=this.touches[i],n=o[i];(!n||n.dist(r)>30)&&(this.aborted=!0)}}touchend(i,r,n){if((!this.centroid||i.timeStamp-this.startTime>500)&&(this.aborted=!0),0===n.length){let i=!this.aborted&&this.centroid;if(this.reset(),i)return i}}}class iM{constructor(i){this.singleTap=new iL(i),this.numTaps=i.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(i,r,n){this.singleTap.touchstart(i,r,n)}touchmove(i,r,n){this.singleTap.touchmove(i,r,n)}touchend(i,r,n){let o=this.singleTap.touchend(i,r,n);if(o){let r=i.timeStamp-this.lastTime<500,n=!this.lastTap||30>this.lastTap.dist(o);if(r&&n||this.reset(),this.count++,this.lastTime=i.timeStamp,this.lastTap=o,this.count===this.numTaps)return this.reset(),o}}}class iz{constructor(){this._zoomIn=new iM({numTouches:1,numTaps:2}),this._zoomOut=new iM({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(i,r,n){this._zoomIn.touchstart(i,r,n),this._zoomOut.touchstart(i,r,n)}touchmove(i,r,n){this._zoomIn.touchmove(i,r,n),this._zoomOut.touchmove(i,r,n)}touchend(i,r,n){let o=this._zoomIn.touchend(i,r,n),a=this._zoomOut.touchend(i,r,n);return o?(this._active=!0,i.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:r=>r.easeTo({duration:300,zoom:r.getZoom()+1,around:r.unproject(o)},{originalEvent:i})}):a?(this._active=!0,i.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:r=>r.easeTo({duration:300,zoom:r.getZoom()-1,around:r.unproject(a)},{originalEvent:i})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}let iD={0:1,2:2};class iR{constructor(i){this.reset(),this._clickTolerance=i.clickTolerance||1}reset(){this._active=!1,this._moved=!1,delete this._lastPoint,delete this._eventButton}_correctButton(i,r){return!1}_move(i,r){return{}}mousedown(i,r){if(this._lastPoint)return;let n=u.mouseButton(i);this._correctButton(i,n)&&(this._lastPoint=r,this._eventButton=n)}mousemoveWindow(i,r){let n=this._lastPoint;if(n){if(i.preventDefault(),function(i,r){let n=iD[r];return void 0===i.buttons||(i.buttons&n)!==n}(i,this._eventButton))this.reset();else if(this._moved||!(r.dist(n)<this._clickTolerance))return this._moved=!0,this._lastPoint=r,this._move(n,r)}}mouseupWindow(i){this._lastPoint&&u.mouseButton(i)===this._eventButton&&(this._moved&&u.suppressClick(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class iB extends iR{mousedown(i,r){super.mousedown(i,r),this._lastPoint&&(this._active=!0)}_correctButton(i,r){return 0===r&&!i.ctrlKey}_move(i,r){return{around:r,panDelta:r.sub(i)}}}class iO extends iR{_correctButton(i,r){return 0===r&&i.ctrlKey||2===r}_move(i,r){let n=.8*(r.x-i.x);if(n)return this._active=!0,{bearingDelta:n}}contextmenu(i){i.preventDefault()}}class iF extends iR{_correctButton(i,r){return 0===r&&i.ctrlKey||2===r}_move(i,r){let n=-.5*(r.y-i.y);if(n)return this._active=!0,{pitchDelta:n}}contextmenu(i){i.preventDefault()}}class iN{constructor(i,r){this._minTouches=i.cooperativeGestures?2:1,this._clickTolerance=i.clickTolerance||1,this._map=r,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new i.pointGeometry(0,0),setTimeout(()=>{this._cancelCooperativeMessage=!1},200)}touchstart(i,r,n){return this._calculateTransform(i,r,n)}touchmove(i,r,n){if(this._map._cooperativeGestures&&(2===this._minTouches&&n.length<2&&!this._cancelCooperativeMessage?this._map._onCooperativeGesture(i,!1,n.length):this._cancelCooperativeMessage||(this._cancelCooperativeMessage=!0)),this._active&&!(n.length<this._minTouches))return i.preventDefault(),this._calculateTransform(i,r,n)}touchend(i,r,n){this._calculateTransform(i,r,n),this._active&&n.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(r,n,o){o.length>0&&(this._active=!0);let a=ik(o,n),s=new i.pointGeometry(0,0),l=new i.pointGeometry(0,0),u=0;for(let i in a){let r=a[i],n=this._touches[i];n&&(s._add(r),l._add(r.sub(n)),u++,a[i]=r)}if(this._touches=a,u<this._minTouches||!l.mag())return;let h=l.div(u);return this._sum._add(h),this._sum.mag()<this._clickTolerance?void 0:{around:s.div(u),panDelta:h}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class iU{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}_start(i){}_move(i,r,n){return{}}touchstart(i,r,n){this._firstTwoTouches||n.length<2||(this._firstTwoTouches=[n[0].identifier,n[1].identifier],this._start([r[0],r[1]]))}touchmove(i,r,n){if(!this._firstTwoTouches)return;i.preventDefault();let[o,a]=this._firstTwoTouches,s=ij(n,r,o),l=ij(n,r,a);if(!s||!l)return;let u=this._aroundCenter?null:s.add(l).div(2);return this._move([s,l],u,i)}touchend(i,r,n){if(!this._firstTwoTouches)return;let[o,a]=this._firstTwoTouches,s=ij(n,r,o),l=ij(n,r,a);s&&l||(this._active&&u.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(i){this._enabled=!0,this._aroundCenter=!!i&&"center"===i.around}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function ij(i,r,n){for(let o=0;o<i.length;o++)if(i[o].identifier===n)return r[o]}function iZ(i,r){return Math.log(i/r)/Math.LN2}class iV extends iU{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(i){this._startDistance=this._distance=i[0].dist(i[1])}_move(i,r){let n=this._distance;if(this._distance=i[0].dist(i[1]),this._active||!(.1>Math.abs(iZ(this._distance,this._startDistance))))return this._active=!0,{zoomDelta:iZ(this._distance,n),pinchAround:r}}}function iq(i,r){return 180*i.angleWith(r)/Math.PI}class iG extends iU{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(i){this._startVector=this._vector=i[0].sub(i[1]),this._minDiameter=i[0].dist(i[1])}_move(i,r){let n=this._vector;if(this._vector=i[0].sub(i[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:iq(this._vector,n),pinchAround:r}}_isBelowThreshold(i){this._minDiameter=Math.min(this._minDiameter,i.mag());let r=25/(Math.PI*this._minDiameter)*360,n=iq(i,this._startVector);return Math.abs(n)<r}}function i$(i){return Math.abs(i.y)>Math.abs(i.x)}class iW extends iU{constructor(i){super(),this._map=i}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(i,r,n){super.touchstart(i,r,n),this._currentTouchCount=n.length}_start(i){this._lastPoints=i,i$(i[0].sub(i[1]))&&(this._valid=!1)}_move(i,r,n){if(this._map._cooperativeGestures&&this._currentTouchCount<3)return;let o=i[0].sub(this._lastPoints[0]),a=i[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(o,a,n.timeStamp),this._valid?(this._lastPoints=i,this._active=!0,{pitchDelta:-((o.y+a.y)/2*.5)}):void 0}gestureBeginsVertically(i,r,n){if(void 0!==this._valid)return this._valid;let o=i.mag()>=2,a=r.mag()>=2;if(!o&&!a)return;if(!o||!a)return void 0===this._firstMove&&(this._firstMove=n),n-this._firstMove<100&&void 0;let s=i.y>0==r.y>0;return i$(i)&&i$(r)&&s}}class iH{constructor(){this._panStep=100,this._bearingStep=15,this._pitchStep=10,this._rotationDisabled=!1}reset(){this._active=!1}keydown(i){if(i.altKey||i.ctrlKey||i.metaKey)return;let r=0,n=0,o=0,a=0,s=0;switch(i.keyCode){case 61:case 107:case 171:case 187:r=1;break;case 189:case 109:case 173:r=-1;break;case 37:i.shiftKey?n=-1:(i.preventDefault(),a=-1);break;case 39:i.shiftKey?n=1:(i.preventDefault(),a=1);break;case 38:i.shiftKey?o=1:(i.preventDefault(),s=-1);break;case 40:i.shiftKey?o=-1:(i.preventDefault(),s=1);break;default:return}return this._rotationDisabled&&(n=0,o=0),{cameraAnimation:l=>{let u=l.getZoom();l.easeTo({duration:300,easeId:"keyboardHandler",easing:iX,zoom:r?Math.round(u)+r*(i.shiftKey?2:1):u,bearing:l.getBearing()+n*this._bearingStep,pitch:l.getPitch()+o*this._pitchStep,offset:[-a*this._panStep,-s*this._panStep],center:l.getCenter()},{originalEvent:i})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function iX(i){return i*(2-i)}class iK{constructor(r,n){this._map=r,this._el=r.getCanvasContainer(),this._handler=n,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222,i.bindAll(["_onTimeout"],this)}setZoomRate(i){this._defaultZoomRate=i}setWheelZoomRate(i){this._wheelZoomRate=i}isEnabled(){return!!this._enabled}isActive(){return!!this._active||void 0!==this._finishTimeout}isZooming(){return!!this._zooming}enable(i){this.isEnabled()||(this._enabled=!0,this._aroundCenter=i&&"center"===i.around)}disable(){this.isEnabled()&&(this._enabled=!1)}wheel(r){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!this._map._metaPress)return;r.preventDefault()}let n=r.deltaMode===WheelEvent.DOM_DELTA_LINE?40*r.deltaY:r.deltaY,o=i.exported.now(),a=o-(this._lastWheelEventTime||0);this._lastWheelEventTime=o,0!==n&&n%4.000244140625==0?this._type="wheel":0!==n&&4>Math.abs(n)?this._type="trackpad":a>400?(this._type=null,this._lastValue=n,this._timeout=setTimeout(this._onTimeout,40,r)):this._type||(this._type=200>Math.abs(a*n)?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,n+=this._lastValue)),r.shiftKey&&n&&(n/=4),this._type&&(this._lastWheelEvent=r,this._delta-=n,this._active||this._start(r)),r.preventDefault()}_onTimeout(i){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(i)}_start(r){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);let n=u.mousePos(this._el,r);this._around=i.LngLat.convert(this._aroundCenter?this._map.getCenter():this._map.unproject(n)),this._aroundPoint=this._map.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;let r=this._map.transform;if(0!==this._delta){let i="wheel"===this._type&&Math.abs(this._delta)>4.000244140625?this._wheelZoomRate:this._defaultZoomRate,n=2/(1+Math.exp(-Math.abs(this._delta*i)));this._delta<0&&0!==n&&(n=1/n);let o="number"==typeof this._targetZoom?r.zoomScale(this._targetZoom):r.scale;this._targetZoom=Math.min(r.maxZoom,Math.max(r.minZoom,r.scaleZoom(o*n))),"wheel"===this._type&&(this._startZoom=r.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}let n="number"==typeof this._targetZoom?this._targetZoom:r.zoom,o=this._startZoom,a=this._easing,s,l=!1;if("wheel"===this._type&&o&&a){let r=Math.min((i.exported.now()-this._lastWheelEventTime)/200,1),u=a(r);s=i.number(o,n,u),r<1?this._frameId||(this._frameId=!0):l=!0}else s=n,l=!0;return this._active=!0,l&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!l,zoomDelta:s-r.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(r){let n=i.ease;if(this._prevEase){let r=this._prevEase,o=(i.exported.now()-r.start)/r.duration,a=r.easing(o+.01)-r.easing(o),s=.27/Math.sqrt(a*a+1e-4)*.01,l=Math.sqrt(.0729-s*s);n=i.bezier(s,l,.25,1)}return this._prevEase={start:i.exported.now(),duration:r,easing:n},n}reset(){this._active=!1}}class iJ{constructor(i,r){this._clickZoom=i,this._tapZoom=r}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class iY{constructor(){this.reset()}reset(){this._active=!1}dblclick(i,r){return i.preventDefault(),{cameraAnimation:n=>{n.easeTo({duration:300,zoom:n.getZoom()+(i.shiftKey?-1:1),around:n.unproject(r)},{originalEvent:i})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class iQ{constructor(){this._tap=new iM({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,this._tap.reset()}touchstart(i,r,n){this._swipePoint||(this._tapTime&&i.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?n.length>0&&(this._swipePoint=r[0],this._swipeTouch=n[0].identifier):this._tap.touchstart(i,r,n))}touchmove(i,r,n){if(this._tapTime){if(this._swipePoint){if(n[0].identifier!==this._swipeTouch)return;let o=r[0],a=o.y-this._swipePoint.y;return this._swipePoint=o,i.preventDefault(),this._active=!0,{zoomDelta:a/128}}}else this._tap.touchmove(i,r,n)}touchend(i,r,n){this._tapTime?this._swipePoint&&0===n.length&&this.reset():this._tap.touchend(i,r,n)&&(this._tapTime=i.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class i0{constructor(i,r,n){this._el=i,this._mousePan=r,this._touchPan=n}enable(i){this._inertiaOptions=i||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan","mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan","mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class i1{constructor(i,r,n){this._pitchWithRotate=i.pitchWithRotate,this._mouseRotate=r,this._mousePitch=n}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class i2{constructor(i,r,n,o){this._el=i,this._touchZoom=r,this._touchRotate=n,this._tapDragZoom=o,this._rotationDisabled=!1,this._enabled=!0}enable(i){this._touchZoom.enable(i),this._rotationDisabled||this._touchRotate.enable(i),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate","mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate","mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}let i3=i=>i.zoom||i.drag||i.pitch||i.rotate;class i5 extends i.Event{}function i4(i){return i.panDelta&&i.panDelta.mag()||i.zoomDelta||i.bearingDelta||i.pitchDelta}class i6{constructor(r,n){this._map=r,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new ib(r),this._bearingSnap=n.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(n),i.bindAll(["handleEvent","handleWindowEvent"],this);let o=this._el;for(let[i,r,n]of(this._listeners=[[o,"touchstart",{passive:!0}],[o,"touchmove",{passive:!1}],[o,"touchend",void 0],[o,"touchcancel",void 0],[o,"mousedown",void 0],[o,"mousemove",void 0],[o,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[o,"mouseover",void 0],[o,"mouseout",void 0],[o,"dblclick",void 0],[o,"click",void 0],[o,"keydown",{capture:!1}],[o,"keyup",void 0],[o,"wheel",{passive:!1}],[o,"contextmenu",void 0],[window,"blur",void 0]],this._listeners))u.addEventListener(i,r,i===document?this.handleWindowEvent:this.handleEvent,n)}destroy(){for(let[i,r,n]of this._listeners)u.removeEventListener(i,r,i===document?this.handleWindowEvent:this.handleEvent,n)}_addDefaultHandlers(i){let r=this._map,n=r.getCanvasContainer();this._add("mapEvent",new iI(r,i));let o=r.boxZoom=new iP(r,i);this._add("boxZoom",o);let a=new iz,s=new iY;r.doubleClickZoom=new iJ(s,a),this._add("tapZoom",a),this._add("clickZoom",s);let l=new iQ;this._add("tapDragZoom",l);let u=r.touchPitch=new iW(r);this._add("touchPitch",u);let h=new iO(i),c=new iF(i);r.dragRotate=new i1(i,h,c),this._add("mouseRotate",h,["mousePitch"]),this._add("mousePitch",c,["mouseRotate"]);let d=new iB(i),p=new iN(i,r);r.dragPan=new i0(n,d,p),this._add("mousePan",d),this._add("touchPan",p,["touchZoom","touchRotate"]);let f=new iG,m=new iV;r.touchZoomRotate=new i2(n,m,f,l),this._add("touchRotate",f,["touchPan","touchZoom"]),this._add("touchZoom",m,["touchPan","touchRotate"]);let g=r.scrollZoom=new iK(r,this);this._add("scrollZoom",g,["mousePan"]);let _=r.keyboard=new iH;for(let n of(this._add("keyboard",_),this._add("blockableMapEvent",new iA(r)),["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"]))i.interactive&&i[n]&&r[n].enable(i[n])}_add(i,r,n){this._handlers.push({handlerName:i,handler:r,allowed:n}),this._handlersById[i]=r}stop(i){if(!this._updatingCamera){for(let{handler:i}of this._handlers)i.reset();this._inertia.clear(),this._fireEvents({},{},i),this._changes=[]}}isActive(){for(let{handler:i}of this._handlers)if(i.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!i3(this._eventsInProgress)||this.isZooming()}_blockedByActive(i,r,n){for(let o in i)if(o!==n&&(!r||0>r.indexOf(o)))return!0;return!1}handleWindowEvent(i){this.handleEvent(i,`${i.type}Window`)}_getMapTouches(i){let r=[];for(let n of i)this._el.contains(n.target)&&r.push(n);return r}handleEvent(i,r){if("blur"===i.type)return void this.stop(!0);this._updatingCamera=!0;let n="renderFrame"===i.type?void 0:i,o={needsRenderFrame:!1},a={},s={},l=i.touches,h=l?this._getMapTouches(l):void 0,c=h?u.touchPos(this._el,h):u.mousePos(this._el,i);for(let{handlerName:l,handler:u,allowed:d}of this._handlers){let p;u.isEnabled()&&(this._blockedByActive(s,d,l)?u.reset():u[r||i.type]&&(p=u[r||i.type](i,c,h),this.mergeHandlerResult(o,a,p,l,n),p&&p.needsRenderFrame&&this._triggerRenderFrame()),(p||u.isActive())&&(s[l]=u))}let d={};for(let i in this._previousActiveHandlers)s[i]||(d[i]=n);this._previousActiveHandlers=s,(Object.keys(d).length||i4(o))&&(this._changes.push([o,a,d]),this._triggerRenderFrame()),(Object.keys(s).length||i4(o))&&this._map._stop(!0),this._updatingCamera=!1;let{cameraAnimation:p}=o;p&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],p(this._map))}mergeHandlerResult(r,n,o,a,s){if(!o)return;i.extend(r,o);let l={handlerName:a,originalEvent:o.originalEvent||s};void 0!==o.zoomDelta&&(n.zoom=l),void 0!==o.panDelta&&(n.drag=l),void 0!==o.pitchDelta&&(n.pitch=l),void 0!==o.bearingDelta&&(n.rotate=l)}_applyChanges(){let r={},n={},o={};for(let[a,s,l]of this._changes)a.panDelta&&(r.panDelta=(r.panDelta||new i.pointGeometry(0,0))._add(a.panDelta)),a.zoomDelta&&(r.zoomDelta=(r.zoomDelta||0)+a.zoomDelta),a.bearingDelta&&(r.bearingDelta=(r.bearingDelta||0)+a.bearingDelta),a.pitchDelta&&(r.pitchDelta=(r.pitchDelta||0)+a.pitchDelta),void 0!==a.around&&(r.around=a.around),void 0!==a.pinchAround&&(r.pinchAround=a.pinchAround),a.noInertia&&(r.noInertia=a.noInertia),i.extend(n,s),i.extend(o,l);this._updateMapTransform(r,n,o),this._changes=[]}_updateMapTransform(r,n,o){let a=this._map,s=a.transform,l=a.style&&a.style.terrain;if(!(i4(r)||l&&this._drag))return this._fireEvents(n,o,!0);let{panDelta:u,zoomDelta:h,bearingDelta:c,pitchDelta:d,around:p,pinchAround:f}=r;void 0!==f&&(p=f),a._stop(!0),p=p||a.transform.centerPoint;let m=s.pointLocation(u?p.sub(u):p);c&&(s.bearing+=c),d&&(s.pitch+=d),h&&(s.zoom+=h),l?n.drag&&!this._drag?(this._drag={center:s.centerPoint,lngLat:s.pointLocation(p),point:p,handlerName:n.drag.handlerName},a.fire(new i.Event("freezeElevation",{freeze:!0}))):this._drag&&o[this._drag.handlerName]?(a.fire(new i.Event("freezeElevation",{freeze:!1})),this._drag=null):n.drag&&this._drag&&(s.center=s.pointLocation(s.centerPoint.sub(u))):s.setLocationAtPoint(m,p),this._map._update(),r.noInertia||this._inertia.record(r),this._fireEvents(n,o,!0)}_fireEvents(r,n,o){let a;let s=i3(this._eventsInProgress),l=i3(r),u={};for(let i in r){let{originalEvent:n}=r[i];this._eventsInProgress[i]||(u[`${i}start`]=n),this._eventsInProgress[i]=r[i]}for(let i in!s&&l&&this._fireEvent("movestart",l.originalEvent),u)this._fireEvent(i,u[i]);for(let i in l&&this._fireEvent("move",l.originalEvent),r){let{originalEvent:n}=r[i];this._fireEvent(i,n)}let h={};for(let i in this._eventsInProgress){let{handlerName:r,originalEvent:o}=this._eventsInProgress[i];this._handlersById[r].isActive()||(delete this._eventsInProgress[i],a=n[r]||o,h[`${i}end`]=a)}for(let i in h)this._fireEvent(i,h[i]);let c=i3(this._eventsInProgress);if(o&&(s||l)&&!c){var d,p;this._updatingCamera=!0;let r=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions);r?(0!==(d=r.bearing||this._map.getBearing())&&-this._bearingSnap<d&&d<this._bearingSnap&&(r.bearing=0),this._map.easeTo(r,{originalEvent:a})):(this._map.fire(new i.Event("moveend",{originalEvent:a})),0!==(p=this._map.getBearing())&&-this._bearingSnap<p&&p<this._bearingSnap&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(r,n){this._map.fire(new i.Event(r,n?{originalEvent:n}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(i=>{delete this._frameId,this.handleEvent(new i5("renderFrame",{timeStamp:i})),this._applyChanges()})}_triggerRenderFrame(){void 0===this._frameId&&(this._frameId=this._requestFrame())}}class i8 extends i.Evented{constructor(r,n){super(),this._moving=!1,this._zooming=!1,this.transform=r,this._bearingSnap=n.bearingSnap,i.bindAll(["_renderFrameCallback"],this)}getCenter(){return new i.LngLat(this.transform.center.lng,this.transform.center.lat)}setCenter(i,r){return this.jumpTo({center:i},r)}panBy(r,n,o){return r=i.pointGeometry.convert(r).mult(-1),this.panTo(this.transform.center,i.extend({offset:r},n),o)}panTo(r,n,o){return this.easeTo(i.extend({center:r},n),o)}getZoom(){return this.transform.zoom}setZoom(i,r){return this.jumpTo({zoom:i},r),this}zoomTo(r,n,o){return this.easeTo(i.extend({zoom:r},n),o)}zoomIn(i,r){return this.zoomTo(this.getZoom()+1,i,r),this}zoomOut(i,r){return this.zoomTo(this.getZoom()-1,i,r),this}getBearing(){return this.transform.bearing}setBearing(i,r){return this.jumpTo({bearing:i},r),this}getPadding(){return this.transform.padding}setPadding(i,r){return this.jumpTo({padding:i},r),this}rotateTo(r,n,o){return this.easeTo(i.extend({bearing:r},n),o)}resetNorth(r,n){return this.rotateTo(0,i.extend({duration:1e3},r),n),this}resetNorthPitch(r,n){return this.easeTo(i.extend({bearing:0,pitch:0,duration:1e3},r),n),this}snapToNorth(i,r){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(i,r):this}getPitch(){return this.transform.pitch}setPitch(i,r){return this.jumpTo({pitch:i},r),this}cameraForBounds(r,n){r=i.LngLatBounds.convert(r);let o=n&&n.bearing||0;return this._cameraForBoxAndBearing(r.getNorthWest(),r.getSouthEast(),o,n)}_cameraForBoxAndBearing(r,n,o,a){let s={top:0,bottom:0,right:0,left:0};if("number"==typeof(a=i.extend({padding:s,offset:[0,0],maxZoom:this.transform.maxZoom},a)).padding){let i=a.padding;a.padding={top:i,bottom:i,right:i,left:i}}a.padding=i.extend(s,a.padding);let l=this.transform,u=l.padding,h=l.project(i.LngLat.convert(r)),c=l.project(i.LngLat.convert(n)),d=h.rotate(-o*Math.PI/180),p=c.rotate(-o*Math.PI/180),f=new i.pointGeometry(Math.max(d.x,p.x),Math.max(d.y,p.y)),m=new i.pointGeometry(Math.min(d.x,p.x),Math.min(d.y,p.y)),g=f.sub(m),_=(l.width-(u.left+u.right+a.padding.left+a.padding.right))/g.x,y=(l.height-(u.top+u.bottom+a.padding.top+a.padding.bottom))/g.y;if(y<0||_<0)return void i.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.");let v=Math.min(l.scaleZoom(l.scale*Math.min(_,y)),a.maxZoom),x=i.pointGeometry.convert(a.offset),b=new i.pointGeometry((a.padding.left-a.padding.right)/2,(a.padding.top-a.padding.bottom)/2).rotate(o*Math.PI/180),w=x.add(b).mult(l.scale/l.zoomScale(v));return{center:l.unproject(h.add(c).div(2).sub(w)),zoom:v,bearing:o}}fitBounds(i,r,n){return this._fitInternal(this.cameraForBounds(i,r),r,n)}fitScreenCoordinates(r,n,o,a,s){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(i.pointGeometry.convert(r)),this.transform.pointLocation(i.pointGeometry.convert(n)),o,a),a,s)}_fitInternal(r,n,o){return r?(delete(n=i.extend(r,n)).padding,n.linear?this.easeTo(n,o):this.flyTo(n,o)):this}jumpTo(r,n){this.stop();let o=this.transform,a=!1,s=!1,l=!1;return"zoom"in r&&o.zoom!==+r.zoom&&(a=!0,o.zoom=+r.zoom),void 0!==r.center&&(o.center=i.LngLat.convert(r.center)),"bearing"in r&&o.bearing!==+r.bearing&&(s=!0,o.bearing=+r.bearing),"pitch"in r&&o.pitch!==+r.pitch&&(l=!0,o.pitch=+r.pitch),null==r.padding||o.isPaddingEqual(r.padding)||(o.padding=r.padding),this.fire(new i.Event("movestart",n)).fire(new i.Event("move",n)),a&&this.fire(new i.Event("zoomstart",n)).fire(new i.Event("zoom",n)).fire(new i.Event("zoomend",n)),s&&this.fire(new i.Event("rotatestart",n)).fire(new i.Event("rotate",n)).fire(new i.Event("rotateend",n)),l&&this.fire(new i.Event("pitchstart",n)).fire(new i.Event("pitch",n)).fire(new i.Event("pitchend",n)),this.fire(new i.Event("moveend",n))}calculateCameraOptionsFromTo(r,n,o,a=0){let s=i.MercatorCoordinate.fromLngLat(r,n),l=i.MercatorCoordinate.fromLngLat(o,a),u=l.x-s.x,h=l.y-s.y,c=l.z-s.z,d=Math.hypot(u,h,c);if(0===d)throw Error("Can't calculate camera options with same From and To");let p=Math.hypot(u,h),f=this.transform.scaleZoom(this.transform.cameraToCenterDistance/d/this.transform.tileSize),m=180*Math.atan2(u,-h)/Math.PI,g=180*Math.acos(p/d)/Math.PI;return g=c<0?90-g:90+g,{center:l.toLngLat(),zoom:f,pitch:g,bearing:m}}easeTo(r,n){let o,a;this._stop(!1,r.easeId),(!1===(r=i.extend({offset:[0,0],duration:500,easing:i.ease},r)).animate||!r.essential&&i.exported.prefersReducedMotion)&&(r.duration=0);let s=this.transform,l=this.getZoom(),u=this.getBearing(),h=this.getPitch(),c=this.getPadding(),d="zoom"in r?+r.zoom:l,p="bearing"in r?this._normalizeBearing(r.bearing,u):u,f="pitch"in r?+r.pitch:h,m="padding"in r?r.padding:s.padding,g=i.pointGeometry.convert(r.offset),_=s.centerPoint.add(g),y=s.pointLocation(_),v=i.LngLat.convert(r.center||y);this._normalizeCenter(v);let x=s.project(y),b=s.project(v).sub(x),w=s.zoomScale(d-l);r.around&&(o=i.LngLat.convert(r.around),a=s.locationPoint(o));let T={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||d!==l,this._rotating=this._rotating||u!==p,this._pitching=this._pitching||f!==h,this._padding=!s.isPaddingEqual(m),this._easeId=r.easeId,this._prepareEase(n,r.noMoveStart,T),this._ease(r=>{if(this._zooming&&(s.zoom=i.number(l,d,r)),this._rotating&&(s.bearing=i.number(u,p,r)),this._pitching&&(s.pitch=i.number(h,f,r)),this._padding&&(s.interpolatePadding(c,m,r),_=s.centerPoint.add(g)),o)s.setLocationAtPoint(o,a);else{let i=s.zoomScale(s.zoom-l),n=d>l?Math.min(2,w):Math.max(.5,w),o=Math.pow(n,1-r),a=s.unproject(x.add(b.mult(r*o)).mult(i));s.setLocationAtPoint(s.renderWorldCopies?a.wrap():a,_)}this._fireMoveEvents(n)},i=>{this._afterEase(n,i)},r),this}_prepareEase(r,n,o={}){this._moving=!0,this.fire(new i.Event("freezeElevation",{freeze:!0})),n||o.moving||this.fire(new i.Event("movestart",r)),this._zooming&&!o.zooming&&this.fire(new i.Event("zoomstart",r)),this._rotating&&!o.rotating&&this.fire(new i.Event("rotatestart",r)),this._pitching&&!o.pitching&&this.fire(new i.Event("pitchstart",r))}_fireMoveEvents(r){this.fire(new i.Event("move",r)),this._zooming&&this.fire(new i.Event("zoom",r)),this._rotating&&this.fire(new i.Event("rotate",r)),this._pitching&&this.fire(new i.Event("pitch",r))}_afterEase(r,n){if(this._easeId&&n&&this._easeId===n)return;delete this._easeId,this.fire(new i.Event("freezeElevation",{freeze:!1}));let o=this._zooming,a=this._rotating,s=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,o&&this.fire(new i.Event("zoomend",r)),a&&this.fire(new i.Event("rotateend",r)),s&&this.fire(new i.Event("pitchend",r)),this.fire(new i.Event("moveend",r))}flyTo(r,n){if(!r.essential&&i.exported.prefersReducedMotion){let o=i.pick(r,["center","zoom","bearing","pitch","around"]);return this.jumpTo(o,n)}this.stop(),r=i.extend({offset:[0,0],speed:1.2,curve:1.42,easing:i.ease},r);let o=this.transform,a=this.getZoom(),s=this.getBearing(),l=this.getPitch(),u=this.getPadding(),h="zoom"in r?i.clamp(+r.zoom,o.minZoom,o.maxZoom):a,c="bearing"in r?this._normalizeBearing(r.bearing,s):s,d="pitch"in r?+r.pitch:l,p="padding"in r?r.padding:o.padding,f=o.zoomScale(h-a),m=i.pointGeometry.convert(r.offset),g=o.centerPoint.add(m),_=o.pointLocation(g),y=i.LngLat.convert(r.center||_);this._normalizeCenter(y);let v=o.project(_),x=o.project(y).sub(v),b=r.curve,w=Math.max(o.width,o.height),T=w/f,E=x.mag();if("minZoom"in r){let n=i.clamp(Math.min(r.minZoom,a,h),o.minZoom,o.maxZoom),s=w/o.zoomScale(n-a);b=Math.sqrt(s/E*2)}let S=b*b;function C(i){let r=(T*T-w*w+(i?-1:1)*S*S*E*E)/(2*(i?T:w)*S*E);return Math.log(Math.sqrt(r*r+1)-r)}function I(i){return(Math.exp(i)-Math.exp(-i))/2}function A(i){return(Math.exp(i)+Math.exp(-i))/2}let P=C(0),k=function(i){return A(P)/A(P+b*i)},M=function(i){var r;return w*((A(P)*(I(r=P+b*i)/A(r))-I(P))/S)/E},z=(C(1)-P)/b;if(1e-6>Math.abs(E)||!isFinite(z)){if(1e-6>Math.abs(w-T))return this.easeTo(r,n);let i=T<w?-1:1;z=Math.abs(Math.log(T/w))/b,M=function(){return 0},k=function(r){return Math.exp(i*b*r)}}return r.duration="duration"in r?+r.duration:1e3*z/("screenSpeed"in r?+r.screenSpeed/b:+r.speed),r.maxDuration&&r.duration>r.maxDuration&&(r.duration=0),this._zooming=!0,this._rotating=s!==c,this._pitching=d!==l,this._padding=!o.isPaddingEqual(p),this._prepareEase(n,!1),this._ease(r=>{let f=r*z,_=1/k(f);o.zoom=1===r?h:a+o.scaleZoom(_),this._rotating&&(o.bearing=i.number(s,c,r)),this._pitching&&(o.pitch=i.number(l,d,r)),this._padding&&(o.interpolatePadding(u,p,r),g=o.centerPoint.add(m));let b=1===r?y:o.unproject(v.add(x.mult(M(f))).mult(_));o.setLocationAtPoint(o.renderWorldCopies?b.wrap():b,g),this._fireMoveEvents(n)},()=>this._afterEase(n),r),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(i,r){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){let i=this._onEaseEnd;delete this._onEaseEnd,i.call(this,r)}if(!i){let i=this.handlers;i&&i.stop(!1)}return this}_ease(r,n,o){!1===o.animate||0===o.duration?(r(1),n()):(this._easeStart=i.exported.now(),this._easeOptions=o,this._onEaseFrame=r,this._onEaseEnd=n,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){let r=Math.min((i.exported.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(r)),r<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(r,n){r=i.wrap(r,-180,180);let o=Math.abs(r-n);return Math.abs(r-360-n)<o&&(r-=360),Math.abs(r+360-n)<o&&(r+=360),r}_normalizeCenter(i){let r=this.transform;if(!r.renderWorldCopies||r.lngRange)return;let n=i.lng-r.center.lng;i.lng+=n>180?-360:n<-180?360:0}}class i9{constructor(r={}){this.options=r,i.bindAll(["_toggleAttribution","_updateData","_updateCompact","_updateCompactMinimize"],this)}getDefaultPosition(){return"bottom-right"}onAdd(i){return this._map=i,this._compact=this.options&&this.options.compact,this._container=u.create("details","maplibregl-ctrl maplibregl-ctrl-attrib mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=u.create("summary","maplibregl-ctrl-attrib-button mapboxgl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=u.create("div","maplibregl-ctrl-attrib-inner mapboxgl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){u.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._attribHTML=void 0}_setElementTitle(i,r){let n=this._map._getUIString(`AttributionControl.${r}`);i.title=n,i.setAttribute("aria-label",n)}_toggleAttribution(){this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show","mapboxgl-compact-show")):(this._container.classList.add("maplibregl-compact-show","mapboxgl-compact-show"),this._container.removeAttribute("open")))}_updateData(i){i&&("metadata"===i.sourceDataType||"visibility"===i.sourceDataType||"style"===i.dataType||"terrain"===i.type)&&this._updateAttributions()}_updateAttributions(){if(!this._map.style)return;let i=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?i=i.concat(this.options.customAttribution.map(i=>"string"!=typeof i?"":i)):"string"==typeof this.options.customAttribution&&i.push(this.options.customAttribution)),this._map.style.stylesheet){let i=this._map.style.stylesheet;this.styleOwner=i.owner,this.styleId=i.id}let r=this._map.style.sourceCaches;for(let n in r){let o=r[n];if(o.used||o.usedForTerrain){let r=o.getSource();r.attribution&&0>i.indexOf(r.attribution)&&i.push(r.attribution)}}(i=i.filter(i=>String(i).trim())).sort((i,r)=>i.length-r.length),i=i.filter((r,n)=>{for(let o=n+1;o<i.length;o++)if(i[o].indexOf(r)>=0)return!1;return!0});let n=i.join(" | ");n!==this._attribHTML&&(this._attribHTML=n,i.length?(this._innerContainer.innerHTML=n,this._container.classList.remove("maplibregl-attrib-empty","mapboxgl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty","mapboxgl-attrib-empty"),this._updateCompact(),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640||this._compact?!1===this._compact?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","mapboxgl-compact","maplibregl-compact-show","mapboxgl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show","mapboxgl-compact","mapboxgl-compact-show"))}_updateCompactMinimize(){this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show","mapboxgl-compact-show")}}class i7{constructor(r={}){this.options=r,i.bindAll(["_updateCompact"],this)}getDefaultPosition(){return"bottom-left"}onAdd(i){this._map=i,this._compact=this.options&&this.options.compact,this._container=u.create("div","maplibregl-ctrl mapboxgl-ctrl");let r=u.create("a","maplibregl-ctrl-logo mapboxgl-ctrl-logo");return r.target="_blank",r.rel="noopener nofollow",r.href="https://maplibre.org/",r.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),r.setAttribute("rel","noopener nofollow"),this._container.appendChild(r),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){u.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}_updateCompact(){let i=this._container.children;if(i.length){let r=i[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?!1!==this._compact&&r.classList.add("maplibregl-compact","mapboxgl-compact"):r.classList.remove("maplibregl-compact","mapboxgl-compact")}}}class rt{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(i){let r=++this._id;return this._queue.push({callback:i,id:r,cancelled:!1}),r}remove(i){let r=this._currentlyRunning,n=r?this._queue.concat(r):this._queue;for(let r of n)if(r.id===i)return void(r.cancelled=!0)}run(i=0){if(this._currentlyRunning)throw Error("Attempting to run(), but is already running.");let r=this._currentlyRunning=this._queue;for(let n of(this._queue=[],r))if(!n.cancelled&&(n.callback(i),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}let re={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","TerrainControl.enableTerrain":"Enable terrain","TerrainControl.disableTerrain":"Disable terrain"},ri={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:void 0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,maplibreLogo:!1,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",transformRequest:null,fadeDuration:300,crossSourceCollisions:!0},rr={showCompass:!0,showZoom:!0,visualizePitch:!1};class rn{constructor(r,n,o=!1){this._clickTolerance=10,this.element=n,this.mouseRotate=new iO({clickTolerance:r.dragRotate._mouseRotate._clickTolerance}),this.map=r,o&&(this.mousePitch=new iF({clickTolerance:r.dragRotate._mousePitch._clickTolerance})),i.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),u.addEventListener(n,"mousedown",this.mousedown),u.addEventListener(n,"touchstart",this.touchstart,{passive:!1}),u.addEventListener(n,"touchmove",this.touchmove),u.addEventListener(n,"touchend",this.touchend),u.addEventListener(n,"touchcancel",this.reset)}down(i,r){this.mouseRotate.mousedown(i,r),this.mousePitch&&this.mousePitch.mousedown(i,r),u.disableDrag()}move(i,r){let n=this.map,o=this.mouseRotate.mousemoveWindow(i,r);if(o&&o.bearingDelta&&n.setBearing(n.getBearing()+o.bearingDelta),this.mousePitch){let o=this.mousePitch.mousemoveWindow(i,r);o&&o.pitchDelta&&n.setPitch(n.getPitch()+o.pitchDelta)}}off(){let i=this.element;u.removeEventListener(i,"mousedown",this.mousedown),u.removeEventListener(i,"touchstart",this.touchstart,{passive:!1}),u.removeEventListener(i,"touchmove",this.touchmove),u.removeEventListener(i,"touchend",this.touchend),u.removeEventListener(i,"touchcancel",this.reset),this.offTemp()}offTemp(){u.enableDrag(),u.removeEventListener(window,"mousemove",this.mousemove),u.removeEventListener(window,"mouseup",this.mouseup)}mousedown(r){this.down(i.extend({},r,{ctrlKey:!0,preventDefault:()=>r.preventDefault()}),u.mousePos(this.element,r)),u.addEventListener(window,"mousemove",this.mousemove),u.addEventListener(window,"mouseup",this.mouseup)}mousemove(i){this.move(i,u.mousePos(this.element,i))}mouseup(i){this.mouseRotate.mouseupWindow(i),this.mousePitch&&this.mousePitch.mouseupWindow(i),this.offTemp()}touchstart(i){1!==i.targetTouches.length?this.reset():(this._startPos=this._lastPos=u.touchPos(this.element,i.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>i.preventDefault()},this._startPos))}touchmove(i){1!==i.targetTouches.length?this.reset():(this._lastPos=u.touchPos(this.element,i.targetTouches)[0],this.move({preventDefault:()=>i.preventDefault()},this._lastPos))}touchend(i){0===i.targetTouches.length&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}function ro(r,n,o){if(r=new i.LngLat(r.lng,r.lat),n){let a=new i.LngLat(r.lng-360,r.lat),s=new i.LngLat(r.lng+360,r.lat),l=o.locationPoint(r).distSqr(n);o.locationPoint(a).distSqr(n)<l?r=a:o.locationPoint(s).distSqr(n)<l&&(r=s)}for(;Math.abs(r.lng-o.center.lng)>180;){let i=o.locationPoint(r);if(i.x>=0&&i.y>=0&&i.x<=o.width&&i.y<=o.height)break;r.lng>o.center.lng?r.lng-=360:r.lng+=360}return r}let ra={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function rs(i,r,n){let o=i.classList;for(let i in ra)o.remove(`maplibregl-${n}-anchor-${i}`,`mapboxgl-${n}-anchor-${i}`);o.add(`maplibregl-${n}-anchor-${r}`,`mapboxgl-${n}-anchor-${r}`)}class rl extends i.Evented{constructor(r,n){if(super(),(r instanceof HTMLElement||n)&&(r=i.extend({element:r},n)),i.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress"],this),this._anchor=r&&r.anchor||"center",this._color=r&&r.color||"#3FB1CE",this._scale=r&&r.scale||1,this._draggable=r&&r.draggable||!1,this._clickTolerance=r&&r.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=r&&r.rotation||0,this._rotationAlignment=r&&r.rotationAlignment||"auto",this._pitchAlignment=r&&r.pitchAlignment&&"auto"!==r.pitchAlignment?r.pitchAlignment:this._rotationAlignment,r&&r.element)this._element=r.element,this._offset=i.pointGeometry.convert(r&&r.offset||[0,0]);else{this._defaultMarker=!0,this._element=u.create("div"),this._element.setAttribute("aria-label","Map marker");let n=u.createNS("http://www.w3.org/2000/svg","svg");n.setAttributeNS(null,"display","block"),n.setAttributeNS(null,"height","41px"),n.setAttributeNS(null,"width","27px"),n.setAttributeNS(null,"viewBox","0 0 27 41");let o=u.createNS("http://www.w3.org/2000/svg","g");o.setAttributeNS(null,"stroke","none"),o.setAttributeNS(null,"stroke-width","1"),o.setAttributeNS(null,"fill","none"),o.setAttributeNS(null,"fill-rule","evenodd");let a=u.createNS("http://www.w3.org/2000/svg","g");a.setAttributeNS(null,"fill-rule","nonzero");let s=u.createNS("http://www.w3.org/2000/svg","g");for(let i of(s.setAttributeNS(null,"transform","translate(3.0, 29.0)"),s.setAttributeNS(null,"fill","#000000"),[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}])){let r=u.createNS("http://www.w3.org/2000/svg","ellipse");r.setAttributeNS(null,"opacity","0.04"),r.setAttributeNS(null,"cx","10.5"),r.setAttributeNS(null,"cy","5.80029008"),r.setAttributeNS(null,"rx",i.rx),r.setAttributeNS(null,"ry",i.ry),s.appendChild(r)}let l=u.createNS("http://www.w3.org/2000/svg","g");l.setAttributeNS(null,"fill",this._color);let h=u.createNS("http://www.w3.org/2000/svg","path");h.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),l.appendChild(h);let c=u.createNS("http://www.w3.org/2000/svg","g");c.setAttributeNS(null,"opacity","0.25"),c.setAttributeNS(null,"fill","#000000");let d=u.createNS("http://www.w3.org/2000/svg","path");d.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),c.appendChild(d);let p=u.createNS("http://www.w3.org/2000/svg","g");p.setAttributeNS(null,"transform","translate(6.0, 7.0)"),p.setAttributeNS(null,"fill","#FFFFFF");let f=u.createNS("http://www.w3.org/2000/svg","g");f.setAttributeNS(null,"transform","translate(8.0, 8.0)");let m=u.createNS("http://www.w3.org/2000/svg","circle");m.setAttributeNS(null,"fill","#000000"),m.setAttributeNS(null,"opacity","0.25"),m.setAttributeNS(null,"cx","5.5"),m.setAttributeNS(null,"cy","5.5"),m.setAttributeNS(null,"r","5.4999962");let g=u.createNS("http://www.w3.org/2000/svg","circle");g.setAttributeNS(null,"fill","#FFFFFF"),g.setAttributeNS(null,"cx","5.5"),g.setAttributeNS(null,"cy","5.5"),g.setAttributeNS(null,"r","5.4999962"),f.appendChild(m),f.appendChild(g),a.appendChild(s),a.appendChild(l),a.appendChild(c),a.appendChild(p),a.appendChild(f),n.appendChild(a),n.setAttributeNS(null,"height",41*this._scale+"px"),n.setAttributeNS(null,"width",27*this._scale+"px"),this._element.appendChild(n),this._offset=i.pointGeometry.convert(r&&r.offset||[0,-14])}this._element.classList.add("maplibregl-marker","mapboxgl-marker"),this._element.addEventListener("dragstart",i=>{i.preventDefault()}),this._element.addEventListener("mousedown",i=>{i.preventDefault()}),rs(this._element,this._anchor,"marker"),this._popup=null}addTo(i){return this.remove(),this._map=i,i.getCanvasContainer().appendChild(this._element),i.on("move",this._update),i.on("moveend",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),u.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(r){return this._lngLat=i.LngLat.convert(r),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(i){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),i){if(!("offset"in i.options)){let r=Math.sqrt(91.125);i.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[r,-1*(24.6+r)],"bottom-right":[-r,-1*(24.6+r)],left:[13.5,-24.6],right:[-13.5,-24.6]}:this._offset}this._popup=i,this._lngLat&&this._popup.setLngLat(this._lngLat),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}_onKeyPress(i){let r=i.code,n=i.charCode||i.keyCode;"Space"!==r&&"Enter"!==r&&32!==n&&13!==n||this.togglePopup()}_onMapClick(i){let r=i.originalEvent.target,n=this._element;this._popup&&(r===n||n.contains(r))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){let i=this._popup;return i&&(i.isOpen()?i.remove():i.addTo(this._map)),this}_update(i){if(!this._map)return;this._map.transform.renderWorldCopies&&(this._lngLat=ro(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._offset);let r="";"viewport"===this._rotationAlignment||"auto"===this._rotationAlignment?r=`rotateZ(${this._rotation}deg)`:"map"===this._rotationAlignment&&(r=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let n="";"viewport"===this._pitchAlignment||"auto"===this._pitchAlignment?n="rotateX(0deg)":"map"===this._pitchAlignment&&(n=`rotateX(${this._map.getPitch()}deg)`),i&&"moveend"!==i.type||(this._pos=this._pos.round()),u.setTransform(this._element,`${ra[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${n} ${r}`),this._map.style&&this._map.style.terrain&&!this._opacityTimeout&&(this._opacityTimeout=setTimeout(()=>{let i=this._map.unproject(this._pos),r=40075016.686*Math.abs(Math.cos(this._lngLat.lat*Math.PI/180))/Math.pow(2,this._map.transform.tileZoom+8);this._element.style.opacity=i.distanceTo(this._lngLat)>20*r?"0.2":"1.0",this._opacityTimeout=null},100))}getOffset(){return this._offset}setOffset(r){return this._offset=i.pointGeometry.convert(r),this._update(),this}_onMove(r){if(!this._isDragging){let i=this._clickTolerance||this._map._clickTolerance;this._isDragging=r.point.dist(this._pointerdownPos)>=i}this._isDragging&&(this._pos=r.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none","pending"===this._state&&(this._state="active",this.fire(new i.Event("dragstart"))),this.fire(new i.Event("drag")))}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),"active"===this._state&&this.fire(new i.Event("dragend")),this._state="inactive"}_addDragHandler(i){this._element.contains(i.originalEvent.target)&&(i.preventDefault(),this._positionDelta=i.point.sub(this._pos).add(this._offset),this._pointerdownPos=i.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))}setDraggable(i){return this._draggable=!!i,this._map&&(i?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(i){return this._rotation=i||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(i){return this._rotationAlignment=i||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(i){return this._pitchAlignment=i&&"auto"!==i?i:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}}let ru={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0},rh,rc=0,rd=!1,rp={maxWidth:100,unit:"metric"};function rf(i,r,n){let o=n&&n.maxWidth||100,a=i._container.clientHeight/2,s=i.unproject([0,a]),l=i.unproject([o,a]),u=s.distanceTo(l);if(n&&"imperial"===n.unit){let n=3.2808*u;n>5280?rm(r,o,n/5280,i._getUIString("ScaleControl.Miles")):rm(r,o,n,i._getUIString("ScaleControl.Feet"))}else n&&"nautical"===n.unit?rm(r,o,u/1852,i._getUIString("ScaleControl.NauticalMiles")):u>=1e3?rm(r,o,u/1e3,i._getUIString("ScaleControl.Kilometers")):rm(r,o,u,i._getUIString("ScaleControl.Meters"))}function rm(i,r,n,o){let a=function(i){let r=Math.pow(10,`${Math.floor(i)}`.length-1),n=i/r;return r*(n=n>=10?10:n>=5?5:n>=3?3:n>=2?2:n>=1?1:function(i){let r=Math.pow(10,Math.ceil(-Math.log(i)/Math.LN10));return Math.round(i*r)/r}(n))}(n);i.style.width=r*(a/n)+"px",i.innerHTML=`${a}&nbsp;${o}`}let rg={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},r_={supported:a,setRTLTextPlugin:i.setRTLTextPlugin,getRTLTextPluginStatus:i.getRTLTextPluginStatus,Map:class extends i8{constructor(r){var n;if(i.PerformanceUtils.mark(i.PerformanceMarkers.create),null!=(r=i.extend({},ri,r)).minZoom&&null!=r.maxZoom&&r.minZoom>r.maxZoom)throw Error("maxZoom must be greater than or equal to minZoom");if(null!=r.minPitch&&null!=r.maxPitch&&r.minPitch>r.maxPitch)throw Error("maxPitch must be greater than or equal to minPitch");if(null!=r.minPitch&&r.minPitch<0)throw Error("minPitch must be greater than or equal to 0");if(null!=r.maxPitch&&r.maxPitch>85)throw Error("maxPitch must be less than or equal to 85");if(super(new ip(r.minZoom,r.maxZoom,r.minPitch,r.maxPitch,r.renderWorldCopies),{bearingSnap:r.bearingSnap}),this._interactive=r.interactive,this._cooperativeGestures=r.cooperativeGestures,this._maxTileCacheSize=r.maxTileCacheSize,this._failIfMajorPerformanceCaveat=r.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=r.preserveDrawingBuffer,this._antialias=r.antialias,this._trackResize=r.trackResize,this._bearingSnap=r.bearingSnap,this._refreshExpiredTiles=r.refreshExpiredTiles,this._fadeDuration=r.fadeDuration,this._crossSourceCollisions=r.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=r.collectResourceTiming,this._renderTaskQueue=new rt,this._controls=[],this._mapId=i.uniqueId(),this._locale=i.extend({},re,r.locale),this._clickTolerance=r.clickTolerance,this._pixelRatio=null!==(n=r.pixelRatio)&&void 0!==n?n:devicePixelRatio,this._requestManager=new h(r.transformRequest),"string"==typeof r.container){if(this._container=document.getElementById(r.container),!this._container)throw Error(`Container '${r.container}' not found.`)}else{if(!(r.container instanceof HTMLElement))throw Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=r.container}if(r.maxBounds&&this.setMaxBounds(r.maxBounds),i.bindAll(["_onWindowOnline","_onWindowResize","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),void 0===this.painter)throw Error("Failed to initialize WebGL.");this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),this.on("terrain",()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)}),"undefined"!=typeof window&&(addEventListener("online",this._onWindowOnline,!1),addEventListener("resize",this._onWindowResize,!1),addEventListener("orientationchange",this._onWindowResize,!1)),this.handlers=new i6(this,r),this._cooperativeGestures&&this._setupCooperativeGestures(),this._hash=r.hash&&new im("string"==typeof r.hash&&r.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:r.center,zoom:r.zoom,bearing:r.bearing,pitch:r.pitch}),r.bounds&&(this.resize(),this.fitBounds(r.bounds,i.extend({},r.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=r.localIdeographFontFamily,r.style&&this.setStyle(r.style,{localIdeographFontFamily:r.localIdeographFontFamily}),r.attributionControl&&this.addControl(new i9({customAttribution:r.customAttribution})),r.maplibreLogo&&this.addControl(new i7,r.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",r=>{this._update("style"===r.dataType),this.fire(new i.Event(`${r.dataType}data`,r))}),this.on("dataloading",r=>{this.fire(new i.Event(`${r.dataType}dataloading`,r))}),this.on("dataabort",r=>{this.fire(new i.Event("sourcedataabort",r))})}_getMapId(){return this._mapId}addControl(r,n){if(void 0===n&&(n=r.getDefaultPosition?r.getDefaultPosition():"top-right"),!r||!r.onAdd)return this.fire(new i.ErrorEvent(Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));let o=r.onAdd(this);this._controls.push(r);let a=this._controlPositions[n];return -1!==n.indexOf("bottom")?a.insertBefore(o,a.firstChild):a.appendChild(o),this}removeControl(r){if(!r||!r.onRemove)return this.fire(new i.ErrorEvent(Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));let n=this._controls.indexOf(r);return n>-1&&this._controls.splice(n,1),r.onRemove(this),this}hasControl(i){return this._controls.indexOf(i)>-1}calculateCameraOptionsFromTo(i,r,n,o){return null==o&&this.style.terrain&&(o=this.transform.getElevation(n,this.style.terrain)),super.calculateCameraOptionsFromTo(i,r,n,o)}resize(r){let n=this._containerDimensions(),o=n[0],a=n[1];this._resizeCanvas(o,a,this.getPixelRatio()),this.transform.resize(o,a),this.painter.resize(o,a,this.getPixelRatio());let s=!this._moving;return s&&(this.stop(),this.fire(new i.Event("movestart",r)).fire(new i.Event("move",r))),this.fire(new i.Event("resize",r)),s&&this.fire(new i.Event("moveend",r)),this}getPixelRatio(){return this._pixelRatio}setPixelRatio(i){let[r,n]=this._containerDimensions();this._pixelRatio=i,this._resizeCanvas(r,n,i),this.painter.resize(r,n,i)}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(r){return this.transform.setMaxBounds(i.LngLatBounds.convert(r)),this._update()}setMinZoom(i){if((i=null==i?-2:i)>=-2&&i<=this.transform.maxZoom)return this.transform.minZoom=i,this._update(),this.getZoom()<i&&this.setZoom(i),this;throw Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(i){if((i=null==i?22:i)>=this.transform.minZoom)return this.transform.maxZoom=i,this._update(),this.getZoom()>i&&this.setZoom(i),this;throw Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(i){if((i=null==i?0:i)<0)throw Error("minPitch must be greater than or equal to 0");if(i>=0&&i<=this.transform.maxPitch)return this.transform.minPitch=i,this._update(),this.getPitch()<i&&this.setPitch(i),this;throw Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(i){if((i=null==i?60:i)>85)throw Error("maxPitch must be less than or equal to 85");if(i>=this.transform.minPitch)return this.transform.maxPitch=i,this._update(),this.getPitch()>i&&this.setPitch(i),this;throw Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(i){return this.transform.renderWorldCopies=i,this._update()}project(r){return this.transform.locationPoint(i.LngLat.convert(r),this.style&&this.style.terrain)}unproject(r){return this.transform.pointLocation(i.pointGeometry.convert(r),this.style&&this.style.terrain)}isMoving(){return this._moving||this.handlers.isMoving()}isZooming(){return this._zooming||this.handlers.isZooming()}isRotating(){return this._rotating||this.handlers.isRotating()}_createDelegatedListener(i,r,n){if("mouseenter"===i||"mouseover"===i){let o=!1;return{layer:r,listener:n,delegates:{mousemove:a=>{let s=this.getLayer(r)?this.queryRenderedFeatures(a.point,{layers:[r]}):[];s.length?o||(o=!0,n.call(this,new iE(i,this,a.originalEvent,{features:s}))):o=!1},mouseout:()=>{o=!1}}}}if("mouseleave"===i||"mouseout"===i){let o=!1;return{layer:r,listener:n,delegates:{mousemove:a=>{(this.getLayer(r)?this.queryRenderedFeatures(a.point,{layers:[r]}):[]).length?o=!0:o&&(o=!1,n.call(this,new iE(i,this,a.originalEvent)))},mouseout:r=>{o&&(o=!1,n.call(this,new iE(i,this,r.originalEvent)))}}}}return{layer:r,listener:n,delegates:{[i]:i=>{let o=this.getLayer(r)?this.queryRenderedFeatures(i.point,{layers:[r]}):[];o.length&&(i.features=o,n.call(this,i),delete i.features)}}}}on(i,r,n){if(void 0===n)return super.on(i,r);let o=this._createDelegatedListener(i,r,n);for(let r in this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[i]=this._delegatedListeners[i]||[],this._delegatedListeners[i].push(o),o.delegates)this.on(r,o.delegates[r]);return this}once(i,r,n){if(void 0===n)return super.once(i,r);let o=this._createDelegatedListener(i,r,n);for(let i in o.delegates)this.once(i,o.delegates[i]);return this}off(i,r,n){return void 0===n?super.off(i,r):(this._delegatedListeners&&this._delegatedListeners[i]&&(o=>{let a=this._delegatedListeners[i];for(let i=0;i<a.length;i++){let o=a[i];if(o.layer===r&&o.listener===n){for(let i in o.delegates)this.off(i,o.delegates[i]);return a.splice(i,1),this}}})(),this)}queryRenderedFeatures(r,n){let o;if(!this.style)return[];if(void 0!==n||void 0===r||r instanceof i.pointGeometry||Array.isArray(r)||(n=r,r=void 0),n=n||{},(r=r||[[0,0],[this.transform.width,this.transform.height]])instanceof i.pointGeometry||"number"==typeof r[0])o=[i.pointGeometry.convert(r)];else{let n=i.pointGeometry.convert(r[0]),a=i.pointGeometry.convert(r[1]);o=[n,new i.pointGeometry(a.x,n.y),a,new i.pointGeometry(n.x,a.y),n]}return this.style.queryRenderedFeatures(o,n,this.transform)}querySourceFeatures(i,r){return this.style.querySourceFeatures(i,r)}setStyle(r,n){return!1!==(n=i.extend({},{localIdeographFontFamily:this._localIdeographFontFamily},n)).diff&&n.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&r?(this._diffStyle(r,n),this):(this._localIdeographFontFamily=n.localIdeographFontFamily,this._updateStyle(r,n))}setTransformRequest(i){return this._requestManager.setTransformRequest(i),this}_getUIString(i){let r=this._locale[i];if(null==r)throw Error(`Missing UI string '${i}'`);return r}_updateStyle(i,r){return this.style&&(this.style.setEventedParent(null),this.style._remove()),i?(this.style=new tZ(this,r||{}),this.style.setEventedParent(this,{style:this.style}),"string"==typeof i?this.style.loadURL(i):this.style.loadJSON(i)):delete this.style,this}_lazyInitEmptyStyle(){this.style||(this.style=new tZ(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(r,n){if("string"==typeof r){let o=this._requestManager.transformRequest(r,i.ResourceType.Style);i.getJSON(o,(r,o)=>{r?this.fire(new i.ErrorEvent(r)):o&&this._updateDiff(o,n)})}else"object"==typeof r&&this._updateDiff(r,n)}_updateDiff(r,n){try{this.style.setState(r)&&this._update(!0)}catch(o){i.warnOnce(`Unable to perform style diff: ${o.message||o.error||o}.  Rebuilding the style from scratch.`),this._updateStyle(r,n)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():i.warnOnce("There is no style added to the map.")}addSource(i,r){return this._lazyInitEmptyStyle(),this.style.addSource(i,r),this._update(!0)}isSourceLoaded(r){let n=this.style&&this.style.sourceCaches[r];if(void 0!==n)return n.loaded();this.fire(new i.ErrorEvent(Error(`There is no source with ID '${r}'`)))}setTerrain(i){return this.style.setTerrain(i),this}getTerrain(){return this.style.terrain&&this.style.terrain.options}areTilesLoaded(){let i=this.style&&this.style.sourceCaches;for(let r in i){let n=i[r]._tiles;for(let i in n){let r=n[i];if("loaded"!==r.state&&"errored"!==r.state)return!1}}return!0}addSourceType(i,r,n){return this._lazyInitEmptyStyle(),this.style.addSourceType(i,r,n)}removeSource(i){return this.style.removeSource(i),this._update(!0)}getSource(i){return this.style.getSource(i)}addImage(r,n,{pixelRatio:o=1,sdf:a=!1,stretchX:s,stretchY:l,content:u}={}){if(this._lazyInitEmptyStyle(),n instanceof HTMLImageElement||i.isImageBitmap(n)){let{width:h,height:c,data:d}=i.exported.getImageData(n);this.style.addImage(r,{data:new i.RGBAImage({width:h,height:c},d),pixelRatio:o,stretchX:s,stretchY:l,content:u,sdf:a,version:0})}else{if(void 0===n.width||void 0===n.height)return this.fire(new i.ErrorEvent(Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{let{width:h,height:c,data:d}=n;this.style.addImage(r,{data:new i.RGBAImage({width:h,height:c},new Uint8Array(d)),pixelRatio:o,stretchX:s,stretchY:l,content:u,sdf:a,version:0,userImage:n}),n.onAdd&&n.onAdd(this,r)}}}updateImage(r,n){let o=this.style.getImage(r);if(!o)return this.fire(new i.ErrorEvent(Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));let a=n instanceof HTMLImageElement||i.isImageBitmap(n)?i.exported.getImageData(n):n,{width:s,height:l,data:u}=a;if(void 0===s||void 0===l)return this.fire(new i.ErrorEvent(Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(s!==o.data.width||l!==o.data.height)return this.fire(new i.ErrorEvent(Error("The width and height of the updated image must be that same as the previous version of the image")));let h=!(n instanceof HTMLImageElement||i.isImageBitmap(n));o.data.replace(u,h),this.style.updateImage(r,o)}hasImage(r){return r?!!this.style.getImage(r):(this.fire(new i.ErrorEvent(Error("Missing required image id"))),!1)}removeImage(i){this.style.removeImage(i)}loadImage(r,n){i.getImage(this._requestManager.transformRequest(r,i.ResourceType.Image),n)}listImages(){return this.style.listImages()}addLayer(i,r){return this._lazyInitEmptyStyle(),this.style.addLayer(i,r),this._update(!0)}moveLayer(i,r){return this.style.moveLayer(i,r),this._update(!0)}removeLayer(i){return this.style.removeLayer(i),this._update(!0)}getLayer(i){return this.style.getLayer(i)}setLayerZoomRange(i,r,n){return this.style.setLayerZoomRange(i,r,n),this._update(!0)}setFilter(i,r,n={}){return this.style.setFilter(i,r,n),this._update(!0)}getFilter(i){return this.style.getFilter(i)}setPaintProperty(i,r,n,o={}){return this.style.setPaintProperty(i,r,n,o),this._update(!0)}getPaintProperty(i,r){return this.style.getPaintProperty(i,r)}setLayoutProperty(i,r,n,o={}){return this.style.setLayoutProperty(i,r,n,o),this._update(!0)}getLayoutProperty(i,r){return this.style.getLayoutProperty(i,r)}setLight(i,r={}){return this._lazyInitEmptyStyle(),this.style.setLight(i,r),this._update(!0)}getLight(){return this.style.getLight()}setFeatureState(i,r){return this.style.setFeatureState(i,r),this._update()}removeFeatureState(i,r){return this.style.removeFeatureState(i,r),this._update()}getFeatureState(i){return this.style.getFeatureState(i)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let i=0,r=0;return this._container&&(i=this._container.clientWidth||400,r=this._container.clientHeight||300),[i,r]}_setupContainer(){let i=this._container;i.classList.add("maplibregl-map","mapboxgl-map");let r=this._canvasContainer=u.create("div","maplibregl-canvas-container mapboxgl-canvas-container",i);this._interactive&&r.classList.add("maplibregl-interactive","mapboxgl-interactive"),this._canvas=u.create("canvas","maplibregl-canvas mapboxgl-canvas",r),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map"),this._canvas.setAttribute("role","region");let n=this._containerDimensions();this._resizeCanvas(n[0],n[1],this.getPixelRatio());let o=this._controlContainer=u.create("div","maplibregl-control-container mapboxgl-control-container",i),a=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(i=>{a[i]=u.create("div",`maplibregl-ctrl-${i} mapboxgl-ctrl-${i}`,o)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_setupCooperativeGestures(){let i=this._container;this._metaPress=!1,this._cooperativeGesturesScreen=u.create("div","maplibregl-cooperative-gesture-screen",i);let r="Control",n="boolean"!=typeof this._cooperativeGestures&&this._cooperativeGestures.windowsHelpText?this._cooperativeGestures.windowsHelpText:"Use Ctrl + scroll to zoom the map";0===navigator.platform.indexOf("Mac")&&(n="boolean"!=typeof this._cooperativeGestures&&this._cooperativeGestures.macHelpText?this._cooperativeGestures.macHelpText:"Use â + scroll to zoom the map",r="Meta"),this._cooperativeGesturesScreen.innerHTML=`
            <div class="maplibregl-desktop-message">${n}</div>
            <div class="maplibregl-mobile-message">${"boolean"!=typeof this._cooperativeGestures&&this._cooperativeGestures.mobileHelpText?this._cooperativeGestures.mobileHelpText:"Use two fingers to move the map"}</div>
        `,document.addEventListener("keydown",i=>{i.key===r&&(this._metaPress=!0)}),document.addEventListener("keyup",i=>{i.key===r&&(this._metaPress=!1)}),this._canvasContainer.addEventListener("wheel",i=>{this._onCooperativeGesture(i,this._metaPress,1)},!1),this._canvasContainer.classList.remove("mapboxgl-touch-drag-pan","maplibregl-touch-drag-pan")}_resizeCanvas(i,r,n){this._canvas.width=n*i,this._canvas.height=n*r,this._canvas.style.width=`${i}px`,this._canvas.style.height=`${r}px`}_setupPainter(){let r=i.extend({},a.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),n=this._canvas.getContext("webgl",r)||this._canvas.getContext("experimental-webgl",r);n?(this.painter=new iu(n,this.transform),i.exported$1.testSupport(n)):this.fire(new i.ErrorEvent(Error("Failed to initialize WebGL")))}_contextLost(r){r.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new i.Event("webglcontextlost",{originalEvent:r}))}_contextRestored(r){this._setupPainter(),this.resize(),this._update(),this.fire(new i.Event("webglcontextrestored",{originalEvent:r}))}_onMapScroll(i){if(i.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}_onCooperativeGesture(i,r,n){return!r&&n<2&&(this._cooperativeGesturesScreen.classList.add("maplibregl-show"),setTimeout(()=>{this._cooperativeGesturesScreen.classList.remove("maplibregl-show")},100)),!1}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(i){return this.style&&(this._styleDirty=this._styleDirty||i,this._sourcesDirty=!0,this.triggerRepaint()),this}_requestRenderFrame(i){return this._update(),this._renderTaskQueue.add(i)}_cancelRenderFrame(i){this._renderTaskQueue.remove(i)}_render(r){let n,o=0,a=this.painter.context.extTimerQuery;if(this.listens("gpu-timing-frame")&&(n=a.createQueryEXT(),a.beginQueryEXT(a.TIME_ELAPSED_EXT,n),o=i.exported.now()),this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(r),this._removed)return;let s=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;let r=this.transform.zoom,n=i.exported.now();this.style.zoomHistory.update(r,n);let o=new i.EvaluationParameters(r,{now:n,fadeDuration:this._fadeDuration,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),a=o.crossFadingFactor();1===a&&a===this._crossFadingFactor||(s=!0,this._crossFadingFactor=a),this.style.update(o)}if(this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.style.terrain&&this.style.terrain.sourceCache.update(this.transform,this.style.terrain),this.transform.updateElevation(this.style.terrain),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,this._fadeDuration,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:this._fadeDuration,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer")}),this.fire(new i.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,i.PerformanceUtils.mark(i.PerformanceMarkers.load),this.fire(new i.Event("load"))),this.style&&(this.style.hasTransitions()||s)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),this.listens("gpu-timing-frame")){let r=i.exported.now()-o;a.endQueryEXT(a.TIME_ELAPSED_EXT,n),setTimeout(()=>{let o=a.getQueryObjectEXT(n,a.QUERY_RESULT_EXT)/1e6;a.deleteQueryEXT(n),this.fire(new i.Event("gpu-timing-frame",{cpuTime:r,gpuTime:o}))},50)}if(this.listens("gpu-timing-layer")){let r=this.painter.collectGpuTimers();setTimeout(()=>{let n=this.painter.queryGpuTimers(r);this.fire(new i.Event("gpu-timing-layer",{layerTimes:n}))},50)}let l=this._sourcesDirty||this._styleDirty||this._placementDirty;return l||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new i.Event("idle")),!this._loaded||this._fullyLoaded||l||(this._fullyLoaded=!0,i.PerformanceUtils.mark(i.PerformanceMarkers.fullLoad)),this}redraw(){return this.style&&(this._frame&&(this._frame.cancel(),this._frame=null),this._render(0)),this}remove(){for(let i of(this._hash&&this._hash.remove(),this._controls))i.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),"undefined"!=typeof window&&(removeEventListener("resize",this._onWindowResize,!1),removeEventListener("orientationchange",this._onWindowResize,!1),removeEventListener("online",this._onWindowOnline,!1));let r=this.painter.context.gl.getExtension("WEBGL_lose_context");r&&r.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),u.remove(this._canvasContainer),u.remove(this._controlContainer),this._cooperativeGestures&&u.remove(this._cooperativeGesturesScreen),this._container.classList.remove("maplibregl-map","mapboxgl-map"),i.PerformanceUtils.clearMetrics(),this._removed=!0,this.fire(new i.Event("remove"))}triggerRepaint(){this.style&&!this._frame&&(this._frame=i.exported.frame(r=>{i.PerformanceUtils.frame(r),this._frame=null,this._render(r)}))}_onWindowOnline(){this._update()}_onWindowResize(i){this._trackResize&&this.resize({originalEvent:i})._update()}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(i){this._showTileBoundaries!==i&&(this._showTileBoundaries=i,this._update())}get showPadding(){return!!this._showPadding}set showPadding(i){this._showPadding!==i&&(this._showPadding=i,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(i){this._showCollisionBoxes!==i&&(this._showCollisionBoxes=i,i?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(i){this._showOverdrawInspector!==i&&(this._showOverdrawInspector=i,this._update())}get repaint(){return!!this._repaint}set repaint(i){this._repaint!==i&&(this._repaint=i,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(i){this._vertices=i,this._update()}_setCacheLimits(r,n){i.setCacheLimits(r,n)}get version(){return"2.4.0"}},NavigationControl:class{constructor(r){this.options=i.extend({},rr,r),this._container=u.create("div","maplibregl-ctrl maplibregl-ctrl-group mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",i=>i.preventDefault()),this.options.showZoom&&(i.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in mapboxgl-ctrl-zoom-in",i=>this._map.zoomIn({},{originalEvent:i})),u.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out mapboxgl-ctrl-zoom-out",i=>this._map.zoomOut({},{originalEvent:i})),u.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(i.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("maplibregl-ctrl-compass mapboxgl-ctrl-compass",i=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:i}):this._map.resetNorth({},{originalEvent:i})}),this._compassIcon=u.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}_updateZoomButtons(){let i=this._map.getZoom(),r=i===this._map.getMaxZoom(),n=i===this._map.getMinZoom();this._zoomInButton.disabled=r,this._zoomOutButton.disabled=n,this._zoomInButton.setAttribute("aria-disabled",r.toString()),this._zoomOutButton.setAttribute("aria-disabled",n.toString())}_rotateCompassArrow(){let i=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${this._map.transform.angle*(180/Math.PI)}deg)`:`rotate(${this._map.transform.angle*(180/Math.PI)}deg)`;this._compassIcon.style.transform=i}onAdd(i){return this._map=i,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new rn(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){u.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(i,r){let n=u.create("button",i,this._container);return n.type="button",n.addEventListener("click",r),n}_setButtonTitle(i,r){let n=this._map._getUIString(`NavigationControl.${r}`);i.title=n,i.setAttribute("aria-label",n)}},GeolocateControl:class extends i.Evented{constructor(r){super(),this.options=i.extend({},ru,r),i.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker"],this)}onAdd(i){var r;return this._map=i,this._container=u.create("div","maplibregl-ctrl maplibregl-ctrl-group mapboxgl-ctrl mapboxgl-ctrl-group"),r=this._setupUI,void 0!==rh?r(rh):void 0!==window.navigator.permissions?window.navigator.permissions.query({name:"geolocation"}).then(i=>{r(rh="denied"!==i.state)}):(rh=!!window.navigator.geolocation,r(rh)),this._container}onRemove(){void 0!==this._geolocationWatchID&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),u.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,rc=0,rd=!1}_isOutOfMapMaxBounds(i){let r=this._map.getMaxBounds(),n=i.coords;return r&&(n.longitude<r.getWest()||n.longitude>r.getEast()||n.latitude<r.getSouth()||n.latitude>r.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error","mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":break;default:throw Error(`Unexpected watchState ${this._watchState}`)}}_onSuccess(r){if(this._map){if(this._isOutOfMapMaxBounds(r))return this._setErrorState(),this.fire(new i.Event("outofmaxbounds",r)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=r,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error","mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background");break;default:throw Error(`Unexpected watchState ${this._watchState}`)}this.options.showUserLocation&&"OFF"!==this._watchState&&this._updateMarker(r),this.options.trackUserLocation&&"ACTIVE_LOCK"!==this._watchState||this._updateCamera(r),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale","mapboxgl-user-location-dot-stale"),this.fire(new i.Event("geolocate",r)),this._finish()}}_updateCamera(r){let n=new i.LngLat(r.coords.longitude,r.coords.latitude),o=r.coords.accuracy,a=this._map.getBearing(),s=i.extend({bearing:a},this.options.fitBoundsOptions);this._map.fitBounds(n.toBounds(o),s,{geolocateSource:!0})}_updateMarker(r){if(r){let n=new i.LngLat(r.coords.longitude,r.coords.latitude);this._accuracyCircleMarker.setLngLat(n).addTo(this._map),this._userLocationDotMarker.setLngLat(n).addTo(this._map),this._accuracy=r.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){let i=this._map._container.clientHeight/2,r=this._map.unproject([0,i]),n=this._map.unproject([1,i]),o=r.distanceTo(n),a=Math.ceil(2*this._accuracy/o);this._circleElement.style.width=`${a}px`,this._circleElement.style.height=`${a}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_onError(r){if(this._map){if(this.options.trackUserLocation){if(1===r.code){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error","mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;let i=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=i,this._geolocateButton.setAttribute("aria-label",i),void 0!==this._geolocationWatchID&&this._clearWatch()}else{if(3===r.code&&rd)return;this._setErrorState()}}"OFF"!==this._watchState&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale","mapboxgl-user-location-dot-stale"),this.fire(new i.Event("error",r)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(r){if(this._container.addEventListener("contextmenu",i=>i.preventDefault()),this._geolocateButton=u.create("button","maplibregl-ctrl-geolocate mapboxgl-ctrl-geolocate",this._container),u.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",!1===r){i.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");let r=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=r,this._geolocateButton.setAttribute("aria-label",r)}else{let i=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=i,this._geolocateButton.setAttribute("aria-label",i)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=u.create("div","maplibregl-user-location-dot mapboxgl-user-location-dot"),this._userLocationDotMarker=new rl(this._dotElement),this._circleElement=u.create("div","maplibregl-user-location-accuracy-circle mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new rl({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",r=>{r.geolocateSource||"ACTIVE_LOCK"!==this._watchState||r.originalEvent&&"resize"===r.originalEvent.type||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active"),this.fire(new i.Event("trackuserlocationend")))})}trigger(){if(!this._setup)return i.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new i.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":rc--,rd=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error","mapboxgl-ctrl-geolocate-background-error"),this.fire(new i.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new i.Event("trackuserlocationstart"));break;default:throw Error(`Unexpected watchState ${this._watchState}`)}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active");break;case"OFF":break;default:throw Error(`Unexpected watchState ${this._watchState}`)}if("OFF"===this._watchState&&void 0!==this._geolocationWatchID)this._clearWatch();else if(void 0===this._geolocationWatchID){let i;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),++rc>1?(i={maximumAge:6e5,timeout:0},rd=!0):(i=this.options.positionOptions,rd=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,i)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:i9,LogoControl:i7,ScaleControl:class{constructor(r){this.options=i.extend({},rp,r),i.bindAll(["_onMove","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_onMove(){rf(this._map,this._container,this.options)}onAdd(i){return this._map=i,this._container=u.create("div","maplibregl-ctrl maplibregl-ctrl-scale mapboxgl-ctrl mapboxgl-ctrl-scale",i.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){u.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}setUnit(i){this.options.unit=i,rf(this._map,this._container,this.options)}},FullscreenControl:class{constructor(r){this._fullscreen=!1,r&&r.container&&(r.container instanceof HTMLElement?this._container=r.container:i.warnOnce("Full screen control 'container' must be a DOM element.")),i.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(r){return this._map=r,this._container||(this._container=this._map.getContainer()),this._controlContainer=u.create("div","maplibregl-ctrl maplibregl-ctrl-group mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",i.warnOnce("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){u.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!!(document.fullscreenEnabled||document.mozFullScreenEnabled||document.msFullscreenEnabled||document.webkitFullscreenEnabled)}_setupUI(){let i=this._fullscreenButton=u.create("button","maplibregl-ctrl-fullscreen mapboxgl-ctrl-fullscreen",this._controlContainer);u.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",i).setAttribute("aria-hidden","true"),i.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){let i=this._getTitle();this._fullscreenButton.setAttribute("aria-label",i),this._fullscreenButton.title=i}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen&&window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},TerrainControl:class{constructor(r){this.options=r,i.bindAll(["_toggleTerrain","_updateTerrainIcon"],this)}onAdd(i){return this._map=i,this._container=u.create("div","maplibregl-ctrl maplibregl-ctrl-group mapboxgl-ctrl mapboxgl-ctrl-group"),this._terrainButton=u.create("button","maplibregl-ctrl-terrain mapboxgl-ctrl-terrain",this._container),u.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){u.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}_toggleTerrain(){this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()}_updateTerrainIcon(){this._terrainButton.classList.remove("maplibregl-ctrl-terrain","mapboxgl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled","mapboxgl-ctrl-terrain-enabled"),this._map.style.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled","mapboxgl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.disableTerrain")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain","mapboxgl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.enableTerrain"))}},Popup:class extends i.Evented{constructor(r){super(),this.options=i.extend(Object.create(rg),r),i.bindAll(["_update","_onClose","remove","_onMouseMove","_onMouseUp","_onDrag"],this)}addTo(r){return this._map&&this.remove(),this._map=r,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer","mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer","mapboxgl-track-pointer")):this._map.on("move",this._update),this.fire(new i.Event("open")),this}isOpen(){return!!this._map}remove(){return this._content&&u.remove(this._content),this._container&&(u.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),delete this._map),this.fire(new i.Event("close")),this}getLngLat(){return this._lngLat}setLngLat(r){return this._lngLat=i.LngLat.convert(r),this._pos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer","mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer","mapboxgl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer","mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer","mapboxgl-track-pointer")),this}getElement(){return this._container}setText(i){return this.setDOMContent(document.createTextNode(i))}setHTML(i){let r;let n=document.createDocumentFragment(),o=document.createElement("body");for(o.innerHTML=i;r=o.firstChild;)n.appendChild(r);return this.setDOMContent(n)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(i){return this.options.maxWidth=i,this._update(),this}setDOMContent(i){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=u.create("div","maplibregl-popup-content mapboxgl-popup-content",this._container);return this._content.appendChild(i),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(i){this._container&&this._container.classList.add(i)}removeClassName(i){this._container&&this._container.classList.remove(i)}setOffset(i){return this.options.offset=i,this._update(),this}toggleClassName(i){if(this._container)return this._container.classList.toggle(i)}_createCloseButton(){this.options.closeButton&&(this._closeButton=u.create("button","maplibregl-popup-close-button mapboxgl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_onMouseUp(i){this._update(i.point)}_onMouseMove(i){this._update(i.point)}_onDrag(i){this._update(i.point)}_update(r){if(!this._map||!this._lngLat&&!this._trackPointer||!this._content||(this._container||(this._container=u.create("div","maplibregl-popup mapboxgl-popup",this._map.getContainer()),this._tip=u.create("div","maplibregl-popup-tip mapboxgl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className&&this.options.className.split(" ").forEach(i=>this._container.classList.add(i)),this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer","mapboxgl-popup-track-pointer")),this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._map.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=ro(this._lngLat,this._pos,this._map.transform)),this._trackPointer&&!r))return;let n=this._pos=this._trackPointer&&r?r:this._map.project(this._lngLat),o=this.options.anchor,a=function r(n){if(n){if("number"==typeof n){let r=Math.round(Math.sqrt(.5*Math.pow(n,2)));return{center:new i.pointGeometry(0,0),top:new i.pointGeometry(0,n),"top-left":new i.pointGeometry(r,r),"top-right":new i.pointGeometry(-r,r),bottom:new i.pointGeometry(0,-n),"bottom-left":new i.pointGeometry(r,-r),"bottom-right":new i.pointGeometry(-r,-r),left:new i.pointGeometry(n,0),right:new i.pointGeometry(-n,0)}}if(n instanceof i.pointGeometry||Array.isArray(n)){let r=i.pointGeometry.convert(n);return{center:r,top:r,"top-left":r,"top-right":r,bottom:r,"bottom-left":r,"bottom-right":r,left:r,right:r}}return{center:i.pointGeometry.convert(n.center||[0,0]),top:i.pointGeometry.convert(n.top||[0,0]),"top-left":i.pointGeometry.convert(n["top-left"]||[0,0]),"top-right":i.pointGeometry.convert(n["top-right"]||[0,0]),bottom:i.pointGeometry.convert(n.bottom||[0,0]),"bottom-left":i.pointGeometry.convert(n["bottom-left"]||[0,0]),"bottom-right":i.pointGeometry.convert(n["bottom-right"]||[0,0]),left:i.pointGeometry.convert(n.left||[0,0]),right:i.pointGeometry.convert(n.right||[0,0])}}return r(new i.pointGeometry(0,0))}(this.options.offset);if(!o){let i;let r=this._container.offsetWidth,s=this._container.offsetHeight;i=n.y+a.bottom.y<s?["top"]:n.y>this._map.transform.height-s?["bottom"]:[],n.x<r/2?i.push("left"):n.x>this._map.transform.width-r/2&&i.push("right"),o=0===i.length?"bottom":i.join("-")}let s=n.add(a[o]).round();u.setTransform(this._container,`${ra[o]} translate(${s.x}px,${s.y}px)`),rs(this._container,o,"popup")}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;let i=this._container.querySelector("a[href], [tabindex]:not([tabindex='-1']), [contenteditable]:not([contenteditable='false']), button:not([disabled]), input:not([disabled]), select:not([disabled]), textarea:not([disabled])");i&&i.focus()}_onClose(){this.remove()}},Marker:rl,Style:tZ,LngLat:i.LngLat,LngLatBounds:i.LngLatBounds,Point:i.pointGeometry,MercatorCoordinate:i.MercatorCoordinate,Evented:i.Evented,AJAXError:i.AJAXError,config:i.config,CanvasSource:M,GeoJSONSource:I,ImageSource:P,RasterDEMTileSource:C,RasterTileSource:S,VectorTileSource:E,VideoSource:k,prewarm:function(){q().acquire(j)},clearPrewarmedResources:function(){let i=n;i&&(i.isPreloaded()&&1===i.numActive()?(i.release(j),n=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get version(){return"2.4.0"},get workerCount(){return Z.workerCount},set workerCount(t){Z.workerCount=t},get maxParallelImageRequests(){return i.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(e){i.config.MAX_PARALLEL_IMAGE_REQUESTS=e},clearStorage(r){i.clearTileCache(r)},workerUrl:"",addProtocol(r,n){i.config.REGISTERED_PROTOCOLS[r]=n},removeProtocol(r){delete i.config.REGISTERED_PROTOCOLS[r]}};return({extend:(r,...n)=>i.extend(r,...n),run(i){i()},logToElement(i,r=!1,n="log"){let o=window.document.getElementById(n);o&&(r&&(o.innerHTML=""),o.innerHTML+=`<br>${i}`)}}).extend(r_,{isSafari:i.isSafari,getPerformanceMetrics:i.PerformanceUtils.getPerformanceMetrics}),r_}),n}()}),l.register("aNJCr",function(i,r){o(i.exports,"getBundleURL",function(){return n},function(i){return n=i});"use strict";var n,a={};n=function(i){var r=a[i];return r||(r=function(){try{throw Error()}catch(r){var i=(""+r.stack).match(/(https?|file|ftp|(chrome|moz|safari-web)-extension):\/\/[^)\n]+/g);if(i)return(""+i[2]).replace(/^((?:https?|file|ftp|(chrome|moz|safari-web)-extension):\/\/.+)\/[^/]+$/,"$1")+"/"}return"/"}(),a[i]=r),r}}),!function(i,r,n){"use strict";function o(i){return i&&"object"==typeof i&&"default"in i?i:{default:i}}var a=o(r),s=o(n);function l(i,r){for(var n=0;n<r.length;n++){var o=r[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(i,o.key,o)}}function u(i,r,n){return r&&l(i.prototype,r),n&&l(i,n),Object.defineProperty(i,"prototype",{writable:!1}),i}function h(){return(h=Object.assign?Object.assign.bind():function(i){for(var r=1;r<arguments.length;r++){var n=arguments[r];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(i[o]=n[o])}return i}).apply(this,arguments)}function c(i,r){return(c=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,r){return i.__proto__=r,i})(i,r)}var d="transitionend",p={TRANSITION_END:"bsTransitionEnd",getUID:function(i){do i+=~~(1e6*Math.random());while(document.getElementById(i))return i},getSelectorFromElement:function(i){var r=i.getAttribute("data-target");if(!r||"#"===r){var n=i.getAttribute("href");r=n&&"#"!==n?n.trim():""}try{return document.querySelector(r)?r:null}catch(i){return null}},getTransitionDurationFromElement:function(i){if(!i)return 0;var r=a.default(i).css("transition-duration"),n=a.default(i).css("transition-delay"),o=parseFloat(r),s=parseFloat(n);return o||s?(r=r.split(",")[0],n=n.split(",")[0],(parseFloat(r)+parseFloat(n))*1e3):0},reflow:function(i){return i.offsetHeight},triggerTransitionEnd:function(i){a.default(i).trigger(d)},supportsTransitionEnd:function(){return!!d},isElement:function(i){return(i[0]||i).nodeType},typeCheckConfig:function(i,r,n){for(var o in n)if(Object.prototype.hasOwnProperty.call(n,o)){var a=n[o],s=r[o],l=s&&p.isElement(s)?"element":null==s?""+s:({}).toString.call(s).match(/\s([a-z]+)/i)[1].toLowerCase();if(!new RegExp(a).test(l))throw Error(i.toUpperCase()+": "+('Option "'+o)+'" provided type "'+l+'" but expected type "'+a+'".')}},findShadowRoot:function(i){if(!document.documentElement.attachShadow)return null;if("function"==typeof i.getRootNode){var r=i.getRootNode();return r instanceof ShadowRoot?r:null}return i instanceof ShadowRoot?i:i.parentNode?p.findShadowRoot(i.parentNode):null},jQueryDetection:function(){if(void 0===a.default)throw TypeError("Bootstrap's JavaScript requires jQuery. jQuery must be included before Bootstrap's JavaScript.");var i=a.default.fn.jquery.split(" ")[0].split(".");if(i[0]<2&&i[1]<9||1===i[0]&&9===i[1]&&i[2]<1||i[0]>=4)throw Error("Bootstrap's JavaScript requires at least jQuery v1.9.1 but less than v4.0.0")}};p.jQueryDetection(),a.default.fn.emulateTransitionEnd=function(i){var r=this,n=!1;return a.default(this).one(p.TRANSITION_END,function(){n=!0}),setTimeout(function(){n||p.triggerTransitionEnd(r)},i),this},a.default.event.special[p.TRANSITION_END]={bindType:d,delegateType:d,handle:function(i){if(a.default(i.target).is(this))return i.handleObj.handler.apply(this,arguments)}};var f="alert",m="bs.alert",g="."+m,_=a.default.fn[f],y="close"+g,v="closed"+g,x=function(){function i(i){this._element=i}var r=i.prototype;return r.close=function(i){var r=this._element;i&&(r=this._getRootElement(i)),this._triggerCloseEvent(r).isDefaultPrevented()||this._removeElement(r)},r.dispose=function(){a.default.removeData(this._element,m),this._element=null},r._getRootElement=function(i){var r=p.getSelectorFromElement(i),n=!1;return r&&(n=document.querySelector(r)),n||(n=a.default(i).closest(".alert")[0]),n},r._triggerCloseEvent=function(i){var r=a.default.Event(y);return a.default(i).trigger(r),r},r._removeElement=function(i){var r=this;if(a.default(i).removeClass("show"),!a.default(i).hasClass("fade")){this._destroyElement(i);return}var n=p.getTransitionDurationFromElement(i);a.default(i).one(p.TRANSITION_END,function(n){return r._destroyElement(i,n)}).emulateTransitionEnd(n)},r._destroyElement=function(i){a.default(i).detach().trigger(v).remove()},i._jQueryInterface=function(r){return this.each(function(){var n=a.default(this),o=n.data(m);o||(o=new i(this),n.data(m,o)),"close"===r&&o[r](this)})},i._handleDismiss=function(i){return function(r){r&&r.preventDefault(),i.close(this)}},u(i,null,[{key:"VERSION",get:function(){return"4.6.2"}}]),i}();a.default(document).on("click"+g+".data-api",'[data-dismiss="alert"]',x._handleDismiss(new x)),a.default.fn[f]=x._jQueryInterface,a.default.fn[f].Constructor=x,a.default.fn[f].noConflict=function(){return a.default.fn[f]=_,x._jQueryInterface};var b="button",w="bs.button",T="."+w,E=".data-api",S=a.default.fn[b],C="active",I='[data-toggle^="button"]',A='input:not([type="hidden"])',P=".btn",k=function(){function i(i){this._element=i,this.shouldAvoidTriggerChange=!1}var r=i.prototype;return r.toggle=function(){var i=!0,r=!0,n=a.default(this._element).closest('[data-toggle="buttons"]')[0];if(n){var o=this._element.querySelector(A);if(o){if("radio"===o.type){if(o.checked&&this._element.classList.contains(C))i=!1;else{var s=n.querySelector(".active");s&&a.default(s).removeClass(C)}}i&&(("checkbox"===o.type||"radio"===o.type)&&(o.checked=!this._element.classList.contains(C)),this.shouldAvoidTriggerChange||a.default(o).trigger("change")),o.focus(),r=!1}}!(this._element.hasAttribute("disabled")||this._element.classList.contains("disabled"))&&(r&&this._element.setAttribute("aria-pressed",!this._element.classList.contains(C)),i&&a.default(this._element).toggleClass(C))},r.dispose=function(){a.default.removeData(this._element,w),this._element=null},i._jQueryInterface=function(r,n){return this.each(function(){var o=a.default(this),s=o.data(w);s||(s=new i(this),o.data(w,s)),s.shouldAvoidTriggerChange=n,"toggle"===r&&s[r]()})},u(i,null,[{key:"VERSION",get:function(){return"4.6.2"}}]),i}();a.default(document).on("click"+T+E,I,function(i){var r=i.target,n=r;if(a.default(r).hasClass("btn")||(r=a.default(r).closest(P)[0]),!r||r.hasAttribute("disabled")||r.classList.contains("disabled"))i.preventDefault();else{var o=r.querySelector(A);if(o&&(o.hasAttribute("disabled")||o.classList.contains("disabled"))){i.preventDefault();return}("INPUT"===n.tagName||"LABEL"!==r.tagName)&&k._jQueryInterface.call(a.default(r),"toggle","INPUT"===n.tagName)}}).on("focus"+T+E+" blur"+T+E,I,function(i){var r=a.default(i.target).closest(P)[0];a.default(r).toggleClass("focus",/^focus(in)?$/.test(i.type))}),a.default(window).on("load"+T+E,function(){for(var i=[].slice.call(document.querySelectorAll('[data-toggle="buttons"] .btn')),r=0,n=i.length;r<n;r++){var o=i[r],a=o.querySelector(A);a.checked||a.hasAttribute("checked")?o.classList.add(C):o.classList.remove(C)}i=[].slice.call(document.querySelectorAll('[data-toggle="button"]'));for(var s=0,l=i.length;s<l;s++){var u=i[s];"true"===u.getAttribute("aria-pressed")?u.classList.add(C):u.classList.remove(C)}}),a.default.fn[b]=k._jQueryInterface,a.default.fn[b].Constructor=k,a.default.fn[b].noConflict=function(){return a.default.fn[b]=S,k._jQueryInterface};var M="carousel",z="bs.carousel",D="."+z,R=".data-api",B=a.default.fn[M],O="active",F="next",N="prev",U="slide"+D,j="slid"+D,Z="keydown"+D,V="mouseenter"+D,q="mouseleave"+D,G="touchstart"+D,W="touchmove"+D,H="touchend"+D,X="pointerdown"+D,K="pointerup"+D,J="dragstart"+D,Y="load"+D+R,Q="click"+D+R,tt=".active.carousel-item",te={interval:5e3,keyboard:!0,slide:!1,pause:"hover",wrap:!0,touch:!0},ti={interval:"(number|boolean)",keyboard:"boolean",slide:"(boolean|string)",pause:"(string|boolean)",wrap:"boolean",touch:"boolean"},tr={TOUCH:"touch",PEN:"pen"},tn=function(){function i(i,r){this._items=null,this._interval=null,this._activeElement=null,this._isPaused=!1,this._isSliding=!1,this.touchTimeout=null,this.touchStartX=0,this.touchDeltaX=0,this._config=this._getConfig(r),this._element=i,this._indicatorsElement=this._element.querySelector(".carousel-indicators"),this._touchSupported="ontouchstart"in document.documentElement||navigator.maxTouchPoints>0,this._pointerEvent=!!(window.PointerEvent||window.MSPointerEvent),this._addEventListeners()}var r=i.prototype;return r.next=function(){this._isSliding||this._slide(F)},r.nextWhenVisible=function(){var i=a.default(this._element);!document.hidden&&i.is(":visible")&&"hidden"!==i.css("visibility")&&this.next()},r.prev=function(){this._isSliding||this._slide(N)},r.pause=function(i){i||(this._isPaused=!0),this._element.querySelector(".carousel-item-next, .carousel-item-prev")&&(p.triggerTransitionEnd(this._element),this.cycle(!0)),clearInterval(this._interval),this._interval=null},r.cycle=function(i){i||(this._isPaused=!1),this._interval&&(clearInterval(this._interval),this._interval=null),this._config.interval&&!this._isPaused&&(this._updateInterval(),this._interval=setInterval((document.visibilityState?this.nextWhenVisible:this.next).bind(this),this._config.interval))},r.to=function(i){var r=this;this._activeElement=this._element.querySelector(tt);var n=this._getItemIndex(this._activeElement);if(!(i>this._items.length-1)&&!(i<0)){if(this._isSliding){a.default(this._element).one(j,function(){return r.to(i)});return}if(n===i){this.pause(),this.cycle();return}var o=i>n?F:N;this._slide(o,this._items[i])}},r.dispose=function(){a.default(this._element).off(D),a.default.removeData(this._element,z),this._items=null,this._config=null,this._element=null,this._interval=null,this._isPaused=null,this._isSliding=null,this._activeElement=null,this._indicatorsElement=null},r._getConfig=function(i){return i=h({},te,i),p.typeCheckConfig(M,i,ti),i},r._handleSwipe=function(){var i=Math.abs(this.touchDeltaX);if(!(i<=40)){var r=i/this.touchDeltaX;this.touchDeltaX=0,r>0&&this.prev(),r<0&&this.next()}},r._addEventListeners=function(){var i=this;this._config.keyboard&&a.default(this._element).on(Z,function(r){return i._keydown(r)}),"hover"===this._config.pause&&a.default(this._element).on(V,function(r){return i.pause(r)}).on(q,function(r){return i.cycle(r)}),this._config.touch&&this._addTouchEventListeners()},r._addTouchEventListeners=function(){var i=this;if(this._touchSupported){var r=function(r){i._pointerEvent&&tr[r.originalEvent.pointerType.toUpperCase()]?i.touchStartX=r.originalEvent.clientX:i._pointerEvent||(i.touchStartX=r.originalEvent.touches[0].clientX)},n=function(r){i.touchDeltaX=r.originalEvent.touches&&r.originalEvent.touches.length>1?0:r.originalEvent.touches[0].clientX-i.touchStartX},o=function(r){i._pointerEvent&&tr[r.originalEvent.pointerType.toUpperCase()]&&(i.touchDeltaX=r.originalEvent.clientX-i.touchStartX),i._handleSwipe(),"hover"===i._config.pause&&(i.pause(),i.touchTimeout&&clearTimeout(i.touchTimeout),i.touchTimeout=setTimeout(function(r){return i.cycle(r)},500+i._config.interval))};a.default(this._element.querySelectorAll(".carousel-item img")).on(J,function(i){return i.preventDefault()}),this._pointerEvent?(a.default(this._element).on(X,function(i){return r(i)}),a.default(this._element).on(K,function(i){return o(i)}),this._element.classList.add("pointer-event")):(a.default(this._element).on(G,function(i){return r(i)}),a.default(this._element).on(W,function(i){return n(i)}),a.default(this._element).on(H,function(i){return o(i)}))}},r._keydown=function(i){if(!/input|textarea/i.test(i.target.tagName))switch(i.which){case 37:i.preventDefault(),this.prev();break;case 39:i.preventDefault(),this.next()}},r._getItemIndex=function(i){return this._items=i&&i.parentNode?[].slice.call(i.parentNode.querySelectorAll(".carousel-item")):[],this._items.indexOf(i)},r._getItemByDirection=function(i,r){var n=i===F,o=i===N,a=this._getItemIndex(r),s=this._items.length-1;if((o&&0===a||n&&a===s)&&!this._config.wrap)return r;var l=(a+(i===N?-1:1))%this._items.length;return -1===l?this._items[this._items.length-1]:this._items[l]},r._triggerSlideEvent=function(i,r){var n=this._getItemIndex(i),o=this._getItemIndex(this._element.querySelector(tt)),s=a.default.Event(U,{relatedTarget:i,direction:r,from:o,to:n});return a.default(this._element).trigger(s),s},r._setActiveIndicatorElement=function(i){if(this._indicatorsElement){var r=[].slice.call(this._indicatorsElement.querySelectorAll(".active"));a.default(r).removeClass(O);var n=this._indicatorsElement.children[this._getItemIndex(i)];n&&a.default(n).addClass(O)}},r._updateInterval=function(){var i=this._activeElement||this._element.querySelector(tt);if(i){var r=parseInt(i.getAttribute("data-interval"),10);r?(this._config.defaultInterval=this._config.defaultInterval||this._config.interval,this._config.interval=r):this._config.interval=this._config.defaultInterval||this._config.interval}},r._slide=function(i,r){var n,o,s,l=this,u=this._element.querySelector(tt),h=this._getItemIndex(u),c=r||u&&this._getItemByDirection(i,u),d=this._getItemIndex(c),f=!!this._interval;if(i===F?(n="carousel-item-left",o="carousel-item-next",s="left"):(n="carousel-item-right",o="carousel-item-prev",s="right"),c&&a.default(c).hasClass(O)){this._isSliding=!1;return}if(!this._triggerSlideEvent(c,s).isDefaultPrevented()&&u&&c){this._isSliding=!0,f&&this.pause(),this._setActiveIndicatorElement(c),this._activeElement=c;var m=a.default.Event(j,{relatedTarget:c,direction:s,from:h,to:d});if(a.default(this._element).hasClass("slide")){a.default(c).addClass(o),p.reflow(c),a.default(u).addClass(n),a.default(c).addClass(n);var g=p.getTransitionDurationFromElement(u);a.default(u).one(p.TRANSITION_END,function(){a.default(c).removeClass(n+" "+o).addClass(O),a.default(u).removeClass(O+" "+o+" "+n),l._isSliding=!1,setTimeout(function(){return a.default(l._element).trigger(m)},0)}).emulateTransitionEnd(g)}else a.default(u).removeClass(O),a.default(c).addClass(O),this._isSliding=!1,a.default(this._element).trigger(m);f&&this.cycle()}},i._jQueryInterface=function(r){return this.each(function(){var n=a.default(this).data(z),o=h({},te,a.default(this).data());"object"==typeof r&&(o=h({},o,r));var s="string"==typeof r?r:o.slide;if(n||(n=new i(this,o),a.default(this).data(z,n)),"number"==typeof r)n.to(r);else if("string"==typeof s){if(void 0===n[s])throw TypeError('No method named "'+s+'"');n[s]()}else o.interval&&o.ride&&(n.pause(),n.cycle())})},i._dataApiClickHandler=function(r){var n=p.getSelectorFromElement(this);if(n){var o=a.default(n)[0];if(o&&a.default(o).hasClass("carousel")){var s=h({},a.default(o).data(),a.default(this).data()),l=this.getAttribute("data-slide-to");l&&(s.interval=!1),i._jQueryInterface.call(a.default(o),s),l&&a.default(o).data(z).to(l),r.preventDefault()}}},u(i,null,[{key:"VERSION",get:function(){return"4.6.2"}},{key:"Default",get:function(){return te}}]),i}();a.default(document).on(Q,"[data-slide], [data-slide-to]",tn._dataApiClickHandler),a.default(window).on(Y,function(){for(var i=[].slice.call(document.querySelectorAll('[data-ride="carousel"]')),r=0,n=i.length;r<n;r++){var o=a.default(i[r]);tn._jQueryInterface.call(o,o.data())}}),a.default.fn[M]=tn._jQueryInterface,a.default.fn[M].Constructor=tn,a.default.fn[M].noConflict=function(){return a.default.fn[M]=B,tn._jQueryInterface};var to="collapse",ta="bs.collapse",ts="."+ta,tl=a.default.fn[to],tu="show",th="collapse",tc="collapsing",td="collapsed",tp="width",tf="show"+ts,tm="shown"+ts,tg="hide"+ts,t_="hidden"+ts,ty='[data-toggle="collapse"]',tv={toggle:!0,parent:""},tx={toggle:"boolean",parent:"(string|element)"},tb=function(){function i(i,r){this._isTransitioning=!1,this._element=i,this._config=this._getConfig(r),this._triggerArray=[].slice.call(document.querySelectorAll('[data-toggle="collapse"][href="#'+i.id+'"],[data-toggle="collapse"][data-target="#'+i.id+'"]'));for(var n=[].slice.call(document.querySelectorAll(ty)),o=0,a=n.length;o<a;o++){var s=n[o],l=p.getSelectorFromElement(s),u=[].slice.call(document.querySelectorAll(l)).filter(function(r){return r===i});null!==l&&u.length>0&&(this._selector=l,this._triggerArray.push(s))}this._parent=this._config.parent?this._getParent():null,this._config.parent||this._addAriaAndCollapsedClass(this._element,this._triggerArray),this._config.toggle&&this.toggle()}var r=i.prototype;return r.toggle=function(){a.default(this._element).hasClass(tu)?this.hide():this.show()},r.show=function(){var r,n,o=this;if(!(this._isTransitioning||a.default(this._element).hasClass(tu))&&(this._parent&&0===(r=[].slice.call(this._parent.querySelectorAll(".show, .collapsing")).filter(function(i){return"string"==typeof o._config.parent?i.getAttribute("data-parent")===o._config.parent:i.classList.contains(th)})).length&&(r=null),!(r&&(n=a.default(r).not(this._selector).data(ta))&&n._isTransitioning))){var s=a.default.Event(tf);if(a.default(this._element).trigger(s),!s.isDefaultPrevented()){r&&(i._jQueryInterface.call(a.default(r).not(this._selector),"hide"),n||a.default(r).data(ta,null));var l=this._getDimension();a.default(this._element).removeClass(th).addClass(tc),this._element.style[l]=0,this._triggerArray.length&&a.default(this._triggerArray).removeClass(td).attr("aria-expanded",!0),this.setTransitioning(!0);var u=l[0].toUpperCase()+l.slice(1),h=p.getTransitionDurationFromElement(this._element);a.default(this._element).one(p.TRANSITION_END,function(){a.default(o._element).removeClass(tc).addClass(th+" "+tu),o._element.style[l]="",o.setTransitioning(!1),a.default(o._element).trigger(tm)}).emulateTransitionEnd(h),this._element.style[l]=this._element["scroll"+u]+"px"}}},r.hide=function(){var i=this;if(!this._isTransitioning&&a.default(this._element).hasClass(tu)){var r=a.default.Event(tg);if(a.default(this._element).trigger(r),!r.isDefaultPrevented()){var n=this._getDimension();this._element.style[n]=this._element.getBoundingClientRect()[n]+"px",p.reflow(this._element),a.default(this._element).addClass(tc).removeClass(th+" "+tu);var o=this._triggerArray.length;if(o>0)for(var s=0;s<o;s++){var l=this._triggerArray[s],u=p.getSelectorFromElement(l);null===u||a.default([].slice.call(document.querySelectorAll(u))).hasClass(tu)||a.default(l).addClass(td).attr("aria-expanded",!1)}this.setTransitioning(!0),this._element.style[n]="";var h=p.getTransitionDurationFromElement(this._element);a.default(this._element).one(p.TRANSITION_END,function(){i.setTransitioning(!1),a.default(i._element).removeClass(tc).addClass(th).trigger(t_)}).emulateTransitionEnd(h)}}},r.setTransitioning=function(i){this._isTransitioning=i},r.dispose=function(){a.default.removeData(this._element,ta),this._config=null,this._parent=null,this._element=null,this._triggerArray=null,this._isTransitioning=null},r._getConfig=function(i){return(i=h({},tv,i)).toggle=!!i.toggle,p.typeCheckConfig(to,i,tx),i},r._getDimension=function(){return a.default(this._element).hasClass(tp)?tp:"height"},r._getParent=function(){var r,n=this;p.isElement(this._config.parent)?(r=this._config.parent,void 0!==this._config.parent.jquery&&(r=this._config.parent[0])):r=document.querySelector(this._config.parent);var o='[data-toggle="collapse"][data-parent="'+this._config.parent+'"]',s=[].slice.call(r.querySelectorAll(o));return a.default(s).each(function(r,o){n._addAriaAndCollapsedClass(i._getTargetFromElement(o),[o])}),r},r._addAriaAndCollapsedClass=function(i,r){var n=a.default(i).hasClass(tu);r.length&&a.default(r).toggleClass(td,!n).attr("aria-expanded",n)},i._getTargetFromElement=function(i){var r=p.getSelectorFromElement(i);return r?document.querySelector(r):null},i._jQueryInterface=function(r){return this.each(function(){var n=a.default(this),o=n.data(ta),s=h({},tv,n.data(),"object"==typeof r&&r?r:{});if(!o&&s.toggle&&"string"==typeof r&&/show|hide/.test(r)&&(s.toggle=!1),o||(o=new i(this,s),n.data(ta,o)),"string"==typeof r){if(void 0===o[r])throw TypeError('No method named "'+r+'"');o[r]()}})},u(i,null,[{key:"VERSION",get:function(){return"4.6.2"}},{key:"Default",get:function(){return tv}}]),i}();a.default(document).on("click"+ts+".data-api",ty,function(i){"A"===i.currentTarget.tagName&&i.preventDefault();var r=a.default(this),n=p.getSelectorFromElement(this),o=[].slice.call(document.querySelectorAll(n));a.default(o).each(function(){var i=a.default(this),n=i.data(ta)?"toggle":r.data();tb._jQueryInterface.call(i,n)})}),a.default.fn[to]=tb._jQueryInterface,a.default.fn[to].Constructor=tb,a.default.fn[to].noConflict=function(){return a.default.fn[to]=tl,tb._jQueryInterface};var tw="dropdown",tT="bs.dropdown",tE="."+tT,tS=".data-api",tC=a.default.fn[tw],tI=RegExp("38|40|27"),tA="disabled",tP="show",tk="dropdown-menu-right",tL="hide"+tE,tM="hidden"+tE,tz="show"+tE,tD="shown"+tE,tR="click"+tE,tB="click"+tE+tS,tO="keydown"+tE+tS,tF="keyup"+tE+tS,tN='[data-toggle="dropdown"]',tU=".dropdown-menu",tj={offset:0,flip:!0,boundary:"scrollParent",reference:"toggle",display:"dynamic",popperConfig:null},tZ={offset:"(number|string|function)",flip:"boolean",boundary:"(string|element)",reference:"(string|element)",display:"string",popperConfig:"(null|object)"},tV=function(){function i(i,r){this._element=i,this._popper=null,this._config=this._getConfig(r),this._menu=this._getMenuElement(),this._inNavbar=this._detectNavbar(),this._addEventListeners()}var r=i.prototype;return r.toggle=function(){if(!(this._element.disabled||a.default(this._element).hasClass(tA))){var r=a.default(this._menu).hasClass(tP);i._clearMenus(),r||this.show(!0)}},r.show=function(r){if(void 0===r&&(r=!1),!(this._element.disabled||a.default(this._element).hasClass(tA)||a.default(this._menu).hasClass(tP))){var n={relatedTarget:this._element},o=a.default.Event(tz,n),l=i._getParentFromElement(this._element);if(a.default(l).trigger(o),!o.isDefaultPrevented()){if(!this._inNavbar&&r){if(void 0===s.default)throw TypeError("Bootstrap's dropdowns require Popper (https://popper.js.org)");var u=this._element;"parent"===this._config.reference?u=l:p.isElement(this._config.reference)&&(u=this._config.reference,void 0!==this._config.reference.jquery&&(u=this._config.reference[0])),"scrollParent"!==this._config.boundary&&a.default(l).addClass("position-static"),this._popper=new s.default(u,this._menu,this._getPopperConfig())}"ontouchstart"in document.documentElement&&0===a.default(l).closest(".navbar-nav").length&&a.default(document.body).children().on("mouseover",null,a.default.noop),this._element.focus(),this._element.setAttribute("aria-expanded",!0),a.default(this._menu).toggleClass(tP),a.default(l).toggleClass(tP).trigger(a.default.Event(tD,n))}}},r.hide=function(){if(!(this._element.disabled||a.default(this._element).hasClass(tA))&&a.default(this._menu).hasClass(tP)){var r={relatedTarget:this._element},n=a.default.Event(tL,r),o=i._getParentFromElement(this._element);a.default(o).trigger(n),n.isDefaultPrevented()||(this._popper&&this._popper.destroy(),a.default(this._menu).toggleClass(tP),a.default(o).toggleClass(tP).trigger(a.default.Event(tM,r)))}},r.dispose=function(){a.default.removeData(this._element,tT),a.default(this._element).off(tE),this._element=null,this._menu=null,null!==this._popper&&(this._popper.destroy(),this._popper=null)},r.update=function(){this._inNavbar=this._detectNavbar(),null!==this._popper&&this._popper.scheduleUpdate()},r._addEventListeners=function(){var i=this;a.default(this._element).on(tR,function(r){r.preventDefault(),r.stopPropagation(),i.toggle()})},r._getConfig=function(i){return i=h({},this.constructor.Default,a.default(this._element).data(),i),p.typeCheckConfig(tw,i,this.constructor.DefaultType),i},r._getMenuElement=function(){if(!this._menu){var r=i._getParentFromElement(this._element);r&&(this._menu=r.querySelector(tU))}return this._menu},r._getPlacement=function(){var i=a.default(this._element.parentNode),r="bottom-start";return i.hasClass("dropup")?r=a.default(this._menu).hasClass(tk)?"top-end":"top-start":i.hasClass("dropright")?r="right-start":i.hasClass("dropleft")?r="left-start":a.default(this._menu).hasClass(tk)&&(r="bottom-end"),r},r._detectNavbar=function(){return a.default(this._element).closest(".navbar").length>0},r._getOffset=function(){var i=this,r={};return"function"==typeof this._config.offset?r.fn=function(r){return r.offsets=h({},r.offsets,i._config.offset(r.offsets,i._element)),r}:r.offset=this._config.offset,r},r._getPopperConfig=function(){var i={placement:this._getPlacement(),modifiers:{offset:this._getOffset(),flip:{enabled:this._config.flip},preventOverflow:{boundariesElement:this._config.boundary}}};return"static"===this._config.display&&(i.modifiers.applyStyle={enabled:!1}),h({},i,this._config.popperConfig)},i._jQueryInterface=function(r){return this.each(function(){var n=a.default(this).data(tT);if(n||(n=new i(this,"object"==typeof r?r:null),a.default(this).data(tT,n)),"string"==typeof r){if(void 0===n[r])throw TypeError('No method named "'+r+'"');n[r]()}})},i._clearMenus=function(r){if(!r||3!==r.which&&("keyup"!==r.type||9===r.which))for(var n=[].slice.call(document.querySelectorAll(tN)),o=0,s=n.length;o<s;o++){var l=i._getParentFromElement(n[o]),u=a.default(n[o]).data(tT),h={relatedTarget:n[o]};if(r&&"click"===r.type&&(h.clickEvent=r),u){var c=u._menu;if(!(!a.default(l).hasClass(tP)||r&&("click"===r.type&&/input|textarea/i.test(r.target.tagName)||"keyup"===r.type&&9===r.which)&&a.default.contains(l,r.target))){var d=a.default.Event(tL,h);a.default(l).trigger(d),d.isDefaultPrevented()||("ontouchstart"in document.documentElement&&a.default(document.body).children().off("mouseover",null,a.default.noop),n[o].setAttribute("aria-expanded","false"),u._popper&&u._popper.destroy(),a.default(c).removeClass(tP),a.default(l).removeClass(tP).trigger(a.default.Event(tM,h)))}}}},i._getParentFromElement=function(i){var r,n=p.getSelectorFromElement(i);return n&&(r=document.querySelector(n)),r||i.parentNode},i._dataApiKeydownHandler=function(r){if(!((/input|textarea/i.test(r.target.tagName)?32===r.which||27!==r.which&&(40!==r.which&&38!==r.which||a.default(r.target).closest(tU).length):!tI.test(r.which))||this.disabled||a.default(this).hasClass(tA))){var n=i._getParentFromElement(this),o=a.default(n).hasClass(tP);if(o||27!==r.which){if(r.preventDefault(),r.stopPropagation(),!o||27===r.which||32===r.which){27===r.which&&a.default(n.querySelector(tN)).trigger("focus"),a.default(this).trigger("click");return}var s=[].slice.call(n.querySelectorAll(".dropdown-menu .dropdown-item:not(.disabled):not(:disabled)")).filter(function(i){return a.default(i).is(":visible")});if(0!==s.length){var l=s.indexOf(r.target);38===r.which&&l>0&&l--,40===r.which&&l<s.length-1&&l++,l<0&&(l=0),s[l].focus()}}}},u(i,null,[{key:"VERSION",get:function(){return"4.6.2"}},{key:"Default",get:function(){return tj}},{key:"DefaultType",get:function(){return tZ}}]),i}();a.default(document).on(tO,tN,tV._dataApiKeydownHandler).on(tO,tU,tV._dataApiKeydownHandler).on(tB+" "+tF,tV._clearMenus).on(tB,tN,function(i){i.preventDefault(),i.stopPropagation(),tV._jQueryInterface.call(a.default(this),"toggle")}).on(tB,".dropdown form",function(i){i.stopPropagation()}),a.default.fn[tw]=tV._jQueryInterface,a.default.fn[tw].Constructor=tV,a.default.fn[tw].noConflict=function(){return a.default.fn[tw]=tC,tV._jQueryInterface};var tq="modal",tG="bs.modal",t$="."+tG,tW=a.default.fn[tq],tH="modal-open",tX="fade",tK="show",tJ="modal-static",tY="hide"+t$,tQ="hidePrevented"+t$,t0="hidden"+t$,t1="show"+t$,t2="shown"+t$,t3="focusin"+t$,t5="resize"+t$,t4="click.dismiss"+t$,t6="keydown.dismiss"+t$,t8="mouseup.dismiss"+t$,t9="mousedown.dismiss"+t$,t7="click"+t$+".data-api",et=".fixed-top, .fixed-bottom, .is-fixed, .sticky-top",ee=".sticky-top",ei={backdrop:!0,keyboard:!0,focus:!0,show:!0},er={backdrop:"(boolean|string)",keyboard:"boolean",focus:"boolean",show:"boolean"},en=function(){function i(i,r){this._config=this._getConfig(r),this._element=i,this._dialog=i.querySelector(".modal-dialog"),this._backdrop=null,this._isShown=!1,this._isBodyOverflowing=!1,this._ignoreBackdropClick=!1,this._isTransitioning=!1,this._scrollbarWidth=0}var r=i.prototype;return r.toggle=function(i){return this._isShown?this.hide():this.show(i)},r.show=function(i){var r=this;if(!this._isShown&&!this._isTransitioning){var n=a.default.Event(t1,{relatedTarget:i});a.default(this._element).trigger(n),n.isDefaultPrevented()||(this._isShown=!0,a.default(this._element).hasClass(tX)&&(this._isTransitioning=!0),this._checkScrollbar(),this._setScrollbar(),this._adjustDialog(),this._setEscapeEvent(),this._setResizeEvent(),a.default(this._element).on(t4,'[data-dismiss="modal"]',function(i){return r.hide(i)}),a.default(this._dialog).on(t9,function(){a.default(r._element).one(t8,function(i){a.default(i.target).is(r._element)&&(r._ignoreBackdropClick=!0)})}),this._showBackdrop(function(){return r._showElement(i)}))}},r.hide=function(i){var r=this;if(i&&i.preventDefault(),this._isShown&&!this._isTransitioning){var n=a.default.Event(tY);if(a.default(this._element).trigger(n),!(!this._isShown||n.isDefaultPrevented())){this._isShown=!1;var o=a.default(this._element).hasClass(tX);if(o&&(this._isTransitioning=!0),this._setEscapeEvent(),this._setResizeEvent(),a.default(document).off(t3),a.default(this._element).removeClass(tK),a.default(this._element).off(t4),a.default(this._dialog).off(t9),o){var s=p.getTransitionDurationFromElement(this._element);a.default(this._element).one(p.TRANSITION_END,function(i){return r._hideModal(i)}).emulateTransitionEnd(s)}else this._hideModal()}}},r.dispose=function(){[window,this._element,this._dialog].forEach(function(i){return a.default(i).off(t$)}),a.default(document).off(t3),a.default.removeData(this._element,tG),this._config=null,this._element=null,this._dialog=null,this._backdrop=null,this._isShown=null,this._isBodyOverflowing=null,this._ignoreBackdropClick=null,this._isTransitioning=null,this._scrollbarWidth=null},r.handleUpdate=function(){this._adjustDialog()},r._getConfig=function(i){return i=h({},ei,i),p.typeCheckConfig(tq,i,er),i},r._triggerBackdropTransition=function(){var i=this,r=a.default.Event(tQ);if(a.default(this._element).trigger(r),!r.isDefaultPrevented()){var n=this._element.scrollHeight>document.documentElement.clientHeight;n||(this._element.style.overflowY="hidden"),this._element.classList.add(tJ);var o=p.getTransitionDurationFromElement(this._dialog);a.default(this._element).off(p.TRANSITION_END),a.default(this._element).one(p.TRANSITION_END,function(){i._element.classList.remove(tJ),n||a.default(i._element).one(p.TRANSITION_END,function(){i._element.style.overflowY=""}).emulateTransitionEnd(i._element,o)}).emulateTransitionEnd(o),this._element.focus()}},r._showElement=function(i){var r=this,n=a.default(this._element).hasClass(tX),o=this._dialog?this._dialog.querySelector(".modal-body"):null;this._element.parentNode&&this._element.parentNode.nodeType===Node.ELEMENT_NODE||document.body.appendChild(this._element),this._element.style.display="block",this._element.removeAttribute("aria-hidden"),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),a.default(this._dialog).hasClass("modal-dialog-scrollable")&&o?o.scrollTop=0:this._element.scrollTop=0,n&&p.reflow(this._element),a.default(this._element).addClass(tK),this._config.focus&&this._enforceFocus();var s=a.default.Event(t2,{relatedTarget:i}),l=function(){r._config.focus&&r._element.focus(),r._isTransitioning=!1,a.default(r._element).trigger(s)};if(n){var u=p.getTransitionDurationFromElement(this._dialog);a.default(this._dialog).one(p.TRANSITION_END,l).emulateTransitionEnd(u)}else l()},r._enforceFocus=function(){var i=this;a.default(document).off(t3).on(t3,function(r){document!==r.target&&i._element!==r.target&&0===a.default(i._element).has(r.target).length&&i._element.focus()})},r._setEscapeEvent=function(){var i=this;this._isShown?a.default(this._element).on(t6,function(r){i._config.keyboard&&27===r.which?(r.preventDefault(),i.hide()):i._config.keyboard||27!==r.which||i._triggerBackdropTransition()}):this._isShown||a.default(this._element).off(t6)},r._setResizeEvent=function(){var i=this;this._isShown?a.default(window).on(t5,function(r){return i.handleUpdate(r)}):a.default(window).off(t5)},r._hideModal=function(){var i=this;this._element.style.display="none",this._element.setAttribute("aria-hidden",!0),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._isTransitioning=!1,this._showBackdrop(function(){a.default(document.body).removeClass(tH),i._resetAdjustments(),i._resetScrollbar(),a.default(i._element).trigger(t0)})},r._removeBackdrop=function(){this._backdrop&&(a.default(this._backdrop).remove(),this._backdrop=null)},r._showBackdrop=function(i){var r=this,n=a.default(this._element).hasClass(tX)?tX:"";if(this._isShown&&this._config.backdrop){if(this._backdrop=document.createElement("div"),this._backdrop.className="modal-backdrop",n&&this._backdrop.classList.add(n),a.default(this._backdrop).appendTo(document.body),a.default(this._element).on(t4,function(i){if(r._ignoreBackdropClick){r._ignoreBackdropClick=!1;return}i.target===i.currentTarget&&("static"===r._config.backdrop?r._triggerBackdropTransition():r.hide())}),n&&p.reflow(this._backdrop),a.default(this._backdrop).addClass(tK),!i)return;if(!n){i();return}var o=p.getTransitionDurationFromElement(this._backdrop);a.default(this._backdrop).one(p.TRANSITION_END,i).emulateTransitionEnd(o)}else if(!this._isShown&&this._backdrop){a.default(this._backdrop).removeClass(tK);var s=function(){r._removeBackdrop(),i&&i()};if(a.default(this._element).hasClass(tX)){var l=p.getTransitionDurationFromElement(this._backdrop);a.default(this._backdrop).one(p.TRANSITION_END,s).emulateTransitionEnd(l)}else s()}else i&&i()},r._adjustDialog=function(){var i=this._element.scrollHeight>document.documentElement.clientHeight;!this._isBodyOverflowing&&i&&(this._element.style.paddingLeft=this._scrollbarWidth+"px"),this._isBodyOverflowing&&!i&&(this._element.style.paddingRight=this._scrollbarWidth+"px")},r._resetAdjustments=function(){this._element.style.paddingLeft="",this._element.style.paddingRight=""},r._checkScrollbar=function(){var i=document.body.getBoundingClientRect();this._isBodyOverflowing=Math.round(i.left+i.right)<window.innerWidth,this._scrollbarWidth=this._getScrollbarWidth()},r._setScrollbar=function(){var i=this;if(this._isBodyOverflowing){var r=[].slice.call(document.querySelectorAll(et)),n=[].slice.call(document.querySelectorAll(ee));a.default(r).each(function(r,n){var o=n.style.paddingRight,s=a.default(n).css("padding-right");a.default(n).data("padding-right",o).css("padding-right",parseFloat(s)+i._scrollbarWidth+"px")}),a.default(n).each(function(r,n){var o=n.style.marginRight,s=a.default(n).css("margin-right");a.default(n).data("margin-right",o).css("margin-right",parseFloat(s)-i._scrollbarWidth+"px")});var o=document.body.style.paddingRight,s=a.default(document.body).css("padding-right");a.default(document.body).data("padding-right",o).css("padding-right",parseFloat(s)+this._scrollbarWidth+"px")}a.default(document.body).addClass(tH)},r._resetScrollbar=function(){var i=[].slice.call(document.querySelectorAll(et));a.default(i).each(function(i,r){var n=a.default(r).data("padding-right");a.default(r).removeData("padding-right"),r.style.paddingRight=n||""});var r=[].slice.call(document.querySelectorAll(""+ee));a.default(r).each(function(i,r){var n=a.default(r).data("margin-right");void 0!==n&&a.default(r).css("margin-right",n).removeData("margin-right")});var n=a.default(document.body).data("padding-right");a.default(document.body).removeData("padding-right"),document.body.style.paddingRight=n||""},r._getScrollbarWidth=function(){var i=document.createElement("div");i.className="modal-scrollbar-measure",document.body.appendChild(i);var r=i.getBoundingClientRect().width-i.clientWidth;return document.body.removeChild(i),r},i._jQueryInterface=function(r,n){return this.each(function(){var o=a.default(this).data(tG),s=h({},ei,a.default(this).data(),"object"==typeof r&&r?r:{});if(o||(o=new i(this,s),a.default(this).data(tG,o)),"string"==typeof r){if(void 0===o[r])throw TypeError('No method named "'+r+'"');o[r](n)}else s.show&&o.show(n)})},u(i,null,[{key:"VERSION",get:function(){return"4.6.2"}},{key:"Default",get:function(){return ei}}]),i}();a.default(document).on(t7,'[data-toggle="modal"]',function(i){var r,n=this,o=p.getSelectorFromElement(this);o&&(r=document.querySelector(o));var s=a.default(r).data(tG)?"toggle":h({},a.default(r).data(),a.default(this).data());("A"===this.tagName||"AREA"===this.tagName)&&i.preventDefault();var l=a.default(r).one(t1,function(i){i.isDefaultPrevented()||l.one(t0,function(){a.default(n).is(":visible")&&n.focus()})});en._jQueryInterface.call(a.default(r),s,this)}),a.default.fn[tq]=en._jQueryInterface,a.default.fn[tq].Constructor=en,a.default.fn[tq].noConflict=function(){return a.default.fn[tq]=tW,en._jQueryInterface};var eo=["background","cite","href","itemtype","longdesc","poster","src","xlink:href"],ea=/^(?:(?:https?|mailto|ftp|tel|file|sms):|[^#&/:?]*(?:[#/?]|$))/i,es=/^data:(?:image\/(?:bmp|gif|jpeg|jpg|png|tiff|webp)|video\/(?:mpeg|mp4|ogg|webm)|audio\/(?:mp3|oga|ogg|opus));base64,[\d+/a-z]+=*$/i;function el(i,r,n){if(0===i.length)return i;if(n&&"function"==typeof n)return n(i);for(var o=new window.DOMParser().parseFromString(i,"text/html"),a=Object.keys(r),s=[].slice.call(o.body.querySelectorAll("*")),l=0,u=s.length;l<u;l++)if("continue"===function(i,n){var o=s[i],l=o.nodeName.toLowerCase();if(-1===a.indexOf(o.nodeName.toLowerCase()))return o.parentNode.removeChild(o),"continue";var u=[].slice.call(o.attributes),h=[].concat(r["*"]||[],r[l]||[]);u.forEach(function(i){!function(i,r){var n=i.nodeName.toLowerCase();if(-1!==r.indexOf(n))return -1===eo.indexOf(n)||!!(ea.test(i.nodeValue)||es.test(i.nodeValue));for(var o=r.filter(function(i){return i instanceof RegExp}),a=0,s=o.length;a<s;a++)if(o[a].test(n))return!0;return!1}(i,h)&&o.removeAttribute(i.nodeName)})}(l))continue;return o.body.innerHTML}var eu="tooltip",eh="bs.tooltip",ec="."+eh,ed=a.default.fn[eu],ep="bs-tooltip",ef=RegExp("(^|\\s)"+ep+"\\S+","g"),em=["sanitize","whiteList","sanitizeFn"],eg="fade",e_="show",ey="show",ev="hover",ex="focus",eb={AUTO:"auto",TOP:"top",RIGHT:"right",BOTTOM:"bottom",LEFT:"left"},ew={animation:!0,template:'<div class="tooltip" role="tooltip"><div class="arrow"></div><div class="tooltip-inner"></div></div>',trigger:"hover focus",title:"",delay:0,html:!1,selector:!1,placement:"top",offset:0,container:!1,fallbackPlacement:"flip",boundary:"scrollParent",customClass:"",sanitize:!0,sanitizeFn:null,whiteList:{"*":["class","dir","id","lang","role",/^aria-[\w-]*$/i],a:["target","href","title","rel"],area:[],b:[],br:[],col:[],code:[],div:[],em:[],hr:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],i:[],img:["src","srcset","alt","title","width","height"],li:[],ol:[],p:[],pre:[],s:[],small:[],span:[],sub:[],sup:[],strong:[],u:[],ul:[]},popperConfig:null},eT={animation:"boolean",template:"string",title:"(string|element|function)",trigger:"string",delay:"(number|object)",html:"boolean",selector:"(string|boolean)",placement:"(string|function)",offset:"(number|string|function)",container:"(string|element|boolean)",fallbackPlacement:"(string|array)",boundary:"(string|element)",customClass:"(string|function)",sanitize:"boolean",sanitizeFn:"(null|function)",whiteList:"object",popperConfig:"(null|object)"},eE={HIDE:"hide"+ec,HIDDEN:"hidden"+ec,SHOW:"show"+ec,SHOWN:"shown"+ec,INSERTED:"inserted"+ec,CLICK:"click"+ec,FOCUSIN:"focusin"+ec,FOCUSOUT:"focusout"+ec,MOUSEENTER:"mouseenter"+ec,MOUSELEAVE:"mouseleave"+ec},eS=function(){function i(i,r){if(void 0===s.default)throw TypeError("Bootstrap's tooltips require Popper (https://popper.js.org)");this._isEnabled=!0,this._timeout=0,this._hoverState="",this._activeTrigger={},this._popper=null,this.element=i,this.config=this._getConfig(r),this.tip=null,this._setListeners()}var r=i.prototype;return r.enable=function(){this._isEnabled=!0},r.disable=function(){this._isEnabled=!1},r.toggleEnabled=function(){this._isEnabled=!this._isEnabled},r.toggle=function(i){if(this._isEnabled){if(i){var r=this.constructor.DATA_KEY,n=a.default(i.currentTarget).data(r);n||(n=new this.constructor(i.currentTarget,this._getDelegateConfig()),a.default(i.currentTarget).data(r,n)),n._activeTrigger.click=!n._activeTrigger.click,n._isWithActiveTrigger()?n._enter(null,n):n._leave(null,n)}else{if(a.default(this.getTipElement()).hasClass(e_)){this._leave(null,this);return}this._enter(null,this)}}},r.dispose=function(){clearTimeout(this._timeout),a.default.removeData(this.element,this.constructor.DATA_KEY),a.default(this.element).off(this.constructor.EVENT_KEY),a.default(this.element).closest(".modal").off("hide.bs.modal",this._hideModalHandler),this.tip&&a.default(this.tip).remove(),this._isEnabled=null,this._timeout=null,this._hoverState=null,this._activeTrigger=null,this._popper&&this._popper.destroy(),this._popper=null,this.element=null,this.config=null,this.tip=null},r.show=function(){var i=this;if("none"===a.default(this.element).css("display"))throw Error("Please use show on visible elements");var r=a.default.Event(this.constructor.Event.SHOW);if(this.isWithContent()&&this._isEnabled){a.default(this.element).trigger(r);var n=p.findShadowRoot(this.element),o=a.default.contains(null!==n?n:this.element.ownerDocument.documentElement,this.element);if(r.isDefaultPrevented()||!o)return;var l=this.getTipElement(),u=p.getUID(this.constructor.NAME);l.setAttribute("id",u),this.element.setAttribute("aria-describedby",u),this.setContent(),this.config.animation&&a.default(l).addClass(eg);var h="function"==typeof this.config.placement?this.config.placement.call(this,l,this.element):this.config.placement,c=this._getAttachment(h);this.addAttachmentClass(c);var d=this._getContainer();a.default(l).data(this.constructor.DATA_KEY,this),a.default.contains(this.element.ownerDocument.documentElement,this.tip)||a.default(l).appendTo(d),a.default(this.element).trigger(this.constructor.Event.INSERTED),this._popper=new s.default(this.element,l,this._getPopperConfig(c)),a.default(l).addClass(e_),a.default(l).addClass(this.config.customClass),"ontouchstart"in document.documentElement&&a.default(document.body).children().on("mouseover",null,a.default.noop);var f=function(){i.config.animation&&i._fixTransition();var r=i._hoverState;i._hoverState=null,a.default(i.element).trigger(i.constructor.Event.SHOWN),"out"===r&&i._leave(null,i)};if(a.default(this.tip).hasClass(eg)){var m=p.getTransitionDurationFromElement(this.tip);a.default(this.tip).one(p.TRANSITION_END,f).emulateTransitionEnd(m)}else f()}},r.hide=function(i){var r=this,n=this.getTipElement(),o=a.default.Event(this.constructor.Event.HIDE),s=function(){r._hoverState!==ey&&n.parentNode&&n.parentNode.removeChild(n),r._cleanTipClass(),r.element.removeAttribute("aria-describedby"),a.default(r.element).trigger(r.constructor.Event.HIDDEN),null!==r._popper&&r._popper.destroy(),i&&i()};if(a.default(this.element).trigger(o),!o.isDefaultPrevented()){if(a.default(n).removeClass(e_),"ontouchstart"in document.documentElement&&a.default(document.body).children().off("mouseover",null,a.default.noop),this._activeTrigger.click=!1,this._activeTrigger[ex]=!1,this._activeTrigger[ev]=!1,a.default(this.tip).hasClass(eg)){var l=p.getTransitionDurationFromElement(n);a.default(n).one(p.TRANSITION_END,s).emulateTransitionEnd(l)}else s();this._hoverState=""}},r.update=function(){null!==this._popper&&this._popper.scheduleUpdate()},r.isWithContent=function(){return!!this.getTitle()},r.addAttachmentClass=function(i){a.default(this.getTipElement()).addClass(ep+"-"+i)},r.getTipElement=function(){return this.tip=this.tip||a.default(this.config.template)[0],this.tip},r.setContent=function(){var i=this.getTipElement();this.setElementContent(a.default(i.querySelectorAll(".tooltip-inner")),this.getTitle()),a.default(i).removeClass(eg+" "+e_)},r.setElementContent=function(i,r){if("object"==typeof r&&(r.nodeType||r.jquery)){this.config.html?a.default(r).parent().is(i)||i.empty().append(r):i.text(a.default(r).text());return}this.config.html?(this.config.sanitize&&(r=el(r,this.config.whiteList,this.config.sanitizeFn)),i.html(r)):i.text(r)},r.getTitle=function(){var i=this.element.getAttribute("data-original-title");return i||(i="function"==typeof this.config.title?this.config.title.call(this.element):this.config.title),i},r._getPopperConfig=function(i){var r=this;return h({},{placement:i,modifiers:{offset:this._getOffset(),flip:{behavior:this.config.fallbackPlacement},arrow:{element:".arrow"},preventOverflow:{boundariesElement:this.config.boundary}},onCreate:function(i){i.originalPlacement!==i.placement&&r._handlePopperPlacementChange(i)},onUpdate:function(i){return r._handlePopperPlacementChange(i)}},this.config.popperConfig)},r._getOffset=function(){var i=this,r={};return"function"==typeof this.config.offset?r.fn=function(r){return r.offsets=h({},r.offsets,i.config.offset(r.offsets,i.element)),r}:r.offset=this.config.offset,r},r._getContainer=function(){return!1===this.config.container?document.body:p.isElement(this.config.container)?a.default(this.config.container):a.default(document).find(this.config.container)},r._getAttachment=function(i){return eb[i.toUpperCase()]},r._setListeners=function(){var i=this;this.config.trigger.split(" ").forEach(function(r){if("click"===r)a.default(i.element).on(i.constructor.Event.CLICK,i.config.selector,function(r){return i.toggle(r)});else if("manual"!==r){var n=r===ev?i.constructor.Event.MOUSEENTER:i.constructor.Event.FOCUSIN,o=r===ev?i.constructor.Event.MOUSELEAVE:i.constructor.Event.FOCUSOUT;a.default(i.element).on(n,i.config.selector,function(r){return i._enter(r)}).on(o,i.config.selector,function(r){return i._leave(r)})}}),this._hideModalHandler=function(){i.element&&i.hide()},a.default(this.element).closest(".modal").on("hide.bs.modal",this._hideModalHandler),this.config.selector?this.config=h({},this.config,{trigger:"manual",selector:""}):this._fixTitle()},r._fixTitle=function(){var i=typeof this.element.getAttribute("data-original-title");(this.element.getAttribute("title")||"string"!==i)&&(this.element.setAttribute("data-original-title",this.element.getAttribute("title")||""),this.element.setAttribute("title",""))},r._enter=function(i,r){var n=this.constructor.DATA_KEY;if((r=r||a.default(i.currentTarget).data(n))||(r=new this.constructor(i.currentTarget,this._getDelegateConfig()),a.default(i.currentTarget).data(n,r)),i&&(r._activeTrigger["focusin"===i.type?ex:ev]=!0),a.default(r.getTipElement()).hasClass(e_)||r._hoverState===ey){r._hoverState=ey;return}if(clearTimeout(r._timeout),r._hoverState=ey,!r.config.delay||!r.config.delay.show){r.show();return}r._timeout=setTimeout(function(){r._hoverState===ey&&r.show()},r.config.delay.show)},r._leave=function(i,r){var n=this.constructor.DATA_KEY;if((r=r||a.default(i.currentTarget).data(n))||(r=new this.constructor(i.currentTarget,this._getDelegateConfig()),a.default(i.currentTarget).data(n,r)),i&&(r._activeTrigger["focusout"===i.type?ex:ev]=!1),!r._isWithActiveTrigger()){if(clearTimeout(r._timeout),r._hoverState="out",!r.config.delay||!r.config.delay.hide){r.hide();return}r._timeout=setTimeout(function(){"out"===r._hoverState&&r.hide()},r.config.delay.hide)}},r._isWithActiveTrigger=function(){for(var i in this._activeTrigger)if(this._activeTrigger[i])return!0;return!1},r._getConfig=function(i){var r=a.default(this.element).data();return Object.keys(r).forEach(function(i){-1!==em.indexOf(i)&&delete r[i]}),"number"==typeof(i=h({},this.constructor.Default,r,"object"==typeof i&&i?i:{})).delay&&(i.delay={show:i.delay,hide:i.delay}),"number"==typeof i.title&&(i.title=i.title.toString()),"number"==typeof i.content&&(i.content=i.content.toString()),p.typeCheckConfig(eu,i,this.constructor.DefaultType),i.sanitize&&(i.template=el(i.template,i.whiteList,i.sanitizeFn)),i},r._getDelegateConfig=function(){var i={};if(this.config)for(var r in this.config)this.constructor.Default[r]!==this.config[r]&&(i[r]=this.config[r]);return i},r._cleanTipClass=function(){var i=a.default(this.getTipElement()),r=i.attr("class").match(ef);null!==r&&r.length&&i.removeClass(r.join(""))},r._handlePopperPlacementChange=function(i){this.tip=i.instance.popper,this._cleanTipClass(),this.addAttachmentClass(this._getAttachment(i.placement))},r._fixTransition=function(){var i=this.getTipElement(),r=this.config.animation;null===i.getAttribute("x-placement")&&(a.default(i).removeClass(eg),this.config.animation=!1,this.hide(),this.show(),this.config.animation=r)},i._jQueryInterface=function(r){return this.each(function(){var n=a.default(this),o=n.data(eh),s="object"==typeof r&&r;if(!(!o&&/dispose|hide/.test(r))&&(o||(o=new i(this,s),n.data(eh,o)),"string"==typeof r)){if(void 0===o[r])throw TypeError('No method named "'+r+'"');o[r]()}})},u(i,null,[{key:"VERSION",get:function(){return"4.6.2"}},{key:"Default",get:function(){return ew}},{key:"NAME",get:function(){return eu}},{key:"DATA_KEY",get:function(){return eh}},{key:"Event",get:function(){return eE}},{key:"EVENT_KEY",get:function(){return ec}},{key:"DefaultType",get:function(){return eT}}]),i}();a.default.fn[eu]=eS._jQueryInterface,a.default.fn[eu].Constructor=eS,a.default.fn[eu].noConflict=function(){return a.default.fn[eu]=ed,eS._jQueryInterface};var eC="popover",eI="bs.popover",eA="."+eI,eP=a.default.fn[eC],ek="bs-popover",eL=RegExp("(^|\\s)"+ek+"\\S+","g"),eM=h({},eS.Default,{placement:"right",trigger:"click",content:"",template:'<div class="popover" role="tooltip"><div class="arrow"></div><h3 class="popover-header"></h3><div class="popover-body"></div></div>'}),ez=h({},eS.DefaultType,{content:"(string|element|function)"}),eD={HIDE:"hide"+eA,HIDDEN:"hidden"+eA,SHOW:"show"+eA,SHOWN:"shown"+eA,INSERTED:"inserted"+eA,CLICK:"click"+eA,FOCUSIN:"focusin"+eA,FOCUSOUT:"focusout"+eA,MOUSEENTER:"mouseenter"+eA,MOUSELEAVE:"mouseleave"+eA},eR=function(i){function r(){return i.apply(this,arguments)||this}r.prototype=Object.create(i.prototype),r.prototype.constructor=r,c(r,i);var n=r.prototype;return n.isWithContent=function(){return this.getTitle()||this._getContent()},n.addAttachmentClass=function(i){a.default(this.getTipElement()).addClass(ek+"-"+i)},n.getTipElement=function(){return this.tip=this.tip||a.default(this.config.template)[0],this.tip},n.setContent=function(){var i=a.default(this.getTipElement());this.setElementContent(i.find(".popover-header"),this.getTitle());var r=this._getContent();"function"==typeof r&&(r=r.call(this.element)),this.setElementContent(i.find(".popover-body"),r),i.removeClass("fade show")},n._getContent=function(){return this.element.getAttribute("data-content")||this.config.content},n._cleanTipClass=function(){var i=a.default(this.getTipElement()),r=i.attr("class").match(eL);null!==r&&r.length>0&&i.removeClass(r.join(""))},r._jQueryInterface=function(i){return this.each(function(){var n=a.default(this).data(eI),o="object"==typeof i?i:null;if(!(!n&&/dispose|hide/.test(i))&&(n||(n=new r(this,o),a.default(this).data(eI,n)),"string"==typeof i)){if(void 0===n[i])throw TypeError('No method named "'+i+'"');n[i]()}})},u(r,null,[{key:"VERSION",get:function(){return"4.6.2"}},{key:"Default",get:function(){return eM}},{key:"NAME",get:function(){return eC}},{key:"DATA_KEY",get:function(){return eI}},{key:"Event",get:function(){return eD}},{key:"EVENT_KEY",get:function(){return eA}},{key:"DefaultType",get:function(){return ez}}]),r}(eS);a.default.fn[eC]=eR._jQueryInterface,a.default.fn[eC].Constructor=eR,a.default.fn[eC].noConflict=function(){return a.default.fn[eC]=eP,eR._jQueryInterface};var eB="scrollspy",eO="bs.scrollspy",eF="."+eO,eN=a.default.fn[eB],eU="active",ej="activate"+eF,eZ="scroll"+eF,eV="load"+eF+".data-api",eq="position",eG=".nav, .list-group",e$=".nav-link",eW=".list-group-item",eH={offset:10,method:"auto",target:""},eX={offset:"number",method:"string",target:"(string|element)"},eK=function(){function i(i,r){var n=this;this._element=i,this._scrollElement="BODY"===i.tagName?window:i,this._config=this._getConfig(r),this._selector=this._config.target+" "+e$+","+this._config.target+" "+eW+","+this._config.target+" .dropdown-item",this._offsets=[],this._targets=[],this._activeTarget=null,this._scrollHeight=0,a.default(this._scrollElement).on(eZ,function(i){return n._process(i)}),this.refresh(),this._process()}var r=i.prototype;return r.refresh=function(){var i=this,r=this._scrollElement===this._scrollElement.window?"offset":eq,n="auto"===this._config.method?r:this._config.method,o=n===eq?this._getScrollTop():0;this._offsets=[],this._targets=[],this._scrollHeight=this._getScrollHeight(),[].slice.call(document.querySelectorAll(this._selector)).map(function(i){var r,s=p.getSelectorFromElement(i);if(s&&(r=document.querySelector(s)),r){var l=r.getBoundingClientRect();if(l.width||l.height)return[a.default(r)[n]().top+o,s]}return null}).filter(Boolean).sort(function(i,r){return i[0]-r[0]}).forEach(function(r){i._offsets.push(r[0]),i._targets.push(r[1])})},r.dispose=function(){a.default.removeData(this._element,eO),a.default(this._scrollElement).off(eF),this._element=null,this._scrollElement=null,this._config=null,this._selector=null,this._offsets=null,this._targets=null,this._activeTarget=null,this._scrollHeight=null},r._getConfig=function(i){if("string"!=typeof(i=h({},eH,"object"==typeof i&&i?i:{})).target&&p.isElement(i.target)){var r=a.default(i.target).attr("id");r||(r=p.getUID(eB),a.default(i.target).attr("id",r)),i.target="#"+r}return p.typeCheckConfig(eB,i,eX),i},r._getScrollTop=function(){return this._scrollElement===window?this._scrollElement.pageYOffset:this._scrollElement.scrollTop},r._getScrollHeight=function(){return this._scrollElement.scrollHeight||Math.max(document.body.scrollHeight,document.documentElement.scrollHeight)},r._getOffsetHeight=function(){return this._scrollElement===window?window.innerHeight:this._scrollElement.getBoundingClientRect().height},r._process=function(){var i=this._getScrollTop()+this._config.offset,r=this._getScrollHeight(),n=this._config.offset+r-this._getOffsetHeight();if(this._scrollHeight!==r&&this.refresh(),i>=n){var o=this._targets[this._targets.length-1];this._activeTarget!==o&&this._activate(o);return}if(this._activeTarget&&i<this._offsets[0]&&this._offsets[0]>0){this._activeTarget=null,this._clear();return}for(var a=this._offsets.length;a--;)this._activeTarget!==this._targets[a]&&i>=this._offsets[a]&&(void 0===this._offsets[a+1]||i<this._offsets[a+1])&&this._activate(this._targets[a])},r._activate=function(i){this._activeTarget=i,this._clear();var r=this._selector.split(",").map(function(r){return r+'[data-target="'+i+'"],'+r+'[href="'+i+'"]'}),n=a.default([].slice.call(document.querySelectorAll(r.join(","))));n.hasClass("dropdown-item")?(n.closest(".dropdown").find(".dropdown-toggle").addClass(eU),n.addClass(eU)):(n.addClass(eU),n.parents(eG).prev(e$+", "+eW).addClass(eU),n.parents(eG).prev(".nav-item").children(e$).addClass(eU)),a.default(this._scrollElement).trigger(ej,{relatedTarget:i})},r._clear=function(){[].slice.call(document.querySelectorAll(this._selector)).filter(function(i){return i.classList.contains(eU)}).forEach(function(i){return i.classList.remove(eU)})},i._jQueryInterface=function(r){return this.each(function(){var n=a.default(this).data(eO);if(n||(n=new i(this,"object"==typeof r&&r),a.default(this).data(eO,n)),"string"==typeof r){if(void 0===n[r])throw TypeError('No method named "'+r+'"');n[r]()}})},u(i,null,[{key:"VERSION",get:function(){return"4.6.2"}},{key:"Default",get:function(){return eH}}]),i}();a.default(window).on(eV,function(){for(var i=[].slice.call(document.querySelectorAll('[data-spy="scroll"]')),r=i.length,n=r;n--;){var o=a.default(i[n]);eK._jQueryInterface.call(o,o.data())}}),a.default.fn[eB]=eK._jQueryInterface,a.default.fn[eB].Constructor=eK,a.default.fn[eB].noConflict=function(){return a.default.fn[eB]=eN,eK._jQueryInterface};var eJ="bs.tab",eY="."+eJ,eQ=a.default.fn.tab,e0="active",e1="fade",e2="show",e3="hide"+eY,e5="hidden"+eY,e4="show"+eY,e6="shown"+eY,e8=".active",e9="> li > .active",e7=function(){function i(i){this._element=i}var r=i.prototype;return r.show=function(){var i,r,n=this;if(!(this._element.parentNode&&this._element.parentNode.nodeType===Node.ELEMENT_NODE&&a.default(this._element).hasClass(e0)||a.default(this._element).hasClass("disabled")||this._element.hasAttribute("disabled"))){var o=a.default(this._element).closest(".nav, .list-group")[0],s=p.getSelectorFromElement(this._element);if(o){var l="UL"===o.nodeName||"OL"===o.nodeName?e9:e8;r=(r=a.default.makeArray(a.default(o).find(l)))[r.length-1]}var u=a.default.Event(e3,{relatedTarget:this._element}),h=a.default.Event(e4,{relatedTarget:r});if(r&&a.default(r).trigger(u),a.default(this._element).trigger(h),!(h.isDefaultPrevented()||u.isDefaultPrevented())){s&&(i=document.querySelector(s)),this._activate(this._element,o);var c=function(){var i=a.default.Event(e5,{relatedTarget:n._element}),o=a.default.Event(e6,{relatedTarget:r});a.default(r).trigger(i),a.default(n._element).trigger(o)};i?this._activate(i,i.parentNode,c):c()}}},r.dispose=function(){a.default.removeData(this._element,eJ),this._element=null},r._activate=function(i,r,n){var o=this,s=(r&&("UL"===r.nodeName||"OL"===r.nodeName)?a.default(r).find(e9):a.default(r).children(e8))[0],l=n&&s&&a.default(s).hasClass(e1),u=function(){return o._transitionComplete(i,s,n)};if(s&&l){var h=p.getTransitionDurationFromElement(s);a.default(s).removeClass(e2).one(p.TRANSITION_END,u).emulateTransitionEnd(h)}else u()},r._transitionComplete=function(i,r,n){if(r){a.default(r).removeClass(e0);var o=a.default(r.parentNode).find("> .dropdown-menu .active")[0];o&&a.default(o).removeClass(e0),"tab"===r.getAttribute("role")&&r.setAttribute("aria-selected",!1)}a.default(i).addClass(e0),"tab"===i.getAttribute("role")&&i.setAttribute("aria-selected",!0),p.reflow(i),i.classList.contains(e1)&&i.classList.add(e2);var s=i.parentNode;if(s&&"LI"===s.nodeName&&(s=s.parentNode),s&&a.default(s).hasClass("dropdown-menu")){var l=a.default(i).closest(".dropdown")[0];if(l){var u=[].slice.call(l.querySelectorAll(".dropdown-toggle"));a.default(u).addClass(e0)}i.setAttribute("aria-expanded",!0)}n&&n()},i._jQueryInterface=function(r){return this.each(function(){var n=a.default(this),o=n.data(eJ);if(o||(o=new i(this),n.data(eJ,o)),"string"==typeof r){if(void 0===o[r])throw TypeError('No method named "'+r+'"');o[r]()}})},u(i,null,[{key:"VERSION",get:function(){return"4.6.2"}}]),i}();a.default(document).on("click"+eY+".data-api",'[data-toggle="tab"], [data-toggle="pill"], [data-toggle="list"]',function(i){i.preventDefault(),e7._jQueryInterface.call(a.default(this),"show")}),a.default.fn.tab=e7._jQueryInterface,a.default.fn.tab.Constructor=e7,a.default.fn.tab.noConflict=function(){return a.default.fn.tab=eQ,e7._jQueryInterface};var it="toast",ie="bs.toast",ii="."+ie,ir=a.default.fn[it],io="hide",ia="show",is="showing",il="click.dismiss"+ii,iu="hide"+ii,ih="hidden"+ii,ic="show"+ii,id="shown"+ii,ip={animation:!0,autohide:!0,delay:500},im={animation:"boolean",autohide:"boolean",delay:"number"},ig=function(){function i(i,r){this._element=i,this._config=this._getConfig(r),this._timeout=null,this._setListeners()}var r=i.prototype;return r.show=function(){var i=this,r=a.default.Event(ic);if(a.default(this._element).trigger(r),!r.isDefaultPrevented()){this._clearTimeout(),this._config.animation&&this._element.classList.add("fade");var n=function(){i._element.classList.remove(is),i._element.classList.add(ia),a.default(i._element).trigger(id),i._config.autohide&&(i._timeout=setTimeout(function(){i.hide()},i._config.delay))};if(this._element.classList.remove(io),p.reflow(this._element),this._element.classList.add(is),this._config.animation){var o=p.getTransitionDurationFromElement(this._element);a.default(this._element).one(p.TRANSITION_END,n).emulateTransitionEnd(o)}else n()}},r.hide=function(){if(this._element.classList.contains(ia)){var i=a.default.Event(iu);a.default(this._element).trigger(i),i.isDefaultPrevented()||this._close()}},r.dispose=function(){this._clearTimeout(),this._element.classList.contains(ia)&&this._element.classList.remove(ia),a.default(this._element).off(il),a.default.removeData(this._element,ie),this._element=null,this._config=null},r._getConfig=function(i){return i=h({},ip,a.default(this._element).data(),"object"==typeof i&&i?i:{}),p.typeCheckConfig(it,i,this.constructor.DefaultType),i},r._setListeners=function(){var i=this;a.default(this._element).on(il,'[data-dismiss="toast"]',function(){return i.hide()})},r._close=function(){var i=this,r=function(){i._element.classList.add(io),a.default(i._element).trigger(ih)};if(this._element.classList.remove(ia),this._config.animation){var n=p.getTransitionDurationFromElement(this._element);a.default(this._element).one(p.TRANSITION_END,r).emulateTransitionEnd(n)}else r()},r._clearTimeout=function(){clearTimeout(this._timeout),this._timeout=null},i._jQueryInterface=function(r){return this.each(function(){var n=a.default(this),o=n.data(ie);if(o||(o=new i(this,"object"==typeof r&&r),n.data(ie,o)),"string"==typeof r){if(void 0===o[r])throw TypeError('No method named "'+r+'"');o[r](this)}})},u(i,null,[{key:"VERSION",get:function(){return"4.6.2"}},{key:"DefaultType",get:function(){return im}},{key:"Default",get:function(){return ip}}]),i}();a.default.fn[it]=ig._jQueryInterface,a.default.fn[it].Constructor=ig,a.default.fn[it].noConflict=function(){return a.default.fn[it]=ir,ig._jQueryInterface},i.Alert=x,i.Button=k,i.Carousel=tn,i.Collapse=tb,i.Dropdown=tV,i.Modal=en,i.Popover=eR,i.Scrollspy=eK,i.Tab=e7,i.Toast=ig,i.Tooltip=eS,i.Util=p,Object.defineProperty(i,"__esModule",{value:!0})}({},l("9qak9"),l("gDcFo"));var u=l("iLKzi");let h=i=>new Promise(function(r,n){navigator.geolocation.getCurrentPosition(r,n,i)}),c=(i,r)=>({x:r,y:i,spatialReference:{wkid:4326}});var d=function(i,r){return(d=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])})(i,r)},p=function(){return(p=Object.assign||function(i){for(var r,n=1,o=arguments.length;n<o;n++)for(var a in r=arguments[n])Object.prototype.hasOwnProperty.call(r,a)&&(i[a]=r[a]);return i}).apply(this,arguments)};function f(i){return Object.keys(i).some(function(r){var n=i[r];if(!n)return!1;switch(n&&n.toParam&&(n=n.toParam()),n.constructor.name){case"Array":case"Object":case"Date":case"Function":case"Boolean":case"String":case"Number":return!1;default:return!0}})}function m(i){var r={};return Object.keys(i).forEach(function(n){var o,a,s,l=i[n];if(l&&l.toParam&&(l=l.toParam()),l||0===l||"boolean"==typeof l||"string"==typeof l){switch(l.constructor.name){case"Array":var u=null===(a=null===(o=l[0])||void 0===o?void 0:o.constructor)||void 0===a?void 0:a.name;s="Array"===u?l:"Object"===u?JSON.stringify(l):l.join(",");break;case"Object":s=JSON.stringify(l);break;case"Date":s=l.valueOf();break;case"Function":s=null;break;case"Boolean":s=l+"";break;default:s=l}(s||0===s||"string"==typeof s||Array.isArray(s))&&(r[n]=s)}}),r}function g(i){var r=m(i);return Object.keys(r).map(function(i){return function i(r,n){return Array.isArray(n)&&n[0]&&Array.isArray(n[0])?n.map(function(n){return i(r,n)}).join("&"):encodeURIComponent(r)+"="+encodeURIComponent(n)}(i,r[i])}).join("&")}var _=function(i,r,n,o,a){i=i||"UNKNOWN_ERROR",r=r||"UNKNOWN_ERROR_CODE",this.name="ArcGISRequestError",this.message="UNKNOWN_ERROR_CODE"===r?i:r+": "+i,this.originalMessage=i,this.code=r,this.response=n,this.url=o,this.options=a};_.prototype=Object.create(Error.prototype),_.prototype.constructor=_;var y={httpMethod:"POST",params:{f:"json"}},v=function(i){function r(r,n,o,a,s){void 0===r&&(r="AUTHENTICATION_ERROR"),void 0===n&&(n="AUTHENTICATION_ERROR_CODE");var l=i.call(this,r,n,o,a,s)||this;return l.name="ArcGISAuthError",l.message="AUTHENTICATION_ERROR_CODE"===n?r:n+": "+r,l}return function(i,r){function n(){this.constructor=i}d(i,r),i.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}(r,i),r.prototype.retry=function(i,r){var n=this;void 0===r&&(r=3);var o=0,a=function(s,l){i(n.url,n.options).then(function(i){var r=p(p({},n.options),{authentication:i});return o+=1,x(n.url,r)}).then(function(i){s(i)}).catch(function(i){"ArcGISAuthError"===i.name&&o<r?a(s,l):"ArcGISAuthError"===i.name&&o>=r?l(n):l(i)})};return new Promise(function(i,r){a(i,r)})},r}(_);function x(i,r){void 0===r&&(r={params:{f:"json"}});var n=p(p(p({httpMethod:"POST"},y),r),{params:p(p({},y.params),r.params),headers:p(p({},y.headers),r.headers)}),o=[],a=[];if(n.fetch||"undefined"==typeof fetch?(o.push("`fetch`"),a.push("`node-fetch`")):n.fetch=fetch.bind(Function("return this")()),"undefined"==typeof Promise&&(o.push("`Promise`"),a.push("`es6-promise`")),"undefined"==typeof FormData&&(o.push("`FormData`"),a.push("`isomorphic-form-data`")),!n.fetch||"undefined"==typeof Promise||"undefined"==typeof FormData)throw Error("`arcgis-rest-request` requires a `fetch` implementation and global variables for `Promise` and `FormData` to be present in the global scope. You are missing "+o.join(", ")+". We recommend installing the "+a.join(", ")+" modules at the root of your application to add these to the global scope. See https://bit.ly/2KNwWaJ for more info.");var s=n.httpMethod,l=n.authentication,u=n.rawResponse,h=p({f:"json"},n.params),c=null,d={method:s,credentials:n.credentials||"same-origin"};return n.headers&&n.headers["X-Esri-Auth-Client-Id"]&&i.indexOf("/oauth2/platformSelf")>-1&&(d.credentials="include"),(l?l.getToken(i,{fetch:n.fetch}).catch(function(r){return r.url=i,r.options=n,c=r,Promise.resolve("")}):Promise.resolve("")).then(function(r){r.length&&(h.token=r),l&&l.getDomainCredentials&&(d.credentials=l.getDomainCredentials(i));var o={};if("GET"===d.method){h.token&&n.hideToken&&"undefined"==typeof window&&(o["X-Esri-Authorization"]="Bearer "+h.token,delete h.token);var a=""===g(h)?i:i+"?"+g(h);n.maxUrlLength&&a.length>n.maxUrlLength||h.token&&n.hideToken?(d.method="POST",r.length&&n.hideToken&&(h.token=r,delete o["X-Esri-Authorization"])):i=a}var s=RegExp("/items/.+/updateResources").test(i);return"POST"===d.method&&(d.body=function(i,r){var n=f(i)||r,o=m(i);if(!n)return g(i);var a=new FormData;return Object.keys(o).forEach(function(i){if("undefined"!=typeof Blob&&o[i]instanceof Blob){var r=o.fileName||o[i].name||i;a.append(i,o[i],r)}else o[i].constructor&&"ReadStream"===o[i].constructor.name&&Number.isInteger(o.dataSize)?a.append(i,o[i],{knownLength:o.dataSize}):a.append(i,o[i])}),a}(h,s)),d.headers=p(p({},o),n.headers),"undefined"!=typeof window||d.headers.referer||(d.headers.referer="@esri/arcgis-rest-js"),f(h)||s||(d.headers["Content-Type"]="application/x-www-form-urlencoded"),n.fetch(i,d)}).then(function(r){if(!r.ok){var o=r.status,a=r.statusText;throw new _(a,"HTTP "+o,r,i,n)}if(u)return r;switch(h.f){case"json":case"geojson":return r.json();case"html":case"text":return r.text();default:return r.blob()}}).then(function(r){if("json"!==h.f&&"geojson"!==h.f||u)return r;var o=function(i,r,n,o,a){if(i.code>=400){var s=i.message,l=i.code;throw new _(s,l,i,r,o)}if(i.error){var u=i.error,s=u.message,l=u.code,h=u.messageCode,c=h||l||"UNKNOWN_ERROR_CODE";if(498===l||499===l||"GWM_0003"===h||400===l&&"Unable to generate token."===s){if(a)throw a;throw new v(s,c,i,r,o)}throw new _(s,c,i,r,o)}if("failed"===i.status||"failure"===i.status){var s=void 0,l="UNKNOWN_ERROR_CODE";try{s=JSON.parse(i.statusMessage).message,l=JSON.parse(i.statusMessage).code}catch(r){s=i.statusMessage||i.message}throw new _(s,l,i,r,o)}return i}(r,i,0,n,c);if(c){var a=i.toLowerCase().split(/\/rest(\/admin)?\/services\//)[0];n.authentication.federatedServers[a]={token:[],expires:new Date(Date.now()+864e5)},c=null}return o})}var u=l("iLKzi");let b=(i,r,n,o)=>null===n||null===o||0===n||0===n?"no centroid coordinates":`https://www.google.com/maps/dir/?api=1&origin=${i},${r}&destination=${n},${o}`,w=(i="",r="",n="")=>{let o,a,s,l,u,h;return(null===i||""===i||" "===i?(o=!1,a=""):(o=!0,a=i),null===r||""===r||" "===r?(s=!1,l=""):(s=!0,l=r),null===n||""===n||" "===n?(u=!1,h=""):(u=!0,h=n),o&&s&&u)?`${a}, ${l}, PA, ${h}`:s&&h?`${l}, PA ${h}`:s?`${l}, PA`:"No address data available"},T=(i,r,n,o)=>{for(let a of r){let r=i.insertRow(-1);E(r,a.properties.PARK_NAME),E(r,w(a.properties.PREMISE_ADDRESS,a.properties.PREMISE_CITY,a.properties.PREMISE_ZIP)),E(r,b(n,o,a.properties.Lat_Cen,a.properties.Long_Cen),"link")}},E=(i,r,n="text")=>{let o=i.insertCell(-1),a=document.createElement("div");if("link"===n){if("no centroid coordinates"===r)a.innerHTML=r;else{let i=document.createElement("a");i.href=r,i.target="_blank",i.rel="noopener noreferrer",i.innerHTML="Driving Directions",a.appendChild(i)}}else a.innerHTML=r;o.appendChild(a)},S=i=>{for(;i.lastElementChild;)i.removeChild(i.lastElementChild)},C=(i,r,n,o)=>{var a,s,l,h,c,d;(s=a={url:"https://www.gis.dcnr.state.pa.us/agsprod/rest/services/BRC/LocalParks/MapServer/1",f:"geojson",geometry:i,distance:r,units:"esriSRUnit_StatuteMile",geometryType:"esriGeometryPoint",spatialRel:"esriSpatialRelIntersects",returnGeometry:!0,orderByFields:"PARK_NAME",outFields:["PARK_NAME","PREMISE_ADDRESS","PREMISE_CITY","PREMISE_ZIP","Lat_Cen","Long_Cen"]},l={httpMethod:"GET",params:p({where:"1=1",outFields:"*"},a.params)},(h=p(p({params:{}},l),s)).params=["where","objectIds","relationParam","time","distance","units","outFields","geometry","geometryType","spatialRel","returnGeometry","maxAllowableOffset","geometryPrecision","inSR","outSR","gdbVersion","returnDistinctValues","returnIdsOnly","returnCountOnly","returnExtentOnly","orderByFields","groupByFieldsForStatistics","outStatistics","returnZ","returnM","multipatchOption","resultOffset","resultRecordCount","quantizationParameters","returnCentroid","resultType","historicMoment","returnTrueCurves","sqlFormat","returnExceededLimitFeatures","f"].reduce(function(i,r){return(s[r]||"boolean"==typeof s[r])&&(i[r]=s[r]),i},h.params),c=["params","httpMethod","rawResponse","authentication","portal","fetch","maxUrlLength","headers"].reduce(function(i,r){return h[r]&&(i[r]=h[r]),i},{}),x(("string"!=typeof(d=a.url)||"/"===(d=d.trim())[d.length-1]&&(d=d.slice(0,-1)),d+"/query"),c)).then(a=>{let s=a.features;if(document.getElementById("numberParks").innerHTML=s.length,0===s.length){let i=`No parks are located within ${r}-miles of your location`;Y(i),console.warn(i);return}T(document.getElementById("records"),s,i.y,i.x);let l=new u.geoJSON(a,{style:function(i){return{color:"#FFFF00",weight:1.5,fillColor:"#c9f7c9",fillOpacity:.5}},onEachFeature:function(i,r){J&&r.bindTooltip(i.properties.PARK_NAME,{direction:"center",className:"parksLabel"})}});return l.bindPopup(function(r){let n='<div class="feat-popup">';n+=`<h3>{PARK_NAME}</h3><hr /><ul><li>Address: ${w(r.feature.properties.PREMISE_ADDRESS,r.feature.properties.PREMISE_CITY,r.feature.properties.PREMISE_ZIP)}</li>`;let o=b(i.y,i.x,r.feature.properties.Lat_Cen,r.feature.properties.Long_Cen);return"no centroid coordinates"===o?n+="<li>No driving directions available</li>":n+=`<li>Driving Directions: <a href="${o}" target="_blank" rel="noopener noreferrer">Google Maps</a></li>`,n+="</ul></div>",L.Util.template(n,r.feature.properties)}),o.addLayer(l),n.fitBounds(l.getBounds()),s}).catch(i=>{console.log(`Error: ${i}`),Y(`Error: ${i}`)})};var u=(l("iLKzi"),l("iLKzi"));l("k23sD");var I=l("5N6lL"),A={};!function(i,r,n,o){"use strict";var a=o&&"object"==typeof o&&"default"in o?o:{default:o};function s(i,n,o){let a=n.token?{token:n.token}:{};r.request(i,a,o)}function l(i,n,o){let a=n.token?{token:n.token}:{},s=n.portalUrl+"/sharing/rest/content/items/"+i;r.request(s,a,o)}function u(i,r,n){s(i,r,function(o,a){let s;if(o){n(o);return}let l=i;"/"===i.charAt(i.length-1)&&(l=i.slice(0,i.length-1)),h(s="/"===a.defaultStyles.charAt(0)?l+a.defaultStyles+"/root.json":l+"/"+a.defaultStyles+"/root.json",r,function(r,o){if(r){n(r);return}n(null,o,s,a,i)})})}function h(i,n,o){let a=n.token?{token:n.token}:{};r.request(i,a,o)}let c=[3857,102100,102113];var d=n.Layer.extend({options:{updateInterval:32,padding:.1,interactive:!1,pane:"tilePane"},initialize:function(i){n.setOptions(this,i),this._throttledUpdate=n.Util.throttle(this._update,this.options.updateInterval,this)},onAdd:function(i){this._container||this._initContainer();let r=this.getPaneName();i.getPane(r).appendChild(this._container),this._initGL(),this._offset=this._map.containerPointToLayerPoint([0,0]),i.options.zoomAnimation&&n.DomEvent.on(i._proxy,n.DomUtil.TRANSITION_END,this._transitionEnd,this)},onRemove:function(i){this._map._proxy&&this._map.options.zoomAnimation&&n.DomEvent.off(this._map._proxy,n.DomUtil.TRANSITION_END,this._transitionEnd,this);let r=this.getPaneName();i.getPane(r).removeChild(this._container),this._container=null,this._glMap.remove(),this._glMap=null},getEvents:function(){return{move:this._throttledUpdate,zoomanim:this._animateZoom,zoom:this._pinchZoom,zoomstart:this._zoomStart,zoomend:this._zoomEnd,resize:this._resize}},getMaplibreMap:function(){return this._glMap},getCanvas:function(){return this._glMap.getCanvas()},getSize:function(){return this._map.getSize().multiplyBy(1+2*this.options.padding)},getOpacity:function(){return this.options.opacity},setOpacity:function(i){this.options.opacity=i,this._container.style.opacity=i},getBounds:function(){let i=this.getSize().multiplyBy(.5),r=this._map.latLngToContainerPoint(this._map.getCenter());return n.latLngBounds(this._map.containerPointToLatLng(r.subtract(i)),this._map.containerPointToLatLng(r.add(i)))},getContainer:function(){return this._container},getPaneName:function(){return this._map.getPane(this.options.pane)?this.options.pane:"tilePane"},_initContainer:function(){if(this._container)return;this._container=n.DomUtil.create("div","leaflet-gl-layer");let i=this.getSize(),r=this._map.getSize().multiplyBy(this.options.padding);this._container.style.width=i.x+"px",this._container.style.height=i.y+"px";let o=this._map.containerPointToLayerPoint([0,0]).subtract(r);n.DomUtil.setPosition(this._container,o)},_initGL:function(){if(this._glMap)return;let i=this._map.getCenter(),r=n.extend({},this.options,{container:this._container,center:[i.lng,i.lat],zoom:this._map.getZoom()-1,attributionControl:!1});this._glMap=new a.default.Map(r),this._glMap.once("styledata",(function(i){this.fire("styleLoaded")}).bind(this)),this._glMap.transform.latRange=null,this._glMap.transform.maxValidLatitude=1/0,this._transformGL(this._glMap),this._glMap._canvas.canvas?this._glMap._actualCanvas=this._glMap._canvas.canvas:this._glMap._actualCanvas=this._glMap._canvas;let o=this._glMap._actualCanvas;n.DomUtil.addClass(o,"leaflet-image-layer"),n.DomUtil.addClass(o,"leaflet-zoom-animated"),this.options.interactive&&n.DomUtil.addClass(o,"leaflet-interactive"),this.options.className&&n.DomUtil.addClass(o,this.options.className)},_update:function(i){if(this._offset=this._map.containerPointToLayerPoint([0,0]),this._zooming)return;let r=this.getSize(),o=this._container,a=this._glMap,s=this._map.getSize().multiplyBy(this.options.padding),l=this._map.containerPointToLayerPoint([0,0]).subtract(s);n.DomUtil.setPosition(o,l),this._transformGL(a),a.transform.width!==r.x||a.transform.height!==r.y?(o.style.width=r.x+"px",o.style.height=r.y+"px",null!==a._resize&&void 0!==a._resize?a._resize():a.resize()):null!==a._update&&void 0!==a._update?a._update():a.update()},_transformGL:function(i){let r=this._map.getCenter(),n=i.transform;n.center=a.default.LngLat.convert([r.lng,r.lat]),n.zoom=this._map.getZoom()-1},_pinchZoom:function(i){this._glMap.jumpTo({zoom:this._map.getZoom()-1,center:this._map.getCenter()})},_animateZoom:function(i){let r=this._map.getZoomScale(i.zoom),o=this._map.getSize().multiplyBy(this.options.padding*r),a=this.getSize()._divideBy(2),s=this._map.project(i.center,i.zoom)._subtract(a)._add(this._map._getMapPanePos().add(o))._round(),l=this._map.project(this._map.getBounds().getNorthWest(),i.zoom)._subtract(s);n.DomUtil.setTransform(this._glMap._actualCanvas,l.subtract(this._offset),r)},_zoomStart:function(i){this._zooming=!0},_zoomEnd:function(){let i=this._map.getZoomScale(this._map.getZoom());n.DomUtil.setTransform(this._glMap._actualCanvas,null,i),this._zooming=!1,this._update()},_transitionEnd:function(i){n.Util.requestAnimFrame(function(){let i=this._map.getZoom(),r=this._map.getCenter(),o=this._map.latLngToContainerPoint(this._map.getBounds().getNorthWest());n.DomUtil.setTransform(this._glMap._actualCanvas,o,1),this._glMap.once("moveend",n.Util.bind(function(){this._zoomEnd()},this)),this._glMap.jumpTo({center:r,zoom:i-1})},this)}}),p=n.Layer.extend({options:{portalUrl:"https://www.arcgis.com"},initialize:function(i,r){if(r&&n.setOptions(this,r),this.options.apiKey&&(this.options.apikey=this.options.apiKey),this.options.apikey?this.options.token=this.options.apikey:this.options.token&&(this.options.apikey=this.options.token),!i)throw Error("An ITEM ID or SERVICE URL is required for vectorTileLayer.");i&&(this.options.key=i),this._createLayer()},_createLayer:function(){var i,r,n;i=this.options.key,r=this.options,n=(function(i,r,n,o){var a;if(i){this.fire("load-error",{value:i});return}a=o.tileInfo.spatialReference.wkid,c.indexOf(a)>=0||console.warn('This layer is not guaranteed to display properly because its service does not use the Web Mercator projection. The "tileInfo.spatialReference" property is:',o.tileInfo.spatialReference,"\nMore information is available at https://github.com/maplibre/maplibre-gl-js/issues/168 and https://github.com/Esri/esri-leaflet-vector/issues/94."),r=function(i,r,n,o){let a=Object.keys(i.sources);for(let s=0;s<a.length;s++){let l=i.sources[a[s]];-1===l.url.indexOf("http")&&(l.url=r.replace("/resources/styles/root.json","")),"/"===l.url.charAt(l.url.length-1)&&(l.url=l.url.slice(0,l.url.length-1)),l.tiles||(n.tiles&&"/"!==n.tiles[0].charAt(0)&&(n.tiles[0]="/"+n.tiles[0]),l.tiles=[l.url+n.tiles[0]]),l.url+="?f=json",l.url+=o?"&token="+o:"",l.tiles[0]+=o?"?token="+o:"",l.minzoom=n.minLOD||n.tileInfo.lods[0].level,l.maxzoom=n.maxLOD||n.tileInfo.lods[n.tileInfo.lods.length-1].level}let s=i.sources[a[a.length-1]];s.attribution=n.copyrightText||"",s.copyrightText=n.copyrightText||"";for(let r=0;r<i.layers.length;r++){let n=i.layers[r];n.layout&&n.layout["text-font"]&&n.layout["text-font"].length>1&&(n.layout["text-font"]=[n.layout["text-font"][0]])}return i.sprite&&-1===i.sprite.indexOf("http")&&(i.sprite=r.replace("styles/root.json",i.sprite.replace("../","")),i.sprite+=o?"?token="+o:""),i.glyphs&&-1===i.glyphs.indexOf("http")&&(i.glyphs=r.replace("styles/root.json",i.glyphs.replace("../","")),i.glyphs+=o?"?token="+o:""),i}(r,n,o,this.options.token),this._createMaplibreLayer(r)}).bind(this),/^https?:\/\//.test(i)&&/\/VectorTileServer\/?$/.test(i)?u(i,r,n):function(i,r,n){let o=r.portalUrl+"/sharing/rest/content/items/"+i+"/resources/styles/root.json";h(o,r,function(a,h){a?l(i,r,function(i,o){if(i){n(i);return}u(o.url,r,n)}):l(i,r,function(i,a){if(i){n(i);return}s(a.url,r,function(i,r){n(i,h,o,r,a.url)})})})}(i,r,n)},_setupAttribution:function(){if(!this.getAttribution()){let i=this._maplibreGL.getMaplibreMap().style.stylesheet.sources,r=Object.keys(i);this.options.attribution=i[r[r.length-1]].attribution,this._map&&this._map.attributionControl&&this._map.attributionControl.addAttribution(this.getAttribution())}},_createMaplibreLayer:function(i){var r;this._maplibreGL=(r={style:i,pane:this.options.pane,opacity:this.options.opacity},new d(r)),this._ready=!0,this.fire("ready",{},!0),this._maplibreGL.on("styleLoaded",(function(){this._setupAttribution(),this.options.style&&"function"==typeof this.options.style&&this._maplibreGL._glMap.setStyle(this.options.style(this._maplibreGL._glMap.getStyle()))}).bind(this))},onAdd:function(i){this._map=i,this._ready?this._asyncAdd():this.once("ready",function(){this._asyncAdd()},this)},onRemove:function(i){i.removeLayer(this._maplibreGL)},_asyncAdd:function(){let i=this._map;this._maplibreGL.addTo(i,this)}}),f=p.extend({initialize:function(i,r){if(r.version||(i.includes("/")?r.version=2:r.version=1),i||(i=1===r.version?"ArcGIS:Streets":"arcgis/streets"),!(r.apikey||r.apiKey||r.token))throw Error("An API Key or token is required for vectorBasemapLayer.");if(r.language&&2!==r.version)throw Error("The language parameter is only supported by the basemap styles service v2. Provide a v2 style enumeration to use this option.");r.pane||(i.includes(":Label")||i.includes("/label")?r.pane="esri-labels":i.includes(":Detail")||i.includes("/detail")?r.pane="esri-detail":r.pane="tilePane"),p.prototype.initialize.call(this,i,r)},_createLayer:function(){let i;i=this.options.version&&2===this.options.version?function(i,r,n){if(i.includes(":"))throw Error(i+" is a v1 style enumeration. Set version:1 to request this style");let o="https://basemapstyles-api.arcgis.com/arcgis/rest/services/styles/v2/styles/";if(i.startsWith("osm/")||i.startsWith("arcgis/")||32!==i.length)o+=i;else if(o=o+"items/"+i,n)throw Error("The 'language' parameter is not supported for custom basemap styles");return r&&(o=o+"?token="+r,n&&(o=o+"&language="+n)),o}(this.options.key,this.options.apikey,this.options.language):function(i,r){if(i.includes("/"))throw Error(i+" is a v2 style enumeration. Set version:2 to request this style");let n="https://basemaps-api.arcgis.com/arcgis/rest/services/styles/"+i+"?type=style";return r&&(n=n+"&token="+r),n}(this.options.key,this.options.apikey),this._createMaplibreLayer(i)},_setupAttribution:function(){if(r.Util.setEsriAttribution(this._map),32===this.options.key.length){let i=this._maplibreGL.getMaplibreMap().style.stylesheet.sources,r=[];Object.keys(i).forEach(function(n){r.push(i[n].attribution),i[n].copyrightText&&i[n].copyrightText&&""!==i[n].copyrightText&&i[n].attribution!==i[n].copyrightText&&r.push(i[n].copyrightText)}),this._map.attributionControl.addAttribution('<span class="">'+r.join(", ")+"</span>")}else if(this.options.attributionUrls||(this.options.attributionUrls=this._getAttributionUrls(this.options.key)),this._map&&this.options.attributionUrls){if(this._map.attributionControl){for(let i=0;i<this.options.attributionUrls.length;i++){let o=this.options.attributionUrls[i];!function(i,o){r.Support.cors&&r.request(i,{},function(i,a){if(!i){o._esriAttributions=o._esriAttributions||[];for(let i=0;i<a.contributors.length;i++){let r=a.contributors[i];for(let i=0;i<r.coverageAreas.length;i++){let a=r.coverageAreas[i],s=n.latLng(a.bbox[0],a.bbox[1]),l=n.latLng(a.bbox[2],a.bbox[3]);o._esriAttributions.push({attribution:r.attribution,score:a.score,bounds:n.latLngBounds(s,l),minZoom:a.zoomMin,maxZoom:a.zoomMax})}}o._esriAttributions.sort(function(i,r){return r.score-i.score}),r.Util._updateMapAttribution({target:o})}})}(o,this._map)}this._map.attributionControl.addAttribution('<span class="esri-dynamic-attribution"></span>')}r.Util._updateMapAttribution({target:this._map})}},_getAttributionUrls:function(i){return 0===i.indexOf("OSM:")||0===i.indexOf("osm/")?["https://static.arcgis.com/attribution/Vector/OpenStreetMap_v2"]:0===i.indexOf("ArcGIS:Imagery")||0===i.indexOf("arcgis/imagery")?["https://static.arcgis.com/attribution/World_Imagery","https://static.arcgis.com/attribution/Vector/World_Basemap_v2"]:["https://static.arcgis.com/attribution/Vector/World_Basemap_v2"]},_initPane:function(){if(!this._map.getPane(this.options.pane)){let i=this._map.createPane(this.options.pane);i.style.pointerEvents="none";let r=500;"esri-detail"===this.options.pane?r=250:"esri-labels"===this.options.pane&&(r=300),i.style.zIndex=r}},onRemove:function(i){if(i.off("moveend",r.Util._updateMapAttribution),i.removeLayer(this._maplibreGL),i.attributionControl){let r=document.getElementsByClassName("esri-dynamic-attribution");if(r&&r.length>0){let n=r[0].outerHTML;i.attributionControl.removeAttribution(n)}}},_asyncAdd:function(){let i=this._map;this._initPane(),i.on("moveend",r.Util._updateMapAttribution),this._maplibreGL.addTo(i,this)}});i.VERSION="4.1.0",i.VectorBasemapLayer=f,i.VectorTileLayer=p,i.vectorBasemapLayer=function(i,r){return new f(i,r)},i.vectorTileLayer=function(i,r){return new p(i,r)},Object.defineProperty(i,"__esModule",{value:!0})}(A,l("k23sD"),l("iLKzi"),l("8s90F"));let P=(0,u.tileLayer)("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{maxZoom:19,attribution:'&copy; <a href="https://openstreetmap.org/copyright">OpenStreetMap contributors</a>'}),k=(0,I.tiledMapLayer)({url:"https://gis.penndot.gov/arcgis/rest/services/basemaps/penndotbasemap/MapServer",attribution:"PennDOT"}),M=(0,I.tiledMapLayer)({url:" https://imagery.pasda.psu.edu/arcgis/rest/services/pasda/PEMAImagery2018_2020/MapServer",detectRetina:!0,attribution:"Pennsylvania Emergency Management Agency"}),z=(0,A.vectorBasemapLayer)("ArcGIS:Imagery:Labels",{apikey:"AAPK56c13fae1a6d4407a5d392981b9b50d2kwxUZMYHbCl1MyifP-JufC7lrC9K2TvvL93oR25h20j0cjvoAro30x-p0O27jPwS"}),D=(0,u.layerGroup)([M,z]),R=new u.map("webmap",{center:[40.79,-77.86],zoom:7,layers:[P]});R.attributionControl.addAttribution("PA Dept. Conservation & Natural Resources");var u=l("iLKzi"),B={};B=l("aNJCr").getBundleURL("01olE")+l("iE7OH").resolve("6zikQ");let O=new u.icon({iconUrl:B,iconSize:[30,30]}),F=(i,r)=>{let n=new u.marker([i,r],{icon:O,alt:"map marker for user's location"});return n},N=[[40.302,-79.544],[41.095,-78.887],[41.5737,-75.501],[40.279,-75.299],[40.913,-77.764],[41.747,-77.302]],U=()=>N[Math.floor(Math.random()*N.length)];L.Control.BetterScale=L.Control.extend({options:{position:"bottomleft",maxWidth:150,metric:!1,imperial:!0,updateWhenIdle:!1},onAdd:function(i){this._map=i;var r="leaflet-control-better-scale",n=L.DomUtil.create("div",r),o=this.options,a=L.DomUtil.create("div",r+"-ruler",n);return L.DomUtil.create("div",r+"-ruler-block "+r+"-upper-first-piece",a),L.DomUtil.create("div",r+"-ruler-block "+r+"-upper-second-piece",a),L.DomUtil.create("div",r+"-ruler-block "+r+"-lower-first-piece",a),L.DomUtil.create("div",r+"-ruler-block "+r+"-lower-second-piece",a),this._addScales(o,r,n),this.ScaleContainer=n,i.on(o.updateWhenIdle?"moveend":"move",this._update,this),i.whenReady(this._update,this),n},onRemove:function(i){i.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(i,r,n){this._iScale=L.DomUtil.create("div",r+"-label-div",n),this._iScaleLabel=L.DomUtil.create("div",r+"-label",this._iScale),this._iScaleFirstNumber=L.DomUtil.create("div",r+"-label "+r+"-first-number",this._iScale),this._iScaleSecondNumber=L.DomUtil.create("div",r+"-label "+r+"-second-number",this._iScale)},_update:function(){var i=this._map.getBounds(),r=6378137*Math.PI*Math.cos(i.getCenter().lat*Math.PI/180)*(i.getNorthEast().lng-i.getSouthWest().lng)/180,n=this._map.getSize(),o=this.options,a=0;n.x>0&&(a=r*(o.maxWidth/n.x)),this._updateScales(o,a)},_updateScales:function(i,r){i.metric&&r&&this._updateMetric(r),i.imperial&&r&&this._updateImperial(r)},_updateMetric_old:function(i){var r=this._getRoundNum(i);this._iScale.style.width=this._getScaleWidth(r/i)+"px",this._iScaleLabel.innerHTML=1e3>r?r+" m":r/1e3+" km"},_updateMetric:function(i){var r,n,o,a,s,l=this._iScaleFirstNumber,u=this._iScaleSecondNumber,h=this._iScale;this._iScaleLabel.innerHTML="0",i>500?(r=i/1e3,n=this._getRoundNum(r),a=this._getRoundNum(r/2),h.style.width=this._getScaleWidth(n/r)+"px",l.innerHTML=a,u.innerHTML=n+"km"):(o=this._getRoundNum(i),s=this._getRoundNum(i/2),h.style.width=this._getScaleWidth(o/i)+"px",l.innerHTML=s,u.innerHTML=o+"m")},_updateImperial:function(i){var r,n,o,a,s,l=3.2808399*i,u=this._iScaleFirstNumber,h=this._iScaleSecondNumber,c=this._iScale;this._iScaleLabel.innerHTML="0",l>2640?(r=l/5280,n=this._getRoundNum(r),a=this._getRoundNum(r/2),c.style.width=this._getScaleWidth(n/r)+"px",u.innerHTML=a,h.innerHTML=n+"mi"):(o=this._getRoundNum(l),s=this._getRoundNum(l/2),c.style.width=this._getScaleWidth(o/l)+"px",u.innerHTML=s,h.innerHTML=o+"ft")},_getScaleWidth:function(i){return Math.round(this.options.maxWidth*i)-10},_getRoundNum:function(i){if(i>=2){var r=Math.pow(10,(Math.floor(i)+"").length-1),n=i/r;return r*(n=n>=10?10:n>=5?5:n>=3?3:n>=2?2:1)}return(Math.round(100*i)/100).toFixed(1)}}),L.control.betterscale=function(i){return new L.Control.BetterScale(i)};let j=L.control.layers({"Open Street Map":P,"Streets (PennDOT)":k,"Satellite (PEMA)":D},null,{collapsed:!1}),Z=L.control.betterscale({maxWidth:200,metric:!1,imperial:!0,updateWhenIdle:!0,position:"bottomleft"});window.$=l("9qak9"),$("#search-btn").click(function(){$("#searchModal").modal("show")}),$("#basemap-btn").click(function(){$("#basemapModal").modal("show")}),$("#about-btn").click(function(){$("#aboutModal").modal("show")});let V=document.getElementById("userLocation"),q=document.getElementById("userDistance"),G=document.getElementById("resultsCard"),W=document.getElementById("errorMsg"),H=document.getElementById("closeResults"),X=document.getElementById("applySearch"),K=document.getElementById("selectPa"),J=u.Browser.pointer;console.log(`Browser supports "pointer events" : ${J}`);let Y=i=>{let r=document.createElement("p");r.innerHTML=i,W.append(r)};j.addTo(R),Z.addTo(R),(()=>{let i=document.querySelectorAll("div.leaflet-top.leaflet-right")[0],r=document.querySelectorAll("div.leaflet-control-layers.leaflet-control")[0],n=document.getElementById("layerControlUI"),o=i.removeChild(r);n.appendChild(o)})();let Q=new u.layerGroup,tt=new u.layerGroup;Q.addTo(R),tt.addTo(R);let te=n=>{h().then(o=>{if($("#searchModal").modal("hide"),K.checked){let n=U();i=n[0],r=n[1]}else i=o.coords.latitude,r=o.coords.longitude;let a=c(i,r);q.innerHTML=n,V.innerHTML=`Latitude: ${i.toFixed(3)}; Longitude: ${r.toFixed(3)}`,Q.getLayers().forEach(i=>{i.removeFrom(R)}),tt.getLayers().forEach(i=>{i.removeFrom(R)}),S(document.getElementById("records")),C(a,n,R,Q,tt);let s=F(i,r);tt.addLayer(s),G.style.display="flex"}).catch(i=>{console.error(i.message),Y(i.message)})};X.addEventListener("click",i=>{te(document.getElementById("queryDistance").value)}),H.addEventListener("click",i=>{G.style.display="none"})}();
//# sourceMappingURL=index.bd4aad7d.js.map
